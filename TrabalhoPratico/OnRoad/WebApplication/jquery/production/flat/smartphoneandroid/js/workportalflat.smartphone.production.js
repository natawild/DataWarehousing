function printf(e){var t,r=Array.prototype.slice.call(arguments,1);return e.replace(/(%[disv])/g,function(e,i){if(void 0!==(t=r.shift()))switch(i.charCodeAt(1)){case 100:return+t;case 105:return Math.round(+t);case 115:return String(t);case 118:return t}return i})}!function(){var e,t,r=window.steal||{},i=window.bizagi||{};i.loader=i.loader||{},"release"===i.loader.environment&&(t={registerMobileWebpart:function(e){"string"==typeof e&&(e=[e]),this.webparts=this.webparts||{},e.map(function(e){this.webparts[e]||(this.webparts[e]={class:"bizagi.workportal.webparts."+e,devices:null,location:"",name:e,js:[],css:[],tmpl:[]}),this.webparts[e].initialized=!0,this.webparts[e].initializing=!1,this.webparts[e].loadingDeferred=this.webparts[e].loadingDeferred||new $.Deferred}.bind(this))}},Object.keys(t).map(function(e){i.loader[e]=t[e]}),e=!1,r.origRequest=r.request,r.request=function(t,a,o){if(!(arguments[0]&&arguments[0].src&&(arguments[0].src+"").match(/\/workportalflat\/webparts\//i)))return this.origRequest(t,a,o);var s=i.detectDevice().replace(/[^a-z0-9]+/gi,"");if(!e){var n=i.loader.useAbsolutePath?i.loader.basePath+i.loader.getLocationPrefix():""+i.loader.getLocationPrefix(),c=n+"jquery/workportalflat/production/"+s+"/webpart."+s+".production.js?build="+i.loader.build,l=n+"jquery/workportalflat/production/"+s+"/webpart."+s+".production.css?build="+i.loader.build;e=!0,i.loader.loadFile({type:"js",src:c}),i.loader.loadFile({type:"css",src:l})}var d=arguments[0].id+"";i.loader.registerMobileWebpart(s),r.resources[d].completed.resolve(),r.resources[d].loaded.resolve(),r.resources[d].loading=!1,r.resources[d].executing=!1,r.resources[d].options.text=JSON.stringify(i.loader.webparts[s]),a(r.resources[d].options.text)})}(),bizagi="undefined"!=typeof bizagi?bizagi:{},bizagi.util=void 0!==bizagi.util?bizagi.util:{},bizagi.context=void 0!==bizagi.context?bizagi.context:{},bizagi.util.smartphone=void 0!==bizagi.util.smartphone?bizagi.util.smartphone:{},bizagi.util.tablet=void 0!==bizagi.util.tablet?bizagi.util.tablet:{},bizagi.util.mobility=void 0!==bizagi.util.mobility?bizagi.util.mobility:{},bizagi.util.detectDevice=function(){return bizagi.detectDevice()},bizagi.util.isNull=function(e){return"[object Null]"===Object.prototype.toString.apply(e)},bizagi.util.isEmpty=function(e){return 0!==e&&(null==e||""===e||("Array"==typeof e?0==e.length:"[object Array]"===Object.prototype.toString.apply(e)?0===e.length:"[object Object]"===Object.prototype.toString.apply(e)&&$.isEmptyObject(e)))},bizagi.loader.initWebpartOld=bizagi.loader.initWebpart,bizagi.loader.initWebpart=function(e,t,r){return null!=e&&(e.initialized?steal.then(function(){r&&r()}):e.devices?void 0!==e.devices[t]?bizagi.loader.initWebpartOld($.extend(e,e.devices[t]),r):console.log("No existe la definicion del device "+t+" Para el webpart "+e.name):bizagi.loader.initWebpartOld(e,r)),this},bizagi.util.initWebpart=function(e,t){var r=new $.Deferred;return e.initialized?r.resolve():e.initializing?$.when(e.loadingDeferred.promise()).done(function(){r.resolve()}):(e.loadingDeferred=new $.Deferred,e.initializing=!0,bizagi.loader.initWebpart(e,t,function(){e.loadingDeferred.resolve(),e.initializing=!1,r.resolve()})),r.promise()},bizagi.cookie=function(e,t,r){if(arguments.length>1&&"[object Object]"!==String(t)){if(r=$.extend({},r),null==t&&(r.expires=-1),"number"==typeof r.expires){var i=r.expires,a=r.expires=new Date;a.setDate(a.getDate()+i)}return t=String(t),document.cookie=[encodeURIComponent(e),"=",r.raw?t:encodeURIComponent(t),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("")}var o,s=(r=t||{}).raw?function(e){return e}:decodeURIComponent;return(o=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?s(o[1]):null},bizagi.util.formatInvariantDate=function(e,t){e=e||"",t=t||"MM/dd/yyyy hh:mm:ss",$(".formatDate",e).not(".formated").each(function(e,r){var i=$(r).html();$(r).addClass("formated");try{var a=new Date(i),o=bizagi.util.dateFormatter.formatDate(a,t);$(r).html(o)}catch(e){$(r).html(i)}})},bizagi.util.isEventSupported=function(e,t){var r,i=!("onblur"in document.documentElement);return!!e&&(t&&"string"!=typeof t||(t=document.createElement(t||"div")),!(r=(e="on"+e)in t)&&i&&(t.setAttribute||(t=document.createElement("div")),t.setAttribute&&t.removeAttribute&&(t.setAttribute(e,""),r="function"==typeof t[e],void 0!==t[e]&&(t[e]=void 0),t.removeAttribute(e))),r)},bizagi.circularDependencies=function(){var e=(new Function).prototype;e.list=[],e.lastNodeAdded,e.addNode=function(t,r){var i=JSON.encode(r),s=a(t,i);if(!s){var n=new o(t,i);return e.list.push({name:t,obj:i,nodeObj:n,timeStamp:(new Date).getTime()}),n}(e.lastNodeAdded||e.list[e.list.length-1]).nodeObj.addChild(s.nodeObj),e.lastNodeAdded=s},e.resolve=function(t,r,a){return t=t||i()||e.list[0].nodeObj,new s(t,r,a)};var t,r,i=function(){for(var t=0;t<e.list.length;t++)if(e.list[t].nodeObj.childs.length>0)return e.list[t].nodeObj;return e.list.length>0?e.list[0].nodeObj:{}},a=function(t,r){for(var i=0;i<e.list.length;i++)if(e.list[i].name==t){var a=(new Date).getTime();if(e.list[i].timeStamp+2e3<a)e.list.splice(i,1);else if(e.list[i].obj==r)return e.list[i]}return!1},o=function(e,t){e=e||"",t=t||{};var r=function(e,t){this.name=e,this.obj=t,this.childs=[]};return r.prototype.addChild=function(e){this.childs.push(e)},r}(),s=((r=(t=function(i,a,o){this.node=i||{},this.node.childs=this.node.childs||[],this.resolved=a||[],this.seen=o||[],this.seen.push(this.node);for(var s=0;s<this.node.childs.length;s++)if(!r.hasObject(this.node.childs[s],this.resolved)){if(r.hasObject(this.node.childs[s],this.seen)){e.list=[];var n={dependencyFrom:this.node.name,dependencyFromObj:this.node.obj,dependencyTo:this.node.childs[s].name,dependencyToObj:this.node.childs[s].obj,path:this.seen};return{error:$.extend({standardError:{status:"error",responseText:JSON.encode({message:r.makeErrorMessage(n),type:"alert"})},multiactionError:{message:r.makeErrorMessage(n),type:"alert"}},n)}}t(this.node.childs[s],this.resolved,this.seen)}this.resolved&&this.resolved.push(this.node)}).prototype).hasObject=function(e,t){for(var r=0;r<t.length;r++)if(t[r].name==e.name)return!0;return!1},r.makeErrorMessage=function(e){return printf(bizagi.localization.getResource("render-actions-loop-validation"),e.dependencyFrom,e.dependencyTo)},t);return e},bizagi.util.autoSave=function(){var e=$.Deferred();return $(document).data("auto-save")?$(document).trigger("save-form",[e]):e.resolve(),e.promise()},bizagi.util.isDate=function(e){var t=!1,r="string"==typeof(e=e||"")?e.split("/"):"";try{if(3==r.length)new Date(e).getYear()>0&&(t=!0)}catch(e){t=!1}return t},bizagi.util.formatBoolean=function(e){return 1==bizagi.util.parseBoolean(e)?bizagi.localization.getResource("render-boolean-yes"):0==bizagi.util.parseBoolean(e)?bizagi.localization.getResource("render-boolean-no"):""},bizagi.util.replaceLineBreak=function(e){return"string"==typeof e?e.replace(/\r\n|\r|\n|<br>|<br\/>/g,"<br/>"):e},bizagi.util.replaceAll=function(e,t,r){return bizagi.replaceAll(e,t,r)},String.prototype.replaceAll=function(e,t){return bizagi.util.replaceAll(this,e,t)},bizagi.util.trim=function(e){return void 0===e||null==e?e:e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},bizagi.util.percent2Number=function(e){return Number(String(e).replace("%",""))},bizagi.util.isObjectEmpty=function(e){return!(e.length>0)},bizagi.util.setContext=function(e,t){e=e||{},(t=t||!1)&&(bizagi.context={}),$.each(e,function(e,t){bizagi.context[e]=t})},bizagi.util.decodeURI=function(e){for(var t,r=!1,i=e=e||"";!r;)try{(t=decodeURI(i))==i?r=!0:i=t}catch(e){r=!0}return i},jQuery,jQuery.br2nl=function(e){return e.replace(/\r\n|\r|\n|<br>|<br\/>/g,"\r")},jQuery,jQuery.nl2br=function(e){return e.replace(/(\r\n|\n\r|\r|\n|\\r\\n|\\n\\r|\\r|\\n)/g,"<br>")},bizagi.util.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},bizagi.util.browserSupportLocalStorage=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}},bizagi.util.setItemLocalStorage=function(e,t){return!!bizagi.util.browserSupportLocalStorage()&&(localStorage.setItem(e,t),!0)},bizagi.util.getItemLocalStorage=function(e){return localStorage.getItem(e)},bizagi.util.removeItemLocalStorage=function(e){localStorage.removeItem(e)},bizagi.util.clearLocalStorage=function(){bizagi.util.browserSupportLocalStorage()&&localStorage.clear()},bizagi.util.md5=function(e){var t=t||function(e,t){var r={},i=r.lib={},a=function(){},o=i.Base={extend:function(e){a.prototype=this;var t=new a;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=i.WordArray=o.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,r=e.words,i=this.sigBytes;if(e=e.sigBytes,this.clamp(),i%4)for(var a=0;a<e;a++)t[i+a>>>2]|=(r[a>>>2]>>>24-a%4*8&255)<<24-(i+a)%4*8;else if(65535<r.length)for(a=0;a<e;a+=4)t[i+a>>>2]=r[a>>>2];else t.push.apply(t,r);return this.sigBytes+=e,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var r=[],i=0;i<t;i+=4)r.push(4294967296*e.random()|0);return new s.init(r,t)}}),n=r.enc={},c=n.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],i=0;i<e;i++){var a=t[i>>>2]>>>24-i%4*8&255;r.push((a>>>4).toString(16)),r.push((15&a).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i+=2)r[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new s.init(r,t/2)}},l=n.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var r=[],i=0;i<e;i++)r.push(String.fromCharCode(t[i>>>2]>>>24-i%4*8&255));return r.join("")},parse:function(e){for(var t=e.length,r=[],i=0;i<t;i++)r[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new s.init(r,t)}},d=n.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},u=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r=this._data,i=r.words,a=r.sigBytes,o=this.blockSize,n=a/(4*o);if(t=(n=t?e.ceil(n):e.max((0|n)-this._minBufferSize,0))*o,a=e.min(4*t,a),t){for(var c=0;c<t;c+=o)this._doProcessBlock(i,c);c=i.splice(0,t),r.sigBytes-=a}return new s.init(c,a)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=u.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new p.HMAC.init(e,r).finalize(t)}}});var p=r.algo={};return r}(Math);return function(e){function r(e,t,r,i,a,o,s){return((e=e+(t&r|~t&i)+a+s)<<o|e>>>32-o)+t}function i(e,t,r,i,a,o,s){return((e=e+(t&i|r&~i)+a+s)<<o|e>>>32-o)+t}function a(e,t,r,i,a,o,s){return((e=e+(t^r^i)+a+s)<<o|e>>>32-o)+t}function o(e,t,r,i,a,o,s){return((e=e+(r^(t|~i))+a+s)<<o|e>>>32-o)+t}for(var s=t,n=(l=s.lib).WordArray,c=l.Hasher,l=s.algo,d=[],u=0;64>u;u++)d[u]=4294967296*e.abs(e.sin(u+1))|0;l=l.MD5=c.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var s=0;16>s;s++){var n=e[u=t+s];e[u]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}s=this._hash.words;var c,l,u=e[t+0],p=(n=e[t+1],e[t+2]),g=e[t+3],m=e[t+4],f=e[t+5],h=e[t+6],y=e[t+7],v=e[t+8],b=e[t+9],w=e[t+10],x=e[t+11],C=e[t+12],P=e[t+13],A=e[t+14],k=e[t+15],S=s[0],R=o(R=o(R=o(R=o(R=a(R=a(R=a(R=a(R=i(R=i(R=i(R=i(R=r(R=r(R=r(R=r(R=s[1],l=r(l=s[2],c=r(c=s[3],S=r(S,R,l,c,u,7,d[0]),R,l,n,12,d[1]),S,R,p,17,d[2]),c,S,g,22,d[3]),l=r(l,c=r(c,S=r(S,R,l,c,m,7,d[4]),R,l,f,12,d[5]),S,R,h,17,d[6]),c,S,y,22,d[7]),l=r(l,c=r(c,S=r(S,R,l,c,v,7,d[8]),R,l,b,12,d[9]),S,R,w,17,d[10]),c,S,x,22,d[11]),l=r(l,c=r(c,S=r(S,R,l,c,C,7,d[12]),R,l,P,12,d[13]),S,R,A,17,d[14]),c,S,k,22,d[15]),l=i(l,c=i(c,S=i(S,R,l,c,n,5,d[16]),R,l,h,9,d[17]),S,R,x,14,d[18]),c,S,u,20,d[19]),l=i(l,c=i(c,S=i(S,R,l,c,f,5,d[20]),R,l,w,9,d[21]),S,R,k,14,d[22]),c,S,m,20,d[23]),l=i(l,c=i(c,S=i(S,R,l,c,b,5,d[24]),R,l,A,9,d[25]),S,R,g,14,d[26]),c,S,v,20,d[27]),l=i(l,c=i(c,S=i(S,R,l,c,P,5,d[28]),R,l,p,9,d[29]),S,R,y,14,d[30]),c,S,C,20,d[31]),l=a(l,c=a(c,S=a(S,R,l,c,f,4,d[32]),R,l,v,11,d[33]),S,R,x,16,d[34]),c,S,A,23,d[35]),l=a(l,c=a(c,S=a(S,R,l,c,n,4,d[36]),R,l,m,11,d[37]),S,R,y,16,d[38]),c,S,w,23,d[39]),l=a(l,c=a(c,S=a(S,R,l,c,P,4,d[40]),R,l,u,11,d[41]),S,R,g,16,d[42]),c,S,h,23,d[43]),l=a(l,c=a(c,S=a(S,R,l,c,b,4,d[44]),R,l,C,11,d[45]),S,R,k,16,d[46]),c,S,p,23,d[47]),l=o(l,c=o(c,S=o(S,R,l,c,u,6,d[48]),R,l,y,10,d[49]),S,R,A,15,d[50]),c,S,f,21,d[51]),l=o(l,c=o(c,S=o(S,R,l,c,C,6,d[52]),R,l,g,10,d[53]),S,R,w,15,d[54]),c,S,n,21,d[55]),l=o(l,c=o(c,S=o(S,R,l,c,v,6,d[56]),R,l,k,10,d[57]),S,R,h,15,d[58]),c,S,P,21,d[59]),l=o(l,c=o(c,S=o(S,R,l,c,m,6,d[60]),R,l,x,10,d[61]),S,R,p,15,d[62]),c,S,b,21,d[63]);s[0]=s[0]+S|0,s[1]=s[1]+R|0,s[2]=s[2]+l|0,s[3]=s[3]+c|0},_doFinalize:function(){var t=this._data,r=t.words,i=8*this._nDataBytes,a=8*t.sigBytes;r[a>>>5]|=128<<24-a%32;var o=e.floor(i/4294967296);for(r[15+(a+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),r[14+(a+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t.sigBytes=4*(r.length+1),this._process(),r=(t=this._hash).words,i=0;4>i;i++)a=r[i],r[i]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8);return t},clone:function(){var e=c.clone.call(this);return e._hash=this._hash.clone(),e}}),s.MD5=c._createHelper(l),s.HmacMD5=c._createHmacHelper(l)}(Math),t.MD5(e).toString()},bizagi.util.stripslashes=function(e){return e.replace(/\\'/g,"'").replace(/\"/g,'"').replace(/\\\\/g,"\\").replace(/\\0/g,"\0")},bizagi.getTimeAgo=function(e){return $.timeago(new Date(e))},bizagi.util.replaceAllGlobalRegExp=function(e,t,r){var i=e,a=new RegExp(t,"g");return(i=i.replace(a,r)).toString()},bizagi.util.dispose=function(e){for(key in e)"object"==typeof e[key]&&delete e[key],"function"==typeof e[key]&&(e[key]=null,delete e[key])},bizagi.getGroupedData=function(e){var t={},r=new Date,i=r.getFullYear(),a=r.getMonth(),o=r.getDate();e=bizagi.util.isDate(e)?e:r;var s=new Date(e),n=s.getMonth(),c=s.getFullYear(),l=s.getDate();return new Date(c,n,l,0,0,0)-new Date(i,a,o,0,0,0)<0?(t.date=bizagi.util.dateFormatter.formatDate(new Date(s),"dd MMM"),t.type=bizagi.localization.getResource("workportal-taskfeed-overdue"),t.status="red"):o===l?(t.date=bizagi.util.dateFormatter.formatDate(new Date(s),"hh:mm"),t.type=bizagi.localization.getResource("workportal-taskfeed-today"),t.status="yellow"):o+1===l?(t.date=bizagi.util.dateFormatter.formatDate(new Date(s),"hh:mm"),t.type=bizagi.localization.getResource("workportal-taskfeed-tomorrow"),t.status="yellow"):(t.date=bizagi.util.dateFormatter.formatDate(new Date(s),"dd MMM"),t.type=bizagi.localization.getResource("workportal-taskfeed-upcomming"),t.status="green"),t},bizagi.util.getTaskStatus=function(e){var t=new Date,r=t.getMonth(),i=t.getDate(),a=t.getFullYear(),o=e||"";if(!bizagi.util.isDate(o))return"--";var s=new Date(o),n=s.getDate(),c=s.getMonth(),l=s.getFullYear();return new Date(l,c,n,0,0,0)-new Date(a,r,i,0,0,0)<0?bizagi.util.dateFormatter.formatDate(new Date(o),"dd MMM"):r===c&&i===n?bizagi.util.dateFormatter.formatDate(new Date(o),"hh:mm"):r===c&&i+1===n?bizagi.util.dateFormatter.formatDate(new Date(o),"hh:mm"):bizagi.util.dateFormatter.formatDate(new Date(o),"dd MMM")},bizagi.util.unicode2htmlencode=function(e){var t,r=(e=e.replace(/\r\n/g,"\n")).length,i="";for(t=0;t<r;t++)i+="&#x"+e.charCodeAt(t).toString(16)+";";return i},bizagi.util.getHeadElement=function(){var e=document.getElementsByTagName("head")[0],t=document&&document.documentElement;return e||(e=document.createElement("head"),t.insertBefore(e,t.firstChild)),bizagi.util.getHeadElement=function(){return e},e},bizagi.util.loadStyle=function(e,t){var r,i=document.getElementById(t);if(e&&!i){var a=document.createElement("style");a.type="text/css",a.id=t,a.styleSheet?a.styleSheet.cssText=e:(r=document.createTextNode(e),a.childNodes.length?a.firstChild.nodeValue!==r.nodeValue&&a.replaceChild(r,a.firstChild):a.appendChild(r)),bizagi.util.getHeadElement().appendChild(a)}},bizagi.util.smartphone.startLoading=function(){bizagi.loading.start()},bizagi.util.smartphone.stopLoading=function(){bizagi.loading.stop()},bizagi.util.formatDataType=function(e,t){return"NText"===t||"VarChar"===t?"<div>"+bizagi.util.replaceLineBreak(e)+"</div>":"Boolean"===t?bizagi.util.formatBoolean(e):"Int"===t||"BigInt"===t||"SmallInt"===t||"TinyInt"===t?e:"Money"===t?bizagi.util.formatMonetaryCell(e):"Float"===t||"Real"===t?bizagi.util.formatDecimalCell(e):"DateTime"===t?bizagi.util.dateFormatter.formatDate(new Date(e),bizagi.localization.getResource("dateFormat")+" "+bizagi.localization.getResource("timeFormat")):e},bizagi.util.formatDateTime=function(e){if(e="string"!=typeof(e=null==e?"":e)?e.toString():e,Date.parse(e)){var t=new Date(e);return(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"/"+(t.getDate()<10?"0"+t.getDate():t.getDate())+"/"+t.getFullYear()+" "+((t.getHours()<12&&e.toLowerCase().indexOf("pm")>0?t.getHours()+12:t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()))}return e},bizagi.util.formatMonetaryCell=function(e){return bizagi.util.formatMoney(e,BIZAGI_DEFAULT_CURRENCY_INFO)},bizagi.util.formatDecimalCell=function(e){var t={decimalSymbol:BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator,digitGroupSymbol:BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator,roundToDecimalPlace:BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits},r=$.extend({colorize:!1,decimalSymbol:".",digitGroupSymbol:",",groupDigits:!0,negativeFormat:"(%s%n)",positiveFormat:"%s%n",roundToDecimalPlace:"2",symbol:""},t);return bizagi.util.formatDecimal(e,r)},bizagi.util.formatMoney=function(e,t){var r="",i="",a="",o="",s="";if((e=null!=e?e.toString():"0").length>=1){var n=e.indexOf(".");if(n>0)a=(e=parseFloat(e).toFixed(t.decimalDigits)).substring(0,n);else{for(var c=0;c<t.decimalDigits;c++)s+="0";a=e.replace(/\D/g,"")}if(e=e.replace(/\D/g,""),o=t.decimalDigits>0?n>0?t.decimalSeparator+e.substring(e.length-t.decimalDigits,e.length):t.decimalSeparator+s:"",a.length>3){var l=0;for(c=a.length-1;c>=0;c--)3==l&&(i+=".",l=0),i+=a[c],l+=1;for(c=i.length-1;c>=0;c--)r+=i[c]}else r=a;return r=r.replaceAll(".",t.groupSeparator),r=t.symbol+r+o}return e},bizagi.util.formatDecimal=function(e,t){var r=$("<i/>").text(e);return r.formatCurrency(t),r.text()},bizagi.util.arrayEach=function(e,t){var r;if(e)if("[object Array]"===Object.prototype.toString.apply(e)&&"[object Function]"===Object.prototype.toString.apply(t)){for(r in e)if(e.hasOwnProperty(r)&&!1===t.call(e[r],r,e[r]))return}else $.each(e,t)},function(e){e.fn.callInside=function(t,r){if("iframe"!=e(this)[0].tagName.toLowerCase())return null;if(null==e(this)[0].contentWindow)return null;try{e(this)[0].contentWindow.args=r}catch(e){return null}return e(this)[0].contentWindow.eval("args = window.args;insideFunction = "+t.toString()+"; insideFunction(args)")}}(jQuery),bizagi.util.encodeHtml=function(e){return null==e?"":"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):e},bizagi.util.syntaxHighlight=function(e){return void 0===e||null==e?"":(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var t="number";return/^"/.test(e)?t=/:$/.test(e)?"key":"string":/true|false/.test(e)?t="boolean":/null/.test(e)&&(t="null"),"<span class='"+t+"'>"+e+"</span>"})},bizagi.util.b64EncodeUnicode=function(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))},bizagi.util.getQueryString=function(e){for(var t={},r=((e=e||window.location.href).indexOf("?")>0?e.substring(e.indexOf("?")+1):"").split("&"),i=0;i<r.length;i++){var a=r[i].indexOf("=");if(-1!=a){var o=r[i].substring(0,a),s=r[i].substring(a+1);t[o]=unescape(s)}}return t},bizagi="undefined"!=typeof bizagi?bizagi:{},bizagi.util=void 0!==bizagi.util?bizagi.util:{},bizagi.util.smartphone=void 0!==bizagi.util.smartphone?bizagi.util.smartphone:{},bizagi.util.mobility=void 0!==bizagi.util.mobility?bizagi.util.mobility:{},bizagi.environment="undefined"!=typeof BIZAGI_ENVIRONMENT?BIZAGI_ENVIRONMENT:queryString.environment||"debug",bizagi.util.smartphone.startLoading=function(){bizagi.loading.start()},bizagi.util.smartphone.stopLoading=function(){bizagi.loading.stop()},bizagi.util.smartphone.startkendo=function(){void 0===bizagi.kendoMobileApplication&&(bizagi.kendoMobileApplication=new kendo.mobile.Application($("body"),{transition:"slide",skin:"flat",initial:"initKendo",init:function(e){kendo.ui.progress($(".km-flat"),!0),bizagi.util.setIphoneXOverrides()}}),bizagi.kendoMobileApplication.bizagiNavigate=function(e,t){this.navigate(e,t)})},$.Class.extend("bizagi.workportal.controllers.controller",{},{init:function(e,t,r){this.workportalFacade=e,this.dataService=t,this.resources=bizagi.localization,this.container=r.container||document,this.componentContainers={},bizagi.workportal.controllers.instances={},bizagi.workportal.controllers.instances.controller=this},getWorkportal:function(){return this.workportalFacade.workportal},publish:function(e,t){return $(this.container).triggerHandler(e,t)},subscribe:function(e,t){$(this.container).bind(e,t)},subscribeEvent:function(e,t){$(document).bind(e,t)},subscribeOneTime:function(e,t){$(this.container).one(e,t)},unsubscribe:function(e,t){t?$(this.container).unbind(e,t):$(this.container).unbind(e)},render:function(){bizagi.showMessageBox("controllers render","Error");var e=this,t=new $.Deferred;return $.when(e.renderContent()).done(function(){e.postRender(),t.resolve(e.getContent())}),t.promise()},getContent:function(){return this.content},getResource:function(e,t){return this.resources.getResource(e,t)},renderContent:function(){return""},postRender:function(){}}),$.Class.extend("bizagi.workportal.services.context",{},{init:function(e){this.context=e.context,this.endPoints=bizagi.workportal.services.getEndPoints(e),this.proxyPrefix=bizagi.util.isEmpty(e.proxyPrefix)?"":e.proxyPrefix},getUrl:function(e){return void 0===this.endPoints[e]&&bizagi.log("Url not found","No endpoint defined for: "+e),this.endPoints[e]},setProxyPrefix:function(e){this.proxyPrefix=bizagi.util.isEmpty(e.proxyPrefix)?"":e.proxyPrefix,this.endPoints=bizagi.workportal.services.getEndPoints(e)}}),bizagi.workportal=void 0!==bizagi.workportal?bizagi.workportal:{},bizagi.workportal.services=void 0!==bizagi.workportal.services?bizagi.workportal.services:{},bizagi.workportal.services.endPoints=[],bizagi.workportal.services.getEndPoints=function(e){if("workportal"==e.context){var t={"user-handler":e.proxyPrefix+"RestServices/UserHandler.ashx","process-handler":e.proxyPrefix+"RestServices/ProcessHandler.ashx","query-handler":e.proxyPrefix+"Rest/Handlers/Query","case-handler":e.proxyPrefix+"RestServices/CaseHandler.ashx","query-form":e.proxyPrefix+"App/ListaDetalle/QueryForm.aspx","query-form-edit":e.proxyPrefix+"App/ListaDetalle/SaveQuery.aspx","query-form-delete":e.proxyPrefix+"App/ListaDetalle/QueryForm.aspx","query-form-delete-cube":e.proxyPrefix+"Rest/Queries/Cubes/{idCube}","favorites-handler":e.proxyPrefix+"RestServices/FavoritesHandler.ashx","file-handler":e.proxyPrefix+"RestServices/EntityHandler.ashx","login-handler":e.proxyPrefix+"Rest/Users/UserAuthentication","login-handlerv10":e.proxyPrefix+"RestServices/UserHandler.ashx?action=authenticateUser&userName={0}&password={1}&domain={2}","logoff-handler":e.proxyPrefix+"RestServices/UserHandler.ashx?action=logOff","logoff-handlerv1":e.proxyPrefix+"Rest/Users/LogOff","authorization-handler-getMenuAuthorization":e.proxyPrefix+"Rest/Authorization/MenuAuthorization","authorization-handler-isCaseCreationAuthorized":e.proxyPrefix+"Rest/Authorization/Processes/{0}/IsCaseCreationAuthorized","case-handler-getCaseSummary":e.proxyPrefix+"Rest/Cases/{idCase}/Summary","case-handler-releaseActivity":e.proxyPrefix+"Rest/Cases/{idCase}/ReleaseActivity","case-handler-getCasesList":e.proxyPrefix+"Rest/Processes/SearchCases","case-handler-getActivityList":e.proxyPrefix+"Api/Cases/Activities","offline-getProcessTree":e.proxyPrefix+"Rest/Processes/OfflineProcessTree","offline-getForms":e.proxyPrefix+"Rest/RenderForm/offlineForms","offline-sendForm":e.proxyPrefix+"Rest/Cases/SaveAsynchWorkItemOffLine","case-handler-getCaseTasks":e.proxyPrefix+"Rest/Cases/{idCase}/Tasks","case-handler-getCaseEvents":e.proxyPrefix+"Rest/Cases/{idCase}/Events","case-handler-getCaseSubprocesses":e.proxyPrefix+"Rest/Cases/{idCase}/Subprocesses","case-handler-getTaskAssignees":e.proxyPrefix+"Rest/Cases/{idCase}/Tasks/{idTask}/Assignees","case-handler-getCaseAssignees":e.proxyPrefix+"Rest/Cases/{idCase}/Assignees","case-handler-getWorkItems":e.proxyPrefix+"Rest/Cases/{idCase}/WorkItems","case-handler-getAsynchExecutionState":e.proxyPrefix+"Rest/Cases/{idCase}/AsynchExecutionState","case-handler-addNewCase":e.proxyPrefix+"Rest/Cases","case-handler-startProcess":e.proxyPrefix+"Rest/Processes/StartProcess/{idProcess}","handler-execute-action-start":e.proxyPrefix+"Api/Cases/{processId}/Start","case-handler-supportedLogTypes":e.proxyPrefix+"Rest/Cases/SupportedLogsTypes","case-handler-getActivityLog":e.proxyPrefix+"Rest/Cases/{idCase}/ActivityLog","case-handler-getActivityDetailLog":e.proxyPrefix+"Rest/Cases/{idCase}/{idWorkItemFrom}/ActivityDetailLog","case-handler-getEntityLog":e.proxyPrefix+"Rest/Cases/{idCase}/EntityLog","case-handler-getEntityDetailLog":e.proxyPrefix+"Rest/Cases/{idCase}/EntityDetailLog","case-handler-getUserLog":e.proxyPrefix+"Rest/Cases/{idCase}/UserLog","case-handler-getUserDetailLog":e.proxyPrefix+"Rest/Cases/{idCase}/{idUser}/UserDetailLog","case-handler-getAdminLog":e.proxyPrefix+"Rest/Cases/{idCase}/AdminLog","case-handler-getCaseFormsRenderVersion":e.proxyPrefix+"Rest/Cases/{idCase}/FormsRenderVersion","case-handler-validateHasStartForm":e.proxyPrefix+"Api/Processes/{processId}/StartContext","favorites-handler-saveFavorite":e.proxyPrefix+"Rest/Favorites","favorites-handler-deleteFavorite":e.proxyPrefix+"Rest/Favorites/{guidFavorite}","process-getIcon":e.proxyPrefix+"Api/Processes/{processId}/Icon","collections-getIcon":e.proxyPrefix+"Api/CurrentUser/Collections/{collectionId}/Icon","bamAnalytics-handler-getAnalisysQueries":e.proxyPrefix+"Rest/BAMAnalytics/AnalisysQueries","bamAnalytics-handler-updateQuery":e.proxyPrefix+"Rest/BAMAnalytics/Reports/Ids/{idQuery}","inbox-handler-getInboxSummary":e.proxyPrefix+"Rest/Inbox/Summary","MessageHandler-NewComment":e.proxyPrefix+"Rest/Cases/Comments","MessageHandler-GetComments":e.proxyPrefix+"Rest/Cases/Comments","MessageHandler-SetCategoryToComment":e.proxyPrefix+"Rest/Cases/Comments/{idComment}","MessageHandler-RemoveComment":e.proxyPrefix+"Rest/Cases/Comments/{idComment}","MessageHandler-ReplyComment":e.proxyPrefix+"Rest/Cases/Comments/{idComment}/Replies","MessageHandler-RemoveReply":e.proxyPrefix+"Rest/Cases/Comments/{idComment}/Replies/{idReply}","MessageHandler-GetCategoryColors":e.proxyPrefix+"Rest/Cases/Comments/CategoryColors","MessageHandler-RenameCategoryColor":e.proxyPrefix+"Rest/Cases/Comments/CategoryColors/{idColorCategory}","MessageHandler-CountNewComments":e.proxyPrefix+"Rest/Cases/Comments/{idComment}/NewComments/Count","process-handler-getAllProcesses":e.proxyPrefix+"Rest/Processes","process-handler-getFavourites":e.proxyPrefix+"Rest/Home/MyFavorites/Count","process-handler-getFavouriteCases":e.proxyPrefix+"Rest/Home/MyFavorites","process-handler-getCustomizedColumnsData":e.proxyPrefix+"Rest/Processes/CustomizedColumnsData","process-handler-getCategory":e.proxyPrefix+"Rest/Processes/Categories","process-handler-getRecentProcesses":e.proxyPrefix+"Rest/Processes/RecentProcesses","process-handler-getCustomizedColumnsDataInfo":e.proxyPrefix+"Rest/Processes/CustomizedColumnsDataInfo","process-handler-getOrganizations":e.proxyPrefix+"Rest/Profile/Organizations","process-handler-getMyStuff":e.proxyPrefix+"Api/CurrentUser/Collections","process-handler-getIdCasesOfProcessEntities":e.proxyPrefix+"Api/Entities/Cases","templates-handler-getCollectionData":e.proxyPrefix+"Api/Collection/{idFact}/Data","data-navigation-handler-collection":e.proxyPrefix+"Api/CurrentUser/Collections/{reference}/Data/{surrogateKey}","data-navigation-handler-entity":e.proxyPrefix+"Api/CurrentUser/Entities/{reference}/Data/{surrogateKey}/{xpath}","data-navigation-handler-entity-filters":e.proxyPrefix+"Api/CurrentUser/Entities/{reference}/Filters/{surrogateKey}/{xpath}","action-handler-getProcessAddAction":e.proxyPrefix+"Api/CurrentUser/Collections/{reference}/{surrogateKey}/Actions","my-search-getSearchLists":e.proxyPrefix+"Api/CurrentUser/Searches","my-search-getFilters":e.proxyPrefix+"Api/CurrentUser/Searches/{guidSearch}/Filters","my-search-getFiltersData":e.proxyPrefix+"Api/CurrentUser/Searches/{guidSearch}/FilterData","my-search-getData":e.proxyPrefix+"Api/CurrentUser/Searches/{guidSearch}/Data","templates-handler-getVirtualCollectionData":e.proxyPrefix+"Api/Collection/{guidVirtualCollection}/VirtualData","templates-handler-getMultipleActions":e.proxyPrefix+"Rest/Entities/multipleInstancesActions","process-handler-getMapping":e.proxyPrefix+"Rest/Entities/Mapping","process-handler-getForm":e.proxyPrefix+"Rest/Handlers/Render","process-handler-startform":e.proxyPrefix+"Rest/Processes/HasStartForm","process-handler-rule":e.proxyPrefix+"Api/Rules/{ruleId}/Execute","process-action-execute":e.proxyPrefix+"Api/Rules/{ruleId}/ExecuteMultiple","process-handler-getActivitiesData":e.proxyPrefix+"Api/Processes/CasesData/MyActivities","process-handler-getPendingsData":e.proxyPrefix+"Api/Processes/CasesData/MyPendings","entities-handler-getActions":e.proxyPrefix+"Api/Entities/{guidEntity}/{surrogateKey}/actions","entities-handler-getUsersAndEvents":e.proxyPrefix+"Rest/Processes/CasesData/UsersAndEvents","entities-handler-getUsers":e.proxyPrefix+"Api/Cases/{caseId}/Users","entities-handler-getEvents":e.proxyPrefix+"Api/Cases/{caseId}/CurrentEvents","entities-handler-getUsersImages":e.proxyPrefix+"Rest/Users/UserPictures","entities-handler-getShotCuts":e.proxyPrefix+"Api/CurrentUser/Shortcuts","query-handler-getqueries":e.proxyPrefix+"Rest/Queries","query-handler-getQueryForm":e.proxyPrefix+"Rest/Handlers/Render","user-handler-getCurrentUser":e.proxyPrefix+"Rest/Users/CurrentUser","old-render":e.proxyPrefix+"App/ListaDetalle/Detalle.aspx",Reports:e.proxyPrefix+"RestServices/BAMAnalyticsHandler.ashx","reports-handler-deleteQueries":e.proxyPrefix+"Rest/BAMAnalytics/Reports/{QueryId}","folders-handler-getUserQueries":e.proxyPrefix+"Rest/SmartFolders","folders-associate-deleteSmartFolder":e.proxyPrefix+"Rest/SmartFolders/{idSmartFolder}","folders-handler":e.proxyPrefix+"RestServices/SmartFoldersHandler.ashx","folders-associate":e.proxyPrefix+"App/Ajax/AJAXGateway.aspx","smartfolders-integration":e.proxyPrefix+"App/WorkPortal/ConfigureFilteredFolder.aspx",AlarmAdmin:e.proxyPrefix+"App/Admin/AlarmsAdmin.aspx",AnalyticsProcess:e.proxyPrefix+"App/Cockpit/AnalyticsProcess.aspx",AnalyticsSensor:e.proxyPrefix+"App/Cockpit/AnalyticsSensor.aspx",AnalyticsTask:e.proxyPrefix+"App/Cockpit/AnalyticsTask.aspx",AsynchronousWorkitemRetries:e.proxyPrefix+"App/Admin/AsynchDisabledWorkitems.aspx",AuthenticationLogQuery:e.proxyPrefix+"App/Admin/AuthLogQuery.aspx",BAMProcess:e.proxyPrefix+"App/Cockpit/BAMProcess.aspx",BAMTask:e.proxyPrefix+"App/Cockpit/BAMTask.aspx",BusinessPolicies:e.proxyPrefix+"App/Admin/BusinessPolicies/BusinessPoliciesSelector.aspx",CaseAdmin:e.proxyPrefix+"App/Admin/CaseSearch.aspx",adminReassignCases:"CaseAdmin",asyncECMUpload:"asyncECMUpload",CasesMonitor:e.proxyPrefix+"App/Admin/CasesMonitor.aspx",Closed:e.proxyPrefix+"App/ListaDetalle/listaitems.aspx?h_Location=Cerrados&I_ProcessState=Completed",CurrentUser:e.proxyPrefix+"App/Admin/CurrentUser.aspx",EncryptionAdmin:e.proxyPrefix+"App/Admin/Encrypt.aspx",MobileUpdatesAdmin:e.proxyPrefix+"App/MobileUpdates/default.aspx",EntityAdmin:e.proxyPrefix+"App/Admin/Entity.aspx",LocationResources:e.proxyPrefix+"App/Admin/AdminLocResources.aspx",NewCase:e.proxyPrefix+"App/Radicar/application.aspx",Pending:e.proxyPrefix+"App/ListaDetalle/listaitems.aspx?h_Location=Pendientes&I_processState=Running",Profiles:e.proxyPrefix+"App/Admin/ProfilesAdminSearch.aspx",Search:e.proxyPrefix+"App/ListaDetalle/Search.aspx",UserAdmin:e.proxyPrefix+"App/Admin/ListUsers.aspx",UserDefaultAssignation:e.proxyPrefix+"App/Admin/DefaultAssignationUser.aspx?h_AdminDefaultAssign=1",UserPendingRequests:e.proxyPrefix+"App/Admin/UserPendingRequests.aspx",ListPreferences:""!==bizagi.UserPreferencesUrl?e.proxyPrefix+bizagi.UserPreferencesUrl:e.proxyPrefix+"App/Admin/CurrentUser.aspx",GRDimensionAdmin:e.proxyPrefix+"App/Cockpit/DimensionEdit.aspx",Licenses:e.proxyPrefix+"App/Admin/Licenses.aspx",AnalysisQueries:e.proxyPrefix+"App/Inicio/WPAnalysisQuery.aspx",DocumentTemplates:e.proxyPrefix+"App/Admin/AdminDocumentTemplates.aspx",ProcessAdmin:e.proxyPrefix+"App/Admin/AdminProcess.aspx",ResourceBAM:e.proxyPrefix+"App/Cockpit/BAMResourceMonitor.aspx",WorkPortalVersion:e.proxyPrefix+"Rest/Util/Version","entities-administration":"RestServices/EntityHandler.ashx","theme-handler-getLogoImagePath":e.proxyPrefix+"Rest/Theme/LogoImage",logout:e.proxyPrefix+"Rest/Authentication/logout",logoutDotNet:e.proxyPrefix+"App/Inicio/LogOff.aspx",authenticationConfig:e.proxyPrefix+"Api/Authentication/BizagiConfig","logout-oauth2":e.proxyPrefix+"Api/Authentication/OAuth2/IdentityProvider/Server/Logout",FederateLogoffUrl:e.proxyPrefix+"Api/Authentication/FederateLogoffUrl",oauth2AuthenticationConfig:e.proxyPrefix+"Api/Authentication/OAuth2/OAuth2AuthenticationConfig","massive-activity-assignments-getOrganizationInfo":e.proxyPrefix+"Rest/Users/OrganizationInfo","massive-activity-assignments-getCasesByOrganization":e.proxyPrefix+"Rest/Queries/GetCasesByOrganization","massive-activity-assignments-reassignCases":e.proxyPrefix+"Rest/Cases/ReassignCases","massive-activity-assignments-searchUsers":e.proxyPrefix+"Rest/Users/","async-ecm-upload-baseService":e.proxyPrefix+"Rest/Handlers/Metadata",domains:e.proxyPrefix+"Rest/Authentication/Domains",getCurrentTheme:e.proxyPrefix+"Api/Theme/Current","admin-getAuthenticationLog":e.proxyPrefix+"Rest/Users/AuthLog","admin-getAuthenticationDomains":e.proxyPrefix+"Rest/Users/Domains","admin-getAuthenticationEventsTypes":e.proxyPrefix+"Rest/Users/EventTypes","admin-getAuthenticationEventSubTypes":e.proxyPrefix+"Rest/Users/EventSubTypes","admin-EncryptString":e.proxyPrefix+"Rest/Util/EncryptString","admin-UserPendingRequests":e.proxyPrefix+"Rest/Users/UserPendingRequests","admin-UserAuthenticationInfo":e.proxyPrefix+"Rest/Users/UserAuthenticationInfo","admin-updateUserAuthenticationInfo":e.proxyPrefix+"Rest/Users/UpdateUserAuthenticationInfo","admin-generateRandomPassword":e.proxyPrefix+"Rest/Util/GenerateRandomPassword","admin-GenerateDataToSendByEmail":e.proxyPrefix+"Rest/Users/GenerateDataToSendByEmail","admin-sendEmail":e.proxyPrefix+"Rest/Util/SendEmail/","admin-getApplicationList":e.proxyPrefix+"Rest/Application","admin-getApplicationProcesses":e.proxyPrefix+"Rest/Application/{idApp}/Process","admin-getProcessVersion":e.proxyPrefix+"Rest/Processes/Version","admin-getProcessTasks":e.proxyPrefix+"Rest/Processes/Version/{version}/Tasks","admin-getTaskAlarms":e.proxyPrefix+"Rest/Alarm/TaskAlarms","admin-getLapseMode":e.proxyPrefix+"Rest/Alarm/LapseMode","admin-getRecurrMode":e.proxyPrefix+"Rest/Alarm/RecurrMode","admin-getScheduleType":e.proxyPrefix+"Rest/Alarm/ScheduleType","admin-getBossList":e.proxyPrefix+"Rest/Alarm/Boss","admin-addAlarm":e.proxyPrefix+"Rest/Alarm","admin-editAlarm":e.proxyPrefix+"Rest/Alarm/{idAlarm}","admin-deleteAlarm":e.proxyPrefix+"Rest/Alarm","admin-alarmRecipients":e.proxyPrefix+"Rest/Alarm/{idAlarm}/Recipient","admin-deleteAlarmRecipients":e.proxyPrefix+"Rest/Alarm/Recipient","admin-recipientToAlarm":e.proxyPrefix+"Rest/Alarm/{idAlarm}/Recipient/{idRecipient}","admin-enableAlarm":e.proxyPrefix+"Rest/Alarm/Task/{idTask}/ToggleAlarm","admin-getCategoriesList":e.proxyPrefix+"Rest/Application/Category","admin-getCasesList":e.proxyPrefix+"Rest/Queries/SearchCases","admin-abortItems":e.proxyPrefix+"Rest/Cases/Abort","admin-reassignItems":e.proxyPrefix+"Rest/Cases/Reassign","admin-getDefaultAssignationUserToAllProcess":e.proxyPrefix+"Rest/Users/{serviceAction}/","admin-getDefaultAssignationUserToProcess":e.proxyPrefix+"Rest/Users/Process/{process}/AssignationUser","admin-setDefaultAssignationUserToProcess":e.proxyPrefix+"Rest/Users/Process/{process}/AssignationUser","admin-getProfilesTypes":e.proxyPrefix+"Rest/Profile/Types","admin-searchProfiles":e.proxyPrefix+"Rest/Profile","admin-getUsersByProfile":e.proxyPrefix+"Rest/Users/Profile/{type}/{id}","admin-removeUserFromProfile":e.proxyPrefix+"Rest/Profile/{type}/{id}/User/{idUser}/","admin-addUserToProfile":e.proxyPrefix+"Rest/Profile/{type}/{id}/User/{idUser}/","admin-async-activities-get-activities":e.proxyPrefix+"Rest/Cases/Asynchronous/Activities","admin-async-activities-get-retry-now":e.proxyPrefix+"Rest/Cases/{idCase}/Workitem/{idworkItem}/RetryNow","admin-async-activities-get-activities-by-task":e.proxyPrefix+"Rest/Cases/Asynchronous/Activities/Task","admin-async-activities-enable-execution":e.proxyPrefix+"Rest/Cases/Asynchronous/Enable","admin-async-activities-enable-multiple":e.proxyPrefix+"Rest/Cases/Asynchronous/EnableMultiple","admin-async-activities-async-execution":e.proxyPrefix+"Rest/Cases/{idCase}/Workitem/{idWorkitem}/AsynchExecution","admin-async-activities-async-execution-log":e.proxyPrefix+"Rest/Cases/{idCase}/Workitem/{idworkItem}/AsynchExecutionLog","admin-Licenses":e.proxyPrefix+"Rest/Licenses","admin-GetDimensions":e.proxyPrefix+"Rest/Dimensions","admin-EditDimension":e.proxyPrefix+"Rest/Dimensions/{id}","admin-CreateAdministrableDimension":e.proxyPrefix+"Rest/Dimensions/Administrable","admin-DeleteDimension":e.proxyPrefix+"Rest/Dimensions/{id}?isAdministrable={administrable}","admin-EntityPathChildNodesAction":e.proxyPrefix+"Rest/Dimensions/EntityChildNodes","admin-GetActiveWFClasses":e.proxyPrefix+"Rest/Dimensions/ActiveProcess","admin-document-templates-storeDocumentTemplates":e.proxyPrefix+"Rest/DocumentTemplates/StoreDocumentTemplates","admin-document-templates-restoreDocumentTemplates":e.proxyPrefix+"Rest/DocumentTemplates/RestoreDocumentTemplate","admin-document-templates-uploadDocumentTemplate":e.proxyPrefix+"Rest/DocumentTemplates/UploadDocumentTemplate","admin-processes-workflowClasses":e.proxyPrefix+"Rest/Processes/WorkflowClasses","admin-processes-tasksByWorkflow":e.proxyPrefix+"Rest/Processes/TasksByWorkflow","admin-processes-modifyProcessDuration":e.proxyPrefix+"Rest/Processes/{idWorkflow}/Duration/","admin-processes-modifyTaskDuration":e.proxyPrefix+"Rest/Processes/Task/{idTask}/Duration/","admin-language-resource":e.proxyPrefix+"Rest/Multilanguage/Resource","admin-language-languages":e.proxyPrefix+"Rest/Multilanguage/Languages","bam-resourcemonitor-myteam":e.proxyPrefix+"Rest/Reports/BAM/Resources/MyTeam","reports-analysisquery":e.proxyPrefix+"Rest/Reports/AnalysisQueries","reports-analysisquery-update":e.proxyPrefix+"Rest/Reports/AnalysisQueries","reports-analysisquery-delete":e.proxyPrefix+"Rest/Reports/AnalysisQueries","processviewer-processdefinition":e.proxyPrefix+"Rest/Reports/Components/ProcessDefinition","processviewer-processgraphicinfo":e.proxyPrefix+"Rest/Reports/Components/ProcessGraphicInfo","mobile-getLastUpdate":e.proxyPrefix+"Rest/Util/mobileUpdates","discussion-case":e.proxyPrefix+"Api/CaseResource/Discussion?globalParent={globalParent}","discussion-case-v1":e.proxyPrefix+"Api/CaseResource/{globalParent}/Discussion","get-users":e.proxyPrefix+"Rest/Users/UserPictures","new-discussion":e.proxyPrefix+"Api/CaseResource/Discussion","count-comments":e.proxyPrefix+"Api/CaseResource/{idParent}/Comment/Count","comment-case":e.proxyPrefix+"Api/CaseResource/{idParent}/Comment","new-comment":e.proxyPrefix+"Api/CaseResource/Comment","new-comment-attach":e.proxyPrefix+"Api/CaseResource/Attachment","get-list-files":e.proxyPrefix+"Api/CaseResource/File?globalParent={globalParent}","get-list-files-v1":e.proxyPrefix+"Api/CaseResource/{globalParent}/File","project-resource-action":e.proxyPrefix+"Api/CaseResource/{typeResource}","thumbnail-file":e.proxyPrefix+"Api/CaseResource/File/Thumbnails","get-attachment":e.proxyPrefix+"Api/CaseResource/Attachment/{idAttachment}","get-mobile-attachment":e.proxyPrefix+"Api/CaseResource/Mobile/Attachment/{idAttachment}","project-files-upload":e.proxyPrefix+"Api/CaseResource/File","count-files":e.proxyPrefix+"Api/CaseResource/File/Count?globalParent={globalParent}","count-files-v1":e.proxyPrefix+"Api/CaseResource/{globalParent}/File/Count","remove-comment":e.proxyPrefix+"Api/CaseResource/Comment","time-schemas-effectiveduration":e.proxyPrefix+"Api/WorkingTimeSchema/EffectiveDuration?idUser={idUser}&fromDate={fromDate}&toDate={toDate}","case-handler-getCaseAssignees":e.proxyPrefix+"Rest/Cases/{idCase}/Assignees","project-users-get":e.proxyPrefix+"Rest/Users/UserPictures","project-plan-get":e.proxyPrefix+"Api/Plans/{idPlan}","project-plan-activities":e.proxyPrefix+"Api/Plans/{idPlan}/Activities","project-plan-workitems":e.proxyPrefix+"Api/Plans/{idPlan}/WorkItems","project-plan-transitions-get":e.proxyPrefix+"Api/Plans/{idPlan}/Activities/Transitions","project-plan-activity-edit":e.proxyPrefix+"Api/Plans/{idPlan}/Activities/{id}","project-plan-get-by-parent":e.proxyPrefix+"Api/Plans?parentWorkItem={parentWorkItem}","project-plan-parent":e.proxyPrefix+"Api/Plans/{idPlan}/ParentCase","project-plan-update":e.proxyPrefix+"Api/Plans/{idPlan}","project-plan-execute":e.proxyPrefix+"Api/Plans/Execute","project-plan-close":e.proxyPrefix+"Api/Plans/Close","project-plan-delete":e.proxyPrefix+"Api/Plans/{idPlan}","project-plan-first-parent-plan":e.proxyPrefix+"Api/Plans/{idPlan}/FirstParentPlan"};return bizagi.util.getFeatureObject("userService.v1.enabled")&&(t["user-handler-getCurrentUser"]=e.proxyPrefix+"Rest/Users/CurrentUserGuid",t["get-users"]=e.proxyPrefix+"Rest/Users/UserPicturesGuid",t["entities-handler-getUsersImages"]=e.proxyPrefix+"Rest/Users/UserPicturesGuid",t["project-users-get"]=e.proxyPrefix+"Rest/Users/UserPicturesGuid",t["entities-handler-getUsers"]=e.proxyPrefix+"Api/Cases/{caseId}/UsersGuid",t["case-handler-getCaseSummary"]=e.proxyPrefix+"Rest/Cases/{idCase}/SummaryGuid",t["case-handler-getCaseAssignees"]=e.proxyPrefix+"Rest/Cases/{idCase}/AssigneesGuid",t["discussion-case"]=e.proxyPrefix+"Api/CaseResource/DiscussionGuid?globalParent={globalParent}",t["new-discussion"]=e.proxyPrefix+"Api/CaseResource/DiscussionGuid",t["comment-case"]=e.proxyPrefix+"Api/CaseResource/{idParent}/CommentGuid",t["new-comment"]=e.proxyPrefix+"Api/CaseResource/CommentGuid",t["project-files-upload"]=e.proxyPrefix+"Api/CaseResource/FileGuid",t["get-list-files"]=e.proxyPrefix+"Api/CaseResource/FileGuid?globalParent={globalParent}",t["time-schemas-effectiveduration"]=e.proxyPrefix+"Api/WorkingTimeSchema/EffectiveDurationGuid?idUser={idUser}&fromDate={fromDate}&toDate={toDate}",t["project-plan-get"]=e.proxyPrefix+"Api/Plans/Guid/{idPlan}",t["project-plan-update"]=e.proxyPrefix+"Api/Plans/Guid/{idPlan}",t["project-plan-activities"]=e.proxyPrefix+"Api/Plans/{idPlan}/ActivitiesGuid",t["project-plan-workitems"]=e.proxyPrefix+"Api/Plans/{idPlan}/WorkItemsGuid",t["project-plan-first-parent-plan"]=e.proxyPrefix+"Api/Plans/{idPlan}/FirstParentPlanGuid",t["project-plan-activity-edit"]=e.proxyPrefix+"Api/Plans/{idPlan}/ActivitiesGuid/{id}"),t}return{}},$.Class.extend("bizagi.workportal.services.service",{BA_CONTEXT_PARAMETER_PREFIX:"h_",ENTITIES_QUERY_PAGE_SIZE:10},{init:function(e){(e="object"==typeof e?e:{}).context=bizagi.util.isEmpty(e.context)?"workportal":e.context,e.proxyPrefix=bizagi.util.isEmpty(e.proxyPrefix)?"":e.proxyPrefix,e.proxyPrefix=this.normalizeUrl(e.proxyPrefix),bizagi.RPproxyPrefix=e.proxyPrefix,e.sharepointProxyPrefix=bizagi.util.isEmpty(e.sharepointProxyPrefix)?"":e.sharepointProxyPrefix,e.sharepointProxyPrefix=this.normalizeUrl(e.sharepointProxyPrefix),this.serviceLocator=new bizagi.workportal.services.context(e),this.pageSize=10,"undefined"!=typeof BIZAGI_INBOX_ROWS_PER_PAGE&&(this.pageSize=$.isNumeric(BIZAGI_INBOX_ROWS_PER_PAGE)?BIZAGI_INBOX_ROWS_PER_PAGE:this.pageSize)},getUrl:function(e){return this.serviceLocator.getUrl(e.endPoint)},normalizeUrl:function(e){return""!==e&&("/"!=e[e.length-1]&&(e=e.concat("/")),-1==e.indexOf("http://")&&-1==e.indexOf("https://")&&(e="http://"+e)),e},getOverrides:function(){return $.ajax({url:this.serviceLocator.getUrl("overrides")}).pipe(function(e){return e=e||{},$.each(e,function(t,r){var i=r.toUpperCase();"TRUE"!=i&&"FALSE"!=i||(e[t]=bizagi.util.parseBoolean(r))}),e})},getCurrentTheme:function(){var e=this.serviceLocator.getUrl("getCurrentTheme");return $.read(e)},authenticatedUser:function(e){var t=this,r=t.serviceLocator.getUrl("login-handler");return $.read({url:r,data:{userName:BIZAGI_USER,password:BIZAGI_PASSWORD,domain:BIZAGI_DOMAIN}}).pipe(function(e){return e},function(e){return r=(r=(r=(r=t.serviceLocator.getUrl("login-handlerv10")).replace("{0}",BIZAGI_USER||"")).replace("{1}",BIZAGI_PASSWORD||"")).replace("{2}",BIZAGI_DOMAIN||""),$.ajax({url:r,type:"GET",dataType:"json"})})},logoutUser:function(e){var t=this.serviceLocator.getUrl("logoff-handlerv1");return $.read({url:t})},logOffUser:function(e){var t=this.serviceLocator.getUrl("logoff-handler");return $.read({url:t})},getCurrentUser:function(e){return $.read(this.serviceLocator.getUrl("user-handler-getCurrentUser"))},getInboxSummary:function(e){return $.read(this.serviceLocator.getUrl("inbox-handler-getInboxSummary")).pipe(function(e){return e.inboxSummary})},getAllProcesses:function(e){e=e||{};var t={},r=this.serviceLocator.getUrl("process-handler-getAllProcesses");return null!=e.taskState&&(t.taskState=e.taskState),null!=e.onlyFavorites&&""!=e.onlyFavorites&&(t.onlyFavorites=e.onlyFavorites),null!=e.myActivities&&""!=e.myActivities&&(t.myActivities=e.myActivities),null!=e.myPendings&&""!=e.myPendings&&(t.myPendings=e.myPendings),e.smartfoldersParameters&&(r=r+"?"+e.smartfoldersParameters),bizagi.isMobile()&&(t.mobileDevice=!0),$.read(r,t).pipe(function(t){if(e.skipAggrupate)return t;var r={},i={},a=bizagi.localization.getResource("workportal-widget-inbox-all-processes"),o={name:bizagi.localization.getResource("workportal-widget-inbox-all-cases"),path:"",category:a,isFavorite:e.onlyFavorites||!1,guidFavorite:"",idworkflow:"",guidWFClass:"",count:0};for(key in i[a]=[],i[a].workflows=[],i[a].workflows.push(o),t.workflows&&$.each(t.workflows.workflow,function(e,t){i[t.category]||(i[t.category]=[],i[t.category].workflows=[]),i[t.category].workflows.push(t),o.count+=Number(t.count)}),r.categories=[],i)r.categories.push({name:key,workflows:i[key].workflows});return r})},getFavourites:function(){var e=this.serviceLocator.getUrl("process-handler-getFavourites");return $.read(e,{}).pipe(function(e){return e})},getMyStuff:function(e){var t={},r=this.serviceLocator.getUrl("process-handler-getMyStuff");return void 0!==e.icon&&e.icon&&(t.icon=!0),$.read(r,t)},getFavouriteCases:function(e){var t={},r=this.serviceLocator.getUrl("process-handler-getFavouriteCases");return t.pageSize=e.pageSize||this.pageSize,t.page=e.page||1,bizagi.isMobile()&&(t.mobileDevice=!0),$.read(r,t).pipe(function(e){return e})},getCasesList:function(e){var t={},r=this.serviceLocator.getUrl("case-handler-getCasesList");return e=e||{},t.pageSize=e.pageSize||10,t.page=e.page||1,t.numberOfFields=e.numberOfFields||"-1",t.idWfClass=e.idWfClass||"-1",$.read(r,t).pipe(function(e){for(var t={overdue:[],today:[],tomorrow:[],upcoming:[],page:e.page,totalPages:e.totalPages},r=new Date,i=r.getMonth(),a=r.getDate(),o=r.getYear(),s=void 0!==e.elements?e.elements.length:0,n=0;s>n;n++){var c=e.elements[n],l=new Date(c[3]),d=l.getDate(),u=l.getMonth(),p=l.getYear();a>d||i>u||o>p?(c[3]=bizagi.util.dateFormatter.formatDate(new Date(c[3]),"dd MMM yyyy"),t.overdue.push(c)):a==d?(c[3]=bizagi.util.dateFormatter.formatDate(new Date(c[3]),"hh:mm"),t.today.push(c)):a+1==d?(c[3]=bizagi.util.dateFormatter.formatDate(new Date(c[3]),"hh:mm"),t.tomorrow.push(c)):(c[3]=bizagi.util.dateFormatter.formatDate(new Date(c[3]),"dd MMM yyyy"),t.upcoming.push(c))}return t})},getCasesListBeta:function(e){var t=this;return t.getMobileCasesList(e).then(function(e){for(var r={elements:[],page:e.page,totalPages:e.totalPages,advanceSearch:e.advanceSearch||!1},i=new Date,a=e.advanceSearch?t.defineActivityStateByTaskState:t.defineActivityStateByDate,o=0;e.elements.length>o;o++){var s=e.elements[o],n={};if(n=a(s[3],s.taskstate),s.length>=10&&parseInt(s[11],10)>0){var c=new Date(s[3]);i.getTime()>c.getTime()?n.state="red":i.getTime()>c.getTime()-6e4*parseInt(s[11],10)?n.state="yellow":n.state="green"}r.elements.push($.extend({},s,n,{endDate:s[3],idworkitem:s[1],idwfclass:bizagi.util.validateFeatureSupport("advancedSearch")?s[10]:s[7]}))}return r})},getMobileCasesList:function(e){var t=this,r={};void 0!==(e=e||{}).radNumber&&(r.radNumber=e.radNumber),r.pageSize=e.pageSize||10,r.page=e.page||1;var i=t.serviceLocator.getUrl("case-handler-getActivityList");return bizagi.util.validateFeatureSupport("advancedSearch")?$.read(i,r).then(function(e){for(var r,i={elements:[],rows:[]},a=-1;r=e.rows[++a];){for(var o,s={},n=["","","","","","",[],"","","",""],c=-1;o=e.headers[++c];)s[o.fieldName.toLowerCase()]={displayName:o.displayName,value:r[c]},t.serializeActivity(n,o.fieldName.toLowerCase(),s[o.fieldName.toLowerCase()]);i.elements.push(n),i.rows.push(s)}return{page:e.page||e.currentPage,totalPages:e.totalPages,elements:i.elements,rows:i.rows,advanceSearch:!0}}):(i=t.serviceLocator.getUrl("case-handler-getCasesList"),r.numberOfFields=e.numberOfFields||"-1",r.idWfClass=e.idWfClass||"-1",$.read(i,r))},defineActivityStateByDate:function(e){var t={};if(e){var r=new Date(e),i=new Date,a=new Date(i.getFullYear(),i.getMonth(),i.getDate());t=r.getTime()<a.getTime()-1e3?{group:"1|"+bizagi.localization.getResource("workportal-taskfeed-overdue"),state:"red",type:"overdue",icon:"overdue",shortEndDate:bizagi.util.dateFormatter.formatDate(new Date(e),"MMMM dd yyyy | hh:mm tt")}:r.getTime()<i.getTime()+6e4-1e3?{group:"2|"+bizagi.localization.getResource("workportal-taskfeed-today"),state:"red",type:"today",icon:"overdue",shortEndDate:bizagi.util.dateFormatter.formatDate(new Date(e),"MMMM dd yyyy | hh:mm tt")}:r.getTime()<a.getTime()+864e5-1e3?{group:"2|"+bizagi.localization.getResource("workportal-taskfeed-today"),state:"yellow",type:"today",icon:"ontime",shortEndDate:bizagi.util.dateFormatter.formatDate(new Date(e),"MMMM dd yyyy | hh:mm tt")}:r.getTime()<a.getTime()+1728e5-1e3?{group:"3|"+bizagi.localization.getResource("workportal-taskfeed-tomorrow"),state:"green",type:"tomorrow",icon:"upcoming",shortEndDate:bizagi.util.dateFormatter.formatDate(new Date(e),"MMMM dd yyyy | hh:mm tt")}:{group:"4|"+bizagi.localization.getResource("workportal-taskfeed-upcomming"),state:"green",type:"upcoming",icon:"upcoming",shortEndDate:bizagi.util.dateFormatter.formatDate(new Date(e),"MMMM dd yyyy | hh:mm tt")}}else t={group:"1|"+bizagi.localization.getResource("workportal-taskfeed-overdue"),state:"red",type:"overdue",shortEndDate:"--",icon:"overdue"};return t},defineActivityStateByTaskState:function(e,t){var r={group:"1|"+bizagi.localization.getResource("workportal-taskfeed-overdue"),state:t,type:"overdue",shortEndDate:"--",icon:"overdue"};if(e&&t){var i=new Date(e),a=new Date,o=new Date(a.getFullYear(),a.getMonth(),a.getDate());switch(r={group:"",state:t,type:"",icon:"",shortEndDate:bizagi.util.dateFormatter.formatDate(new Date(e),"MMMM dd yyyy | hh:mm tt")},i.getTime()<o.getTime()-1e3?(r.group="1|"+bizagi.localization.getResource("workportal-taskfeed-overdue"),r.type="overdue"):i.getTime()<o.getTime()+864e5-1e3?(r.group="2|"+bizagi.localization.getResource("workportal-taskfeed-today"),r.type="today"):i.getTime()<o.getTime()+1728e5-1e3?(r.group="3|"+bizagi.localization.getResource("workportal-taskfeed-tomorrow"),r.type="tomorrow"):(r.group="4|"+bizagi.localization.getResource("workportal-taskfeed-upcomming"),r.type="upcoming"),t){case"green":r.icon="upcoming";break;case"yellow":r.icon="ontime";break;case"red":default:r.icon="overdue"}}return r},serializeActivity:function(e,t,r){switch(t){case"radnumber":e[6].push([r.displayName,r.value]);break;case"wfclsdisplayname":e[4]=null!==r.value?r.value.toString():bizagi.localization.getResource("workportal-project-activity-plan");break;case"currenttask":e[5]=null!==r.value?r.value.toString():bizagi.localization.getResource("workportal-project-casedashboard-activity");break;case"cascreationdate":break;case"wiestimatedsolutiondate":e[3]=r.value;break;case"cassolutiondate":break;case"idcase":e[0]=r.value;break;case"idworkitem":e[1]=r.value.toString();break;case"wientrydate":break;case"taskid":e[2]=r.value;break;case"taskstate":e.taskstate=r.value?(""+r.value).toLowerCase():"";break;case"idwfclass":e[10]=e.idwfclass=r.value;break;case"isfavorite":e[9]=r.value;break;case"atrisktime":e[11]=r.value;break;case"guidfavorite":e[8]=r.value}},getCurrentActivities:function(e){var t=this,r={};e=e||{},r.page=e.page||1,r.pageSize=e.pageSize||10,void 0!==e.radNumber&&(r.radNumber=e.radNumber);var i=t.serviceLocator.getUrl("case-handler-getActivityList");return $.read(i,r).then(function(e){return t.processActivitiesResponse(e)})},processActivitiesResponse:function(e,t,r){var i,a=-1;for(e.elements=[],e.processes=[];i=e.rows[++a];){for(var o,s={},n=-1;o=e.headers[++n];)s["o_"+o.fieldName.toLowerCase()]={displayName:o.displayName,value:i[n]},s[o.fieldName.toLowerCase()]=i[n];$.extend(s,this.defineActivityStateByDate(s.wiestimatedsolutiondate),{highlightedNumber:this.highlightsString(s.radnumber,t)}),e.elements.push(s),void 0===e.processes.find(function(e){return e.processname==s.wfclsdisplayname})&&e.processes.push({processname:s.wfclsdisplayname,idwfclass:s.idwfclass,active:r?"active":""})}return e},highlightsString:function(e,t){if("string"!=typeof e||"string"!=typeof t)return e;var r=new RegExp(t,"gi");return e.replace(r,function(e,t){return"<strong>"+e+"</strong>"})},getDiscussionCase:function(e){var t=t||{};t.globalParent=e.globalParent;var r=bizagi.util.validateFeatureSupport("discussionCase")?this.serviceLocator.getUrl("discussion-case"):this.serviceLocator.getUrl("discussion-case-v1");return $.read({url:r,data:t,contentType:"application/json"}).pipe(function(e){return e})},editDiscussion:function(e){var t=this.serviceLocator.getUrl("new-discussion");return $.update({url:t,data:JSON.stringify(e),dataType:"json",contentType:"application/json"})},getUsersDiscussion:function(e){var t=t||{};t.userIds=e,t.width=50,t.height=50;var r=this.serviceLocator.getUrl("get-users");return bizagi.util.getFeatureObject("userService.v1.enabled")?$.ajax({url:r,data:t,type:"POST",dataType:"json"}):$.read(r,t).pipe(function(e){return e})},getEffectiveDuration:function(e){var t=this.serviceLocator.getUrl("time-schemas-effectiveduration");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"})},getUsersData:function(e){var t=this.serviceLocator.getUrl("project-users-get");return bizagi.util.getFeatureObject("userService.v1.enabled")?$.ajax({url:t,data:e,type:"POST",dataType:"json"}):$.read({url:t,data:e,dataType:"json"})},createNewDiscussion:function(e){var t=this.serviceLocator.getUrl("new-discussion");return e=e||{},$.create({url:t,data:JSON.stringify(e),dataType:"json",contentType:"application/json"})},createNewComment:function(e){var t=(e=e||{}).data||{},r=this.serviceLocator.getUrl("new-comment");return $.create({url:r.replace("{typeResource}","Comment"),data:JSON.stringify(t),dataType:"json",contentType:"application/json"})},updateProjectFile:function(e){var t=this.serviceLocator.getUrl("project-files-upload");return $.update({url:t,data:JSON.stringify(e),dataType:"json",contentType:"application/json"})},createProjectFile:function(e){var t=this.serviceLocator.getUrl("project-files-upload");return $.create({url:t,data:JSON.stringify(e),dataType:"json",contentType:"application/json"})},getFilesCount:function(e){e=e||{};var t=bizagi.util.validateFeatureSupport("filesCount")?this.serviceLocator.getUrl("count-files"):this.serviceLocator.getUrl("count-files-v1");return $.read({url:t,data:e,contentType:"application/json"}).pipe(function(e){return e})},getCommentCase:function(e){e=e||{};var t=this.serviceLocator.getUrl("comment-case");return $.read({url:t,data:e,contentType:"application/json"}).pipe(function(e){return e})},getCommentsByParent:function(e){e=e||{};var t=this.serviceLocator.getUrl("count-comments");return $.read({url:t,data:e,contentType:"application/json"}).pipe(function(e){return e})},getFilesList:function(e){var t=bizagi.util.validateFeatureSupport("filesList")?this.serviceLocator.getUrl("get-list-files"):this.serviceLocator.getUrl("get-list-files-v1");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"}).pipe(function(e){return e})},deleteFile:function(e){var t=this.serviceLocator.getUrl("project-resource-action");return $.destroy({url:t.replace("{typeResource}","Attachment"),data:JSON.stringify(e),dataType:"json",contentType:"application/json"})},getFilesThumbnail:function(e){e=e||{};var t=this.serviceLocator.getUrl("thumbnail-file");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"}).pipe(function(e){return e})},getAttachment:function(e){var t=this.serviceLocator.getUrl("get-attachment");return t=t.replace("{idAttachment}",e.idAttachment)},getMobileAttachment:function(e){var t=this.serviceLocator.getUrl("get-mobile-attachment");return(t=t.replace("{idAttachment}",e.idAttachment))+"?sessionId="},getAllAdministrableEntities:function(e){e=e||{};var t={action:"entitiesList",kind:"administrable"};return $.ajax({url:this.serviceLocator.getUrl("entities-administration"),data:t,type:"POST",dataType:"json"}).pipe(function(e){var t={entities:[]};return $.each(e,function(e,r){t.entities.push(r)}),t})},getEntitiesList:function(e){return(e=e||{}).action="entitiesList",e.kind="entitiesData",$.ajax({url:this.serviceLocator.getUrl("entities-administration"),data:e,type:"POST",dataType:"json"})},getCasesByWorkflow:function(e){e=e||{};var t={},r=this.serviceLocator.getUrl("process-handler-getCustomizedColumnsDataInfo");if(bizagi.util.isEmpty(e.taskState)||(t.taskState=e.taskState),bizagi.util.isEmpty(e.idWorkflow)||(t.idWorkflow=e.idWorkflow),1==e.onlyFavorites&&(t.onlyFavorites=!0,t.taskState="all"),t.pageSize=e.pageSize||this.pageSize,t.page=e.page||1,bizagi.isMobile()&&(t.mobileDevice=!0),e.smartfoldersParameters){var i=e.smartfoldersParameters.split("&");$.each(i,function(e,r){var i=r.split("=");t[i[0]]=i[1]})}return(e.radnumber||e.radNumber)&&(t.radNumber=e.radNumber?e.radNumber:e.radnumber),(e.idcase||e.idCase)&&bizagi.util.isNumeric(e.idcase||e.idCase)&&(t.idCase=e.idCase?e.idCase:e.idcase),$.read(r,t).pipe(function(e){return $.each(e.cases.rows,function(t,r){var i=[];e.cases.rows[t].radnumber=r.id,$.each(r.fields,function(r,a){if(null!=a)try{null!=a.isRadNumber&&"true"==a.isRadNumber?(e.cases.rows[t].radnumber=a.Value,e.cases.rows[t].casenumberdisplayname=a.DisplayName):null!=a.workitems?e.cases.rows[t].workitems=a.workitems:i.push(a)}catch(e){}}),e.cases.rows[t].fields=i}),e.cases})},getOrganizationsList:function(){var e=this.serviceLocator.getUrl("process-handler-getOrganizations"),t={type:12,name:""};return $.read(e,t)},getCustomizedColumnsData:function(e){e=e||{};var t={},r=this.serviceLocator.getUrl("process-handler-getCustomizedColumnsData");if(t.pageSize=e.pageSize||this.pageSize,t.page=e.page||1,t.orderFieldName=e.orderFieldName||"",t.orderType=e.orderType||"0",t.order=e.order||"",bizagi.isMobile()&&(t.mobileDevice=!0),e.taskState=e.taskState||"all",""===e.taskState.toString().toLowerCase()&&(e.taskState="all"),"red"===e.taskState.toString().toLowerCase()&&(e.taskState="Red"),"yellow"===e.taskState.toString().toLowerCase()&&(e.taskState="Yellow"),"green"===e.taskState.toString().toLowerCase()&&(e.taskState="Green"),t.taskState=e.taskState,bizagi.util.isEmpty(e.idWorkflow)||(t.idWorkflow=e.idWorkflow),bizagi.util.isEmpty(e.idTask)||(t.idTask=e.idTask),bizagi.util.isEmpty(e.radNumber)||(t.radNumber=e.radNumber),1==e.onlyFavorites&&(t.onlyFavorites=!0,t.taskState="all"),e.smartfoldersParameters){var i=e.smartfoldersParameters.split("&");$.each(i,function(e,r){var i=r.split("=");t[i[0]]=i[1]})}return $.read(r,t)},getCustomizedColumnsDataBeta:function(e){e=e||{};var t={},r=this.serviceLocator.getUrl("process-handler-getCustomizedColumnsData");if(t.pageSize=e.pageSize||this.pageSize,t.page=e.page||1,t.orderFieldName=e.orderFieldName||"",t.orderType=e.orderType||"0",t.order=e.order||"",t.mobileDevice=!!bizagi.isMobile(),e.taskState=e.taskState||"all",""===e.taskState.toString().toLowerCase()&&(e.taskState="all"),"red"===e.taskState.toString().toLowerCase()&&(e.taskState="Red"),"yellow"===e.taskState.toString().toLowerCase()&&(e.taskState="Yellow"),"green"===e.taskState.toString().toLowerCase()&&(e.taskState="Green"),t.taskState=e.taskState,bizagi.util.isEmpty(e.idWorkflow)||(t.idWorkflow=e.idWorkflow),bizagi.util.isEmpty(e.idTask)||(t.idTask=e.idTask),bizagi.util.isEmpty(e.radNumber)||(t.radNumber=e.radNumber),1==e.onlyFavorites&&(t.onlyFavorites=!0,t.taskState="all"),e.smartfoldersParameters){var i=e.smartfoldersParameters.split("&");$.each(i,function(e,r){var i=r.split("=");t[i[0]]=i[1]})}return $.read(r,t).pipe(function(e){var t={columnTitle:[],lstIdCases:[],elements:[],page:e.page,totalPages:e.totalPages},r=new Date,i=r.getMonth(),a=r.getDate(),o=r.getYear();t.columnTitle=e.cases.columnTitle,t.lstIdCases=e.cases.lstIdCases,t.page=e.cases.page,t.totalPages=e.cases.totalPages;for(var s=0,n=e.cases.rows.length;s<n;s++){var c=e.cases.rows[s],l=new Date(c.fields[3]),d=l.getDate(),u=l.getMonth(),p=l.getYear();a>d||i>u||o>p?(c.fields[3]=bizagi.util.dateFormatter.formatDate(new Date(c.fields[3]),"dd MMM"),t.elements.push($.extend({},c,{group:"overdue"}))):a==d?(c.fields[3]=bizagi.util.dateFormatter.formatDate(new Date(c.fields[3]),"hh:mm"),t.elements.push($.extend({},c,{group:"today"}))):a+1==d?(c.fields[3]=bizagi.util.dateFormatter.formatDate(new Date(c.fields[3]),"hh:mm"),t.elements.push($.extend({},c,{group:"tomorrow"}))):(c.fields[3]=bizagi.util.dateFormatter.formatDate(new Date(c.fields[3]),"dd MMM"),t.elements.push($.extend({},c,{group:"upcoming"})))}return(void 0===t.elements||void 0!==t.elements&&0===t.elements.length)&&t.elements.push({noResults:!0,message:bizagi.localization.getResource("workportal-menu-search-found-no-cases")}),t})},getCategories:function(e){var t={};return(e=e||{}).idCategory&&(t.idCategory=e.idCategory),e.idApp&&(t.idApp=e.idApp),bizagi.isMobile()&&(t.mobileDevice=!0),t.groupByApp=e.groupByApp||!1,$.read(this.serviceLocator.getUrl("process-handler-getCategory"),t)},getRecentProcesses:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("process-handler-getRecentProcesses"),e)},getCaseSummary:function(e){return e=e||{},$.read({url:this.serviceLocator.getUrl("case-handler-getCaseSummary"),data:{idCase:e.idCase,eventAsTasks:e.eventAsTasks||"false",onlyUserWorkItems:e.onlyUserWorkItems||"true",mobileDevice:bizagi.isMobile()||"false"},serviceType:"GETSUMMARY"}).pipe(function(e){return e})},getCaseAssignees:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getCaseAssignees"),{idCase:e.idCase}).pipe(function(e){return e})},getCaseTasks:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getCaseTasks"),{idCase:e.idCase})},getCaseEvents:function(e){return e=e||{},$.read({url:this.serviceLocator.getUrl("case-handler-getCaseEvents"),data:{idCase:e.idCase},serviceType:"GETEVENTS"}).pipe(function(e){return e})},getCaseSubprocesses:function(e){return e=e||{},$.read({url:this.serviceLocator.getUrl("case-handler-getCaseSubprocesses"),data:{idCase:e.idCase},serviceType:"GETSUBPROCESSES"}).pipe(function(e){return e})},getCaseFormsRenderVersion:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getCaseFormsRenderVersion"),{idCase:e.idCase})},getCaseFormsRenderVersionDataContent:function(e){var t=new $.Deferred;return $.when(this.getCaseFormsRenderVersion(e)).done(function(e){t.resolve(e)}),t.promise()},getTaskAssignees:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getTaskAssignees"),{idCase:e.idCase,idTask:e.idTask})},getWorkitems:function(e){var t={};return e=e||{},t.idCase=e.idCase,t.fromTask=e.fromTask,t.fromWorkItemId=e.fromWorkItemId,t.mobileDevice=bizagi.isMobile(),e.eventAsTasks&&(t.eventAsTasks=e.eventAsTasks),void 0!==e.onlyUserWorkItems&&(t.onlyUserWorkItems=e.onlyUserWorkItems),$.read({url:this.serviceLocator.getUrl("case-handler-getWorkItems"),data:t,serviceType:"GETWORKITEMS"})},getQueries:function(e){var t=this;if(t.hashQueries&&e.idElement)return t.hashQueries[e.idElement];var r=new $.Deferred;return $.read(t.serviceLocator.getUrl("query-handler-getqueries")).done(function(e){t.hashQueries={},t.hashQueries[0]={},t.processQueries(e.query),r.resolve(t.hashQueries[-1])}),r.promise()},processQueries:function(e){var t=this;$.each(e,function(e,r){t.hashQueries[r.idParent]||(t.hashQueries[r.idParent]=[]),t.hashQueries[r.idParent].push(r),r.nodes?t.processQueries(r.nodes):r.nodes={}})},createNewCase:function(e){return e=e||{},$.create({url:this.serviceLocator.getUrl("case-handler-addNewCase"),data:{idWfClass:e.idWfClass,caseData:e.caseData?JSON.stringify(e.caseData):null,idOrganization:e.idOrganization?e.idOrganization:null},serviceType:"NEWCASE"})},validateHasStartForm:function(e){var t={processId:e.processId};return $.read({url:this.serviceLocator.getUrl("case-handler-validateHasStartForm"),data:t,batchRequest:!0})},startProcess:function(e){var t=this,r={idProcess:(e=e||{}).idProcess,entityMapping:e.mapping?JSON.stringify(e.mapping):{}};void 0!==e.idParentCase&&(r.idParentCase=e.idParentCase);var i=$.Deferred();return $.create({url:t.serviceLocator.getUrl("case-handler-startProcess"),data:r,serviceType:"STARTPROCESS"}).fail(function(r){if("error"!==$.parseJSON(r.responseText).status||bizagi.util.isVersionSupported())i.reject(r);else{var a={idWfClass:e.idProcess||e.idWfClass,idOrganization:e.idOrganization||null};t.createNewCase(a).then(function(e){e.oldVersion=!0,i.resolve(e)}).fail(function(e){i.reject(e)})}}).done(function(e){i.resolve(e)}),i.promise()},actionCreateCase:function(e){var t={processId:void 0!==e.idProcess?e.idProcess:e.guidProcess};return void 0!==e.parentCaseId&&(t.parentCaseId=e.parentCaseId),void 0!==e.mapping&&(t.entityMapping=e.mapping?JSON.stringify(e.mapping):{}),$.create({url:this.serviceLocator.getUrl("handler-execute-action-start"),data:t,serviceType:"STARTPROCESS"})},getFirstParentPlan:function(e){var t=this.serviceLocator.getUrl("project-plan-first-parent-plan"),r=$.Deferred();return $.when($.read({url:t,data:e,dataType:"json"})).done(function(e){r.resolve(e)}).fail(function(){r.resolve(null)}),r.promise()},searchCases:function(e){e=e||{};var t={h_action:"SEARCHCASES",onlyUserCases:!1,active:!1};return t.page=e.page||1,e.radNumber&&(t.radNumber=$.trim(e.radNumber)),t.pageSize=e.pageSize||this.pageSize,$.ajax({url:this.serviceLocator.getUrl("query-handler"),data:t,type:"POST",dataType:"json"})},queryCases:function(e){e=e||{};var t={h_action:"QUERYCASES"};return t.onlyUserCases=e.onlyUserCases||!1,t.active=e.active&&!0,t.page=e.page||1,e.radNumber&&(t.radNumber=$.trim(e.radNumber)),t.pageSize=e.pageSize||this.pageSize,t.filter=e.filter,t.outputxpath=e.outputxpath,t.orderFieldName=e.orderFieldName||"",t.orderType="asc"==e.orderType||1==e.orderType?1:0,t.order=e.order||"",$.ajax({url:this.serviceLocator.getUrl("query-handler"),data:t,type:"POST",dataType:"json"})},queryEntities:function(e){e=e||{};var t={h_action:"QUERYENTITIES"};return t.page=e.page||1,t.pageSize=this.Class.ENTITIES_QUERY_PAGE_SIZE,t[this.Class.BA_CONTEXT_PARAMETER_PREFIX+"idEnt"]=e.idEntity,t.filter=e.filter,t.outputxpath=e.outputxpath,t.orderFieldName=e.orderFieldName||"",t.orderType=e.orderType||"",t.order=e.order||"",$.ajax({url:this.serviceLocator.getUrl("query-handler"),data:t,type:"POST",dataType:"json"})},getMenuAuthorization:function(){return $.read(this.serviceLocator.getUrl("authorization-handler-getMenuAuthorization"))},isCaseCreationAuthorized:function(e){var t=this.serviceLocator.getUrl("authorization-handler-isCaseCreationAuthorized");return t=t.replace("{0}",e.idWfClass||""),$.read({url:t})},getAsynchExecutionState:function(e){return(e=e||{}).idCase,$.read({url:this.serviceLocator.getUrl("case-handler-getAsynchExecutionState"),data:{idCase:e.idCase,idAsynchWorkitem:e.idAsynchWorkitem},serviceType:"ASYNCHEXECUTION"})},supportedLogTypes:function(){return $.read(this.serviceLocator.getUrl("case-handler-supportedLogTypes"))},getActivityLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getActivityLog"),{idCase:e.idCase,orden:e.sort||0,idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe(function(e){return e})},getActivityDetailLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getActivityDetailLog"),{idCase:e.idCase,idWorkItemFrom:e.idWorkItemFrom,idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe(function(e){return e})},getEntityLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getEntityLog"),{idCase:e.idCase,orden:e.sort||0,idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe(function(e){return e})},getEntityDetailLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getEntityDetailLog"),{idCase:e.idCase,idEntity:e.idEntity||-1,userFullName:e.userFullName||"",attribDisplayName:e.attribDisplayName||"",idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe(function(e){return e})},getUserLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getUserLog"),{idCase:e.idCase,orden:e.sort||0,idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe(function(e){return e})},getUserDetailLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getUserDetailLog"),{idCase:e.idCase,idUser:e.idUser,entDisplayName:e.entDisplayName||"",attribDisplayName:e.attribDisplayName||"",idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe(function(e){return e})},getAdminLog:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("case-handler-getAdminLog"),{idCase:e.idCase,orden:e.sort||0,idActualPage:e.idActualPage||1,pageSize:e.pageSize||10}).pipe(function(e){return e})},addFavorite:function(e){return e=e||{},$.create(this.serviceLocator.getUrl("favorites-handler-saveFavorite"),{idObject:e.idObject,favoriteType:e.favoriteType}).pipe(function(e){return e})},delFavorite:function(e){return e=e||{},$.destroy(this.serviceLocator.getUrl("favorites-handler-deleteFavorite"),{guidFavorite:e.idObject}).pipe(function(e){return e})},summaryAssigness:function(e){var t=new $.Deferred,r=e.idCase||"";return $.when(this.getCaseAssignees({idCase:r})).done(function(e){for(var r=e.assignees||[],i=r.length,a={showAssignees:!!(bizagi.override.showAssignees&&r.length>0),assignees:{},events:"",activities:""},o="",s="",n=[],c=[],l=0;l<i;l++)bizagi.util.parseBoolean(r[l].isEvent)?-1==n.indexOf(r[l].idUser)&&(n.push(r[l].idUser),o+=r[l].Name+", "):-1==c.indexOf(r[l].idUser)&&(c.push(r[l].idUser),s+=r[l].Name+", ");a.events=o.substring(0,o.length-2),a.activities=s.substring(0,s.length-2),t.resolve(a)}),t.promise()},summarySubProcess:function(e){var t=$.Deferred(),r=e.idCase||"";return $.when(this.getCaseSubprocesses({idCase:r})).done(function(e){if(e.showSubProcess=e.subProcesses.length>=1,e.showSubProcesColumns=void 0!==e.CustFields[0]&&e.CustFields[0][0].length>=1,e.showSubProcesColumns){var r;e.subProcPersonalized={};for(var i=0;i<e.CustFields.length;i++){r=0;for(var a=0;a<e.subProcesses.length;a++)e.subProcesses[a].idCustData==i&&(e.subProcPersonalized[i]=e.subProcPersonalized[i]||{},e.subProcPersonalized[i].subProcesses=e.subProcPersonalized[i].subProcesses||{},e.subProcPersonalized[i].subProcesses[r++]=e.subProcesses[a]);-1!=e.subProcesses[i].idCustData&&null!=e.subProcPersonalized[i]&&(e.subProcPersonalized[i].CustFields=e.CustFields[i],e.subProcPersonalized[i].idCase=e.idCase)}}t.resolve(e)}),t.promise()},summaryCaseEvents:function(e){var t=$.Deferred(),r=e.idCase||"";return $.when(this.getCaseEvents({idCase:r})).done(function(e){e.showEvents=e.events.length>=1,t.resolve(e)}),t.promise()},summaryCaseDetails:function(e){var t=new $.Deferred,r=e.idWorkitem||0;return $.when(this.getCaseSummaryDataContent(e)).done(function(e){e.currentState=e.currentState||[];var a=e.currentState.length;for(e.showEvents=e.countEvents>=1,e.showParentProcess=e.idParentCase>=1,e.parentProcess={displayName:e.parentDisplayName,idCase:e.idParentCase},e.isClosedForAllUsers=bizagi.util.parseBoolean(e.isClosed),e.isClosed=!bizagi.util.parseBoolean(e.isOpen),e.showAssignees=!!(bizagi.override.showAssignees&&e.countAssigness>0),e.showSubProcess=e.countSubProcesses>0,e.showForm=!!bizagi.util.parseBoolean(e.hasGlobalForm),e.allowsReassign="false",i=0;i<a;i++)e.currentState[i].idWorkItem==r&&(e.allowsReassign=e.currentState[i].allowsReassign);var o=[],s=0;for(i=0;i<a;i++)!bizagi.util.parseBoolean(e.currentState[i].isEvent)&&bizagi.util.parseBoolean(e.currentState[i].assignToCurrentUser)&&e.currentState[i].idWorkItem!=r&&(o[s++]=e.currentState[i]);e.currentStateTypes=o,e.showActivities=o.length>0,t.resolve(e)}),t.promise()},releaseActivity:function(e){var t=this.serviceLocator.getUrl("case-handler-releaseActivity");t=t.replace("{idCase}",e.idCase);var r={};return e&&(r.idCase=e.idCase,r.idWorkItem=e.idWorkItem),$.ajax({url:t,data:r,type:"POST",dataType:"json"})},summaryActivities:function(e){var t={},r=e.data||{},i=i||e.idWorkitem||0;try{t.showActivities=r.currentStateTypes.length>=1,t.currentState=r.currentStateTypes,t.globalIdWorkitem=i,t.creationDate=r.creationDate}catch(e){}return t},getCaseSummaryDataContent:function(e){var t=this,r=new $.Deferred;return $.when(t.getCaseSummary(e)).done(function(e){e.taskState=t.icoTaskState,e.process=e.process?e.process:"",e.createdBy&&(e.createdByName=e.createdBy.Name,e.createdByUserName=e.createdBy.userName,e.caseDescription=""==e.caseDescription?"":e.caseDescription,e.processPath=e.processPath.replace(/\//g," > ")+e.process,e.showWorkOnIt=!0),r.resolve(e)}),r.promise()},getSmartFolders:function(e){var t=this,r={};return r.idFolder=e||"",$.read(t.serviceLocator.getUrl("folders-handler-getUserQueries"),r).pipe(function(r){return-1==e||""==e?r:t.searchFolders(e,r)||[]})},deleteSmartFolder:function(e){var t={action:"6"};return e=e||{},t.idSmartFolder=e.idSmartFolder||"",t.idUser=e.idUser||"",$.destroy(this.serviceLocator.getUrl("folders-associate-deleteSmartFolder"),t)},getFolders:function(e){var t=this,r={action:"getUserFolder"};return r.idFolder=e||"",$.ajax({url:t.serviceLocator.getUrl("folders-handler"),type:"POST",data:r,dataType:"json"}).pipe(function(r){return""==e?{folders:[{name:bizagi.localization.getResource("workportal-widget-folders"),id:"-1",idParent:0,childs:r}]}:-1==e?r:t.searchFolders(e,r)||[]})},searchFolders:function(e,t){for(var r=0;r<t.folders.length;r++){if(t.folders[r].id==e)return t.folders[r].childs}},getCasesByFolder:function(e){return e=e||"",$.ajax({cache:!0,url:"RestServices/"+e,type:"GET",dataType:"json"})},makeFolder:function(e){var t={action:"CreateUpdateFolder"};return t.folderName=e.folderName||"No Name",null!=e.idParentFolder&&e.idParentFolder>1&&(t.idParentFolder=e.idParentFolder),$.ajax({url:this.serviceLocator.getUrl("folders-handler"),data:t,type:"POST",dataType:"json"})},updateFolder:function(e){var t={};return e=e||{},t.action="CreateUpdateFolder",t.idFolder=e.idFolder||"",e.folderName&&(t.folderName=e.folderName),e.idParentFolder&&(t.idParentFolder=e.idParentFolder),$.ajax({url:this.serviceLocator.getUrl("folders-handler"),data:t,type:"POST",dataType:"json"})},associateCaseToFolder:function(e){var t={action:"4"};return e=e||{},t.idCase=e.idCase||"",t.idCustomFolder=e.idCustomFolder,$.ajax({url:this.serviceLocator.getUrl("folders-associate"),data:t,type:"POST",dataType:"json"})},dissasociateCaseFromFolder:function(e){var t={action:"DeleteCaseFromFolder"};return e=e||{},t.idFolder=e.idFolder,t.idCase=e.idCase,$.ajax({url:this.serviceLocator.getUrl("folders-handler"),data:t,type:"POST",dataType:"json"})},deleteFolder:function(e){var t={action:"5"};return e=e||{},t.idCustomFolder=e.idCustomFolder||"",$.ajax({url:this.serviceLocator.getUrl("folders-associate"),data:t,type:"POST",dataType:"json"})},getFile:function(e){var t={},r=this.serviceLocator.getUrl("file-handler");return e=e||{},t.action="getFileContent",t.uploadId=e.uploadId||"",t.entityId=e.entityId||"",t.entityKey=e.entityKey||"",bizagi.services.ajax.pathToBase+r+"?"+jQuery.param(t)},getComments:function(e){var t=this;return e=e||{},$.read(encodeURI(t.serviceLocator.getUrl("MessageHandler-GetComments")),{idCase:e.idCase||"",idColorCategory:"number"==typeof e.idColorCategory?e.idColorCategory:"",pag:e.pag||1,pagSize:e.pagSize||10}).pipe(function(e){var r=new $.Deferred,i="iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABJwSURBVHhe7Vt5UJPnuj+ddvSqdcpotQougCyGRfY9QCQQwhKIrAqurUtbbbVV1KO2UrXH46lL1aOOdWvrcl3QuosIBUSGongA5bLXqLjCVbarrX/97vO8SSAieLRVJ86czPwmX0L8vve3PM/7vp/JX/7yn8d/FHhVCkykC+144403NL16vQ1TU1MtBpqiR48eoL8VE9YQnF/VgF7VdVLffPPNRkdHJ0SER0CpDIdCEYqQkBAtgvlZgdDQUHh5ecHMzIzFyCbIXtUAX9Z12MliN1c3JCcnIzkpGWp1jCBrSD6YBAgODoZczpALBMmCYGFhwULsIJi8rAG+zPM6s+vseGLiaMTFxSM2JlaQl8lkAoGBgQgMCERAQAD8/f0hlfrDz88Pfr5+8PX1FXByctKXxmslgiAfEqxAdFQ0VKooqCJVwnVvb1+Ct4i6l6cXPDw8CR5wd3OHm5sbXF1d4ezMcIYTlQwLYGNjoxfhZRr2ws7NTmm8vLwRSnWuIMelflK46kkRISbl6OAIB4K9vT3s7ewhkdgRJLC1sRWEra2tYWVlhWHDhonnPn36sAjcII3+kWplZQ0Pd08RYXt7Bx0pW0FKT8xqmBUsLYfB0sISFkMtMHToUAwZPASDBw8WTdDU1AwDBw4UGDBggAClikUwN2YFTLp37y5izvFlId7t+y4G9B8gSGmJaae9gQO0xPr3649+/fqJz/UlsNN9TPrAxMRE4J133hGf43RwEnRN0Wg1mMVR5q5vQc72pLl99sfj0b3bW3j77beJYF8t+vRtI9qjR0+80/sdIqoly8e9e/d+DJaWlrC1tRXlwn8z5lmh2MvTm2rYFt26dcOSeTNQnn8U2Ue2w8pyCHp076EjTwIIl/vgrbfeYkKCGAvQ+ykCcAq4VOjzE40xAiYm5CIvdvpRrHv26I6a8+nQXMxAbdFpFGcfxJTx8YIsk9fHnB3n9xicho7uc3K4D3ACGNxDjLUZyrh+hwwZSvXcD3J/T1wrPYNrJRkC10uzUPFLOnZvWQ13Zwf06tVL29yoPzBJqZc7fD2cRaN7913qG/Q3fuY+wKLwbMACGKwSjS4EsoHU3MzMBoOTwLVfV5pJOCNw41I2bpadxbVLubiUn46VyxZhYP9+QghujBx/pVyKr+d/goH9+gpRWAR2n4Xg1wwWmfcSRsee65IF4O7OdTxn+gTcvJyFm5cyBW6V5eB2xTncrvoFd2qKoLmcj5L8DHy37hsE+HmR828xMVgOMcWejcsw98MkSN3tRY/gBOgF4EToSsbo+oBMTG0UaRZg/fL5uFOWTcgSuFuRi7uV+aivKUTDlYtouFqKe9fLUVddgrLCLGQc/hGLPp+GQF83mPZ/F9tXzkPegfU4vHkJUmeOx9houSCuE4B3jWpjS4GMu3p/FuDtXqgsOIr6ihzUl2cLNFSeRUN1Ae7VXsD9qyVovH4JTTcq0XyrBo115bhbfQG1FzJQmrUfpWd24VbREdwpOoTrBftQkfk9StO3GApglCtCE65nruUFMz8gwrm4V0WozCHkorEmH02a82i5XoLWG5fx8E4VHt6txcP6q3hwuwotdaVovHIe96vO4l7ZGTSUHkd98WHUXzxEOIj6ojT4eziAF1rkfKqxuS/G06vHfzXy9HZo+2oikovmmjy01BKunEPr1UI8uF6EhzdK8dvtcvx2txq/37uKR/ev47f6WvHew7pitF4pQFNlFu5dOoF7JUcIh3Gv+BDukQiBXo7o2bMnkiOkvEU2rsepTYsmTklQigXQ0R/XoonIN1ZRCVzOQF3RUdy4eAI3S07jFs0It2hGaL5eSgJo8KhRJ8CtMjRQn7hRdBx1hRT9/L24lrcL1wm3C/eRAGmQ+7qKafIfcyfjxIZFxtUDTmxamHpwy3JRp0d/WIP6skxcPX8ENXn7tTiXhqqzB1CZewDl2VTXOQdwX1NCCbhGCagRopRn7iLsRGXWTlRR3ddkfY/abC2uZG+Hr6stYkOlyNi9Fic3LphlVBFgRzL3rINc6o7D36+ixpeJO5cycLs0nVxnZBDJLJoOc2k9kIfawpO4XpzZJoCm8DiuFaWjrphw4QjqqPnV5e/GDcJNwp3CvVi9YDLy9qxC5u7VOLVpocyoBDi1abH52X1ryZ3VKCMn66mRNVVlaxtaWQYayrNoVshFfRVNhdWFtCYowNWiDDy6RwmgfnC7/BzulucK0e4UH8edC2m4c36fQP2FfWgsPoCajC24eHQT8ug6P61ZbGJUAvBgzmxdqrlB7p3bv0643lKdQ6B6r8pCU3Uu9QWaCa4UounqRTReLUZFbppohCwAv3e/Oh/3K7Jx/3K6aH73i9MEGhkXqXRObsSVvL04tflLXgcY34PLoOjwP5Gz8x+4UXyCunkmWog8o5Vmg1bNLzQTXMRvNBM0XrlgIECVeO/htfNorTmLlvIMNJUeQWPJwTbyjRf345e934DPb3QN0NAKHtzhdXM1tef2o+HyaTSTCM1VmYJYq6YAD64VCbL1tCoUCWjQUAJ0AtBU2UpJaSk/TQIcfox8w/k9OLFxocaoyeuFOLouRV14aANulxwnAc4IEVprcmmOzycBLtB8X4o62iZX5OgEuFOpTYCGBchBc5lOAIo9O8+ozviOGt8io1v/d1mHxzYs1Fw7fwjNFRlCBCbWWnsOD66eJwFKUJ13SEyFIgFCgBI8oBJpocbZXJaOppJDbeRZgPzdf2/8aYcRNr6uFDi4NiW1NH0bLWlPCBFaqRlqBShEMy159WuB3xuuCAFYlAdUIkKAyydJAKp/nfvXcraT+18a5fq/ywTwNJW+dUljXeFBNFNTa9U1wgcU84fXi2lKzKOF0SFKAAlwu0IrAC2DW2gZ3HyZGqiBAOQ+Tu1Ybm58bf/fjIhTUHhwPRrJ0RbRB86KmD/kmeDmJXK+Cr/XswC0DyBRHlCP6CgAu396y1fGufl5FkfSVqdoNDR3t3AfoEbILrcLUEkC6DZCJEpHAbjzZ21bguzXqfY7inJk/bzU01uXUC84KRohk3yomwq59oUAtBFiUToKUHKI1vybv+D9xev7OLBqdmpe2gZcOLIJTRVZbQJot8UsQE2nAlRnbEPe7hU4s33p6y3AwbVzf6osPIHMXatQcnIbWmib/OAqrQWEABWdClCbsxOZ25eh/DSt/SkFp79b7PzaRuDExkXZdbQLrCg4JkS4cGwrmmupD9BiqDMBanL3kOvLaNOzgTZB+3Hp2Aac2rLYuHZ+z+PGqiUp2Q/qLtJuLwdVdJ/wwvFtyPh+BYpP78QN+r8C3gXepnsB1WfTkLNrJU5Sv/jl0HrcKNgjFkNHvluKxTMnvz4rQBYnOjraPDIycs1IpVrj6S9HQcY+tNISuJlmgJt0X6A0ay/O7F2Hw0Ru/7qF+OGbFPy4ai69XoJ8mjYr6WYI3wW6SSKMT1TDL3oilFHxGpVKlcrnfh4DXulnaYATw1SjsmWxk+GS/CXsx6+Ac9znUCpCsHPzSnFfkPcDfHOk/Ox+nDv8HY5uX4E9//wSaXT7+wwl4PyRjUIAvgs8LoHIK+NgN26FOBefk8/N1+BrvVJyXV2MHWFnFOrRjd6jZ8Nx3NdisIbwSPgMsuBQxKhV2LlpBUqz9wsBCqgfnPxxVZsAx7b9DdtWzkfK9IniuwU+ihjYJS974nx8Db5WaFR8oy4VJq9cDF3Md4SMGgv3pAVPDLKjCE5jl0AaMxUjQ1Xi+0BMcNzoWIyJi0K8OgKhIXLx/SD+3pBvRBJcEufDTgj5d9iPM8Ryek0Yuxx2BLfR8xE8KhlUcjteSXnQRUxY9Wcl3lEIJuSS9AU8ElPgE/shvEZNE3CLm0mk5wlSdmP/pkUy42sDLINdkh5L6ZgwZikkBNeEFMjVSS83EeHh4c4RqlGaJx0nh/6NU12SaiPExLSE9KQkY5YQOcJoxlftSEyFpA2LIUnQYjjBPXYm94hiHusLLQs+oUKd2OiYTAPUxe+FkUokck8hNTzhSwyPZ3zxOOIWYXgbFmJ4rBZ2sfMQokpofGEicOzDyXmHMam6CHblkoFTTyVFZDojFUcEuyBlG7sAAjGMvz6OUfNhKzBPC/U8SNRzKAnqF3PzlOd01/g5HVziGLZHTxB6UaRGEcFOSDExG/VcLaIZKe2IouOoOTrMpufZcFVNo+8oqv7cVppjFKQeB4lBBG05ap04xe936VQbocedsnkqKT0hfiZSqnZYqz6HdaQen9GxFlbhn8I6YlYbRqpG40/NDqRgtnM8RSquPX7Dwj/RRvAFkrImcl2RMiRkHTET1uHtYMJWYYxPBCxDpmFY6HRYKWfAOmwGHCI+FlPkH2qIERERsqBRE+AQvwCSmPlt8bMImdohfp07JQh15lTEZ1i3Ox38SJ6/ntzqQKgDKUFOyZhhACLJRHUYFvoxhik+hqV8MsxHTqLjj2BN7w0PnwGZaswfSwG5/5M71b5j7HxqKlRjOpcGS8c8GT+D2GkdezqpdbtOagWYu7ZTUoKQjhSTaUMIHYd82I5gcrwNU2FB5If4jSEhpsCa0jBc+RGcwqc9fwq4buRU+y7x8+EYkwJJ1OewIWIWwVMwyDtO1FrH+GmdMnSJjzu4pCO1dudxIUDSnNXwSpiDUdO/hrN6lpaYASnL4KkQkDOmtCOIjoMm6/ABLEdqMVSaDDP3aDp+H9aUBoliGhzCPoI8MuH5UsCd3yd2BlxiU+Co/hwSFblKNTVEmgQzrxhRaxy/rp0ycKkTUmt/OCoE+HHPfvz888/49ddf8ejRI6Sl58M5imo5qJ0UE7MgQhYyPSbRsQ6BE2HRhgkY4pOIAU6hsAycAOugSZCETIaDciq8wyfwjDDrmXtBuCpW4xGfApcY2uBEzYIk4hNRU4O8YmHmqYYFDdAweu0uGTj1mEvsVjupb78/IgRYunIjZi5eg282/zf+936TeC8j71+PkbIImAA9zAPGw9xfj3F0rIN0LMwJg73i8J6DHOa+o2EtmwCJfBIcFZPhpJwCZYT62b5ep5/6PGJnw4Vi6Rj5CSRhH8Oa4jTQOUxEjFXXRtDQKXKoM6cec4kdm4Bvd/wkyI7+dDn0pEaEfYjm1gfifWn8Z4JQO5Jh7qdHEob6EXwZY9rhMwaDPWLwnn0QhnrGwDpgLCQjJ8AxZBJclJMRGJaAZ1od8uJBGvMhPGJmwSXqUzjSVCIJnQZrqn8+uambSijfHj0iZeCSBbvUmVMGhNZsOyiITv3rah0xLamCf5WL9xOnL9ESI1JDfUa3wzsRQ9uQgCFeesTTcTwGuUXjPYkMg8goG/8xkMjGwlE+AS6KSfBUJD9TGXQjlU66Rc2Ah/pTuKimw5GcsVNQVw16H/1s/WDqEikGK+L3mEvkWJtL7JbepY5OjcZX3/4giBZc/J82QmHj5rYlwFc9XRAS8NQjjo518IjFkDbEYLC7FoNcVHhveCAGjQiBjV8iJAFJGBE0Fi4hE+AUNI6325upDwwjvNlVP3DkD/lEvg/P6OlwjfgII6iJ2AW/Dyv/JPRnAUhd4cpj8TNwif9m4NJQ7yedciBX6m7VCxH4mYVobvk/8XrrnmNErp3UYPdRRI7gxlAbIBqDXQ0RBTOncAwY7o+BBBvfOEj8EzFCRvcX5OMgVSbS75KkK4m4G0HSlQBu9J1+mUKhyB6pSoZb+GSMUHwAuyCqee8Y9LfxhamTUufO4/HTOmXgEh8buNSRlI9qKgqKLgvS/GABtu4++gSpQS5R5CxDpYUzI7IdThEYpIOZoxIDbKUYaOMDGxqvnV88nAMTEUi31pgTc9MJwCJ0+uiv/wD9tmeqUqnMDoqIp/qhxY831Red2NRRIZoNE3p+p6KIoJ6QISkDQkzOgNQgcpVhNoJBTZjhqIeSjnVwCIWZfQgG2PhhkK0PPGVqyJVq+p2iMpu5GBBn8n2fNiX21tUJf1AkwsfHJ5V+23csSBF5y1sWCSf/aEh89PH7g6QEoY6kDAgxMSbVBgURVMBUIKQddiGwdQuFs68SvrJwjJSH3eKx8pg7OM58zAndnnU9wI2CleJ/5KhXkE/KinKv4AvJFcoiaVDErYDgSHgERMKdYO8dgeGe4QJWbkRS79JzkDK1C4aVi0KQs3VTwM4jFO7SMAH/oHBIRypvyYNDi+iHlnt4LDymTgjzuHn8zKPLxvesgrByJgRTXUJsOsRKpIUHwmAHeGCG4DqkSBY9DSxqx39Hvy2crT9vJyRFUgk8Hu7wPD4e5zM7/awCdPU5VpbLhsE9hAdgKBIPTA/njqJ18Zo/Z/jvDMnxufk6+mv+qfH/Pz9r9qvYcZe2AAAAAElFTkSuQmCC";return e.comments?$.each(e.comments,function(t,r){e.comments[t].hasOwnProperty("CategoryColor")||(e.comments[t].CategoryColor="")}):e.comments=[],e.users?$.each(e.users,function(t,r){e.users[t].Picture=""===e.users[t].Picture?i:e.users[t].Picture}):$.when(t.getCurrentUser()).done(function(t){e.users=[],e.users.push({Id:t.idUser,Name:t.user,DisplayName:t.userName,Picture:i})}),r.resolve(e),r.promise()})},makeNewComment:function(e){return $.create(this.serviceLocator.getUrl("MessageHandler-NewComment"),{idCase:e.idCase||"",comment:e.comment.replace(/\n/g,"<br>")||""}).pipe(function(e){if(e.comments){var t=[e.comments];$.each(t,function(e,r){t[e].CategoryColor=""}),e.comments=t}if(e.users){var r=[e.users];$.each(r,function(e,t){r[e].Picture=""==r[e].Picture?"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":r[e].Picture}),e.users=r}return e})},makeNewReply:function(e){return e=e||{},$.create(this.serviceLocator.getUrl("MessageHandler-ReplyComment"),{idCase:e.idCase||"",idComment:e.idComment||"",comment:e.comment.replace(/\n/g,"<br>")||""}).pipe(function(e){if(e.comments&&(e.Replies=[e.comments]),e.users){var t=[e.users];$.each(t,function(e,r){t[e].Picture=""==t[e].Picture?"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":t[e].Picture}),e.users=t}return e})},removeMobileComment:function(e){var t=this.serviceLocator.getUrl("remove-comment");return e=e||{},$.destroy({url:t,data:JSON.stringify(e),dataType:"json",contentType:"application/json"}).pipe(function(e){return e})},removeComment:function(e){return e=e||{},$.destroy(this.serviceLocator.getUrl("MessageHandler-RemoveComment"),{idCase:e.idCase||"",idComment:e.idComment||""})},removeReply:function(e){return e=e||{},$.destroy(this.serviceLocator.getUrl("MessageHandler-RemoveReply"),{idCase:e.idCase||"",idComment:e.idComment||"",idReply:e.idReply||""})},renameCommentCategory:function(e){return e=e||{},$.update(this.serviceLocator.getUrl("MessageHandler-RenameCategoryColor"),{idColorCategory:e.idColorCategory>=0?e.idColorCategory:"",colorName:e.colorName||""})},setCommentCategory:function(e){return e=e||{},$.update(this.serviceLocator.getUrl("MessageHandler-SetCategoryToComment"),{idCase:e.idCase||"",idComment:e.idComment||"",idColorCategory:"number"==typeof e.idColorCategory?e.idColorCategory:""})},getCommentsCategories:function(){return $.read(this.serviceLocator.getUrl("MessageHandler-GetCategoryColors")).pipe(function(e){return e.length>1&&e[0].categories?e[0]:e})},getNewComments:function(e){return e=e||{},$.read(encodeURI(this.serviceLocator.getUrl("MessageHandler-CountNewComments")),{idCase:e.idCase||0,idComment:e.idComment||0})},getAnalisysQueries:function(){return $.read(this.serviceLocator.getUrl("bamAnalytics-handler-getAnalisysQueries"))},updateQueries:function(e){return $.update(this.serviceLocator.getUrl("bamAnalytics-handler-updateQuery"),{idQuery:e.idQuery>=0?e.idQuery:"",queryName:e.queryName||"",queryDescription:e.queryDescription||""})},deleteQueries:function(e){var t={action:"1612"};return t.QueryId=e||"",$.destroy(this.serviceLocator.getUrl("reports-handler-deleteQueries"),t)},getConfiguration:function(){var e=this.serviceLocator.getUrl("authenticationConfig");return $.read(e)},logout:function(){sessionStorage.removeItem("bizagiAuthentication");try{var e=$.create(this.serviceLocator.getUrl("logout"));$.when(e).done(function(){location.reload()}).fail(function(){bizagi.log("Error logging out")})}catch(e){}},logoutMobile:function(){var e=this,t={sourceLogout:"user"};if(sessionStorage.removeItem("bizagiAuthentication"),bizagi.util.isCordovaSupported()){var r=e.serviceLocator.getUrl("logout");return $.create(r)}try{$.when(e.getConfiguration()).done(function(r){if(r.redirectErrorPage)window.location.href=r.redirectErrorPage;else switch(r.authenticationType){case"Federate":var i=r.logOffURL,a=r.federationLogoutBindingProtocol;if("WSFederated"===authenticationSubType)$.when($.create(e.serviceLocator.getUrl("logout"),t)).done(function(){location.href=i}).fail(function(){bizagi.log("Error logging out")}).always(function(){location.href=r.logOffURL});else if("Saml"===authenticationSubType){$.when($.read(e.serviceLocator.getUrl("FederateLogoffUrl"),{})).done(function(r){r.federateLogoffUrl&&(i=r.federateLogoffUrl),$.when($.create(e.serviceLocator.getUrl("logout"),t)).done(function(){"POST"===a?(window.document.open("text/html"),window.document.write(i),window.document.close()):window.location.href=i}).fail(function(){bizagi.log("Error logging out")}).always(function(){})}).fail(function(){bizagi.log("Error logging out")}).always(function(){})}break;case"SAML":loader.nativeAjax(loader.getPathUrl(e.serviceLocator.getUrl("logout"),t),function(e){var t=JSON.parse(e.responseText);if(!0===t.logout)if(void 0!==t.samlUrlRedirect){var r=decodeURI(t.samlUrlRedirect),i=document.createElement("iframe");document.getElementsByTagName("body")[0].appendChild(i),$(i).on("load",function(){(bizagi.util.isIE8()?$(this.contentWindow.document.body):$(this.contentWindow.eval("document.body"))).text();location.reload()}),i.src=r}else location.reload();else bizagi.log("Error logging out")});break;case"OAuth2":$.when($.create(e.serviceLocator.getUrl("logout"),t)).done(function(){$.when($.read(e.serviceLocator.getUrl("oauth2AuthenticationConfig"))).done(function(e){if(e.logoutUrl&&""!=e.logoutUrl){var t=e.logoutUrl,r=e.homeUrl;t=t.replace(/post_logout_redirect_uri=[^&]*/,"post_logout_redirect_uri="+r),location.href=t}else location.reload()}).fail(function(){bizagi.log("Error logging out")})}).fail(function(){bizagi.log("Error logging out")});break;default:$.when($.create(e.serviceLocator.getUrl("logout"),t)).done(function(){window.location=bizagi.services.ajax.loginPage}).fail(function(){bizagi.log("Error logging out")})}}).fail(function(e){bizagi.log(e)})}catch(e){bizagi.log(e)}},getOrganizationInfo:function(e){var t={};return t.objectType=e,$.ajax({url:this.serviceLocator.getUrl("massive-activity-assignments-getOrganizationInfo"),data:t,type:"GET",dataType:"json"})},getCasesByOrganization:function(e){var t={};return t.roles=e.roles?"["+e.roles.toString()+"]":"[]",t.skills=e.skills?"["+e.skills.toString()+"]":"[]",t.locations=e.locations?"["+e.locations.toString()+"]":"[]",$.ajax({url:this.serviceLocator.getUrl("massive-activity-assignments-getCasesByOrganization"),data:t,type:"GET",dataType:"json"})},reassignCases:function(e){var t={};return t.users=e.user?"["+e.user.toString()+"]":"[]",t.roles=e.roles?"["+e.roles.toString()+"]":"[]",t.skills=e.skills?"["+e.skills.toString()+"]":"[]",t.locations=e.locations?"["+e.locations.toString()+"]":"[]",$.ajax({url:this.serviceLocator.getUrl("massive-activity-assignments-reassignCases"),data:t,type:"POST",dataType:"json"})},searchUsers:function(e){var t={};return t.userName=e.userName||"",t.fullName=e.fullName||"",t.domain=e.domain||"",$.ajax({url:this.serviceLocator.getUrl("massive-activity-assignments-searchUsers"),data:t,type:"GET",dataType:"json"})},getDomainList:function(){var e=this.serviceLocator.getUrl("domains");return $.read(e)},getEcmAllScheduledJobs:function(){var e={action:"getEcmAllScheduledJobs"};return $.read(this.serviceLocator.getUrl("async-ecm-upload-baseService"),e)},retryECMPendingScheduledJob:function(e){var t={action:"retryECMPendingScheduledJob"};return t.idJob=e,$.read(this.serviceLocator.getUrl("async-ecm-upload-baseService"),t)},getWorkPortalVersion:function(){return $.ajax({url:this.serviceLocator.getUrl("WorkPortalVersion"),type:"GET",dataType:"json"}).always(function(e){return""==(e=e||{}).version&&(e.version=bizagi.loader.productBuild||""),e})},getAuthenticationLogData:function(e){var t="";return t="domains"==e.dataType?"admin-getAuthenticationDomains":"events"==e.dataType?"admin-getAuthenticationEventsTypes":"admin-getAuthenticationEventSubTypes",$.ajax({url:this.serviceLocator.getUrl(t),data:{},type:"GET",dataType:"json"})},getAuthenticationLogResult:function(e){var t={};return t.action=e.action,t.domain=e.domain,t.userName=e.userName,t.dtFrom=e.dtFrom,t.dtTo=e.dtTo,t.eventSubType=e.eventSubType,t.eventType=e.eventType,t.pag=e.pag,t.pagSize=e.pagSize,$.ajax({url:this.serviceLocator.getUrl("admin-getAuthenticationLog"),data:t,type:"GET",dataType:"json"})},encryptString:function(e){var t={};return e=e||{},t.entry=e.entry,$.ajax({url:this.serviceLocator.getUrl("admin-EncryptString"),data:t,type:"POST",dataType:"json"})},userPendingRequests:function(e){var t={pag:e.pag,pagSize:e.pagSize};return $.read(this.serviceLocator.getUrl("admin-UserPendingRequests"),t)},userAuthenticationInfo:function(e){return $.read(this.serviceLocator.getUrl("admin-UserAuthenticationInfo"),{idUser:e.idUser})},updateUserAuthenticationInfo:function(e){return $.create(this.serviceLocator.getUrl("admin-updateUserAuthenticationInfo"),{idUser:e.idUser,password:e.password,enable:e.enable,expired:e.expired,locked:e.locked})},generateRandomPassword:function(e){return(e=e||{}).action="generateRandomPassword",$.ajax({url:this.serviceLocator.getUrl("admin-generateRandomPassword"),data:e,type:"POST",dataType:"json"})},generateDataToSendByEmail:function(e){e=e||{};var t={action:"GenerateDataToSendByEmail"};return t.idUser=e.idUser,t.password=e.password,$.ajax({url:this.serviceLocator.getUrl("admin-GenerateDataToSendByEmail"),data:e,type:"POST",dataType:"json"})},sendEmail:function(e){e=e||{};var t={action:"sendEmail"};return t.emailTo=e.emailTo,t.subject=e.subject,t.body=e.body,$.ajax({url:this.serviceLocator.getUrl("admin-sendEmail"),data:e,type:"POST",dataType:"json"})},getApplicationCategoriesList:function(e){var t={},r="";return"Applications"==e.action?(r="admin-getApplicationList",$.ajax({url:this.serviceLocator.getUrl(r),type:"GET",dataType:"json"})):(r="admin-getCategoriesList",t.idApp=e.idApp,t.idCategory=e.idCategory,""==t.idCategory&&(t.idCategory=-1),void 0!==e.filterStartEvent&&(t.filterStartEvent=e.filterStartEvent),$.ajax({url:this.serviceLocator.getUrl(r),data:t,type:"GET",dataType:"json"}))},getAdminCasesList:function(e){var t=e||{};return $.ajax({cache:!0,url:this.serviceLocator.getUrl("admin-getCasesList"),data:t,type:"GET",dataType:"json"})},getApplicationProcesses:function(e){var t=this.serviceLocator.getUrl("admin-getApplicationProcesses"),r={};return r.idApp=e.idApp?e.idApp:-1,$.read(t,r)},getProcessVersion:function(e){var t=this.serviceLocator.getUrl("admin-getProcessVersion"),r={};return r.idWfClass=e.idWFClass,$.read(t,r)},getProcessTasks:function(e){var t=this.serviceLocator.getUrl("admin-getProcessTasks"),r={};return r.idWfClass=e.idWFClass,r.version=e.version?e.version:void 0,$.read(t,r)},getTaskAlarms:function(e){var t=this.serviceLocator.getUrl("admin-getTaskAlarms"),r={};return r.idTask=e.idTask,$.read(t,r)},getLapseMode:function(){var e=this.serviceLocator.getUrl("admin-getLapseMode");return $.read(e)},getRecurrMode:function(){var e=this.serviceLocator.getUrl("admin-getRecurrMode");return $.read(e)},getScheduleType:function(){var e=this.serviceLocator.getUrl("admin-getScheduleType");return $.read(e)},getBossList:function(e){var t=this.serviceLocator.getUrl("admin-getBossList");return $.read(t)},addAlarm:function(e){var t=this.serviceLocator.getUrl("admin-addAlarm"),r={};return r.idTask=e.idTask,r.idRecurrMode=e.idRecurrMode,r.idLapseMode=e.idLapseMode,r.scheduleType=e.scheduleType,r.alarmTime=e.alarmTime,r.alarmRecurrTime=e.alarmRecurrTime,r.sendToCurrentAssignee=e.sendToCurrentAssignee,$.update(t,r)},editAlarm:function(e){var t=this.serviceLocator.getUrl("admin-editAlarm"),r={};return r.idTask=e.idTask,r.idAlarm=e.idAlarm,r.idRecurrMode=e.idRecurrMode,r.idLapseMode=e.idLapseMode,r.scheduleType=e.scheduleType,r.alarmTime=e.alarmTime,r.alarmRecurrTime=e.alarmRecurrTime,r.sendToCurrentAssignee=e.sendToCurrentAssignee,$.update(t,r)},deleteAlarm:function(e){var t=this.serviceLocator.getUrl("admin-deleteAlarm");return e.idAlarm,$.destroy(t,e)},getAlarmRecipients:function(e){var t=this.serviceLocator.getUrl("admin-alarmRecipients"),r={};return r.idAlarm=e.idAlarm,$.read(t,r)},addRecipientToAlarm:function(e){var t=this.serviceLocator.getUrl("admin-recipientToAlarm"),r={};return r.idAlarm=e.idAlarm,r.idRecipient=e.idRecipient,$.update(t,r)},deleteRecipientsFromAlarm:function(e){var t=this.serviceLocator.getUrl("admin-deleteAlarmRecipients"),r={};return r.idRecipients=e.idRecipients,$.destroy(t,r)},enableAlarm:function(e){var t=this.serviceLocator.getUrl("admin-enableAlarm"),r={};return r.idTask=e.idTask,$.create(t,r)},abortReassignItems:function(e){var t=e||{},r="abort"==e.action?"admin-abortItems":"admin-reassignItems";return $.ajax({url:this.serviceLocator.getUrl(r),data:t,type:"POST",dataType:"json"})},asyncActivitiesServices:function(e){var t=this,r=e,i="",a="GET";return"getActivities"==e.action?i=t.serviceLocator.getUrl("admin-async-activities-get-activities"):"retryNow"==e.action?(a="POST",i=(i=(i=(i=t.serviceLocator.getUrl("admin-async-activities-get-retry-now")).replace("{idCase}",e.idCase)).replace("{idworkItem}",e.idWorkitem)).replace("{idAsynchWorkitem}",e.idAsynchWorkitem)):"getActivitiesByTask"==e.action?i=t.serviceLocator.getUrl("admin-async-activities-get-activities-by-task"):"enableExecution"==e.action?(a="POST",i=t.serviceLocator.getUrl("admin-async-activities-enable-execution")):"enableMultiple"==e.action?(i=t.serviceLocator.getUrl("admin-async-activities-enable-multiple"),a="POST"):"asyncExecution"==e.action?i=t.serviceLocator.getUrl("admin-async-activities-async-execution"):"asyncExecutionLog"==e.action?i=(i=(i=(i=t.serviceLocator.getUrl("admin-async-activities-async-execution-log")).replace("{idCase}",e.idCase)).replace("{idworkItem}",e.idWorkItem)).replace("{idAsynchWorkitem}",e.idAsynchWorkitem):"getAsyncExecution"==e.action&&(i=t.serviceLocator.getUrl("admin-async-activities-async-get-current-execution-log")),$.ajax({url:i,data:r,type:a,dataType:"json"})},getDefaultAssignationUserToAllProcess:function(e){return $.read(this.serviceLocator.getUrl("admin-getDefaultAssignationUserToAllProcess"),{serviceAction:"getDefaultAssignationUserToAllProcess"})},getDefaultAssignationUserToProcess:function(e){var t;return t=""==e.idWFClass?-1:e.idWfClass,$.read(this.serviceLocator.getUrl("admin-getDefaultAssignationUserToProcess"),{serviceAction:"getDefaultAssignationUserToProcess",process:t})},setDefaultAssignationUserToProcess:function(e){return""==e.idWFClass?process=-1:process=e.idWfClass,$.create(this.serviceLocator.getUrl("admin-setDefaultAssignationUserToProcess"),{serviceAction:"setDefaultAssignationUserToProcess",process:process,idUser:e.idUser})},getProcessIcon:function(e){var t={processId:e.processId};return $.read({url:this.serviceLocator.getUrl("process-getIcon"),data:t,batchRequest:!0})},getCollectionIcon:function(e){var t={collectionId:e.collectionId};return $.read({url:this.serviceLocator.getUrl("collections-getIcon"),data:t,batchRequest:!0})},getProfilesTypes:function(e){return $.read(this.serviceLocator.getUrl("admin-getProfilesTypes"))},searchProfiles:function(e){var t=this.serviceLocator.getUrl("admin-searchProfiles"),r={};return r.type=e.profileType,r.name=e.profileName,r.orgId=e.orgId?e.orgId:null,$.read(t,r)},getUsersByProfile:function(e){var t=this.serviceLocator.getUrl("admin-getUsersByProfile"),r={};return r.type=e.profileType,r.id=e.idProfile,$.read(t,r)},removeUserFromProfile:function(e){var t=this.serviceLocator.getUrl("admin-removeUserFromProfile"),r={};return r.type=e.profileType,r.id=e.idProfile,r.idUser=e.idUser,$.destroy(t,r)},addUserToProfile:function(e){var t=this.serviceLocator.getUrl("admin-addUserToProfile"),r={};return r.type=e.profileType,r.id=e.idProfile,r.idUser=e.idUser,$.update(t,r)},licenses:function(){var e=this.serviceLocator.getUrl("admin-Licenses");return $.read(e)},getDimensions:function(){var e=this.serviceLocator.getUrl("admin-GetDimensions");return $.read(e)},editDimension:function(e){e=e||{};var t={};t.id=e.id,t.displayName=e.displayName,t.name=e.name,t.idWfClass=e.idWfClass,t.entityPath=e.entityPath,t.description=e.description;var r=this.serviceLocator.getUrl("admin-EditDimension");return $.create(r,t)},createAdministrableDimension:function(e){e=e||{};var t={};return t.displayName=e.displayName,t.name=e.name,t.idWfClass=e.idWfClass,t.entityPath=e.entityPath,t.Description=e.description,$.ajax({url:this.serviceLocator.getUrl("admin-CreateAdministrableDimension"),data:e,type:"PUT",dataType:"json"})},deleteDimension:function(e){var t=this.serviceLocator.getUrl("admin-DeleteDimension");e=e||{};var r={};return r.id=e.id,r.idDimension=e.id,r.administrable=e.administrable,$.destroy(t,r)},entityPathChildNodesAction:function(e){e=e||{};var t={};return t.pathNodeType=e.nodeType,t.idNode=e.idNode,t.nodeDisplayPath=e.nodeDisplayPath,t.nodePath=e.nodePath,t.idWfClass=e.idWfClass,$.ajax({url:this.serviceLocator.getUrl("admin-EntityPathChildNodesAction"),data:e,type:"GET",dataType:"json"})},getActiveWFClasses:function(e){var t=e||{};return $.ajax({cache:!0,url:this.serviceLocator.getUrl("admin-GetActiveWFClasses"),data:t,type:"GET",dataType:"json"})},storeDocumentTemplates:function(){var e=this.serviceLocator.getUrl("admin-document-templates-storeDocumentTemplates");return $.read(e)},restoreDocumentTemplates:function(e){var t=this.serviceLocator.getUrl("admin-document-templates-restoreDocumentTemplates");return t+="?Guid="+e.Guid,$.read(t)},getWorkFlowClasses:function(){var e=this.serviceLocator.getUrl("admin-processes-workflowClasses");return $.read(e)},getTaskByWorkFlow:function(e){var t=this.serviceLocator.getUrl("admin-processes-tasksByWorkflow"),r={};return r.idWorkflow=e.idWorkflow,$.read(t,r)},modifyProcessDuration:function(e){var t=this.serviceLocator.getUrl("admin-processes-modifyProcessDuration"),r={};return r.idWorkflow=e.idWorkflow,r.duration=e.duration,$.create(t,r)},modifyTaskDuration:function(e){var t=this.serviceLocator.getUrl("admin-processes-modifyTaskDuration"),r={};return r.idTask=e.idTask,r.duration=e.duration,$.create(t,r)},processesHierarchy:function(){var e={removeOnlineItems:"true"};return $.ajax({url:this.serviceLocator.getUrl("offline-getProcessTree"),data:e,dataType:"json",type:"GET"})},syncOfflineCases:function(e){return $.ajax({url:this.serviceLocator.getUrl("offline-sendForm"),data:{idCase:e.idCase,idWFClass:e.idWfClass,awCaseCreationContext:JSON.stringify(e.objToSend),idWorkflow:e.idWfClass},type:"POST",dataType:"json",serviceType:"LOAD"})},processesHierarchyTofetchForms:function(e){var t={};return t.idChangeSet=e.changeSet,$.ajax({url:this.serviceLocator.getUrl("offline-getForms"),data:t,dataType:"json"})},getDataForMyTeam:function(){return $.ajax({url:this.serviceLocator.getUrl("bam-resourcemonitor-myteam"),type:"GET",dataType:"json"})},getReporstAnalysisQuery:function(){return $.read(this.serviceLocator.getUrl("reports-analysisquery"))},updateReportData:function(e){return $.update(this.serviceLocator.getUrl("reports-analysisquery-update"),e)},deleteReportData:function(e){return $.destroy(this.serviceLocator.getUrl("reports-analysisquery-delete")+"?"+e)},getStoreLanguageTemplates:function(){var e=this.serviceLocator.getUrl("admin-language-languages");return $.read(e,{justActives:!1})},getLanguageTemplate:function(e){var t=$.Deferred(),r=this.serviceLocator.getUrl("admin-language-resource")+"?cultureName="+e.cultureName;return t.resolve("OK"),window.location.href=r,t.promise()},processDefinition:function(e){return $.read(this.serviceLocator.getUrl("processviewer-processdefinition"),e)},graphicInfo:function(e){return $.read(this.serviceLocator.getUrl("processviewer-processgraphicinfo"),e)},getLastUpdateByMobile:function(){return $.read({url:this.serviceLocator.getUrl("mobile-getLastUpdate")})},getCollectionData:function(e){var t={},r=this.serviceLocator.getUrl("templates-handler-getCollectionData");return t.idFact=e.idFact,t.pag=e.page||1,t.pagSize=e.pageSize||10,t.filters=e.filters?Array.isArray(e.filters)?void 0:JSON.stringify(e.filters):void 0,$.read(r,t).pipe(function(e){return e})},getVirtualCollectionData:function(e){var t={},r=this.serviceLocator.getUrl("templates-handler-getVirtualCollectionData");return t.guidVirtualCollection=e.guidVirtualCollection,t.pag=e.page||1,t.pagSize=e.pageSize||10,t.filters=e.filters?Array.isArray(e.filters)?void 0:JSON.stringify(e.filters):void 0,$.read(r,t).pipe(function(e){return e})},getSearchData:function(e){var t=this,r=t.serviceLocator.getUrl("my-search-getData");r=r.replace("{guidSearch}",e.guidSearch);var i=e.filters||[],a={filters:JSON.stringify(i),pag:e.page||1,calculateFilters:e.calculateFilters||!1,pagSize:e.pageSize||10};return $.read(r,a).then(function(e){return t.serializeEntityData(e)})},getCollectionEntityData:function(e){var t,r=this,i={templateType:"VIRTUAL"===(e=e||{}).referenceType||"FACT"===e.referenceType?"List":"Content",surrogateKey:e.surrogateKey,pag:e.page||1,pagSize:e.pageSize||10,defaultFilterApplied:e.defaultFilterApplied,filters:JSON.stringify(e.filters)};return"VIRTUAL"===e.referenceType?(t=r.serviceLocator.getUrl("data-navigation-handler-collection"),i.reference=e.reference):(t=r.serviceLocator.getUrl("data-navigation-handler-entity"),i.reference=e.guidEntityCurrent,i.xpath=e.xpath,i.collectionId=e.reference),$.read(t,i).then(function(e){return r.serializeEntityData(e)})},getFiltersEntityData:function(e){var t={reference:(e=e||{}).guidEntityCurrent,collectionId:e.reference,surrogateKey:e.surrogateKey,xpath:e.xpath,templateType:"List",defaultFilterApplied:e.defaultFilterApplied,filters:JSON.stringify(e.filters)};return $.read({url:this.serviceLocator.getUrl("data-navigation-handler-entity-filters"),data:t})},getProcessAddAction:function(e){var t=this.serviceLocator.getUrl("action-handler-getProcessAddAction");return $.read(t,e).pipe(function(e){return e})},getMultipleActions:function(e){var t=this.serviceLocator.getUrl("templates-handler-getMultipleActions");return $.read(t,e).pipe(function(e){return e})},getMapping:function(e){return $.ajax({url:this.serviceLocator.getUrl("process-handler-getMapping"),data:e,type:"POST",dataType:"json"})},getForm:function(e){return $.ajax({url:this.serviceLocator.getUrl("process-handler-getForm"),data:e,type:"POST",dataType:"json"})},hasStartForm:function(e){var t={};return e.guid&&(t.guidWFClass=e.guid),$.read(this.serviceLocator.getUrl("process-handler-startform"),t)},executeAction:function(e){var t={surrogateKey:JSON.stringify(e.surrogatedKey),entityId:e.entityId,ruleId:e.processId};return $.create({url:this.serviceLocator.getUrl("process-action-execute"),data:t})},actionRule:function(e){var t={surrogateKey:e.surrogateKey,entityId:e.entityId,ruleId:e.processId};return $.create({url:this.serviceLocator.getUrl("process-handler-rule"),data:t,batchRequest:!1})},getActivitiesData:function(e){var t=this,r=t.serviceLocator.getUrl("process-handler-getActivitiesData"),i={page:(e=e||{}).page||1,pagsize:e.pageSize||10};return(void 0!==e.idworkflow&&e.idworkflow||void 0!==e.idWorkflow&&e.idWorkflow)&&(i.idWorkflow=e.idworkflow||e.idWorkflow),void 0!==e.idCase&&e.idCase&&(i.idCase=e.idCase),$.read(r,i).then(function(e){return t.serializeEntityData(e)})},getPendingsData:function(e){var t=this,r=t.serviceLocator.getUrl("process-handler-getPendingsData"),i={page:(e=e||{}).page||1,pagsize:e.pageSize||10};return(void 0!==e.idworkflow&&e.idworkflow||void 0!==e.idWorkflow&&e.idWorkflow)&&(i.idWorkflow=e.idworkflow||e.idWorkflow),void 0!==e.idCase&&e.idCase&&(i.idCase=e.idCase),void 0!==e.taskState&&e.taskState&&(i.taskState=e.taskState),$.read(r,i).then(function(e){return t.serializeEntityData(e)})},getActionsData:function(e){return e=e||{},$.read({url:this.serviceLocator.getUrl("entities-handler-getActions"),data:e,batchRequest:!0}).pipe(function(e){return e})},getUsersAndEvents:function(e){var t={};return e.idCases&&e.idCases.length>0&&(t.idCases=e.idCases.toString()),$.read(this.serviceLocator.getUrl("entities-handler-getUsersAndEvents"),t)},getUsers:function(e){e.caseId;return $.read({url:this.serviceLocator.getUrl("entities-handler-getUsers"),data:e,batchRequest:!0})},getEvents:function(e){e.caseId;return $.read({url:this.serviceLocator.getUrl("entities-handler-getEvents"),data:e,batchRequest:!0})},getUsersImages:function(e,t){var r={},i=this.serviceLocator.getUrl("entities-handler-getUsersImages");return t&&t.length>0&&(r.userIds=t.toString()),r.width=e.width,r.height=e.height,r.square=e.square,bizagi.util.getFeatureObject("userService.v1.enabled")?$.ajax({url:i,data:r,type:"POST",dataType:"json"}):$.read({url:i,data:r,dataType:"json"})},getShortCuts:function(e){var t={},r=this.serviceLocator.getUrl("entities-handler-getShotCuts");return void 0!==e.icon&&e.icon&&(t.icon=!0),$.read(r,t)},getSearchLists:function(){return $.read(this.serviceLocator.getUrl("my-search-getSearchLists"),{})},getIdCasesOfProcessEntities:function(e){e=e||{};var t={ids:JSON.stringify(e)};return bizagi.version.server.lessThanOrEqualsTo("11.0.0.2608")?$.read({url:this.serviceLocator.getUrl("process-handler-getIdCasesOfProcessEntities"),data:t}):$.ajax({url:this.serviceLocator.getUrl("process-handler-getIdCasesOfProcessEntities"),data:t,type:"POST"})},getQueryForm:function(e){return e=e||{},$.ajax({url:this.serviceLocator.getUrl("query-handler-getQueryForm"),data:e,type:"POST",dataType:e.dataType||"json"})},defineFilterObject:function(e,t,r){var i=e.properties,a=i.xpath.split("@")[0],o=t.find(function(e){return e.xpath==a});if(o){if("from"==i.rangeQuery)o.value=o.value||{},o.searchType="range",o.value.min=e.value;else if("to"==i.rangeQuery)o.value=o.value||{},o.searchType="range",o.value.max=e.value;else{e.properties.typeSearch=o.searchType;var s=c(e);$.extend(o,s)}i.orderType&&(o.orderType=i.orderType),r&&r(bizagi.clone(o))}else{var n=i.defaultFilter||!1;o=c(e),i.orderType&&(o.orderType=i.orderType),(void 0!==o.value||o.orderType||n)&&(t.push(o),r&&r(bizagi.clone(o)))}function c(e){var t=e.properties,r=t.typeSearch,i=e.value;if("boolean"==t.type&&("null"===i.toLowerCase()?(i=null,r="Nullable"):(i=bizagi.util.parseBoolean(i),r="exact")),"number"!=t.type&&"money"!=t.type&&"date"!=t.type||(r="exact"),"object"==typeof e.value){if(i=[],Array.isArray(e.value))for(var o=0,s=e.value.length;o<s;o++){var n=parseInt(e.value[o].id);isNaN(n)||i.push(n)}else{n=parseInt(e.value.id);isNaN(n)||i.push(n)}r="exact",i=i.length>0?i:void 0}t.rangeQuery&&"none"!==t.rangeQuery&&(i={min:e.value,max:e.value},r="range");var c={xpath:a,searchType:r=r||"approx"};return void 0!==i&&(c.value=i),c}},getPlan:function(e){var t=this.serviceLocator.getUrl("project-plan-get");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"})},getActivities:function(e){var t=this.serviceLocator.getUrl("project-plan-activities");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"})},updatePlan:function(e){var t=this.serviceLocator.getUrl("project-plan-update");return $.update({url:t.replace("{idPlan}",e.id),data:JSON.stringify(e),dataType:"json",contentType:"application/json"})},putExecutePlan:function(e){var t=this.serviceLocator.getUrl("project-plan-execute");return $.create({url:t,data:e,contentType:"application/x-www-form-urlencoded"})},deletePlan:function(e){var t=this.serviceLocator.getUrl("project-plan-delete");return $.destroy({url:t.replace("{idPlan}",e.id),data:e,contentType:"application/x-www-form-urlencoded"})},closePlan:function(e){var t=this.serviceLocator.getUrl("project-plan-close");return $.create({url:t,data:e,contentType:"application/x-www-form-urlencoded"})},getWorkitemsPlan:function(e){var t=this.serviceLocator.getUrl("project-plan-workitems");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"})},getTransitionsByPlan:function(e){var t=this.serviceLocator.getUrl("project-plan-transitions-get");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"})},editActivityPlan:function(e){var t={};e.activity?(t=e.activity).items=e.items:t=e;var r=this.serviceLocator.getUrl("project-plan-activity-edit").replace("{idPlan}",t.idPlan).replace("{id}",t.id);return $.update({url:r,data:JSON.stringify(t),dataType:"json",contentType:"application/json"})},getPlanByParent:function(e){var t=this.serviceLocator.getUrl("project-plan-get-by-parent"),r=$.Deferred();return $.when($.read({url:t,data:e,dataType:"json",contentType:"application/json"})).done(function(e){r.resolve(e)}),r.promise()},getItemsByActivity:function(e){var t=this.serviceLocator.getUrl("project-plan-activity-tasks-get");return $.read({url:t,data:e,dataType:"json",contentType:"application/json"})},getPlanParent:function(e){var t=this.serviceLocator.getUrl("project-plan-parent");return $.read({url:t,data:e,dataType:"json"})},serializeEntityData:function(e){var t=e;function r(e,t){var r={data:{},guid:t.guidEntity,timestamp:e.timestamp},i=e.columns,a=t.row;for(name in t)t.hasOwnProperty(name)&&"row"!==name.toString()&&"id"!==name.toString()&&(r[name]=t[name]);for(var o=0,s=i.length;o<s;o+=1)r.data[i[o]]=a[o];return r}t.entities=[];for(var i,a=-1;i=e.rows[++a];)for(var o,s=-1;o=e.cells[++s];)if(o.id===i.id){var n=r(o,i);t.entities.push(n);break}return t},getRecentOfflineProcesses:function(e){return e=e||{},$.read(this.serviceLocator.getUrl("process-handler-getRecentProcesses"),e).then(function(e){var t=e.processes||[],r={processes:[]};if(!bizagi.util.isObjectEmpty(t))for(var i,a=-1;i=t[++a];)i.hasOfflineForm&&r.processes.push(i);return r})}}),$.Class.extend("bizagi.workportal.services.routing",{BIZAGI_WORKPORTAL_WIDGET_START_FORM:"startForm"},{init:function(e){var t=this;e=e||{},t.params=e.params||{},t.dataService=e.dataService||{},t.modules={render:"activityform",oldRender:"oldrenderintegration",async:"async",activitySelector:"routing"},t.renderVersion=2,t.resetRouteInformation()},resetRouteInformation:function(){this.route={module:"",moduleParams:{}}},setRenderParams:function(e){this.params=this.getRenderParams(e)},getRenderParams:function(e){var t={idCase:parseInt(e.idCase||0),idWorkflow:parseInt(e.idWorkflow||0),idWorkitem:!0===e.isOfflineForm?0:e.idWorkitem||e.idWorkItem||0,idTask:parseInt(e.idTask||0),eventAsTasks:e.eventAsTasks||!1,onlyUserWorkItems:e.onlyUserWorkItems||"true",formsRenderVersion:e.formsRenderVersion||0,referrer:e.referrer||"",isComplex:void 0!==e.isComplex,formsRenderVersion:2,onClose:e.onClose||"",isOfflineForm:e.isOfflineForm||!1,radNumber:e.radNumber||null},r=!0;try{r=BIZAGI_SETTINGS.skipSubprocessGlobalForm||!0}catch(e){}return this.skipSubprocessGlobalForm="true"==r,t},getRoute:function(e){var t=this,r=new $.Deferred;t.params=e||t.params;var i=e.fromTask||e.idTask||"",a=e.fromWorkItemId||e.idWorkitem||e.idWorkItem||"";return $.when(t.getRenderVersion(t.params)).done(function(e){t.renderVersion=e,t.route.moduleParams=t.getRenderParams(t.params),$.when(t.dataService.getWorkitems({idCase:t.params.idCase,onlyUserWorkItems:t.params.onlyUserWorkItems,isOfflineForm:t.params.isOfflineForm,fromTask:i,fromWorkItemId:a})).done(function(i){var a=i.workItems.length;if(t.route.moduleParams.hasWorkItems=!!a,t.route.moduleParams.isEvent=t.params.isEvent||!1,t.route.moduleParams.hasGlobalForm=bizagi.util.parseBoolean(i.hasGlobalForm),t.route.moduleParams.idWorkitem>0){if(t.setRenderModuleName(t.getRenderModuleName(e)),0===t.route.moduleParams.idTask&&(t.route.moduleParams.idTask=t.searchIdTask(t.route.moduleParams.idWorkitem)),t.route.moduleParams.radNumber=i.radNumber||"",t.route.moduleParams.idWorkflow=i.idWorkFlow||"",!t.route.moduleParams.displayName&&!t.params.displayName){var o=i.workItems.find(function(e){return Number(e.idWorkItem)===Number(t.route.moduleParams.idWorkitem)});void 0!==o&&o.displayName&&(t.route.moduleParams.displayName=o.displayName)}r.resolve(t.route),t.resetRouteInformation()}else{var s=t.checkAsyncWorkItems(i);if(0===a)t.route.moduleParams.idWorkflow=i.idWorkFlow||"",t.route.moduleParams.radNumber=i.radNumber||"",""!==$.trim(i.msgTask)?r.resolve(t.routeToMessageForm(i.msgTask)):bizagi.util.parseBoolean(i.hasGlobalForm)?(t.route.moduleParams.displayName=null,r.resolve(t.routeToGlobalForm(i))):r.resolve(t.routeToGlobalFormWithoutData());else if(1===a||s.length>0){var n=0;if(s.length>0)for(var c=0;c<a;c++)if("true"==i.workItems[c].isAsynch){n=c;break}t.route.moduleParams.idCase=i.workItems[n].idCase,t.route.moduleParams.idTask=i.workItems[n].idTask,t.route.moduleParams.fromTask=i.workItems[n].idTask,t.route.moduleParams.idWorkitem=i.workItems[n].idWorkItem,t.route.moduleParams.idWorkflow=i.workItems[n].idWorkFlow,t.route.moduleParams.displayName=i.workItems[n].displayName?i.workItems[n].displayName:"",t.route.moduleParams.radNumber=i.radNumber||"",s.length>0?t.setRenderModuleName(t.modules.async):t.setRenderModuleName(t.getRenderModuleName(e)),r.resolve(t.route),t.resetRouteInformation()}else i.checkProcess=!!(i.subProcesses.length>0&&t.skipSubprocessGlobalForm),i.checkWorkItems=a>1,i.fromSearchWidget="search"==t.params.referrer,t.setRenderModuleName(t.modules.activitySelector),t.route.moduleParams.data=i,r.resolve(t.route),t.resetRouteInformation()}}).fail(function(e){var i=bizagi.localization.getResource("workportal-menu-search-found-no-cases");r.resolve(t.routeToMessageForm(i))})}).fail(function(e,t,i){r.reject()}),r.promise()},setRenderModuleName:function(e){this.route.module=e,this.route.moduleParams.widgetName=e},getRenderModuleName:function(e){return 1==e?this.modules.oldRender:this.modules.render},searchIdTask:function(e,t){for(var r=0,i=0,a=(e=e||[]).length;i<a;i++)if(parseInt(e[i].idWorkItem)==parseInt(t)){r=parseInt(e[i].idTask);break}return r},checkAsyncWorkItems:function(e){var t=[];return $.each(e.workItems,function(r){"true"==e.workItems[r].isAsynch&&t.push({idCase:e.idCase,idWorkitem:e.workItems[r].idWorkItem,idTask:e.workItems[r].idTask})}),t},routeToGlobalForm:function(e){var t=this;if(t.route.moduleParams.idCase=$.isNumeric(e.idCaseForGlobalForm)&&e.idCaseForGlobalForm>0?e.idCaseForGlobalForm:t.route.moduleParams.idCase,t.route.moduleParams.idWorkflow=parseInt(e.idWorkFlow||0),1==t.renderVersion){var r=printf(t.dataService.serviceLocator.getUrl("old-render")+"?PostBack=1&idCase=%s&idWorkitem=%s&idTask=%s",t.route.moduleParams.idCase||"",t.route.moduleParams.idWorkitem||"",t.route.moduleParams.idTask||"");t.route.moduleParams.onlyUserWorkItems=t.route.moduleParams.idCase||"",t.setRenderModuleName(t.modules.oldRender),t.route.moduleParams.url=r}else t.setRenderModuleName(t.modules.render);return t.route},routeToGlobalFormWithoutData:function(){return this.setRenderModuleName(this.modules.render),this.route.moduleParams.withOutGlobalForm=!0,this.route},routeToMessageForm:function(e){var t=this;return e=e||"",t.setRenderModuleName(t.modules.render),t.route.moduleParams.withOutGlobalForm=!0,t.route.moduleParams.messageForm=e,t.route},getRenderVersion:function(e){var t=new $.Deferred,r=e.formsRenderVersion||0;return 0!=r?t.resolve(r):$.when(this.dataService.getCaseFormsRenderVersion({idCase:e.idCase})).done(function(e){r=parseInt(e.formsRenderVersion),t.resolve(r)}).fail(function(e,r,i){t.reject()}),t.promise()}}),$.Class.extend("bizagi.workportal.device.factory",{},{init:function(e){this.device=bizagi.util.detectDevice(),this.workportal=e,this.cachedFacade=null},getWorkportalFacade:function(e,t){var r=this,i=new $.Deferred;if(t=void 0===t||t,null!=r.cachedFacade)i.resolve(r.cachedFacade);else{if("desktop"==this.device)return r.cachedFacade=new bizagi.workportal.desktop.facade(this.workportal,e),$.when(r.cachedFacade.initAsyncStuff(t)).done(function(){i.resolve(r.cachedFacade)}),i.promise();if(bizagi.util.isTabletDevice())return r.cachedFacade=new bizagi.workportal.tablet.facade(e,this.device),$.when(r.cachedFacade.initAsyncStuff()).done(function(){i.resolve(r.cachedFacade)}),i.promise();if(bizagi.util.isSmartphoneDevice())return r.cachedFacade=new bizagi.workportal.smartphone.facade(e,this.device),$.when(r.cachedFacade.initAsyncStuff()).done(function(){i.resolve(r.cachedFacade)}),i.promise();bizagi.showMessageBox("Not supported device: "+this.device,"Error"),i.resolve("")}return i.promise()},getDataService:function(){return this.dataService}}),-1!=location.href.indexOf("#")&&(document.location="index.html"),bizagi.workportal=bizagi.workportal||{},bizagi.workportal.currentInboxView="inbox",bizagi.workportal.state=bizagi.workportal.state||{},bizagi.webparts=bizagi.webparts||{},bizagi.webparts.instances=bizagi.webparts.instances||[],$.Class.extend("bizagi.workportal.facade",{},{init:function(e){if(this.deviceFactory=new bizagi.workportal.device.factory(this),this.dataService=new bizagi.workportal.services.service(e),this.dataService.routing=new bizagi.workportal.services.routing({dataService:this.dataService}),!bizagi.util.isEmpty(window.location.search)){var t=bizagi.util.getQueryString();t.idCase&&(e.idCase=t.idCase,this.isConfiguredFromHash=!0),t.idWorkitem&&(e.idWorkitem=t.idWorkitem)}this.defaultParams=e||{}},createWebpart:function(e){return this.executeWebpart($.extend(e,{creating:!0}))},executeWebpart:function(e){var t=this.ownerDocument,r=($("body",t),e.canvas),i=!0;if(e.webpartConfiguration&&(i=this.testWebpartConfiguration(e)),i)return this.processWebpart(e).then(function(e){return e.name=e.webpart.Class.fullName,bizagi.webparts.instances.push(e),r.append(e.content),r.triggerHandler("ondomincluded"),e})},ready:function(){return this.executionDeferred.promise()},processWebpart:function(e){var t,r=new $.Deferred,i=this.deviceFactory.getWorkportalFacade(this.dataService,!1);return $.extend(e,this.defaultParams),$.when(i).then(function(t){var r=new $.Deferred;return $.when(t.loadWebpart(e)).done(function(){r.resolve(t)}),r.promise()}).then(function(r){return(t=r.getWebpart(e.webpart,e)).render(e)}).then(function(e){r.resolve({webpart:t,content:e})}).fail(function(e){r.reject(e)}),r.promise()},getMainController:function(){return this.mainController},execute:function(){var e=this,t=arguments,r=this.deviceFactory.getWorkportalFacade(e.dataService);return e.processOfflineData(),bizagi.loading.start(),$.when(r).then(function(e){return e.executeWebparts(t)}).then(function(){if(!bizagi.util.isEmpty(e.defaultParams.idCase)&&e.isConfiguredFromHash){var t={action:"routing",idCase:e.defaultParams.idCase};e.defaultParams.idWorkitem&&(t.idWorkitem=e.defaultParams.idWorkitem);var r=$("#homePortal").data("kendoMobileSplitView");r&&r.element&&r.element.hide(),bizagi.webpart.publish("executeRoutingAction",t)}else(!bizagi.util.isNativePluginSupported()||bizagi.util.isNativePluginSupported()&&bizagi.util.isiOSTabletDevice())&&bizagi.kendoMobileApplication.navigate("#homePortal");bizagi.loading.stop()})},processOfflineData:function(){var e=this;void 0!==e.dataService.fetchOfflineData&&!0===e.dataService.online&&$.when(e.dataService.pushOfflineData()).always(function(){e.dataService.fetchOfflineData()})}}),$.Class.extend("bizagi.workportal.smartphone.facade",{render_module:"renderingflat",setup:function(){this.render_module=bizagi.override.enableMSF?"rendering":"renderingflat"},getWidgetImplementation:function(e){bizagi.log("getWidgetImplementation"+e)}},{init:function(e,t){var r=this;r.templates={},r.dataService=e,r.setMobileMetaTags(),r.modules={},r.device=t,r.homePortalFramework=new bizagi.workportal.homeportalFramework(this),bizagi.override.enableMSF?bizagi.hasOwnProperty("kendo")?r.templateService=new bizagi.kendo.templates.services.service(bizagi.localization):r.templateService=new bizagi.templates.services.service(bizagi.localization):r.templateService=bizagi.templateService},setMobileMetaTags:function(){$("<meta>",{name:"apple-mobile-web-app-capable",content:"yes"}).appendTo("head"),$("<meta>",{name:"viewport",content:"width=device-width, initial-scale=1.0, minimum-scale=1, maximum-scale=1, user-scalable=no"}).appendTo("head"),$("<link>",{rel:"apple-touch-icon-precomposed",href:"jquery/common/base/css/smartphone/images/BizAgi_logo.png"}).appendTo("head"),$("<link>",{rel:"apple-touch-startup-image",href:"jquery/common/base/css/smartphone/images/splash.png"}).appendTo("head")},initAsyncStuff:function(){var e=this;return $.when(e.loadTemplate("base",bizagi.getTemplate("base.workportal.smartphone"))).done(function(){$("body").append(e.getTemplate("base")),bizagi.util.smartphone.startkendo({init:function(){kendo.UserEvents.defaultThreshold("android"===kendo.support.mobileOS.device?0:20)}})})},loadTemplate:function(e,t){var r=this;return r.templateService.getTemplate(t,e).done(function(t){"string"==typeof t&&(r.templates[e]=$.trim(t.replace(/\n/g,"")))})},loadTemplateWebpart:function(e,t){var r=this;return r.templateService.getTemplateWebpart(t,e).done(function(t){r.templates[e]=$.trim(t.replace(/\n/g,""))})},getTemplate:function(e){return this.templates[e]},loadWebpart:function(e){var t=this,r=new $.Deferred,i=e.webpart,a=bizagi.getWebpart(i,e);return a||bizagi.log("webpart not found"),"release"===bizagi.loader.environment?r.resolve(a):$.when(bizagi.util.initWebpart(a,t.device)).done(function(){$.when.apply(this,$.map(a.tmpl,function(e){return t.loadTemplateWebpart(e.originalAlias,bizagi.getTemplate(e.alias,!0))})).done(function(){r.resolve(a)})}),r.promise()},getWebpart:function(webpartImplementation,params){try{var dynamicFunction;-1===webpartImplementation.indexOf("bizagi")&&(webpartImplementation="bizagi.workportal.webparts."+webpartImplementation);var stringBuilder=["var baDynamicFn = function(facade, dataService, params){ \r\n"];return stringBuilder.push("return new "+webpartImplementation+"(facade, dataService, params);\r\n"),stringBuilder.push("}\r\n"),stringBuilder.push("baDynamicFn"),dynamicFunction=eval(stringBuilder.join("\n")),dynamicFunction(this,this.dataService,params)}catch(e){bizagi.log(e)}},executeWebpart:function(e){var t=this,r=new $.Deferred;return $.when(t.loadWebpart(e)).done(function(i){var a=i.class,o=t.getWebpart(a,e);$.when(o.render($.extend(e,{creating:!1}))).done(function(){e.canvas.triggerHandler("ondomincluded"),r.resolve(o)})}),r.promise()},executeWebparts:function(){var e=this,t=["homePortal","render","menu","newcase","summaryCase"];return e.loadModule(e.Class.render_module),t=arguments.length>0&&arguments[0].length>0&&arguments[0][0].executeParams?arguments[0][0].executeParams:t,$.when(e.dataService.getCurrentUser()).then(function(r){var i;r.userProperties={};for(var a=-1;i=r.sUserProperties[++a];)r.userProperties[i.key]=i.value;bizagi.currentUser=r;var o=r.userProperties.userstartpage=r.userProperties.userstartpage||"";e.sortMenuItemsByStartPage(o,r);var s,n=-1,c=[];return $.when(e.loadReleaseTemplates()).then(function(){for(;s=t[++n];){var r=e.executeWebpart({webpart:s,canvas:$("body")});c.push(r)}return $.when.apply($,c)})}).fail(function(){$.when(e.dataService.logoutMobile()).always(function(){e.defaultLogout()})}).then(function(){bizagi.log("Finalizo ejecucion de webparts"),window.addEventListener("orientationchange",function(){bizagi.util.isIphoneHigherIOS5()&&$("body").removeAttr("style")},!1)})},loadReleaseTemplates:function(){if("release"!==bizagi.loader.environment)return!0;var self=this,defer=new $.Deferred,prefix=bizagi.loader.useAbsolutePath?bizagi.loader.basePath+bizagi.loader.getLocationPrefix():""+bizagi.loader.getLocationPrefix(),url=prefix+"jquery/workportalflat/production/"+this.device.replace(/[^a-z0-9]+/gi,"")+"/webpart."+this.device.replace(/[^a-z0-9]+/gi,"")+".production.tmpl.html?build="+bizagi.loader.build;return steal.then({src:url,id:url,type:"text",waits:!1,onError:function(e){bizagi.log("Could not load file "+e.src,e,"error"),defer.reject(e)}}).then(function(){var data=steal.resources[url].options.text;self.templates=eval("("+data+")"),Object.keys(self.templates).map(function(e){self.templates[e]=self.templateService.localization.translate(self.templates[e])}),defer.resolve()}),defer.promise()},sortMenuItemsByStartPage:function(e,t){var r=this;("1"===e||"2"===e)&&void 0!==t.associatedStakeholders&&t.associatedStakeholders.length>0?r.homePortalFramework.homePortalLayout=$.extend(r.homePortalFramework.homePortalLayoutDashboard,r.homePortalFramework.homePortalLayoutTaskFeed,r.homePortalFramework.homePortalLayoutComplement):r.homePortalFramework.homePortalLayout=$.extend(r.homePortalFramework.homePortalLayoutTaskFeed,r.homePortalFramework.homePortalLayoutDashboard,r.homePortalFramework.homePortalLayoutComplement)},loadModule:function(e){var t=this;if("string"==typeof e)return void 0!==t.modules[e]?t.modules[e]:(t.modules[e]=new $.Deferred,bizagi.loader.start(e).then(function(){t.modules[e].resolve()}),t.modules[e].promise())},defaultLogout:function(){bizagi.util.isCordovaSupported()?window.location=bizagi.services.ajax.logoutPage:window.location.replace("")}}),bizagi="undefined"!=typeof bizagi?bizagi:{},bizagi.webparts=void 0!==bizagi.webparts?bizagi.webparts:{},$.Class.extend("bizagi.workportal.webpart.helper",{},{init:function(e){this.dataService=e.dataService,this.resources=e.resources,this.workportalFacade=e.workportalFacade,this.templates={}},getFileImage:function(e){return e&&0!=e.length?e:this.getEmptyFile()},getFile:function(e){return e&&0!=e.length?this.dataService.getFile(e[0]):this.getEmptyFile()},loadTemplate:function(e,t){var r=this;return r.workportalFacade.templateService.getTemplate(t).done(function(t){r.templates[e]=t})},isWebpartInIFrame:function(){try{return window.self!==window.top}catch(e){return!0}},getFailServerErrorDeferred:function(e,t,r){}}),bizagi="undefined"!=typeof bizagi?bizagi:{},bizagi.webpart=void 0!==bizagi.webpart?bizagi.webpart:{},bizagi.webpart.subscribe=function(e,t){$(document).bind(e,t)},bizagi.webpart.publish=function(e,t){return $(document).triggerHandler(e,t)},bizagi.webpart.whenCreated=function(e,t){bizagi.webpart.subscribe("bizagi-webpart-created",function(r){r.webpart.Class.fullname=="bizagi.workportal.webparts."+e&&t&&t(r)})},bizagi.webpart.whenExecuted=function(e,t){bizagi.webpart.subscribe("bizagi-webpart-executed",function(r){r.webpart.Class.fullname=="bizagi.workportal.webparts."+e&&t&&t(r)})},bizagi.workportal.controllers.controller.extend("bizagi.workportal.webparts.webpart",{BIZAGI_WORKPORTAL_WEBPART_ROUTING:"routing",BIZAGI_WORKPORTAL_WEBPART_RENDER:"activityform",BIZAGI_WORKPORTAL_WEBPART_ASYNC:"async",BIZAGI_WORKPORTAL_WEBPART_OLDRENDERINTEGRATION:"oldrenderintegration"},{init:function(workportalFacade,dataService,params){var self=this;this._super(workportalFacade,dataService,params),this.helper=new bizagi.workportal.webpart.helper(this),this.canvas=params.canvas,this.pane=params.pane,this.project=params.project,this.sharepointProxyPrefix=params.sharepointProxyPrefix,this.homePortalFramework=this.workportalFacade.homePortalFramework,this.namespace=params.namespace,this.isVisible=!0,this.isWebpartInIFrame=void 0!==params.isWebpartInIFrame?params.isWebpartInIFrame:self.helper.isWebpartInIFrame(),this.adjustButtonsToContent=params.adjustButtonsToContent,this.remoteServer=params.remoteServer,this.remoteServer&&(self.postmessageSocket=new bizagi.postmessage({remoteServer:this.remoteServer,destination:window.parent,origin:window}),self.postmessageSocket.receive=function(msg){var params=eval("("+msg.data+")");if((!params.parameters||params.parameters.iframeidentifier!=BIZAGI_IFRAME_IDENTIFIER)&&params.postMessageEventName)switch(params.postMessageEventName){case"postmessage-bizagi-canCloseIFramePopUp":self.canHide&&self.Class.shortName==params.webPartDestine&&$.when(self.canHide()).done(function(){var e={postMessageEventName:"postmessage-bizagi-closeIFramePopUp",parameters:{}};e.parameters.iframeidentifier=BIZAGI_IFRAME_IDENTIFIER,self.postmessageSocket.send(JSON.stringify(e));var t={postMessageEventName:"ui-bizagi-reload-cases"};self.postmessageSocket.send(JSON.stringify(t))});break;case"postmessage-bizagi-openParentPopUp":break;default:self.publish(params.postMessageEventName,params.parameters,!0)}},self.sendDimensionsiFrame())},sendDimensionsiFrame:function(e){var t=this;this.remoteServer&&(t.adjustButtonsToContent||t.namespace&&!e||t.isWebpartInIFrame&&window.setTimeout(function(){var e={};e.iframeName=BIZAGI_IFRAME_IDENTIFIER,e.iframeHeight=$("body").height(),"newcaselist"==t.Class.shortName?e.iframeWidth=$(document).width():e.iframeWidth=void 0,t.postmessageSocket.send(JSON.stringify(e))},50))},publish:function(e,t,r){if(e=this.namespace?this.namespace+"."+e:e,!r&&-1==e.indexOf("bizagi-webpart-created")&&-1==e.indexOf("bizagi-webpart-executed")&&this.postmessageSocket){var i={};i.postMessageEventName=e,t&&(t.canvas=null,t.workportal=null),i.parameters=$.extend(t,{project:this.project,iframeidentifier:BIZAGI_IFRAME_IDENTIFIER}),this.postmessageSocket.send(JSON.stringify(i))}return this._super(e,$.extend(t,{project:this.project}))},subscribe:function(e,t){var r=this;e=this.namespace?this.namespace+"."+e:e,this._super(e,function(e,i){if(void 0===i&&(i={}),r.project==i.project&&r.isVisible)return t(e,i)})},unsubscribe:function(e,t){e=this.namespace?this.namespace+"."+e:e,this._super(e,t)},refresh:function(e){var t,r=this;return(t="view"==r.canvas.data("role")?r.canvas.data("kendoMobileView").contentElement():r.canvas).empty(),r.render(e).then(function(e){return t.append(e),r.canvas.triggerHandler("ondomincluded"),"included"})},render:function(e){var t=this;return t.params=e,e.creating?(t.content=t.empty(),t.publish("bizagi-webpart-created",{webpart:t}),t.content):(t.publish("bizagi-webpart-created",{webpart:t}),$.when(t.renderContent(e)).pipe(function(r){return"string"==typeof r&&(r=$(r)),t.content=r,e.canvas.append(r),$.when(t.postRender(e)).then(function(){return t.publish("bizagi-webpart-executed",{webpart:t}),t.sendDimensionsiFrame(),t.getContent()})}))},renderContent:function(e){},postRender:function(e){},getContent:function(){return this.content},empty:function(){return $("<div/>")},getTemplate:function(e){return this.workportalFacade.getTemplate(e)},createWebpart:function(e){return this.workportalFacade.workportal.createWebpart(e)},executeWebpart:function(e){return this.workportalFacade.workportal.executeWebpart(e)},manageError:function(e,t,r){var i=this,a="";if(-1==(a=e.responseText?e.responseText:e).indexOf("AUTHENTICATION_ERROR"))i.helper.getFailServerErrorDeferred({message:a,sharepointProxyPrefix:i.sharepointProxyPrefix},t),i.endWaiting(),r&&t.done(function(e){r.append(e),i.endWaiting()});else{var o=i.content="<div class='ui-bizagi-webpart-error-message'>The current user does not exist as a registered user in the bizagi project</div>";r&&r.append(o),i.endWaiting(),t.resolve(o)}},hide:function(e){this.canvas.hide(),e&&this.canvas.parent().hide(),this.isVisible=!1},show:function(){this.canvas.show(),this.canvas.parent().show(),this.isVisible=!0},isVisible:function(){return this.isVisible},destroy:function(){},getHomeportalFrameworkIntance:function(){return this.workportalFacade.homePortalFramework||(this.workportalFacade.homePortalFramework=new bizagi.workportal.homeportalFramework(this.workportalFacade)),this.workportalFacade.homePortalFramework}}),bizagi.workportal.webparts.webpart.extend("bizagi.workportal.webparts.rendermanager",{},{init:function(e,t,r){this._super(e,t,r),r&&void 0!==r.navigator||console.error("it is a render webpart and there is no navigator to this webpart"),this.navigator=r.navigator}}),bizagi="undefined"!=typeof bizagi?bizagi:{},bizagi.webparts=void 0!==bizagi.webparts?bizagi.webparts:{},$.Class.extend("bizagi.workportal.homeportalFramework",{},{init:function(e){var t=this;t.workportalFacade=e,t.device=bizagi.detectDevice(),t.accumulatedContext=[],t.navigateFromRender=!1,t._homeportalShow(),t.configureHandler(),bizagi.util.mobility.homePortalNavigate=$.proxy(t.homePortalNavigate,t),bizagi.util.mobility.homePortalViewShown=$.proxy(t.homePortalViewShown,t),bizagi.util.mobility.homePortalViewInit=$.proxy(t.homePortalViewInit,t),bizagi.util.mobility.homePortalViewHide=$.proxy(t.homePortalViewHide,t),bizagi.util.mobility.drawerBeforeShow=$.proxy(t.drawerBeforeShow,t)},loadComponents:function(e,t){var r=this,i=[];return $.each(r.homePortalLayout,function(a,o){if(Array.isArray(o.position))$.each(o.position,function(s,n){if(n===e){var c=$("#"+o.canvas[s],t),l=r.workportalFacade.executeWebpart({webpart:a,canvas:c,pane:c.parent('div[data-role="pane"]')});i.push(l)}});else if("drawer"!==o.type&&o.position===e){var s=$("#"+o.canvas,t),n=r.workportalFacade.executeWebpart({webpart:a,canvas:s,pane:s.parent('div[data-role="pane"]')});i.push(n)}else if("drawer"===o.type&&o.position===e){s=$("#"+o.canvas,"body"),n=r.workportalFacade.executeWebpart({webpart:a,canvas:s});i.push(n)}}),$.when(i)},loadComponentTemplate:function(e,t,r){var i=this,a=kendo.template(i.workportalFacade.getTemplate(e),{useWithBlock:!1}),o=[];for(var s in i.homePortalLayout){var n=i.homePortalLayout[s];Array.isArray(n.position)?$.each(n.position,function(e,r){r===t&&o.push({canvas:i.homePortalLayout[s].canvas[e]})}):"drawer"!==n.type&&n.position===t&&o.push(n),"drawer"===n.type&&s===t&&$.extend(r,{canvas:n.canvas,direction:n.direction})}return a($.extend(r,{homePortalLayoutPositions:o}))},_homeportalShow:function(){var e=this;bizagi.webpart.subscribe("homeportalShow",function(t,r){r.params=r.params||{};var i="",a=!1,o=!1;switch(r.what){case"reportsChart":i="reportsChart",a=!1;break;case"stuffTemplates":i="renderTemplates",r.params.data&&r.params.data.navigateFromRender&&(e.setContextFromRender(r),e.navigateFromRender=o=r.params.data.navigateFromRender);break;case"favorites":case"pendings":case"ontime":case"overdue":case"risk":i="caseTemplates";break;case"startForm":r.transition="overlay:up",i=r.what;break;case"newCase":case"menu":case"render":a=!0;break;case"activitiesOptions":r.what="caseTemplatesOptions",a=!0;break;default:i=r.what}if(a)e.showDrawer(r.what);else{e.closeDrawers();var s=e.homePortalLayout[i].canvas,n=$("#"+s);if("none"===n.css("display")||"#renderTemplates"===n.selector){var c=n.parent().data("kendoMobilePane");r.preventNavigate||(o?e.navigateToRenderTemplates():c.navigate(s,r.transition||"")),r.title&&$.each(c.view().header,function(e,t){$(".km-navbar",t).data("kendoMobileNavBar").title(r.title)})}}bizagi.webpart.publish("homeportalShow-"+r.what,r.params)})},configureHandler:function(){var e=this;bizagi.webpart.subscribe("homeportalBack",function(t,r){e._back()}),bizagi.webpart.subscribe("homeportalShowNotification",function(e,t){$.notifier.add({text:t.message})})},showDrawer:function(e){"newCase"===e?$("#newCase-drawer").data("kendoMobileDrawer").show():"menu"===e?$("#menu-drawer").data("kendoMobileDrawer").show():"caseTemplatesOptions"===e?$("#caseTemplatesOptions").data("kendoMobileDrawer").show():$("#bz-render-drawer").length>0&&$("#bz-render-drawer").data("kendoMobileDrawer").show()},_cleanContext:function(){void 0!==this.accumulatedContext&&(this.accumulatedContext=[]),this.navigateFromRender=!1},getActionsContext:function(){var e={},t=this.accumulatedContext;return t.length>0?e.context=$.map(t,function(e){var t={entityGuid:e.entityGuid?e.entityGuid:e.guidEntityCurrent};return null!==e.surrogateKeyToMapping?t.surrogateKey="object"==typeof e.surrogateKeyToMapping?e.surrogateKeyToMapping:[e.surrogateKeyToMapping]:t.surrogateKey="",t}).filter(function(e){return""!==e.surrogateKey}):e.context=[],e},addContext:function(e){return this.accumulatedContext.push(e),{context:this.accumulatedContext}},extendCurrentContext:function(e){$.extend(this.accumulatedContext[this.accumulatedContext.length-1],e)},popContext:function(){return this.accumulatedContext.pop(),{context:this.accumulatedContext}},setContextFromRender:function(e){e=e.params||{},this.addContext($.extend(e.data,{entityType:"actionLauncher"}))},homePortalViewInit:function(e){e.view.element.trigger("view-initialized",e.view)},homePortalViewHide:function(e){e.view.element.trigger("view-hidden",e.view)},homePortalViewShown:function(e){e.view.element.trigger("view-showed",e.view)}}),bizagi="undefined"!=typeof bizagi?bizagi:{},bizagi.webparts=void 0!==bizagi.webparts?bizagi.webparts:{},bizagi.workportal.homeportalFramework.extend("bizagi.workportal.homeportalFramework",{},{init:function(e){var t=this;t._super(e),t.deviceType="smartphone",t.homePortalLayoutDashboard={menuHome:{position:"homePortal",direction:"left",type:"view",canvas:"menuHome",title:"",elastic:"false",layout:"main-default"}},t.homePortalLayoutTaskFeed={taskFeed:{position:"homePortal",direction:"left",canvas:"taskFeed",type:"view",title:"",layout:"activity-feed"}},t.homePortalLayoutComplement={loadForm:{position:"homePortal",direction:"right",type:"view",canvas:"loadForm",title:"Search Form",layout:"main-default-close-action"},renderTemplates:{position:"homePortal",direction:"right",type:"view",canvas:"renderTemplates",title:"Entities",layout:"main-double-header"},caseTemplates:{position:"homePortal",direction:"right",type:"view",canvas:"caseTemplates",title:"Cases",layout:"main-double-header-cases"},caseTemplatesOptions:{position:"homePortal",direction:"right",type:"drawer",canvas:"caseTemplatesOptions",title:""},stakeHolder:{position:"homePortal",canvas:"menuHome"},stuff:{position:"menuHome",canvas:"stuff"},shortCut:{position:"menuHome",canvas:"shortCut"},dashBoard:{position:"menuHome",canvas:"dashBoard"},searchesList:{position:"shortCut",canvas:"searchesList"}}},_back:function(e){this.container.data("kendoMobilePane").navigate("#:back",e||"")},_backRenderTemplates:function(e){var t=this;if(t.accumulatedContext.length>1){var r=t.accumulatedContext[t.accumulatedContext.length-1],i=t.popContext().context;if(r.navigateFromRender)bizagi.kendoMobileApplication.navigate("renderSplitView"),t.navigateFromRender=!1;else{var a=i[i.length-1],o={data:a,calculateFilters:a.calculateFilters||!1,filters:[],eventType:"DATA-NAVIGATION"};bizagi.webpart.publish("homeportalShow",{what:"stuffTemplates",title:o.data.displayName,params:o,preventNavigate:!0})}}else t.navigateFromRender&&(bizagi.kendoMobileApplication.navigate("renderSplitView"),t.navigateFromRender=!1);t._back(e)},configureHandler:function(){this._super()},navigateToRenderTemplates:function(e){$("#homeportal-pane").data("kendoMobilePane").navigate("renderTemplates"),bizagi.kendoMobileApplication.navigate("homePortal")},homePortalNavigate:function(e){e.url,e.sender.element},homePortalViewShown:function(e){var t=this;switch(t.destination=e.view.id.replace(/#/i,""),t.content=e.view.element,t.container=e.view.container,t.destination){case"dashBoard":$(".km-view-title",t.content).children().text("Stuff"),$(".btn-back",t.content).unbind("click").bind("click",function(){t._back("fade")}),$("#bz-workarea-newcase",t.content).unbind("click").bind("click",function(){t.showDrawer("newCase")});break;case"taskFeed":$(".bz-login-user",t.content).unbind("click").bind("click",function(){t.showDrawer("menu")}),$("#bz-workarea-newcase",t.content).unbind("click").bind("click",function(){t.showDrawer("newCase")});break;case"renderTemplates":$(".btn-back",t.content).unbind("click").bind("click",function(){t._backRenderTemplates()}),$("#bz-workarea-newdata",t.content).unbind("click").bind("click",function(){bizagi.webpart.publish("newData")});break;case"discussionCase":$(".btn-back",t.content).unbind("click").bind("click",function(){t._back()}),$("#bz-workarea-newcase",t.content).unbind("click").bind("click",function(){t.showDrawer("newCase")});break;case"caseTemplates":$(".btn-back",t.content).unbind("click").bind("click",function(){t._back()}),$("#bz-workarea-caseTemplatesOptions",t.content).unbind("click").bind("click",function(){t.showDrawer("caseTemplatesOptions")})}},drawerBeforeShow:function(e){var t=e.view.element.attr("id");"newCase-drawer"===t&&("caseTemplates"!==this.destination&&"renderTemplates"!==this.destination||e.preventDefault()),"caseTemplatesOptions"===t&&"renderTemplates"===this.destination&&e.preventDefault()},displayNotification:function(e){var t=this.container.data("kendoMobilePane");void 0===bizagi.templates.services.service.cachedTemplates["wp-notification"]?$.when(this.workportalFacade.loadTemplate("wp-notification",bizagi.getTemplate("base.workportal.smartphone.notification"))).done(function(){bizagi.util.mobility.showNotification(e,t.view().element)}):bizagi.util.mobility.showNotification(e,t.view().element)},closeDrawers:function(){$("#menu-drawer").data("kendoMobileDrawer").hide(),$("#newCase-drawer").data("kendoMobileDrawer").hide(),$("#caseTemplatesOptions").data("kendoMobileDrawer").hide()}}),$.Class("bizagi.workportal.command.search",{SEARCH_PAGE_SIZE:30,SEARCH_DELAY:700},{init:function(e){this.isTabletDevice=bizagi.util.isTabletDevice(),this.enableOfflineForm=bizagi.util.hasOfflineFormsEnabled(),this.dataService=e},searchList:function(e){(e=e||{}).inputtray=bizagi.util.inputTray(this.dataService.online);var t={radNumber:$.trim(e.query),idWorkflow:"",taskState:"all",onlyFavorites:!1,order:"",numberOfFields:2,orderFieldName:"",orderType:"0",page:e.page||1,pageSize:this.Class.SEARCH_PAGE_SIZE,inputtray:e.inputtray?e.inputtray:"inbox"};return bizagi.util.isQuickSearchEnabled()?this.loadDataListBeta(t):this.loadDataList(t)},loadDataList:function(e){var t=this;return t.dataService.getCasesByWorkflow(e).done(function(e){e.elements=[];var r=[];0===e.totalPages&&r.push({noResults:!0,message:bizagi.localization.getResource("workportal-menu-search-found-no-cases")});for(var i=0,a=e.rows.length;a>i;i++){var o=e.rows[i].fields,s=e.rows[i].radnumber||e.rows[i].id,n={},c=o[o.length-1],l={};if(n.radNumber=s,"string"!=typeof c.Value)for(var d=0,u=c.Value.length;d<u;d++){var p=c.Value[d];if(""!==p&&"string"==typeof p){l.solutionDate=p;break}}else l.solutionDate=c.Value;l.solutionDate=bizagi.util.getTaskStatus(l.solutionDate);for(var g=0;g<o.length;g++)if("Process"===o[g].DisplayName){l.processName=o[g].Value;break}if(l.processName||(l.processName=o[0].Value),void 0!==e.rows[i].workitems)for(var m=e.rows[i].workitems,f=0;m.length>f;f++){n[0]=e.rows[i].id,n[1]=m[f].idWorkItem,n[2]=m[f].idTask,n.state=m[f].State.toLowerCase()||"gray",n[5]=m[f].TaskName||bizagi.localization.getResource("webpart-cases-summary-without-name"),n[6]=[],n[6][0]=[],n[6][0]=[0,e.rows[i].id],n[4]=l.processName,n[3]=l.solutionDate,t.isTabletDevice&&e.rows[i].isOfflineForm&&(n[7]=e.rows[i].isOfflineForm,n[8]=e.rows[i].isOpen);var h=$.extend(!0,{},n);r.push(h)}else{if(n[0]=e.rows[i].id,n[1]=n[2]=0,n[5]=bizagi.localization.getResource("webpart-cases-summary-without-name"),n.state="gray",n[6]=[],n[6][0]=[],n[6][0]=[0,e.rows[i].id],n[4]=l.processName,n[3]=l.solutionDate,t.isTabletDevice&&e.rows[i].isOfflineForm){var y=bizagi.getGroupedData(o[3]);n[7]=e.rows[i].isOfflineForm,n[8]=e.rows[i].isOpen,n.state=y.status}r.push(n)}}return e.elements=r,e.elements}).fail(function(e){var t={elements:[],page:1,totalPages:1};return t.elements.push({noResults:!0,message:bizagi.localization.getResource("workportal-menu-search-found-no-cases")}),t.elements})},loadDataListBeta:function(e){return this.dataService.getCasesListBeta(e).done(function(e){return 0===e.elements.length&&e.elements.push({noResults:!0,message:bizagi.localization.getResource("workportal-menu-search-found-no-cases")}),e.elements}).fail(function(e){var t={elements:[],page:1,totalPages:1};return t.elements.push({noResults:!0,message:bizagi.localization.getResource("workportal-menu-search-found-no-cases")}),t.elements})},getCaseData:function(e){var t=e.dataItem,r={};return t&&void 0===t.noResults&&(-1!==t[1]&&-1!==t[2]?(r.idCase=t[0],r.idWorkitem=bizagi.util.isNumeric(t[1])?t[1]:0,r.idTask=bizagi.util.isNumeric(t[2])?t[2]:0,r.displayName=t[5]||t[6],r.radNumber=t.radNumber,r.isOfflineForm=!0===t[7]||!1,r.formsRenderVersion=!0===t[7]?2:0):(r.idCase=t[0],r.displayName=t[4]||t[0])),r}}),$.Class.extend("bizagi.actionsEvents",{},{init:function(e,t,r){this.initialParams=r||{},this.parent=t||"Entities",this.dataService=e},getEvents:function(e){var t=this,r=$.map(e,function(e){var r=e.idCase;if(void 0!==r&&r>0)return t.dataService.getEvents({caseId:r}).then(function(t){e.events=t.map(function(e){return e.isEvent=!0,e})})});return $.when.apply($,r)},getActions:function(e){var t=this,r=$.map(e,function(e){if("Entities"===t.parent||"Cases"===t.parent&&e.surrogateKey>=0){var r={surrogateKey:e.surrogateKey,guidEntity:e.guid};return void 0!==e.idCase&&(r.caseId=e.idCase),t.dataService.getActionsData(r).then(function(r){return e.actions=r,$.when.apply($,$.map(r,function(e){if("Process"==e.type)return t.dataService.validateHasStartForm({processId:e.reference}).then(function(t){e.hasStartForm=t.startForm,e.entityId=t.entityId,e.entityName=t.entityName})}))})}});return $.when.apply($,r)},getCommomActions:function(e){for(var t,r=e||[],i=[],a=-1;t=r[++a];)i[a]=t.actions||[];return i.shift().reduce(function(e,t){return i.every(function(e){return void 0!==e.find(function(e){return e.id==t.id})})&&void 0===e.find(function(e){return e.id==t.id})&&function(e){if(void 0===e.mode||"Entity"===e.mode)return 2==e.multiplicity||"Form"!=e.type&&("Process"!=e.type||!e.hasStartForm);return!1}(t)&&e.push(t),e},[])},executeActionSingleData:function(e,t){var r=this;if("WorkOnIt"===e.type){bizagi.loading.start();var i=void 0!==e.idCase?e.idCase:t.idCase;r.executeChangeCaseEvent(i,e.idTask,e.idWorkitem,t)}else if(void 0!==e.isEvent&&e.isEvent)r.processEvent(e);else{var a=e.type,o=2===e.multiplicity;if("Rule"===a){var s={actionType:a,entityId:t.guid,isMultiInstance:o,processId:e.reference,surrogateKey:t.surrogateKey,displayName:e.displayName};r.processAction(s).then(function(e){var t=printf(bizagi.localization.getResource("workportal-widget-templateengine-action-rule-notification-singular"),s.displayName,1);"success"===e.result?(t=t+" "+printf(bizagi.localization.getResource("workportal-widget-templateengine-action-rule-success"),""),$.notifier.add({title:s.displayName,text:t,sticky:!0})):(t=t+" "+bizagi.localization.getResource("workportal-widget-templateengine-action-rule-error"),$.notifier.add({title:s.displayName,text:t,sticky:!0,class_name:"error"}));r.refreshTemplate()})}else if("Form"===a||"Process"===a){s={actionType:a,displayName:e.displayName,entityGuid:t.guid,entitySurrogateKey:t.surrogateKey,id:e.id,isMultiInstance:o,isBatch:e.isBatch||null,reference:e.reference,readonlyform:e.readonlyform,showConfirmation:e.showConfirmation};"Process"===a&&(s.entityId=e.entityId,s.entityName=e.entityName,s.hasStartForm=e.hasStartForm),void 0!==t.idCase&&(s.caseId=t.idCase),r.processAction(s)}}},executeChangeCaseEvent:function(e,t,r,i){var a=this;$.when(bizagi.webpart.publish("changeCase",{idCase:e,idTask:t,idWorkitem:r})).fail(function(e){a.showErrorMessage(i.idCase,e)}).always(function(){bizagi.loading.stop()})},executeActionMultipleData:function(e,t,r){var i=this,a=2===e.multiplicity,o=r.map(function(e){return e.surrogateKey});switch(e.type){case"Process":var s={actionType:e.type,displayName:e.displayName,entityGuid:t.guid,entityId:e.entityId,entityName:e.entityName,id:e.id,isMultiInstance:a,reference:e.reference,hasStartForm:e.hasStartForm};"Cases"===i.parent&&(s.caseId=r.map(function(e){return e.idCase})),a?(s.isBatch=!1,s.entitySurrogateKey=o,i.processAction(s)):(s.isBatch=!0,i.processBatchCreationAction(s,r));break;case"Rule":s={actionType:e.type,entityId:t.guid,isMultiInstance:a,processId:e.reference,displayName:e.displayName};if(a)s.surrogatedKey=o,i.processAction(s).then(function(e){var t=printf(bizagi.localization.getResource("workportal-widget-templateengine-action-rule-notification-singular"),s.displayName,1),r="";r="success"===e.result?printf(r=bizagi.localization.getResource("workportal-widget-templateengine-action-rule-success"),1):bizagi.localization.getResource("workportal-widget-templateengine-action-rule-error"),$.notifier.add({title:r,text:t,sticky:!0}),i.refreshTemplate()});else{s.confirmation=!1;for(var n,c=-1,l=[];n=r[++c];)s.surrogateKey=n.surrogateKey,l.push(i.processAction(s));$.when.apply($,l).then(function(){var e=printf(bizagi.localization.getResource("workportal-widget-templateengine-action-rule-notification-plural"),s.displayName,r.length);e+=printf(bizagi.localization.getResource("workportal-widget-templateengine-action-rule-success"),""),$.notifier.add({title:s.displayName,text:e,sticky:!0}),i.refreshTemplate()}).fail(function(){var e=printf(bizagi.localization.getResource("workportal-widget-templateengine-action-rule-notification-plural"),s.displayName,r.length);e+=printf(bizagi.localization.getResource("workportal-widget-templateengine-action-rule-error"),""),$.notifier.add({title:s.displayName,text:e,sticky:!0,class_name:"error"})})}}},processBatchCreationAction:function(e,t){var r,i=this,a=-1;void 0!==(r=t[++a])&&(e.itemSelected=r,function o(){$.when(i.processAction(e)).always(function(){void 0!==(r=t[++a])&&(e.itemSelected=r,o())})}())},processAddAction:function(e){var t=this,r={actionType:e.type,addAction:!0,displayName:e.displayName,entityGuid:e.guidEntity,entitySurrogateKey:null,reference:e.reference};if("Process"===e.type)r.entityId=e.guidEntity,r.entityName=e.xpathContext,r.hasStartForm=e.startForm,t.processAction(r);else if("Form"===e.type){var i={xpathContext:"",guidEntity:e.guidEntity,accumulatedContext:JSON.stringify(t.initialParams.homePortalFramework.getActionsContext())};$.when(t.dataService.getMapping(i)).then(function(e){r.mapping=e,t.processAction(r)}).fail(function(r){t.showErrorMessage(e.displayName,r)})}},processAction:function(e){var t=this,r="Entities"===t.parent?"stuffTemplates":"caseTemplates";e.confirmation=void 0===e.confirmation||e.confirmation;var i=new $.Deferred;switch(e.actionType){case"Process":var a={xpathContext:e.entityName,guidEntity:e.entityId},o=void 0!==e.itemSelected?e.itemSelected.surrogateKey:e.entitySurrogateKey;t.initialParams.homePortalFramework.extendCurrentContext({surrogateKeyToMapping:o});var s=t.initialParams.homePortalFramework.getActionsContext();a.accumulatedContext=JSON.stringify(s),$.when(t.dataService.getMapping(a)).done(function(t){var a={guidProcess:e.reference,hasStartForm:e.hasStartForm,isBatch:void 0!==e.isBatch?e.isBatch:null,isMultiInstance:e.isMultiInstance,mapping:t,notification:!0,displayName:e.displayName,type:e.actionType,origin:r};void 0!==e.caseId&&(a.idParentCase=e.caseId),$.when(bizagi.webpart.publish("createNewCase",a)).then(function(){i.resolve(a)}).fail(function(){i.reject()})}).fail(function(r){t.showErrorMessage(e.displayName,r),i.reject()});break;case"Form":bizagi.webpart.publish("render-start-form",{params:{displayName:e.displayName,entityGuid:e.entityGuid,entitySurrogateKey:e.entitySurrogateKey,formGuid:e.reference,mapping:void 0!==e.mapping?e.mapping:null,type:e.actionType,origin:r,readonlyform:e.readonlyform,showConfirmation:e.showConfirmation}}),i.resolve();break;case"Rule":e.confirmation?bizagi.showConfirmationBox(bizagi.localization.getResource("workportal-widget-templateengine-action-rule-confirmation"),"Bizagi",!0,[{label:"Ok",action:"resolve"},{label:"Cancel",action:"reject"}]).done(function(){t.executeRuleAction(e).then(function(e){i.resolve(e)}).fail(function(e){i.reject(e)})}):t.executeRuleAction(e).then(function(e){i.resolve(e)}).fail(function(e){i.reject(e)});break;default:i.resolve()}return i.promise()},showErrorMessage:function(e,t){var r=bizagi.localization.getResource("workportal-widget-sortbar-execute-error-message").replace("%s",e);$.notifier.add({title:"Error",text:r,class_name:"error",sticky:!1})},executeRuleAction:function(e){var t=e.isMultiInstance?this.dataService.executeAction:this.dataService.actionRule;return $.when(t.apply(this.dataService,[e]))},refreshTemplate:function(){var e=this.initialParams.homePortalFramework.accumulatedContext,t={calculateFilters:!0,data:e.length>0?e[e.length-1]:this.accumulatedContext,filters:[],eventType:"DATA-NAVIGATION"};bizagi.webpart.publish("homeportalShow",{what:"stuffTemplates",title:t&&t.data?t.data.displayName:"",params:t,preventNavigate:!0})},processEvent:function(e){bizagi.webpart.publish("executeRoutingAction",{idCase:e.idCase,idWorkItem:e.idWorkitem,idTask:e.idTask,idWorkflow:e.idWorkflow,isEvent:!0})}}),$.Class.extend("bizagi.caseUsers",{},{init:function(e,t,r){this.initialParams=r||{},this.parent=t||"Entities",this.dataService=e,this.userDataPromise={}},getUsers:function(e){var t=this,r=[],i=$.map(e,function(e){return t.dataService.getUsers({caseId:e.idCase}).done(function(i){e.assignees=$.map(i.assignees,function(e){return $.extend(e,{initials:t._getInitials(e.name)})}),e.createdBy=$.extend(i.createdBy,{initials:t._getInitials(i.createdBy.name)}),e.users=t._getUniqueUsers($.merge([e.createdBy],e.assignees)),e.workOnIt=t._canWorkOnIt(i.assignees);for(var a,o=-1;a=e.users[++o];){r.find(function(e){return a.idUser==e.idUser})||r.push(a)}})});return $.when.apply($,i).then(function(e){return r})},_getInitials:function(e){var t=e.split(" ");return(void 0!==t[0]?t[0].charAt(0):"")+(void 0!==t[1]?t[1].charAt(0):"")},_getUniqueUsers:function(e){for(var t,r=-1,i=[];t=e[++r];){i.find(function(e){return t.idUser==e.idUser})||i.push({idUser:t.idUser,name:t.name,initials:t.initials})}return i.length>0&&(i[0].isAssignee=!0),i},_canWorkOnIt:function(e){for(var t,r=-1,i=!1;t=e[++r];)if(t.idUser===bizagi.currentUser.idUser){i=!0;break}return i}});
//# sourceMappingURL=../../../../Maps/smartphone_android/workportalflat.smartphone.production.js.map
