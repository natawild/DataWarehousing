$.bizagi||($.bizagi={processviewer:{}}),$.bizagi.processviewer={configuration:{constants:{ELEMENT_TYPE:{PROCESS:"Process",LANE:"Lane",MILESTONES:"Milestone",TEXTANNOTATION:"TextAnnotation",ASSOCIATION:"Association",SEQUENCEFLOW:"SequenceFlow"},CONDITION_TYPE:{SUBPROCESSEXP:"SubprocessException",CANCELLATION:"Cancellation",NORMAL:"Normal",RELATION:"Relation",COMPENSATION:"Compensation"},PROPERTIES:{WAYPOINTS:"waypoints",BOUNDS:"bounds"},LANESETS:"laneSets",LANES:"lanes",BPMNLABELSTYLES:"bpmnLabelStyles"},validTypeDefinitions:["artifacts","flowElements","laneSets","milestones"]},design:{markers:{normal:{type:"path",properties:{d:"M0.616,9.401  l2.05-4.4l-2.05-4.399l8.8,4.433L0.616,9.401",class:"normal"}},highlighted:{type:"path",properties:{d:"M0.616,9.401  l2.05-4.4l-2.05-4.399l8.8,4.433L0.616,9.401",class:"highlighted"}},selected:{type:"path",properties:{d:"M0.616,9.401  l2.05-4.4l-2.05-4.399l8.8,4.433L0.616,9.401",class:"highlighted"}},association:{type:"path",properties:{d:"M0.595,0.598  l8.8,4.132l-8.8,4.667",class:"association"}}}}},function(t){t.widget("ui.processviewer",{constants:t.bizagi.processviewer.configuration.constants,options:{image:null,zoomRange:50,hotspots:[],dragMessage:"Drag Image (Image Pane)",processMessage:"Process Image....",previewWidth:120,previewHeight:120,hotspotsCSS:"",draggable:!0,controls:!0,zoomImageOptions:!1,moveIncrement:20,isIE8:!1,device:"desktop",minZoom:.5,minZoomIE8:.5,maxZoomIE8:1.5,maxZoom:1.5,template:!1,unavailableImage:"img/unavailable_image.png",tmpl:"bizagi.processviewer.template",hotSpotsSVG:!1,formatStyles:{},milestonesHeight:25,width:"100%",height:150,dimentions:{width:100,height:150},animation:{path:[],interval:0,instance:0,time:200,counter:0},configuration:{localTemplate:"",processviewerStageId:"",processviewerStage:"",$processviewerStage:"",processviewerStageSet:"",processviewerImageStage:"",processviewerHotSpotsContainer:"",processviewerStagePathsSet:"",errorImageCSS:"processviewer-error-image",sliderOptions:{}},getTemplate:function(t){return bizagi.getTemplate(t)}},_create:function(){var e=this;t.support.touch="ontouchend"in document,e._isInWorkportal()?"undefined"!=typeof bizagi&&void 0!==bizagi.util&&(e.options.isIE8=bizagi.util.isIE8(),e.options.device=bizagi.util.detectDevice()):bizagi={workportal:!1},e.$el=t('<div class="wdg-processviewer"></div>'),e.$el.attr("role","widget.bizagi.processviewer"),e.element.append(e.$el),e.options.jsonBizagi?"string"==typeof e.options.jsonBizagi.processDefinition&&"string"==typeof e.options.jsonBizagi.processDefinition?t.when(t.get(e.options.jsonBizagi.processDefinition),t.get(e.options.jsonBizagi.processGraphicsInfo)).done(function(t,i){e._processDataForPlugin({definition:t[0],graphics:i[0]})}).fail(function(t){e.$el.text(t.message)}):e._processDataForPlugin({definition:e.options.jsonBizagi.processDefinition,graphics:e.options.jsonBizagi.processGraphicsInfo}):e._loadTemplate()},_processDataForPlugin:function(e){var i=this;e.definition.status||e.graphics.status?i._triggers.error({message:e.definition.message,json:e}):t.when(t(e).processviewerQueries()).done(function(e){t.extend(i.options,e),i._loadTemplate()})},_triggerError:function(t){},_loadTemplate:function(){var e=this,i=e.options.template;bizagi.workportal?(e.loader=new bizagi.ui.controls.tmplloader,i?i.indexOf(".html")&&t.when(e.loader.loadTemplates({processviewer:i})).done(function(){e.options.configuration.localTemplate=e.loader.getTemplate("processviewer"),e._buildprocessviewer()}):(i=e.options.getTemplate(e.options.tmpl),t.when(e.loader.loadTemplates({processviewer:i})).done(function(){e.options.configuration.localTemplate=e.loader.getTemplate("processviewer"),e._buildprocessviewer()}))):i?i.indexOf(".html")&&t.when(t.get(e.options.template)).done(function(t){e.options.configuration.localTemplate=t,e._buildprocessviewer()}):(i=e.options.getTemplate(e.options.tmpl),t.when(t.get(i)).done(function(t){e.options.configuration.localTemplate=t,e._buildprocessviewer()}))},_buildprocessviewer:function(){var e,i,r=this;r.$el.empty(),e=r.options.configuration.processviewerStageId=r._generateID(),i=t.tmpl(r.options.configuration.localTemplate,{id:e,isIE8:r.options.isIE8}),r.$el.append(i),r._createStage()},resize:function(t,e){var i=this;e=e||i.options.width,h=t||i.options.height,i.$el.outerWidth(e),i.$el.outerHeight(t)},calculatePosition:function(t,e,i,r){return{top:r/2-(e+45)+"px",left:i/2-(t+67.5)+"px"}},setPosition:function(e,i){var r=document.getElementById(i),n=this._getStageContainer(),s=t("#bz-gq-processviewer-canvas"),a=t(n),o=parseInt(isNaN(e.css("left").replace("px",""))?0:e.css("left").replace("px","")),l=parseInt(isNaN(e.css("top").replace("px",""))?0:e.css("top").replace("px","")),c=this.calculatePosition(o,l,s.width(),s.height());a.animate({left:c.left,top:c.top},1500,function(){var t=!0,e=0,i=setInterval(function(){t?r.classList.remove("processviewer-shape-selected"):r.classList.add("processviewer-shape-selected"),t=!t,5==e&&clearInterval(i),e++},400)})},_createStage:function(){var e,i,r,n,s,a,o=this;e=o.options.width?o.options.width:"100%",i=o.options.height?o.options.height:150,o.$el.outerWidth(e),o.$el.outerHeight(i);var l=100*o.options.dimentions.width/150+o.options.dimentions.width,c=100*o.options.dimentions.height/150+o.options.dimentions.height,h=o._getStageContainer();o._ScrollZoomProcessViewer(h),o._setResetZoom(t("button#resetZoom"),h),o.options.configuration.processviewerStage=s=new Raphael(h,l,c),o.options.configuration.processviewerPathsStageGroup=s.group(),s.canvas.setAttribute("id",o._generateID()),s.canvas.setAttribute("id",o._generateID()),s.canvas.setAttribute("class","processviewer-zvg-container"),s.canvas.setAttribute("class","processviewer-zvg-nested"),o.options.configuration.processviewerStageSet=s.set(),o.options.configuration.processviewerstageHotSpotSet=s.set(),e.indexOf("%")&&(a=!0),a||o.options.dimentions.width<e?t("[data-processviewercontainer]",o.element).width("100%"):t("[data-processviewercontainer]",o.element).width(o.options.dimentions.width),o.options.dimentions.width<e&&t("[data-processviewercontainer]",o.element).width(e),o.options.image?t.when(o._verifyingImage(o.options.image)).done(function(t){r=t.width?t.width:"150",n=t.height?t.height:"150",o.options.configuration.processviewerImageStage=o.options.configuration.processviewerStage.image(t.src,0,0,r,n),o.options.configuration.processviewerStageSet.push(o.options.configuration.processviewerImageStage),o.options.configuration.processviewerRectStage.attr("fill","rgba(255,255,255,0)"),o.options.configuration.processviewerRectStage.attr("stroke","none"),o._createUIControls()}).fail(function(t){o._createUIFailView(t)}):(r=o.element.width()?o.element.width():"150",n=o.element.height()?o.element.height():"150",o.options.configuration.processviewerRectStage=o.options.configuration.processviewerStage.rect(0,0,2*e,2*i),o.options.configuration.processviewerRectStage.attr("fill","rgba(255,255,255,0)"),o.options.configuration.processviewerRectStage.attr("stroke","none"),o.options.configuration.processviewerRectStage[0].setAttribute("id","BaseStage"+o._generateID()),o._createUIControls())},_createUIControls:function(){var e=this;e.options.configuration.processviewerStage,e.options.configuration.processviewerImageStage;e.options.draggable&&e._setDraggable(),t.when(e._createSVGProcessPool(),e._createSVGLanes(),e._createSVGMilestones(),e._createSVGSequenceFlows()).done(function(){e._createStyleFormats(),e.options.isIE8||e._createMarkers(),e._addHandlers(),e._createSlider(),e.options.hotSpotsSVG?e._createSVGHotSpots():t.when(e._createHTMLHotSpots()).done(function(){e._adjustLabelsPosition();var t={type:"pvComplete",message:"processviewer complete",time:new Date,ui:e.$el};e.element.trigger(t)})})},_zoomProcessViewer:function(e,i){var r=this;r._updateOutputSlider(i);var n=t(i).val();r.options.configuration.processviewerPathsStageGroup.scale(n),r.options.configuration.processviewerHotSpotsContainer.css("font-size",n+"em");var s=t(r.options.configuration.processviewerStage.defs);t(r.options.configuration.processviewerStage.canvas).append(s),r._updateHotSpotsScale(n),e.preventDefault(),e.stopPropagation()},calcProcessViewerTo:function(t,e,i,r){var n=t*(e-r),s=t>0?n-i+r:i-r-n;return t>0?(s<0?"":"-")+Math.abs(s):s},_ScrollZoomProcessViewer:function(e){var i=this,r=t(e).closest(".processviewer-wrapper"),n=t("input[type='range']",i.element),s=t(e),a=null;e.addEventListener("wheel",function(t){null==a&&(a=s.find("[data-processviewerhotspots] > [data-processviewerhotspot]:first"));var e=parseInt(isNaN(s.css("left").replace("px",""))?0:s.css("left").replace("px","")),o=parseInt(isNaN(s.css("top").replace("px",""))?0:s.css("top").replace("px","")),l=Number(n.val()),c=(t.wheelDelta?t.wheelDelta:-1*t.deltaY)>=0;if(n.val(l+.1*(c?1:-1)),l!=n.val()){var h=r.offset(),u=parseInt(a.css("left").replace("px",""))+parseInt(a.css("width").replace("px",""))/2,p=parseInt(a.css("top").replace("px",""))+parseInt(a.css("height").replace("px",""))/2;i._zoomProcessViewer(t,n);var d=parseInt(a.css("left").replace("px",""))+parseInt(a.css("width").replace("px",""))/2,f=parseInt(a.css("top").replace("px",""))+parseInt(a.css("height").replace("px",""))/2,g=i.calcProcessViewerTo(d/u,t.clientX-e,t.clientX,h.left+10),v=i.calcProcessViewerTo(f/p,t.clientY-o,t.clientY,h.top+10);s.css({left:g+"px",top:v+"px"})}})},_setResetZoom:function(e,i){var r=this;e.click(function(e){var n=t("input[type='range']",r.element);n.val(1),t(i).css({left:"0px",top:"0px"}),r._zoomProcessViewer(e,n)})},_createSlider:function(){var e=this,i=e.validateHTML5Features.checkInput("range");if(t.support.touch||i){t(".ui-for-desktop",e.element).remove();var r=t("input[type='range']",e.element);r.attr("min",e.options.minZoom),r.attr("max",e.options.maxZoom),r.attr("step",.1),r.attr("value",1),t.support.touch&&"desktop"!==e.options.device?(r.change(function(){e._updateOutputSlider(this)}),r.bind("touchstart",function(){t(this).prev("output").addClass("is-visible-output"),e._updateOutputSlider(this)}),r.bind("touchend",function(){var i=t(this).val();t(this).prev("output").removeClass("is-visible-output"),e.options.configuration.processviewerPathsStageGroup.scale(i),e.options.configuration.processviewerHotSpotsContainer.css("font-size",i+"em"),e._updateHotSpotsScale(i),e._updateOutputSlider(this)})):(r.mouseenter(function(){t(this).prev("output").addClass("is-visible-output"),e._updateOutputSlider(this)}).mouseleave(function(){t(this).prev("output").removeClass("is-visible-output")}),r.change(function(t){e._zoomProcessViewer(t,this)}))}else{t(".ui-for-touch",e.element).remove();var n=t(".processviewer-zvg-nested",e.element);n.data("real-width",n.width()),n.data("real-height",n.height());var s=function(e,i){var r=i.value||1,n='<div class="tooltip"><div class="tooltip-inner">'+(Math.round(100*r)+"%")+"</div></div>";t(".sliderTooltip").html(n)};e.options.configuration.sliderOptions={min:e.options.minZoomIE8,max:e.options.maxZoomIE8,step:.1,value:1,create:s,slide:s,stop:function(t,i){i.value>1&&(n[0].setAttribute("width",n.data("real-width")*i.value),n[0].setAttribute("height",n.data("real-height")*i.value)),e.options.configuration.processviewerPathsStageGroup.scale(i.value),e.options.configuration.processviewerHotSpotsContainer.css("font-size",i.value+"em"),e._updateHotSpotsScale(i.value),e._setDraggable()}},t("[data-processviewerslider]",e.element).slider(e.options.configuration.sliderOptions)}},_updateOutputSlider:function(e){var i=t(e);i.prev("output").text(Math.round(100*i.val())+"%")},_updateHotSpotsScale:function(e){var i=this.options.configuration.hotspotsList,r=t("[data-processviewerhotspots]",this.element),n=r;if(r.length>1){n=r[0];for(var s=1;s<r.length;s++)t(r[s]).offset().left>t(n).offset().left&&(n=r[s]);i=t(n).find(".processviewer-hotspot")}t(n).hide(),t(".processviewer-hotspot-icon svg g",this.element).each(function(){this.setAttribute("transform","scale("+e/10+")")});for(var a=0;a<i.length;a++){var o=t(i[a]),l=o.data("real-width")*e,c=o.data("real-height")*e,h=o.data("real-left")*e,u=o.data("real-top")*e;o.outerWidth(l),o.outerHeight(c),o.css("left",h),o.css("top",u)}t(n).show()},_scaleSVG:function(){},_addHandlers:function(){var e=this;t(window).on("resize.processviewer",function(){e._setDraggable()})},_setDraggable:function(){var e=this;if(t.support.touch&&"desktop"!==e.options.device){var i=e.options.configuration.processviewerPathsStageGroup.getScale(),r=e.options.configuration.processviewerStage.canvas.getAttribute("width")*i,n=e.options.configuration.processviewerStage.canvas.getAttribute("height")*i;t(".processviewer-wrapper",e.element).addClass("ui-scroll-touch"),t("[data-processviewercontainer]",e.element).width(r),t("[data-processviewercontainer]",e.element).height(n)}else{e.options.configuration.$processviewerStage=t(e.options.configuration.processviewerStage.canvas).parent();var s=t("[data-processviewercontainer]",e.element).position();if(s){i=e.options.configuration.processviewerPathsStageGroup.getScale();var a=e.element.width(),o=e.element.height();r=e.options.configuration.processviewerStage.width*i,n=e.options.configuration.processviewerStage.height*i;maxleft=s.left,maxTop=s.top;var l=t("[data-processviewer-wrapper-container]",e.element).is(":ui-draggable");a<r||o<n?l||(e.$el.addClass(" processviewer-drag"),e._dragLimits(),e.options.configuration.$processviewerStage.draggable({refreshPositions:!0,drag:function(t,e){}})):l&&(e.options.configuration.$processviewerStage.draggable("destroy"),e.element.removeClass("processviewer-drag"),e.options.configuration.$processviewerStage.css({left:0,top:0}),e.options.configuration.processviewerHotSpotsContainer.css({left:0,top:0}))}}},_dragLimits:function(){var t=this,e=t.options.configuration.processviewerPathsStageGroup.getScale(),i=t.element.width(),r=t.element.height(),n=t.options.configuration.processviewerStage.width*e,s=t.options.configuration.processviewerStage.height*e,a=0,o=0;return i<n&&(a=i-n),r<s&&(o=r-s),{x:a,y:o}},_movePaths:function(t,e){this.options.configuration.processviewerStage.move(t,e)},_createMarkers:function(){var e=t.bizagi.processviewer.design.markers;if(e)for(var i in e){var r=e[i].properties,n={id:i,css:i,markerHeight:10,markerWidth:10,refX:10,refY:5,orient:"auto"},s=this.options.configuration.processviewerStage.marker();t(s.node).attrSVG(n),t(s.node.lastElementChild).attrSVG(r),this.options.configuration.processviewerMarkerEndArrow||(this.options.configuration.processviewerMarkerEndArrow=[]),this.options.configuration.processviewerMarkerEndArrow.push(s)}},_createStyleFormats:function(){var e=this.options.formatStyles,i=t("<div></div>"),r="<style>";for(var n in e){var s="."+n.toLowerCase()+"{";i.css(e[n].css),r+=s+=i.attr("style")+"}"}r+="</style>",t("head").append(t(r))},_asignLabelFormat:function(e,i){if(i.bpmnLabel&&i.bpmnLabel.labelStyle){var r=i.bpmnLabel.labelStyle,n=this.options.formatStyles[r];t(e).closest("svg").length>0&&t(e).css(n.css);var s=n.cssClass;s.push(r);for(var a=0;a<s.length;a++)t(e).addClass(s[a].toLowerCase())}},_createSVGProcessPool:function(){for(var t=this,e=[],i=t.options.configuration.processviewerPathsStageGroup,r=t.options.hotspots.length-1;r>=0;r--)t.options.hotspots[r].elementType===t.constants.ELEMENT_TYPE.PROCESS&&(e.push(t.options.hotspots[r]),t.options.hotspots.splice(r,1));t._createSVGRect(i,e,"processPool")},_createSVGLanes:function(){for(var t=this,e=[],i=t.options.configuration.processviewerPathsStageGroup,r=t.options.hotspots.length-1;r>=0;r--)t.options.hotspots[r].elementType===t.constants.ELEMENT_TYPE.LANE&&(e.push(t.options.hotspots[r]),t.options.hotspots.splice(r,1));t._createSVGRect(i,e,"lanes")},_createSVGMilestones:function(){for(var t=this,e=[],i=t.options.configuration.processviewerPathsStageGroup,r=t.options.hotspots.length-1;r>=0;r--)t.options.hotspots[r].elementType===t.constants.ELEMENT_TYPE.MILESTONES&&(e.push(t.options.hotspots[r]),t.options.hotspots.splice(r,1));t._createSVGRect(i,e,"milestones")},_createSVGSequenceFlows:function(){for(var t=this,e=[],i=t.options.configuration.processviewerPathsStageGroup,r=t.options.hotspots.length-1;r>=0;r--)t.options.hotspots[r].elementType!==t.constants.ELEMENT_TYPE.SEQUENCEFLOW&&t.options.hotspots[r].elementType!==t.constants.ELEMENT_TYPE.ASSOCIATION||!t.options.hotspots[r].hasOwnProperty(t.constants.PROPERTIES.WAYPOINTS)||(e.push(t.options.hotspots[r]),t.options.hotspots[r].conditionType===t.constants.CONDITION_TYPE.NORMAL&&t.options.hotspots.splice(r,1));t._createSVGPaths(i,e)},_createSVGRect:function(e,i,r){for(var n,s=this,a=0;a<i.length;a++){var o=i[a];if(void 0===o[s.constants.PROPERTIES.BOUNDS])console.log(o);else{var l=o[s.constants.PROPERTIES.BOUNDS],c=e.rect(l.x,l.y,l.width,l.height);if(o.bpmnElementRef?c[0].setAttribute("id",o.bpmnElementRef):o.bpmnElement&&o.bpmnElement.baref&&o.bpmnElement.baref.ref&&c[0].setAttribute("id",o.bpmnElement.baref.ref),""===o.displayName&&(o.displayName="Lane"),null===o.displayName&&(o.displayName=" "),o.displayName&&(n=e.text(l.height/2*-1,10,o.displayName)),o.elementType===s.constants.ELEMENT_TYPE.PROCESS&&(n.attr({"font-weight":"600",y:o.bounds.y+l.height/2,x:10}).data("rotation",-90),n.transform("r-90")),o.elementType===s.constants.ELEMENT_TYPE.MILESTONES){n.attr({"font-weight":"600",y:o.bounds.y+16,x:o.bounds.x+l.width/2}),c.attr("height",s.options.milestonesHeight);var h=o.bounds.x+o.bounds.width,u=o.bounds.y+s.options.milestonesHeight,p=o.bounds.height,d=s._getPathString([{x:h,y:u},{x:h,y:p}]);e.path(d).attr({stroke:"#CCC","stroke-dasharray":"--"});var f=h-1,g=s._getPathString([{x:f,y:o.bounds.y},{x:f+s.options.milestonesHeight,y:s.options.milestonesHeight/2},{x:f,y:s.options.milestonesHeight}]);e.path(g).attr({stroke:"#CCC",fill:"#FFF"})}if(o.elementType===s.constants.ELEMENT_TYPE.LANE){t(n.node).width(),o.bounds.height,t(n.node).height();n.attr({y:o.bounds.y+o.bounds.height/2,x:o.bounds.x+10,"font-weight":"600"}).data("rotation",-90),n.transform("r-90");var v=o.bounds.x+30,m=o.bounds.height,y=s._getPathString([{x:v,y:o.bounds.y+25},{x:v,y:m}]);e.path(y).attr({stroke:"#E6E6E6",fill:"none"})}t(c[0]).attr("id")&&o.displayName&&t(n[0]).data("id",o.id),c.attr({stroke:"#E6E6E6",fill:"none"}),s._asignLabelFormat(n[0],o)}}},_createSVGPaths:function(e,i){for(var r=this,n=0;n<i.length;n++){var s=i[n];if(void 0===s[r.constants.PROPERTIES.WAYPOINTS])console.log(s);else{var a=!1;s.elementType!==r.constants.ELEMENT_TYPE.TEXTANNOTATION&&s.conditionType!==r.constants.CONDITION_TYPE.RELATION&&s.conditionType!==r.constants.CONDITION_TYPE.COMPENSATION&&(a=!0);var o=r._getPathString(s[r.constants.PROPERTIES.WAYPOINTS]);o+=r.options.isIE8&&a?r._getArrowPathString(s[r.constants.PROPERTIES.WAYPOINTS]):"";var l=e.path(o);s.bpmnElementRef?l[0].setAttribute("id",s.bpmnElementRef):s.bpmnElement&&s.bpmnElement.baref&&s.bpmnElement.baref.ref&&l[0].setAttribute("id",s.bpmnElement.baref.ref),a&&t(l.node).setMarkerSVG("normal");var c=l.getTotalLength()/2,h=l.getPointAtLength(c);s.displayName&&(nText=e.text(h.x,h.y,s.displayName)),t(l[0]).attr("id")&&s.displayName&&t(nText[0]).data("id",s.id),s.conditionType!==r.constants.CONDITION_TYPE.RELATION&&s.conditionType!==r.constants.CONDITION_TYPE.COMPENSATION||l.attr({"stroke-dasharray":".","stroke-width":"2"}),r._asignLabelFormat(l[0],s)}}},_createHTMLHotSpots:function(){for(var e=this,i=[],r=e.options.hotspots,n=e.options.configuration.processviewerHotSpotsContainer=t('<div class="processviewer-hotspots-container" data-processviewerhotspots style="position:absolute;"></div>'),s=0;s<r.length;s++){var a=r[s];if(a.bounds||a.x){a.number=s;var o=e._createHotSpotDiv(a);i.push(o),n.append(o)}}t("[data-processviewer-wrapper-container]",e.element).prepend(n),n.on("click",".processviewer-hotspot",function(i){var r=t(this).data("number"),n=t(this);e.options.hotspots[r].onClick&&e.options.hotspots[r].onClick(i,n),e._triggers.click.apply(n,[e.element])}),n.on("mouseenter",".processviewer-hotspot",function(i){var r=t(this).data("number"),n=t(this);e.options.hotspots[r].onMouseOver&&e.options.hotspots[r].onMouseOver(i,n),e._triggers.onMouseOver.apply(n,[e.element])}),n.on("mouseout",".processviewer-hotspot",function(i){var r=t(this).data("number"),n=t(this);e.options.hotspots[r].onMouseOut&&e.options.hotspots[r].onMouseOut(i,n),e._triggers.onMouseOut.apply(n,[e.element])}),e.options.configuration.hotspotsList=t(".processviewer-hotspot",e.element)},_createHotSpotDiv:function(e){var i=t('<div class="processviewer-hotspot processviewer-hotspot-div" data-processviewerhotspot></div>'),r=t('<div class="processviewer-hotspot-label" data-processviewerlabel></div>'),n=this._getHotSpotData(e);return i.outerWidth(n.w),i.outerHeight(n.h),i.css("left",n.x+"px"),i.css("top",n.y+"px"),i.data("number",e.number),i.attr("number",e.number),e.bounds&&(i.data("real-width",e.bounds.width),i.data("real-height",e.bounds.height),i.data("real-left",e.bounds.x),i.data("real-top",e.bounds.y)),e.displayName&&e.elementType!==this.constants.ELEMENT_TYPE.SEQUENCEFLOW&&(r.text(e.displayName),i.append(r)),e.elementType&&this._createIconsForHotSpots(i,e),e.text&&e.text.content&&(r.text(e.text.content),i.append(r)),e.dataState&&e.dataState.displayName&&(r.text(e.dataState.displayName),i.append(r)),e.radius&&i.css("border-radius",e.radius),e.css&&i.addClass(e.css),e.loopCharacteristics&&(e.loopCharacteristics.isSequential?i.addClass("issequential"):e.loopCharacteristics.isSequential||i.addClass("isparallel")),this._asignLabelFormat(r[0],e),e.elementType&&i.addClass(e.elementType.toLowerCase()),e.conditionType&&i.addClass(e.conditionType.toLowerCase()),e.eventType&&i.addClass(e.eventType.toLowerCase()),e.subProcessType&&i.addClass(e.subProcessType.toLowerCase()),e.isForCompensation&&i.addClass("isforcompensation"),e.bpmnElementRef?i.attr("id",e.bpmnElementRef):e.bpmnElement&&e.bpmnElement.baref&&e.bpmnElement.baref.ref&&i.attr("id",e.bpmnElement.baref.ref),e.content&&i.append(e.content),i},_createIconsForHotSpots:function(e,i){var r=i.elementType.toLowerCase(),n=t('<div class="processviewer-hotspot-icon" data-processviewericon></div>');if(e.append(n),t.bizagi.processviewer.design.icons){var s=t.bizagi.processviewer.design.icons.scale,a=t.bizagi.processviewer.design.icons.bounds.width*s,o=t.bizagi.processviewer.design.icons.bounds.height*s,l=new Raphael(n[0],a,o).group();i.isForCompensation&&(r="isforcompensation");var c=t.bizagi.processviewer.design.icons.iconset[r];if(c){svgTmp=c.svg;for(var h=0;h<svgTmp.length;h++){var u=svgTmp[h],p=l[u.type]();for(var d in s<1&&l.node.setAttribute("transform","scale("+s+")"),u.properties)p[0].setAttribute(d,u.properties[d])}}}},_getPathString:function(t){for(var e="",i=0;i<t.length;i++)0===i&&(e+="M"),i>0&&(e+="L"),e+=t[i].x+",",e+=t[i].y+",";return e},_getArrowPathString:function(t){var e=t[t.length-1],i=t[t.length-2],r=i.x,n=e.x,s=i.y,a=e.y,o=Raphael.angle(n,a,r,s),l=Raphael.rad(o-135),c=Raphael.rad(o+135);return"M"+n+","+a+",L"+(n+10*Math.cos(l))+","+(a+10*Math.sin(l))+",M"+n+","+a+",L"+(n+10*Math.cos(c))+","+(a+10*Math.sin(c))},_getHotSpotData:function(t){var e={x:0,y:0,w:0,h:0};return t.x?e.x=t.x:t.bounds.x&&(e.x=t.bounds.x),t.y?e.y=t.y:t.bounds.y&&(e.y=t.bounds.y),t.w?e.w=t.w:t.bounds.width&&(e.w=t.bounds.width),t.h?e.h=t.h:t.bounds.height&&(e.h=t.bounds.height),e},_createSVGHotSpots:function(){for(var t=this,e=t.options.hotspots,i=0;i<e.length;i++){var r=e[i],n=t.options.configuration.processviewerStage.rect(r.x,r.y,50,50);n.id=r.id,"function"==typeof r.onClick?n.click(r.onClick):n.click(t._triggers.click);var s=t._triggers.onMouseOver,a=t._triggers.onMouseOut;"function"==typeof r.onMouseOver&&(s=r.onMouseOver),"function"==typeof r.onMouseOut&&(a=r.onMouseOut),n.hover(s,a),n.node.id=r.id,n.node.class=r.css,t.options.configuration.processviewerstageHotSpotSet.push(n)}t.options.configuration.processviewerStageSet.push(t.options.configuration.processviewerstageHotSpotSet)},_triggers:{click:function(e){var i={type:"pvClick",message:"hotspot clicked",time:new Date,ui:{control:this,id:t(this).attr("id")}};e.trigger(i)},onMouseOver:function(e){var i={type:"pvMouseIn",message:"hotspot mouse in",time:new Date,ui:{control:this,id:t(this).attr("id")}};e.trigger(i)},onMouseOut:function(e){var i={type:"pvMouseOut",message:"hotspot mouse out",time:new Date,ui:{control:this,id:t(this).attr("id")}};e.trigger(i)},error:function(e){var i={type:"pvError",time:new Date};t.extend(e,i),t.event.trigger(e)}},_createUIFailView:function(e){var i=t('<div class="'+this.options.configuration.errorImageCSS+' svg-error-content"><div class="processviewer-absolute-center"><img src="'+this.options.unavailableImage+'" class="processviewer-absolute-center"/></div><span class="processviewer-message">'+e+"</span></div>");t("[data-processviewercontainer]",this.element).append(i)},_verifyingImage:function(e){var i=t.Deferred(),r=document.createElement("img");return r.onload=function(){i.resolve(r)},r.onerror=function(){i.reject(e)},r.src=e,i.promise()},_getStageContainer:function(e){return t("[data-processviewer-wrapper-container]",this.element)[0]},_generateID:function(){var e=(new Date).getTime(),i="processviewer-xxxxxxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?i:7&i|8).toString(16)});return t("#"+i).length>0?this._generateID():i},_adjustLabelsPosition:function(){for(var e=t(".processviewer-hotspot-label",this.element),i=(e.closest(".processviewer-hotspot"),0);i<e.length;i++){var r=t(e[i]),n=r.closest(".processviewer-hotspot"),s=n.outerHeight();if(n.hasClass("subprocess")||n.hasClass("callactivity")||n.hasClass("dataobject")){var a=t._ptToem(s+10);r.css({paddingTop:a})}else this.options.isIE8&&r.css({paddingTop:"1.8em"})}},_setOption:function(t,e){this.options[t]=e,this._update()},_update:function(){var t=this.options.value+"%";this.element.text(t),100===this.options.value&&this._trigger("complete",null,{value:100})},_destroy:function(){this.element.empty().removeAttr("style","").removeAttr("role",""),clearInterval(this.options.animation.interval)},_getSelectedClassCSSByWorkitemState:function(t,e){var i;e&&e.filter&&(i=e.filter(function(e){return e.guidTask===t}));var r="processviewer-shape-selected";return i&&i.length>0&&14==i[0].wiState&&(r="processviewer-shape-selected-standby"),r},selectShape:function(e,i){for(var r=t.isArray(e)?e:[e],n=0,s=r.length;n<s;n++){var a=t("#"+r[n],this.$el);if(a.length){var o=this._getSelectedClassCSSByWorkitemState(r[n],i);"div"!==a.prop("tagName").toLowerCase()?(a.addClassSVG(o),a.setMarkerSVG("selected")):a.addClass(o)}}},unSelectShape:function(e,i){for(var r=t.isArray(e)?e:[e],n=0,s=r.length;n<s;n++){var a=t("#"+r[n],this.$el),o=a.prop("tagName").toLowerCase(),l=this._getSelectedClassCSSByWorkitemState(r[n],i);"div"!==o?(a.removeClassSVG(l),a.reverseMarkerSVG()):a.removeClass(l)}},unSelectAllShapes:function(){for(var e=t(".processviewer-shape-selected",this.$el),i=0;i<e.length;i++){var r=t(e[i]);"div"!==r.prop("tagName").toLowerCase()?(r.removeClassSVG("processviewer-shape-selected"),r.reverseMarkerSVG()):r.removeClass("processviewer-shape-selected")}},drawRoute:function(e){for(var i=[],r=0;r<e.length;r++){var n=t("#"+e[r],this.$el);if(n.length>0)"div"!==n.prop("tagName").toLowerCase()?(n.addClassSVG("processviewer-highlighted"),n.setMarkerSVG("highlighted")):n.addClass("processviewer-highlighted");else i.push(e[r])}this._triggers.error({message:"Doesn't find element",ui:i})},animateRoute:function(e){var i=this;i.option.counter;t.isArray(e)&&(i.options.animation.counter=0,i.options.animation.path=e,i.options.animation.status=0),0===i.options.animation.status?i._startRouteAnimation():i._stopRouteAnimation()},_startRouteAnimation:function(){var e=this,i=e.options.animation.path;e.options.animation.status=1,0===e.options.animation.counter&&e.clearRoute(),e.options.animation.interval=setInterval(function(){if(e.options.animation.counter<i.length){var r=t("[id="+i[e.options.animation.counter]+"]",e.$el).last();if(r.length>0)"div"!==r.prop("tagName").toLowerCase()?(r.addClassSVG("processviewer-highlighted"),r.setMarkerSVG("highlighted"),r[0].strokecolor="#FF7F00"):r.addClass("processviewer-highlighted");e.options.animation.counter++}else e.element.trigger({type:"animationComplete",message:"animation end!",time:new Date,ui:e.$el}),e.options.animation.counter=0,e._stopRouteAnimation()},e.options.animation.time)},_stopRouteAnimation:function(){this.options.animation.status=0,clearInterval(this.options.animation.interval)},_isInWorkportal:function(){var t=!1;return"undefined"!=typeof bizagi&&void 0!==bizagi.workportal&&(t=!0),t},clearRoute:function(){for(var e=t(".processviewer-highlighted",this.$el),i=0;i<e.length;i++){var r=t(e[i]);"div"!==r.prop("tagName").toLowerCase()?(r.removeClassSVG("processviewer-highlighted"),r[0].strokecolor="#000",r.reverseMarkerSVG()):r.removeClass("processviewer-highlighted")}},validateHTML5Features:{checkInput:function(t){var e=document.createElement("input");return e.setAttribute("type",t),e.type==t}}}),t.fn.addClassSVG=function(e){var i=arguments[0];return e=t.extend({},t.fn.addClassSVG.config,e),this.each(function(){var t=this.getAttribute("class"),e="";null===t&&(t=""),"string"==typeof i&&-1===t.indexOf(i)&&(e=t+" "+i,this.setAttribute("class",e))})},t.fn.addClassSVG.config={},t.fn.setMarkerSVG=function(e){var i="url(#"+arguments[0]+")";return e=t.extend({},t.fn.addClassSVG.config,e),this.each(function(){var t=this.getAttribute("marker-end");t!=i&&(this.setAttribute("marker-end",i),this.setAttribute("toggle-marker-end",t))})},t.fn.reverseMarkerSVG=function(){return this.each(function(){var t=this.getAttribute("marker-end"),e=this.getAttribute("toggle-marker-end");null!==e&&null!==t&&(this.setAttribute("marker-end",e),this.removeAttribute("toggle-marker-end"))})},t.fn.removeClassSVG=function(e){var i=arguments[0];return e=t.extend({},t.fn.addClassSVG.config,e),this.each(function(){var t=this.getAttribute("class"),e="";null!==t&&"string"==typeof i&&-1!==t.indexOf(i)&&(e=t.replace(i,"").replace("  "," "),this.setAttribute("class",e))})},t.fn.removeClassSVG.config={},t.fn.hasClassSVG=function(t){var e=arguments[0],i=this[0].getAttribute("class"),r=!1;return null!==i&&"string"==typeof e&&-1!==i.indexOf(e)&&(r=!0),r},t.fn.attrSVG=function(t){var e=this[0];for(var i in t)e.setAttribute(i,t[i]);return e},t._ptToem=function(t,e){return e||(e=12),t/e+"em"}}(jQuery),function(t){t.fn.processviewerQueries=function(){this.css("color","green");var e=this;return e.data=this[0],e.internalDataSource={elements:[]},e.datasource={hotspots:[],formatStyles:[]},e.deferred=t.Deferred(),e.padding=80,e.typeDefinitions=t.bizagi.processviewer.configuration.validTypeDefinitions,e.constants=t.bizagi.processviewer.configuration.constants,this.methods={init:function(){var e=this,i=t.Deferred();return e.typeDefinitions.unshift("owner"),e.data.definition.owner={processType:e.data.definition.processType,elementType:e.data.definition.elementType,displayName:e.data.definition.displayName,id:e.data.definition.id},t.when(e.methods.processElements.apply(e,[])).done(function(){i.resolve(e.datasource)}),i.promise()},processElements:function(){var e=this,i=[];for(var r in e.data.definition){var n=e.data.definition[r];if(e.methods.validateKindObject.apply(e,[r]))if(r===e.constants.LANESETS){if(n){var s=e.methods.getLanesFromLaneSet.apply(e,[n]);i=i.concat(s)}}else i=i.concat(n)}e.internalDataSource.elements=e.internalDataSource.elements.concat(i);for(var a=0;a<e.internalDataSource.elements.length;a++){var o=e.internalDataSource.elements[a].id,l=e.methods.getElementGraphicDataById.apply(e,[o]);if(l){var c=t.extend({},l,e.internalDataSource.elements[a]);e.datasource.hotspots.push(c)}}e.datasource.dimentions=e.methods._getMaxDimentions.apply(e,[]),e.datasource.formatStyles=e.methods.getStylesFormat.apply(e,[])},getStylesFormat:function(){var e,i={};if(this.data.graphics[this.constants.BPMNLABELSTYLES]){e=this.data.graphics[this.constants.BPMNLABELSTYLES];for(var r=0;r<e.length;r++){var n=e[r],s=n.font.size?t._ptToem(n.font.size):"1em";i[n.id]={css:{fontFamily:n.font.name||"Arial",fontSize:s,fontWeight:n.font.isBold?"bold":"normal",fontStyle:n.font.isItalic?"italic":"normal",color:n.font.color||"Black"},cssClass:["alignment-"+n.alignment]}}}return i},_getMaxDimentions:function(){var t,e=this,i=0,r=0,n=[];for(var s in e.data.definition){var a=e.data.definition[s];s===e.constants.LANESETS&&a&&(n=e.methods.getLanesFromLaneSet.apply(e,[a]))}for(var o=0;o<n.length;o++)n[o].id&&(t=e.methods.getElementGraphicDataById.apply(e,[n[o].id])),"object"==typeof t&&(i<t.bounds.width&&(i=t.bounds.width+e.padding),r+=t.bounds.height+e.padding);return{width:i,height:r}},_ptToEM:function(t){return t/e.pixelFontSize},getElementGraphicDataById:function(t){for(var e,i=this.data.graphics.bpmnPlane.diagramElements,r=0;r<i.length;r++){var n=this.methods.hasReferenceId(i[r]);if(n&&(localID=n,localID===t)){e=i[r];break}}return e},getLanesFromLaneSet:function(t){for(var e=[],i=0;i<t.length;i++)e=e.concat(t[i].lanes);return e},validateKindObject:function(t){for(var e=!1,i=0;i<this.typeDefinitions.length;i++)if(this.typeDefinitions[i]===t){e=!0;break}return e},hasReferenceId:function(t){var e=!1;return t.bpmnElement?t.bpmnElement.baref&&t.bpmnElement.baref.ref&&(e=t.bpmnElement.baref.ref):t.bpmnElementRef&&(e=t.bpmnElementRef),e}},this.methods.init.apply(this,[])}}(jQuery),function(t){if(t.support.touch="ontouchend"in document,t.support.touch){var e,i=t.ui.mouse.prototype,r=i._mouseInit;i._touchStart=function(t){!e&&this._mouseCapture(t.originalEvent.changedTouches[0])&&(e=!0,this._touchMoved=!1,n(t,"mouseover"),n(t,"mousemove"),n(t,"mousedown"))},i._touchMove=function(t){e&&(this._touchMoved=!0,n(t,"mousemove"))},i._touchEnd=function(t){e&&(n(t,"mouseup"),n(t,"mouseout"),this._touchMoved||n(t,"click"),e=!1)},i._mouseInit=function(){var e=this;e.element.bind("touchstart",t.proxy(e,"_touchStart")).bind("touchmove",t.proxy(e,"_touchMove")).bind("touchend",t.proxy(e,"_touchEnd")),r.call(e)}}function n(t,e){if(!(t.originalEvent.touches.length>1)){t.preventDefault();var i=t.originalEvent.changedTouches[0],r=document.createEvent("MouseEvents");r.initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(r)}}}(jQuery),function(t){var e,i,r="hasOwnProperty",n=/[\.\/]/,s=function(){},a=function(t,e){return t-e},o={n:{}},l=function(t,r){t=String(t);var n,s=i,o=Array.prototype.slice.call(arguments,2),c=l.listeners(t),h=0,u=[],p={},d=[],f=e;e=t,i=0;for(var g=0,v=c.length;g<v;g++)"zIndex"in c[g]&&(u.push(c[g].zIndex),c[g].zIndex<0&&(p[c[g].zIndex]=c[g]));for(u.sort(a);u[h]<0;)if(n=p[u[h++]],d.push(n.apply(r,o)),i)return i=s,d;for(g=0;g<v;g++)if("zIndex"in(n=c[g]))if(n.zIndex==u[h]){if(d.push(n.apply(r,o)),i)break;do{if((n=p[u[++h]])&&d.push(n.apply(r,o)),i)break}while(n)}else p[n.zIndex]=n;else if(d.push(n.apply(r,o)),i)break;return i=s,e=f,d.length?d:null};l._events=o,l.listeners=function(t){var e,i,r,s,a,l,c,h,u=t.split(n),p=o,d=[p],f=[];for(s=0,a=u.length;s<a;s++){for(h=[],l=0,c=d.length;l<c;l++)for(i=[(p=d[l].n)[u[s]],p["*"]],r=2;r--;)(e=i[r])&&(h.push(e),f=f.concat(e.f||[]));d=h}return f},l.on=function(t,e){if(t=String(t),"function"!=typeof e)return function(){};for(var i=t.split(n),r=o,a=0,l=i.length;a<l;a++)r=(r=r.n).hasOwnProperty(i[a])&&r[i[a]]||(r[i[a]]={n:{}});for(r.f=r.f||[],a=0,l=r.f.length;a<l;a++)if(r.f[a]==e)return s;return r.f.push(e),function(t){+t==+t&&(e.zIndex=+t)}},l.f=function(t){var e=[].slice.call(arguments,1);return function(){l.apply(null,[t,null].concat(e).concat([].slice.call(arguments,0)))}},l.stop=function(){i=1},l.nt=function(t){return t?new RegExp("(?:\\.|\\/|^)"+t+"(?:\\.|\\/|$)").test(e):e},l.nts=function(){return e.split(n)},l.off=l.unbind=function(t,e){if(t){var i,s,a,c,h,u,p,d=t.split(n),f=[o];for(c=0,h=d.length;c<h;c++)for(u=0;u<f.length;u+=a.length-2){if(a=[u,1],i=f[u].n,"*"!=d[c])i[d[c]]&&a.push(i[d[c]]);else for(s in i)i[r](s)&&a.push(i[s]);f.splice.apply(f,a)}for(c=0,h=f.length;c<h;c++)for(i=f[c];i.n;){if(e){if(i.f){for(u=0,p=i.f.length;u<p;u++)if(i.f[u]==e){i.f.splice(u,1);break}!i.f.length&&delete i.f}for(s in i.n)if(i.n[r](s)&&i.n[s].f){var g=i.n[s].f;for(u=0,p=g.length;u<p;u++)if(g[u]==e){g.splice(u,1);break}!g.length&&delete i.n[s].f}}else for(s in delete i.f,i.n)i.n[r](s)&&i.n[s].f&&delete i.n[s].f;i=i.n}}else l._events=o={n:{}}},l.once=function(t,e){var i=function(){return l.unbind(t,i),e.apply(this,arguments)};return l.on(t,i)},l.version="0.4.2",l.toString=function(){return"You are running Eve 0.4.2"},"undefined"!=typeof module&&module.exports?module.exports=l:t.eve=l}(this),function(t,e){!function(t,e){function i(t){if(i.is(t,"function"))return y?t():e.on("raphael.DOMload",t);if(i.is(t,H))return i._engine.create[E](i,t.splice(0,3+i.is(t[0],q))).add(t);var r=Array.prototype.slice.call(arguments,0);if(i.is(r[r.length-1],"function")){var n=r.pop();return y?n.call(i._engine.create[E](i,r)):e.on("raphael.DOMload",function(){n.call(i._engine.create[E](i,r))})}return i._engine.create[E](i,arguments)}function r(t){if("function"==typeof t||Object(t)!==t)return t;var e=new t.constructor;for(var i in t)t[k](i)&&(e[i]=r(t[i]));return e}function n(t,e,i){return function r(){var n=Array.prototype.slice.call(arguments,0),s=n.join("␀"),a=r.cache=r.cache||{},o=r.count=r.count||[];if(a[k](s))return function(t,e){for(var i=0,r=t.length;i<r;i++)if(t[i]===e)return t.push(t.splice(i,1)[0])}(o,s),i?i(a[s]):a[s];o.length>=1e3&&delete a[o.shift()];o.push(s);a[s]=t[E](e,n);return i?i(a[s]):a[s]}}function s(){return this.hex}function a(t,e){for(var i=[],r=0,n=t.length;n-2*!e>r;r+=2){var s=[{x:+t[r-2],y:+t[r-1]},{x:+t[r],y:+t[r+1]},{x:+t[r+2],y:+t[r+3]},{x:+t[r+4],y:+t[r+5]}];e?r?n-4==r?s[3]={x:+t[0],y:+t[1]}:n-2==r&&(s[2]={x:+t[0],y:+t[1]},s[3]={x:+t[2],y:+t[3]}):s[0]={x:+t[n-2],y:+t[n-1]}:n-4==r?s[3]=s[2]:r||(s[0]={x:+t[r],y:+t[r+1]}),i.push(["C",(-s[0].x+6*s[1].x+s[2].x)/6,(-s[0].y+6*s[1].y+s[2].y)/6,(s[1].x+6*s[2].x-s[3].x)/6,(s[1].y+6*s[2].y-s[3].y)/6,s[2].x,s[2].y])}return i}function o(t,e,i,r,n){var s=-3*e+9*i-9*r+3*n,a=t*s+6*e-12*i+6*r;return t*a-3*e+3*i}function l(t,e,i,r,n,s,a,l,c){null==c&&(c=1);for(var h=(c=c>1?1:c<0?0:c)/2,u=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],p=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],d=0,f=0;f<12;f++){var g=h*u[f]+h,v=o(g,t,i,n,a),m=o(g,e,r,s,l),y=v*v+m*m;d+=p[f]*M.sqrt(y)}return h*d}function c(t,e,i,r,n,s,a,o){if(!(R(t,i)<W(n,a)||W(t,i)>R(n,a)||R(e,r)<W(s,o)||W(e,r)>R(s,o))){var l=(t*r-e*i)*(n-a)-(t-i)*(n*o-s*a),c=(t*r-e*i)*(s-o)-(e-r)*(n*o-s*a),h=(t-i)*(s-o)-(e-r)*(n-a);if(h){var u=l/h,p=c/h,d=+u.toFixed(2),f=+p.toFixed(2);if(!(d<+W(t,i).toFixed(2)||d>+R(t,i).toFixed(2)||d<+W(n,a).toFixed(2)||d>+R(n,a).toFixed(2)||f<+W(e,r).toFixed(2)||f>+R(e,r).toFixed(2)||f<+W(s,o).toFixed(2)||f>+R(s,o).toFixed(2)))return{x:u,y:p}}}}function h(t,e,r){var n=i.bezierBBox(t),s=i.bezierBBox(e);if(!i.isBBoxIntersect(n,s))return r?0:[];for(var a=l.apply(0,t),o=l.apply(0,e),h=R(~~(a/5),1),u=R(~~(o/5),1),p=[],d=[],f={},g=r?0:[],v=0;v<h+1;v++){var m=i.findDotsAtSegment.apply(i,t.concat(v/h));p.push({x:m.x,y:m.y,t:v/h})}for(v=0;v<u+1;v++)m=i.findDotsAtSegment.apply(i,e.concat(v/u)),d.push({x:m.x,y:m.y,t:v/u});for(v=0;v<h;v++)for(var y=0;y<u;y++){var x=p[v],b=p[v+1],w=d[y],_=d[y+1],k=O(b.x-x.x)<.001?"y":"x",S=O(_.x-w.x)<.001?"y":"x",C=c(x.x,x.y,b.x,b.y,w.x,w.y,_.x,_.y);if(C){if(f[C.x.toFixed(4)]==C.y.toFixed(4))continue;f[C.x.toFixed(4)]=C.y.toFixed(4);var T=x.t+O((C[k]-x[k])/(b[k]-x[k]))*(b.t-x.t),E=w.t+O((C[S]-w[S])/(_[S]-w[S]))*(_.t-w.t);T>=0&&T<=1.001&&E>=0&&E<=1.001&&(r?g++:g.push({x:C.x,y:C.y,t1:W(T,1),t2:W(E,1)}))}}return g}function u(t,e,r){t=i._path2curve(t),e=i._path2curve(e);for(var n,s,a,o,l,c,u,p,d,f,g=r?0:[],v=0,m=t.length;v<m;v++){var y=t[v];if("M"==y[0])n=l=y[1],s=c=y[2];else{"C"==y[0]?(d=[n,s].concat(y.slice(1)),n=d[6],s=d[7]):(d=[n,s,n,s,l,c,l,c],n=l,s=c);for(var x=0,b=e.length;x<b;x++){var w=e[x];if("M"==w[0])a=u=w[1],o=p=w[2];else{"C"==w[0]?(f=[a,o].concat(w.slice(1)),a=f[6],o=f[7]):(f=[a,o,a,o,u,p,u,p],a=u,o=p);var _=h(d,f,r);if(r)g+=_;else{for(var k=0,S=_.length;k<S;k++)_[k].segment1=v,_[k].segment2=x,_[k].bez1=d,_[k].bez2=f;g=g.concat(_)}}}}}return g}function p(t,e,i,r,n,s){null!=t?(this.a=+t,this.b=+e,this.c=+i,this.d=+r,this.e=+n,this.f=+s):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function d(){return this.x+A+this.y+A+this.width+" × "+this.height}function f(t,e,i,r,n,s){function a(t){return((h*t+c)*t+l)*t}var o,l=3*e,c=3*(r-e)-l,h=1-l-c,u=3*i,p=3*(n-i)-u,d=1-u-p;return o=function(t,e){var i,r,n,s,o,u;for(n=t,u=0;u<8;u++){if(s=a(n)-t,O(s)<e)return n;if(O(o=(3*h*n+2*c)*n+l)<1e-6)break;n-=s/o}if(r=1,(n=t)<(i=0))return i;if(n>r)return r;for(;i<r;){if(s=a(n),O(s-t)<e)return n;t>s?i=n:r=n,n=(r-i)/2+i}return n}(t,1/(200*s)),((d*o+p)*o+u)*o}function g(t,e){var i=[],r={};if(this.ms=e,this.times=1,t){for(var n in t)t[k](n)&&(r[Z(n)]=t[n],i.push(Z(n)));i.sort(lt)}this.anim=r,this.top=i[i.length-1],this.percents=i}function v(t,r,n,s,a,o){n=Z(n);var l,c,h,u,d,g,v=t.ms,m={},y={},x={};if(s)for(_=0,S=se.length;_<S;_++){var w=se[_];if(w.el.id==r.id&&w.anim==t){w.percent!=n?(se.splice(_,1),h=1):c=w,r.attr(w.totalOrigin);break}}else s=+y;for(var _=0,S=t.percents.length;_<S;_++){if(t.percents[_]==n||t.percents[_]>s*t.top){n=t.percents[_],d=t.percents[_-1]||0,v=v/t.top*(n-d),u=t.percents[_+1],l=t.anim[n];break}s&&r.attr(t.anim[t.percents[_]])}if(l){if(c)c.initstatus=s,c.start=new Date-c.ms*s;else{for(var C in l)if(l[k](C)&&(tt[k](C)||r.paper.customAttributes[k](C)))switch(m[C]=r.attr(C),null==m[C]&&(m[C]=J[C]),y[C]=l[C],tt[C]){case q:x[C]=(y[C]-m[C])/v;break;case"colour":m[C]=i.getRGB(m[C]);var T=i.getRGB(y[C]);x[C]={r:(T.r-m[C].r)/v,g:(T.g-m[C].g)/v,b:(T.b-m[C].b)/v};break;case"path":var E=zt(m[C],y[C]),B=E[1];for(m[C]=E[0],x[C]=[],_=0,S=m[C].length;_<S;_++){x[C][_]=[0];for(var A=1,N=m[C][_].length;A<N;A++)x[C][_][A]=(B[_][A]-m[C][_][A])/v}break;case"transform":var z=r._,D=Ot(z[C],y[C]);if(D)for(m[C]=D.from,y[C]=D.to,x[C]=[],x[C].real=!0,_=0,S=m[C].length;_<S;_++)for(x[C][_]=[m[C][_][0]],A=1,N=m[C][_].length;A<N;A++)x[C][_][A]=(y[C][_][A]-m[C][_][A])/v;else{var M=r.matrix||new p,R={_:{transform:z.transform},getBBox:function(){return r.getBBox(1)}};m[C]=[M.a,M.b,M.c,M.d,M.e,M.f],Rt(R,y[C]),y[C]=R._.transform,x[C]=[(R.matrix.a-M.a)/v,(R.matrix.b-M.b)/v,(R.matrix.c-M.c)/v,(R.matrix.d-M.d)/v,(R.matrix.e-M.e)/v,(R.matrix.f-M.f)/v]}break;case"csv":var W=I(l[C])[L](b),O=I(m[C])[L](b);if("clip-rect"==C)for(m[C]=O,x[C]=[],_=O.length;_--;)x[C][_]=(W[_]-m[C][_])/v;y[C]=W;break;default:for(W=[][P](l[C]),O=[][P](m[C]),x[C]=[],_=r.paper.customAttributes[C].length;_--;)x[C][_]=((W[_]||0)-(O[_]||0))/v}var F=l.easing,$=i.easing_formulas[F];if(!$)if(($=I(F).match(X))&&5==$.length){var V=$;$=function(t){return f(t,+V[1],+V[2],+V[3],+V[4],v)}}else $=ct;if(g=l.start||t.start||+new Date,w={anim:t,percent:n,timestamp:g,start:g+(t.del||0),status:0,initstatus:s||0,stop:!1,ms:v,easing:$,from:m,diff:x,to:y,el:r,callback:l.callback,prev:d,next:u,repeat:o||t.times,origin:r.attr(),totalOrigin:a},se.push(w),s&&!c&&!h&&(w.stop=!0,w.start=new Date-v*s,1==se.length))return oe();h&&(w.start=new Date-w.ms*s),1==se.length&&ae(oe)}e("raphael.anim.start."+r.id,r,t)}}function m(t){for(var e=0;e<se.length;e++)se[e].el.paper==t&&se.splice(e--,1)}i.version="2.1.2",i.eve=e;var y,x,b=/[, ]+/,w={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},_=/\{(\d+)\}/g,k="hasOwnProperty",S={doc:document,win:t},C={was:Object.prototype[k].call(S.win,"Raphael"),is:S.win.Raphael},T=function(){this.ca=this.customAttributes={}},E="apply",P="concat",B="ontouchstart"in S.win||S.win.DocumentTouch&&S.doc instanceof DocumentTouch,A=" ",I=String,L="split",N="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[L](A),z={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},D=I.prototype.toLowerCase,M=Math,R=M.max,W=M.min,O=M.abs,F=M.pow,$=M.PI,q="number",V="string",H="array",G=Object.prototype.toString,Y=(i._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),j={NaN:1,Infinity:1,"-Infinity":1},X=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,U=M.round,Z=parseFloat,Q=parseInt,K=I.prototype.toUpperCase,J=i._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},tt=i._availableAnimAttrs={blur:q,"clip-rect":"csv",cx:q,cy:q,fill:"colour","fill-opacity":q,"font-size":q,height:q,opacity:q,path:"path",r:q,rx:q,ry:q,stroke:"colour","stroke-opacity":q,"stroke-width":q,transform:"transform",width:q,x:q,y:q},et=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,it={hs:1,rg:1},rt=/,?([achlmqrstvxz]),?/gi,nt=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,st=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,at=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,ot=(i._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),lt=function(t,e){return Z(t)-Z(e)},ct=function(t){return t},ht=i._rectPath=function(t,e,i,r,n){return n?[["M",t+n,e],["l",i-2*n,0],["a",n,n,0,0,1,n,n],["l",0,r-2*n],["a",n,n,0,0,1,-n,n],["l",2*n-i,0],["a",n,n,0,0,1,-n,-n],["l",0,2*n-r],["a",n,n,0,0,1,n,-n],["z"]]:[["M",t,e],["l",i,0],["l",0,r],["l",-i,0],["z"]]},ut=function(t,e,i,r){return null==r&&(r=i),[["M",t,e],["m",0,-r],["a",i,r,0,1,1,0,2*r],["a",i,r,0,1,1,0,-2*r],["z"]]},pt=i._getPath={path:function(t){return t.attr("path")},circle:function(t){var e=t.attrs;return ut(e.cx,e.cy,e.r)},ellipse:function(t){var e=t.attrs;return ut(e.cx,e.cy,e.rx,e.ry)},rect:function(t){var e=t.attrs;return ht(e.x,e.y,e.width,e.height,e.r)},image:function(t){var e=t.attrs;return ht(e.x,e.y,e.width,e.height)},text:function(t){var e=t._getBBox();return ht(e.x,e.y,e.width,e.height)},set:function(t){var e=t._getBBox();return ht(e.x,e.y,e.width,e.height)}},dt=i.mapPath=function(t,e){if(!e)return t;var i,r,n,s,a,o,l;for(t=zt(t),n=0,a=t.length;n<a;n++)for(l=t[n],s=1,o=l.length;s<o;s+=2)i=e.x(l[s],l[s+1]),r=e.y(l[s],l[s+1]),l[s]=i,l[s+1]=r;return t};if(i._g=S,i.type=S.win.SVGAngle||S.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==i.type){var ft,gt=S.doc.createElement("div");if(gt.innerHTML='<v:shape adj="1"/>',(ft=gt.firstChild).style.behavior="url(#default#VML)",!ft||"object"!=typeof ft.adj)return i.type="";gt=null}i.svg=!(i.vml="VML"==i.type),i._Paper=T,i.fn=x=T.prototype=i.prototype,i._id=0,i._oid=0,i.is=function(t,e){return"finite"==(e=D.call(e))?!j[k](+t):"array"==e?t instanceof Array:"null"==e&&null===t||e==typeof t&&null!==t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||G.call(t).slice(8,-1).toLowerCase()==e},i.angle=function(t,e,r,n,s,a){if(null==s){var o=t-r,l=e-n;return o||l?(180+180*M.atan2(-l,-o)/$+360)%360:0}return i.angle(t,e,s,a)-i.angle(r,n,s,a)},i.rad=function(t){return t%360*$/180},i.deg=function(t){return 180*t/$%360},i.snapTo=function(t,e,r){if(r=i.is(r,"finite")?r:10,i.is(t,H)){for(var n=t.length;n--;)if(O(t[n]-e)<=r)return t[n]}else{var s=e%(t=+t);if(s<r)return e-s;if(s>t-r)return e-s+t}return e};i.createUUID=(vt=/[xy]/g,mt=function(t){var e=16*M.random()|0,i="x"==t?e:3&e|8;return i.toString(16)},function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(vt,mt).toUpperCase()});var vt,mt;i.setWindow=function(t){e("raphael.setWindow",i,S.win,t),S.win=t,S.doc=S.win.document,i._engine.initWin&&i._engine.initWin(S.win)};var yt=function(t){if(i.vml){var e,r=/^\s+|\s+$/g;try{var s=new ActiveXObject("htmlfile");s.write("<body>"),s.close(),e=s.body}catch(t){e=createPopup().document.body}var a=e.createTextRange();yt=n(function(t){try{e.style.color=I(t).replace(r,"");var i=a.queryCommandValue("ForeColor");return"#"+("000000"+(i=(255&i)<<16|65280&i|(16711680&i)>>>16).toString(16)).slice(-6)}catch(t){return"none"}})}else{var o=S.doc.createElement("i");o.title="Raphaël Colour Picker",o.style.display="none",S.doc.body.appendChild(o),yt=n(function(t){return o.style.color=t,S.doc.defaultView.getComputedStyle(o,"").getPropertyValue("color")})}return yt(t)},xt=function(){return"hsb("+[this.h,this.s,this.b]+")"},bt=function(){return"hsl("+[this.h,this.s,this.l]+")"},wt=function(){return this.hex},_t=function(t,e,r){if(null==e&&i.is(t,"object")&&"r"in t&&"g"in t&&"b"in t&&(r=t.b,e=t.g,t=t.r),null==e&&i.is(t,V)){var n=i.getRGB(t);t=n.r,e=n.g,r=n.b}return(t>1||e>1||r>1)&&(t/=255,e/=255,r/=255),[t,e,r]},kt=function(t,e,r,n){var s={r:t*=255,g:e*=255,b:r*=255,hex:i.rgb(t,e,r),toString:wt};return i.is(n,"finite")&&(s.opacity=n),s};i.color=function(t){var e;return i.is(t,"object")&&"h"in t&&"s"in t&&"b"in t?(e=i.hsb2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.hex=e.hex):i.is(t,"object")&&"h"in t&&"s"in t&&"l"in t?(e=i.hsl2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.hex=e.hex):(i.is(t,"string")&&(t=i.getRGB(t)),i.is(t,"object")&&"r"in t&&"g"in t&&"b"in t?(e=i.rgb2hsl(t),t.h=e.h,t.s=e.s,t.l=e.l,e=i.rgb2hsb(t),t.v=e.b):(t={hex:"none"}).r=t.g=t.b=t.h=t.s=t.v=t.l=-1),t.toString=wt,t},i.hsb2rgb=function(t,e,i,r){var n,s,a,o,l;return this.is(t,"object")&&"h"in t&&"s"in t&&"b"in t&&(i=t.b,e=t.s,t=t.h,r=t.o),o=(l=i*e)*(1-O((t=(t*=360)%360/60)%2-1)),n=s=a=i-l,kt(n+=[l,o,0,0,o,l][t=~~t],s+=[o,l,l,o,0,0][t],a+=[0,0,o,l,l,o][t],r)},i.hsl2rgb=function(t,e,i,r){var n,s,a,o,l;return this.is(t,"object")&&"h"in t&&"s"in t&&"l"in t&&(i=t.l,e=t.s,t=t.h),(t>1||e>1||i>1)&&(t/=360,e/=100,i/=100),o=(l=2*e*(i<.5?i:1-i))*(1-O((t=(t*=360)%360/60)%2-1)),n=s=a=i-l/2,kt(n+=[l,o,0,0,o,l][t=~~t],s+=[o,l,l,o,0,0][t],a+=[0,0,o,l,l,o][t],r)},i.rgb2hsb=function(t,e,i){var r,n;return i=_t(t,e,i),t=i[0],e=i[1],i=i[2],r=R(t,e,i),n=r-W(t,e,i),{h:((0==n?null:r==t?(e-i)/n:r==e?(i-t)/n+2:(t-e)/n+4)+360)%6*60/360,s:0==n?0:n/r,b:r,toString:xt}},i.rgb2hsl=function(t,e,i){var r,n,s,a;return i=_t(t,e,i),t=i[0],e=i[1],i=i[2],n=R(t,e,i),s=W(t,e,i),r=(n+s)/2,{h:((0==(a=n-s)?null:n==t?(e-i)/a:n==e?(i-t)/a+2:(t-e)/a+4)+360)%6*60/360,s:0==a?0:r<.5?a/(2*r):a/(2-2*r),l:r,toString:bt}},i._path2string=function(){return this.join(",").replace(rt,"$1")};i._preload=function(t,e){var i=S.doc.createElement("img");i.style.cssText="position:absolute;left:-9999em;top:-9999em",i.onload=function(){e.call(this),this.onload=null,S.doc.body.removeChild(this)},i.onerror=function(){S.doc.body.removeChild(this)},S.doc.body.appendChild(i),i.src=t};i.getRGB=n(function(t){if(!t||(t=I(t)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:s};if("none"==t)return{r:-1,g:-1,b:-1,hex:"none",toString:s};!it[k](t.toLowerCase().substring(0,2))&&"#"!=t.charAt()&&(t=yt(t));var e,r,n,a,o,l,c=t.match(Y);return c?(c[2]&&(n=Q(c[2].substring(5),16),r=Q(c[2].substring(3,5),16),e=Q(c[2].substring(1,3),16)),c[3]&&(n=Q((o=c[3].charAt(3))+o,16),r=Q((o=c[3].charAt(2))+o,16),e=Q((o=c[3].charAt(1))+o,16)),c[4]&&(l=c[4][L](et),e=Z(l[0]),"%"==l[0].slice(-1)&&(e*=2.55),r=Z(l[1]),"%"==l[1].slice(-1)&&(r*=2.55),n=Z(l[2]),"%"==l[2].slice(-1)&&(n*=2.55),"rgba"==c[1].toLowerCase().slice(0,4)&&(a=Z(l[3])),l[3]&&"%"==l[3].slice(-1)&&(a/=100)),c[5]?(l=c[5][L](et),e=Z(l[0]),"%"==l[0].slice(-1)&&(e*=2.55),r=Z(l[1]),"%"==l[1].slice(-1)&&(r*=2.55),n=Z(l[2]),"%"==l[2].slice(-1)&&(n*=2.55),("deg"==l[0].slice(-3)||"°"==l[0].slice(-1))&&(e/=360),"hsba"==c[1].toLowerCase().slice(0,4)&&(a=Z(l[3])),l[3]&&"%"==l[3].slice(-1)&&(a/=100),i.hsb2rgb(e,r,n,a)):c[6]?(l=c[6][L](et),e=Z(l[0]),"%"==l[0].slice(-1)&&(e*=2.55),r=Z(l[1]),"%"==l[1].slice(-1)&&(r*=2.55),n=Z(l[2]),"%"==l[2].slice(-1)&&(n*=2.55),("deg"==l[0].slice(-3)||"°"==l[0].slice(-1))&&(e/=360),"hsla"==c[1].toLowerCase().slice(0,4)&&(a=Z(l[3])),l[3]&&"%"==l[3].slice(-1)&&(a/=100),i.hsl2rgb(e,r,n,a)):((c={r:e,g:r,b:n,toString:s}).hex="#"+(16777216|n|r<<8|e<<16).toString(16).slice(1),i.is(a,"finite")&&(c.opacity=a),c)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:s}},i),i.hsb=n(function(t,e,r){return i.hsb2rgb(t,e,r).hex}),i.hsl=n(function(t,e,r){return i.hsl2rgb(t,e,r).hex}),i.rgb=n(function(t,e,i){return"#"+(16777216|i|e<<8|t<<16).toString(16).slice(1)}),i.getColor=function(t){var e=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},i=this.hsb2rgb(e.h,e.s,e.b);return e.h+=.075,e.h>1&&(e.h=0,e.s-=.2,e.s<=0&&(this.getColor.start={h:0,s:1,b:e.b})),i.hex},i.getColor.reset=function(){delete this.start},i.parsePathString=function(t){if(!t)return null;var e=St(t);if(e.arr)return Tt(e.arr);var r={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},n=[];return i.is(t,H)&&i.is(t[0],H)&&(n=Tt(t)),n.length||I(t).replace(nt,function(t,e,i){var s=[],a=e.toLowerCase();if(i.replace(at,function(t,e){e&&s.push(+e)}),"m"==a&&s.length>2&&(n.push([e][P](s.splice(0,2))),a="l",e="m"==e?"l":"L"),"r"==a)n.push([e][P](s));else for(;s.length>=r[a]&&(n.push([e][P](s.splice(0,r[a]))),r[a]););}),n.toString=i._path2string,e.arr=Tt(n),n},i.parseTransformString=n(function(t){if(!t)return null;var e=[];return i.is(t,H)&&i.is(t[0],H)&&(e=Tt(t)),e.length||I(t).replace(st,function(t,i,r){var n=[];D.call(i);r.replace(at,function(t,e){e&&n.push(+e)}),e.push([i][P](n))}),e.toString=i._path2string,e});var St=function(t){var e=St.ps=St.ps||{};return e[t]?e[t].sleep=100:e[t]={sleep:100},setTimeout(function(){for(var i in e)e[k](i)&&i!=t&&(e[i].sleep--,!e[i].sleep&&delete e[i])}),e[t]};i.findDotsAtSegment=function(t,e,i,r,n,s,a,o,l){var c=1-l,h=F(c,3),u=F(c,2),p=l*l,d=p*l,f=h*t+3*u*l*i+3*c*l*l*n+d*a,g=h*e+3*u*l*r+3*c*l*l*s+d*o,v=t+2*l*(i-t)+p*(n-2*i+t),m=e+2*l*(r-e)+p*(s-2*r+e),y=i+2*l*(n-i)+p*(a-2*n+i),x=r+2*l*(s-r)+p*(o-2*s+r),b=c*t+l*i,w=c*e+l*r,_=c*n+l*a,k=c*s+l*o,S=90-180*M.atan2(v-y,m-x)/$;return(v>y||m<x)&&(S+=180),{x:f,y:g,m:{x:v,y:m},n:{x:y,y:x},start:{x:b,y:w},end:{x:_,y:k},alpha:S}},i.bezierBBox=function(t,e,r,n,s,a,o,l){i.is(t,"array")||(t=[t,e,r,n,s,a,o,l]);var c=Nt.apply(null,t);return{x:c.min.x,y:c.min.y,x2:c.max.x,y2:c.max.y,width:c.max.x-c.min.x,height:c.max.y-c.min.y}},i.isPointInsideBBox=function(t,e,i){return e>=t.x&&e<=t.x2&&i>=t.y&&i<=t.y2},i.isBBoxIntersect=function(t,e){var r=i.isPointInsideBBox;return r(e,t.x,t.y)||r(e,t.x2,t.y)||r(e,t.x,t.y2)||r(e,t.x2,t.y2)||r(t,e.x,e.y)||r(t,e.x2,e.y)||r(t,e.x,e.y2)||r(t,e.x2,e.y2)||(t.x<e.x2&&t.x>e.x||e.x<t.x2&&e.x>t.x)&&(t.y<e.y2&&t.y>e.y||e.y<t.y2&&e.y>t.y)},i.pathIntersection=function(t,e){return u(t,e)},i.pathIntersectionNumber=function(t,e){return u(t,e,1)},i.isPointInsidePath=function(t,e,r){var n=i.pathBBox(t);return i.isPointInsideBBox(n,e,r)&&u(t,[["M",e,r],["H",n.x2+10]],1)%2==1},i._removedFactory=function(t){return function(){e("raphael.log",null,"Raphaël: you are calling to method “"+t+"” of removed object",t)}};var Ct=i.pathBBox=function(t){var e=St(t);if(e.bbox)return r(e.bbox);if(!t)return{x:0,y:0,width:0,height:0,x2:0,y2:0};t=zt(t);for(var i,n=0,s=0,a=[],o=[],l=0,c=t.length;l<c;l++)if("M"==(i=t[l])[0])n=i[1],s=i[2],a.push(n),o.push(s);else{var h=Nt(n,s,i[1],i[2],i[3],i[4],i[5],i[6]);a=a[P](h.min.x,h.max.x),o=o[P](h.min.y,h.max.y),n=i[5],s=i[6]}var u=W[E](0,a),p=W[E](0,o),d=R[E](0,a),f=R[E](0,o),g=d-u,v=f-p,m={x:u,y:p,x2:d,y2:f,width:g,height:v,cx:u+g/2,cy:p+v/2};return e.bbox=r(m),m},Tt=function(t){var e=r(t);return e.toString=i._path2string,e},Et=i._pathToRelative=function(t){var e=St(t);if(e.rel)return Tt(e.rel);i.is(t,H)&&i.is(t&&t[0],H)||(t=i.parsePathString(t));var r=[],n=0,s=0,a=0,o=0,l=0;"M"==t[0][0]&&(n=t[0][1],s=t[0][2],a=n,o=s,l++,r.push(["M",n,s]));for(var c=l,h=t.length;c<h;c++){var u=r[c]=[],p=t[c];if(p[0]!=D.call(p[0]))switch(u[0]=D.call(p[0]),u[0]){case"a":u[1]=p[1],u[2]=p[2],u[3]=p[3],u[4]=p[4],u[5]=p[5],u[6]=+(p[6]-n).toFixed(3),u[7]=+(p[7]-s).toFixed(3);break;case"v":u[1]=+(p[1]-s).toFixed(3);break;case"m":a=p[1],o=p[2];default:for(var d=1,f=p.length;d<f;d++)u[d]=+(p[d]-(d%2?n:s)).toFixed(3)}else{u=r[c]=[],"m"==p[0]&&(a=p[1]+n,o=p[2]+s);for(var g=0,v=p.length;g<v;g++)r[c][g]=p[g]}var m=r[c].length;switch(r[c][0]){case"z":n=a,s=o;break;case"h":n+=+r[c][m-1];break;case"v":s+=+r[c][m-1];break;default:n+=+r[c][m-2],s+=+r[c][m-1]}}return r.toString=i._path2string,e.rel=Tt(r),r},Pt=i._pathToAbsolute=function(t){var e=St(t);if(e.abs)return Tt(e.abs);if(i.is(t,H)&&i.is(t&&t[0],H)||(t=i.parsePathString(t)),!t||!t.length)return[["M",0,0]];var r=[],n=0,s=0,o=0,l=0,c=0;"M"==t[0][0]&&(n=+t[0][1],s=+t[0][2],o=n,l=s,c++,r[0]=["M",n,s]);for(var h,u,p=3==t.length&&"M"==t[0][0]&&"R"==t[1][0].toUpperCase()&&"Z"==t[2][0].toUpperCase(),d=c,f=t.length;d<f;d++){if(r.push(h=[]),(u=t[d])[0]!=K.call(u[0]))switch(h[0]=K.call(u[0]),h[0]){case"A":h[1]=u[1],h[2]=u[2],h[3]=u[3],h[4]=u[4],h[5]=u[5],h[6]=+(u[6]+n),h[7]=+(u[7]+s);break;case"V":h[1]=+u[1]+s;break;case"H":h[1]=+u[1]+n;break;case"R":for(var g=[n,s][P](u.slice(1)),v=2,m=g.length;v<m;v++)g[v]=+g[v]+n,g[++v]=+g[v]+s;r.pop(),r=r[P](a(g,p));break;case"M":o=+u[1]+n,l=+u[2]+s;default:for(v=1,m=u.length;v<m;v++)h[v]=+u[v]+(v%2?n:s)}else if("R"==u[0])g=[n,s][P](u.slice(1)),r.pop(),r=r[P](a(g,p)),h=["R"][P](u.slice(-2));else for(var y=0,x=u.length;y<x;y++)h[y]=u[y];switch(h[0]){case"Z":n=o,s=l;break;case"H":n=h[1];break;case"V":s=h[1];break;case"M":o=h[h.length-2],l=h[h.length-1];default:n=h[h.length-2],s=h[h.length-1]}}return r.toString=i._path2string,e.abs=Tt(r),r},Bt=function(t,e,i,r){return[t,e,i,r,i,r]},At=function(t,e,i,r,n,s){return[1/3*t+2/3*i,1/3*e+2/3*r,1/3*n+2/3*i,1/3*s+2/3*r,n,s]},It=function(t,e,i,r,s,a,o,l,c,h){var u,p=120*$/180,d=$/180*(+s||0),f=[],g=n(function(t,e,i){var r=t*M.cos(i)-e*M.sin(i),n=t*M.sin(i)+e*M.cos(i);return{x:r,y:n}});if(h)S=h[0],C=h[1],_=h[2],k=h[3];else{u=g(t,e,-d),t=u.x,e=u.y,u=g(l,c,-d),l=u.x,c=u.y;M.cos($/180*s),M.sin($/180*s);var v=(t-l)/2,m=(e-c)/2,y=v*v/(i*i)+m*m/(r*r);y>1&&(y=M.sqrt(y),i*=y,r*=y);var x=i*i,b=r*r,w=(a==o?-1:1)*M.sqrt(O((x*b-x*m*m-b*v*v)/(x*m*m+b*v*v))),_=w*i*m/r+(t+l)/2,k=w*-r*v/i+(e+c)/2,S=M.asin(((e-k)/r).toFixed(9)),C=M.asin(((c-k)/r).toFixed(9));(S=t<_?$-S:S)<0&&(S=2*$+S),(C=l<_?$-C:C)<0&&(C=2*$+C),o&&S>C&&(S-=2*$),!o&&C>S&&(C-=2*$)}var T=C-S;if(O(T)>p){var E=C,B=l,A=c;C=S+p*(o&&C>S?1:-1),l=_+i*M.cos(C),c=k+r*M.sin(C),f=It(l,c,i,r,s,0,o,B,A,[C,E,_,k])}T=C-S;var I=M.cos(S),N=M.sin(S),z=M.cos(C),D=M.sin(C),R=M.tan(T/4),W=4/3*i*R,F=4/3*r*R,q=[t,e],V=[t+W*N,e-F*I],H=[l+W*D,c-F*z],G=[l,c];if(V[0]=2*q[0]-V[0],V[1]=2*q[1]-V[1],h)return[V,H,G][P](f);f=[V,H,G][P](f).join()[L](",");for(var Y=[],j=0,X=f.length;j<X;j++)Y[j]=j%2?g(f[j-1],f[j],d).y:g(f[j],f[j+1],d).x;return Y},Lt=function(t,e,i,r,n,s,a,o,l){var c=1-l;return{x:F(c,3)*t+3*F(c,2)*l*i+3*c*l*l*n+F(l,3)*a,y:F(c,3)*e+3*F(c,2)*l*r+3*c*l*l*s+F(l,3)*o}},Nt=n(function(t,e,i,r,n,s,a,o){var l,c=n-2*i+t-(a-2*n+i),h=2*(i-t)-2*(n-i),u=t-i,p=(-h+M.sqrt(h*h-4*c*u))/2/c,d=(-h-M.sqrt(h*h-4*c*u))/2/c,f=[e,o],g=[t,a];return O(p)>"1e12"&&(p=.5),O(d)>"1e12"&&(d=.5),p>0&&p<1&&(l=Lt(t,e,i,r,n,s,a,o,p),g.push(l.x),f.push(l.y)),d>0&&d<1&&(l=Lt(t,e,i,r,n,s,a,o,d),g.push(l.x),f.push(l.y)),c=s-2*r+e-(o-2*s+r),u=e-r,p=(-(h=2*(r-e)-2*(s-r))+M.sqrt(h*h-4*c*u))/2/c,d=(-h-M.sqrt(h*h-4*c*u))/2/c,O(p)>"1e12"&&(p=.5),O(d)>"1e12"&&(d=.5),p>0&&p<1&&(l=Lt(t,e,i,r,n,s,a,o,p),g.push(l.x),f.push(l.y)),d>0&&d<1&&(l=Lt(t,e,i,r,n,s,a,o,d),g.push(l.x),f.push(l.y)),{min:{x:W[E](0,g),y:W[E](0,f)},max:{x:R[E](0,g),y:R[E](0,f)}}}),zt=i._path2curve=n(function(t,e){var i=!e&&St(t);if(!e&&i.curve)return Tt(i.curve);for(var r=Pt(t),n=e&&Pt(e),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},o=function(t,e,i){var r,n;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][P](It[E](0,[e.x,e.y][P](t.slice(1))));break;case"S":"C"==i||"S"==i?(r=2*e.x-e.bx,n=2*e.y-e.by):(r=e.x,n=e.y),t=["C",r,n][P](t.slice(1));break;case"T":"Q"==i||"T"==i?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"][P](At(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][P](At(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][P](Bt(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][P](Bt(e.x,e.y,t[1],e.y));break;case"V":t=["C"][P](Bt(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][P](Bt(e.x,e.y,e.X,e.Y))}return t},l=function(t,e){if(t[e].length>7){t[e].shift();for(var i=t[e];i.length;)t.splice(e++,0,["C"][P](i.splice(0,6)));t.splice(e,1),u=R(r.length,n&&n.length||0)}},c=function(t,e,i,s,a){t&&e&&"M"==t[a][0]&&"M"!=e[a][0]&&(e.splice(a,0,["M",s.x,s.y]),i.bx=0,i.by=0,i.x=t[a][1],i.y=t[a][2],u=R(r.length,n&&n.length||0))},h=0,u=R(r.length,n&&n.length||0);h<u;h++){r[h]=o(r[h],s),l(r,h),n&&(n[h]=o(n[h],a)),n&&l(n,h),c(r,n,s,a,h),c(n,r,a,s,h);var p=r[h],d=n&&n[h],f=p.length,g=n&&d.length;s.x=p[f-2],s.y=p[f-1],s.bx=Z(p[f-4])||s.x,s.by=Z(p[f-3])||s.y,a.bx=n&&(Z(d[g-4])||a.x),a.by=n&&(Z(d[g-3])||a.y),a.x=n&&d[g-2],a.y=n&&d[g-1]}return n||(i.curve=Tt(r)),n?[r,n]:r},null,Tt),Dt=(i._parseDots=n(function(t){for(var e=[],r=0,n=t.length;r<n;r++){var s={},a=t[r].match(/^([^:]*):?([\d\.]*)/);if(s.color=i.getRGB(a[1]),s.color.error)return null;s.color=s.color.hex,a[2]&&(s.offset=a[2]+"%"),e.push(s)}for(r=1,n=e.length-1;r<n;r++)if(!e[r].offset){for(var o=Z(e[r-1].offset||0),l=0,c=r+1;c<n;c++)if(e[c].offset){l=e[c].offset;break}l||(l=100,c=n);for(var h=((l=Z(l))-o)/(c-r+1);r<c;r++)o+=h,e[r].offset=o+"%"}return e}),i._tear=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)}),Mt=(i._tofront=function(t,e){e.top!==t&&(Dt(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},i._toback=function(t,e){e.bottom!==t&&(Dt(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},i._insertafter=function(t,e,i){Dt(t,i),e==i.top&&(i.top=t),e.next&&(e.next.prev=t),t.next=e.next,t.prev=e,e.next=t},i._insertbefore=function(t,e,i){Dt(t,i),e==i.bottom&&(i.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,e.prev=t,t.next=e},i.toMatrix=function(t,e){var i=Ct(t),r={_:{transform:""},getBBox:function(){return i}};return Rt(r,e),r.matrix}),Rt=(i.transformPath=function(t,e){return dt(t,Mt(t,e))},i._extractTransform=function(t,e){if(null==e)return t._.transform;e=I(e).replace(/\.{3}|\u2026/g,t._.transform||"");var r=i.parseTransformString(e),n=0,s=0,a=0,o=1,l=1,c=t._,h=new p;if(c.transform=r||[],r)for(var u=0,d=r.length;u<d;u++){var f,g,v,m,y,x=r[u],b=x.length,w=I(x[0]).toLowerCase(),_=x[0]!=w,k=_?h.invert():0;"t"==w&&3==b?_?(f=k.x(0,0),g=k.y(0,0),v=k.x(x[1],x[2]),m=k.y(x[1],x[2]),h.translate(v-f,m-g)):h.translate(x[1],x[2]):"r"==w?2==b?(y=y||t.getBBox(1),h.rotate(x[1],y.x+y.width/2,y.y+y.height/2),n+=x[1]):4==b&&(_?(v=k.x(x[2],x[3]),m=k.y(x[2],x[3]),h.rotate(x[1],v,m)):h.rotate(x[1],x[2],x[3]),n+=x[1]):"s"==w?2==b||3==b?(y=y||t.getBBox(1),h.scale(x[1],x[b-1],y.x+y.width/2,y.y+y.height/2),o*=x[1],l*=x[b-1]):5==b&&(_?(v=k.x(x[3],x[4]),m=k.y(x[3],x[4]),h.scale(x[1],x[2],v,m)):h.scale(x[1],x[2],x[3],x[4]),o*=x[1],l*=x[2]):"m"==w&&7==b&&h.add(x[1],x[2],x[3],x[4],x[5],x[6]),c.dirtyT=1,t.matrix=h}t.matrix=h,c.sx=o,c.sy=l,c.deg=n,c.dx=s=h.e,c.dy=a=h.f,1==o&&1==l&&!n&&c.bbox?(c.bbox.x+=+s,c.bbox.y+=+a):c.dirtyT=1}),Wt=function(t){var e=t[0];switch(e.toLowerCase()){case"t":return[e,0,0];case"m":return[e,1,0,0,1,0,0];case"r":return 4==t.length?[e,0,t[2],t[3]]:[e,0];case"s":return 5==t.length?[e,1,1,t[3],t[4]]:3==t.length?[e,1,1]:[e,1]}},Ot=i._equaliseTransform=function(t,e){e=I(e).replace(/\.{3}|\u2026/g,t),t=i.parseTransformString(t)||[],e=i.parseTransformString(e)||[];for(var r,n,s,a,o=R(t.length,e.length),l=[],c=[],h=0;h<o;h++){if(s=t[h]||Wt(e[h]),a=e[h]||Wt(s),s[0]!=a[0]||"r"==s[0].toLowerCase()&&(s[2]!=a[2]||s[3]!=a[3])||"s"==s[0].toLowerCase()&&(s[3]!=a[3]||s[4]!=a[4]))return;for(l[h]=[],c[h]=[],r=0,n=R(s.length,a.length);r<n;r++)r in s&&(l[h][r]=s[r]),r in a&&(c[h][r]=a[r])}return{from:l,to:c}};i._getContainer=function(t,e,r,n){var s;if(null!=(s=null!=n||i.is(t,"object")?t:S.doc.getElementById(t)))return s.tagName?null==e?{container:s,width:s.style.pixelWidth||s.offsetWidth,height:s.style.pixelHeight||s.offsetHeight}:{container:s,width:e,height:r}:{container:1,x:t,y:e,width:r,height:n}},i.pathToRelative=Et,i._engine={},i.path2curve=zt,i.matrix=function(t,e,i,r,n,s){return new p(t,e,i,r,n,s)},function(t){function e(t){return t[0]*t[0]+t[1]*t[1]}function r(t){var i=M.sqrt(e(t));t[0]&&(t[0]/=i),t[1]&&(t[1]/=i)}t.add=function(t,e,i,r,n,s){var a,o,l,c,h=[[],[],[]],u=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],d=[[t,i,n],[e,r,s],[0,0,1]];for(t&&t instanceof p&&(d=[[t.a,t.c,t.e],[t.b,t.d,t.f],[0,0,1]]),a=0;a<3;a++)for(o=0;o<3;o++){for(c=0,l=0;l<3;l++)c+=u[a][l]*d[l][o];h[a][o]=c}this.a=h[0][0],this.b=h[1][0],this.c=h[0][1],this.d=h[1][1],this.e=h[0][2],this.f=h[1][2]},t.invert=function(){var t=this,e=t.a*t.d-t.b*t.c;return new p(t.d/e,-t.b/e,-t.c/e,t.a/e,(t.c*t.f-t.d*t.e)/e,(t.b*t.e-t.a*t.f)/e)},t.clone=function(){return new p(this.a,this.b,this.c,this.d,this.e,this.f)},t.translate=function(t,e){this.add(1,0,0,1,t,e)},t.scale=function(t,e,i,r){null==e&&(e=t),(i||r)&&this.add(1,0,0,1,i,r),this.add(t,0,0,e,0,0),(i||r)&&this.add(1,0,0,1,-i,-r)},t.rotate=function(t,e,r){t=i.rad(t),e=e||0,r=r||0;var n=+M.cos(t).toFixed(9),s=+M.sin(t).toFixed(9);this.add(n,s,-s,n,e,r),this.add(1,0,0,1,-e,-r)},t.x=function(t,e){return t*this.a+e*this.c+this.e},t.y=function(t,e){return t*this.b+e*this.d+this.f},t.get=function(t){return+this[I.fromCharCode(97+t)].toFixed(4)},t.toString=function(){return i.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},t.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},t.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},t.split=function(){var t={};t.dx=this.e,t.dy=this.f;var n=[[this.a,this.c],[this.b,this.d]];t.scalex=M.sqrt(e(n[0])),r(n[0]),t.shear=n[0][0]*n[1][0]+n[0][1]*n[1][1],n[1]=[n[1][0]-n[0][0]*t.shear,n[1][1]-n[0][1]*t.shear],t.scaley=M.sqrt(e(n[1])),r(n[1]),t.shear/=t.scaley;var s=-n[0][1],a=n[1][1];return a<0?(t.rotate=i.deg(M.acos(a)),s<0&&(t.rotate=360-t.rotate)):t.rotate=i.deg(M.asin(s)),t.isSimple=!(+t.shear.toFixed(9)||t.scalex.toFixed(9)!=t.scaley.toFixed(9)&&t.rotate),t.isSuperSimple=!+t.shear.toFixed(9)&&t.scalex.toFixed(9)==t.scaley.toFixed(9)&&!t.rotate,t.noRotation=!+t.shear.toFixed(9)&&!t.rotate,t},t.toTransformString=function(t){var e=t||this[L]();return e.isSimple?(e.scalex=+e.scalex.toFixed(4),e.scaley=+e.scaley.toFixed(4),e.rotate=+e.rotate.toFixed(4),(e.dx||e.dy?"t"+[e.dx,e.dy]:"")+(1!=e.scalex||1!=e.scaley?"s"+[e.scalex,e.scaley,0,0]:"")+(e.rotate?"r"+[e.rotate,0,0]:"")):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(p.prototype);var Ft=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);"Apple Computer, Inc."==navigator.vendor&&(Ft&&Ft[1]<4||"iP"==navigator.platform.slice(0,2))||"Google Inc."==navigator.vendor&&Ft&&Ft[1]<8?x.safari=function(){var t=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){t.remove()})}:x.safari=function(){};for(var $t=function(){this.returnValue=!1},qt=function(){return this.originalEvent.preventDefault()},Vt=function(){this.cancelBubble=!0},Ht=function(){return this.originalEvent.stopPropagation()},Gt=function(t){var e=S.doc.documentElement.scrollTop||S.doc.body.scrollTop,i=S.doc.documentElement.scrollLeft||S.doc.body.scrollLeft;return{x:t.clientX+i,y:t.clientY+e}},Yt=S.doc.addEventListener?function(t,e,i,r){var n=function(t){var e=Gt(t);return i.call(r,t,e.x,e.y)};return t.addEventListener(e,n,!1),B&&z[e]&&t.addEventListener(z[e],function(e){for(var n=Gt(e),s=e,a=0,o=e.targetTouches&&e.targetTouches.length;a<o;a++)if(e.targetTouches[a].target==t){(e=e.targetTouches[a]).originalEvent=s,e.preventDefault=qt,e.stopPropagation=Ht;break}return i.call(r,e,n.x,n.y)},!1),function(){return t.removeEventListener(e,n,!1),B&&z[e]&&t.removeEventListener(z[e],n,!1),!0}}:S.doc.attachEvent?function(t,e,i,r){var n=function(t){t=t||S.win.event;var e=S.doc.documentElement.scrollTop||S.doc.body.scrollTop,n=S.doc.documentElement.scrollLeft||S.doc.body.scrollLeft,s=t.clientX+n,a=t.clientY+e;return t.preventDefault=t.preventDefault||$t,t.stopPropagation=t.stopPropagation||Vt,i.call(r,t,s,a)};return t.attachEvent("on"+e,n),function(){return t.detachEvent("on"+e,n),!0}}:void 0,jt=[],Xt=function(t){for(var i,r=t.clientX,n=t.clientY,s=S.doc.documentElement.scrollTop||S.doc.body.scrollTop,a=S.doc.documentElement.scrollLeft||S.doc.body.scrollLeft,o=jt.length;o--;){if(i=jt[o],B&&t.touches){for(var l,c=t.touches.length;c--;)if((l=t.touches[c]).identifier==i.el._drag.id){r=l.clientX,n=l.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();var h,u=i.el.node,p=u.nextSibling,d=u.parentNode,f=u.style.display;S.win.opera&&d.removeChild(u),u.style.display="none",h=i.el.paper.getElementByPoint(r,n),u.style.display=f,S.win.opera&&(p?d.insertBefore(u,p):d.appendChild(u)),h&&e("raphael.drag.over."+i.el.id,i.el,h),r+=a,n+=s,e("raphael.drag.move."+i.el.id,i.move_scope||i.el,r-i.el._drag.x,n-i.el._drag.y,r,n,t)}},Ut=function(t){i.unmousemove(Xt).unmouseup(Ut);for(var r,n=jt.length;n--;)(r=jt[n]).el._drag={},e("raphael.drag.end."+r.el.id,r.end_scope||r.start_scope||r.move_scope||r.el,t);jt=[]},Zt=i.el={},Qt=N.length;Qt--;)!function(t){i[t]=Zt[t]=function(e,r){return i.is(e,"function")&&(this.events=this.events||[],this.events.push({name:t,f:e,unbind:Yt(this.shape||this.node||S.doc,t,e,r||this)})),this},i["un"+t]=Zt["un"+t]=function(e){for(var r=this.events||[],n=r.length;n--;)r[n].name!=t||!i.is(e,"undefined")&&r[n].f!=e||(r[n].unbind(),r.splice(n,1),!r.length&&delete this.events);return this}}(N[Qt]);Zt.data=function(t,r){var n=ot[this.id]=ot[this.id]||{};if(0==arguments.length)return n;if(1==arguments.length){if(i.is(t,"object")){for(var s in t)t[k](s)&&this.data(s,t[s]);return this}return e("raphael.data.get."+this.id,this,n[t],t),n[t]}return n[t]=r,e("raphael.data.set."+this.id,this,r,t),this},Zt.removeData=function(t){return null==t?ot[this.id]={}:ot[this.id]&&delete ot[this.id][t],this},Zt.getData=function(){return r(ot[this.id]||{})},Zt.hover=function(t,e,i,r){return this.mouseover(t,i).mouseout(e,r||i)},Zt.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)};var Kt=[];Zt.drag=function(t,r,n,s,a,o){function l(l){(l.originalEvent||l).preventDefault();var c=l.clientX,h=l.clientY,u=S.doc.documentElement.scrollTop||S.doc.body.scrollTop,p=S.doc.documentElement.scrollLeft||S.doc.body.scrollLeft;if(this._drag.id=l.identifier,B&&l.touches)for(var d,f=l.touches.length;f--;)if(d=l.touches[f],this._drag.id=d.identifier,d.identifier==this._drag.id){c=d.clientX,h=d.clientY;break}this._drag.x=c+p,this._drag.y=h+u,!jt.length&&i.mousemove(Xt).mouseup(Ut),jt.push({el:this,move_scope:s,start_scope:a,end_scope:o}),r&&e.on("raphael.drag.start."+this.id,r),t&&e.on("raphael.drag.move."+this.id,t),n&&e.on("raphael.drag.end."+this.id,n),e("raphael.drag.start."+this.id,a||s||this,l.clientX+p,l.clientY+u,l)}return this._drag={},Kt.push({el:this,start:l}),this.mousedown(l),this},Zt.onDragOver=function(t){t?e.on("raphael.drag.over."+this.id,t):e.unbind("raphael.drag.over."+this.id)},Zt.undrag=function(){for(var t=Kt.length;t--;)Kt[t].el==this&&(this.unmousedown(Kt[t].start),Kt.splice(t,1),e.unbind("raphael.drag.*."+this.id));!Kt.length&&i.unmousemove(Xt).unmouseup(Ut),jt=[]},x.circle=function(t,e,r){var n=i._engine.circle(this,t||0,e||0,r||0);return this.__set__&&this.__set__.push(n),n},x.rect=function(t,e,r,n,s){var a=i._engine.rect(this,t||0,e||0,r||0,n||0,s||0);return this.__set__&&this.__set__.push(a),a},x.ellipse=function(t,e,r,n){var s=i._engine.ellipse(this,t||0,e||0,r||0,n||0);return this.__set__&&this.__set__.push(s),s},x.path=function(t){t&&!i.is(t,V)&&!i.is(t[0],H)&&(t+="");var e=i._engine.path(i.format[E](i,arguments),this);return this.__set__&&this.__set__.push(e),e},x.image=function(t,e,r,n,s){var a=i._engine.image(this,t||"about:blank",e||0,r||0,n||0,s||0);return this.__set__&&this.__set__.push(a),a},x.text=function(t,e,r){var n=i._engine.text(this,t||0,e||0,I(r));return this.__set__&&this.__set__.push(n),n},x.set=function(t){!i.is(t,"array")&&(t=Array.prototype.splice.call(arguments,0,arguments.length));var e=new ce(t);return this.__set__&&this.__set__.push(e),e.paper=this,e.type="set",e},x.setStart=function(t){this.__set__=t||this.set()},x.setFinish=function(t){var e=this.__set__;return delete this.__set__,e},x.setSize=function(t,e){return i._engine.setSize.call(this,t,e)},x.setViewBox=function(t,e,r,n,s){return i._engine.setViewBox.call(this,t,e,r,n,s)},x.top=x.bottom=null,x.raphael=i;x.getElementByPoint=function(t,e){var i,r,n,s,a,o,l,c,h,u=this.canvas,p=S.doc.elementFromPoint(t,e);if(S.win.opera&&"svg"==p.tagName){var d=(r=(i=u).getBoundingClientRect(),n=i.ownerDocument,s=n.body,a=n.documentElement,o=a.clientTop||s.clientTop||0,l=a.clientLeft||s.clientLeft||0,c=r.top+(S.win.pageYOffset||a.scrollTop||s.scrollTop)-o,h=r.left+(S.win.pageXOffset||a.scrollLeft||s.scrollLeft)-l,{y:c,x:h}),f=u.createSVGRect();f.x=t-d.x,f.y=e-d.y,f.width=f.height=1;var g=u.getIntersectionList(f,null);g.length&&(p=g[g.length-1])}if(!p)return null;for(;p.parentNode&&p!=u.parentNode&&!p.raphael;)p=p.parentNode;return p==this.canvas.parentNode&&(p=u),p=p&&p.raphael?this.getById(p.raphaelid):null},x.getElementsByBBox=function(t){var e=this.set();return this.forEach(function(r){i.isBBoxIntersect(r.getBBox(),t)&&e.push(r)}),e},x.getById=function(t){for(var e=this.bottom;e;){if(e.id==t)return e;e=e.next}return null},x.forEach=function(t,e){for(var i=this.bottom;i;){if(!1===t.call(e,i))return this;i=i.next}return this},x.getElementsByPoint=function(t,e){var i=this.set();return this.forEach(function(r){r.isPointInside(t,e)&&i.push(r)}),i},Zt.isPointInside=function(t,e){var r=this.realPath=pt[this.type](this);return this.attr("transform")&&this.attr("transform").length&&(r=i.transformPath(r,this.attr("transform"))),i.isPointInsidePath(r,t,e)},Zt.getBBox=function(t){if(this.removed)return{};var e=this._;return t?(!e.dirty&&e.bboxwt||(this.realPath=pt[this.type](this),e.bboxwt=Ct(this.realPath),e.bboxwt.toString=d,e.dirty=0),e.bboxwt):((e.dirty||e.dirtyT||!e.bbox)&&(!e.dirty&&this.realPath||(e.bboxwt=0,this.realPath=pt[this.type](this)),e.bbox=Ct(dt(this.realPath,this.matrix)),e.bbox.toString=d,e.dirty=e.dirtyT=0),e.bbox)},Zt.clone=function(){if(this.removed)return null;var t=this.paper[this.type]().attr(this.attr());return this.__set__&&this.__set__.push(t),t},Zt.glow=function(t){if("text"==this.type)return null;var e={width:((t=t||{}).width||10)+(+this.attr("stroke-width")||1),fill:t.fill||!1,opacity:t.opacity||.5,offsetx:t.offsetx||0,offsety:t.offsety||0,color:t.color||"#000"},i=e.width/2,r=this.paper,n=r.set(),s=this.realPath||pt[this.type](this);s=this.matrix?dt(s,this.matrix):s;for(var a=1;a<i+1;a++)n.push(r.path(s).attr({stroke:e.color,fill:e.fill?e.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(e.width/i*a).toFixed(3),opacity:+(e.opacity/i).toFixed(3)}));return n.insertBefore(this).translate(e.offsetx,e.offsety)};var Jt=function(t,e,r,n,s,a,o,c,h){return null==h?l(t,e,r,n,s,a,o,c):i.findDotsAtSegment(t,e,r,n,s,a,o,c,function(t,e,i,r,n,s,a,o,c){if(c<0||l(t,e,i,r,n,s,a,o)<c)return;var h,u=.5,p=1-u;h=l(t,e,i,r,n,s,a,o,p);for(;O(h-c)>.01;)h=l(t,e,i,r,n,s,a,o,p+=(h<c?1:-1)*(u/=2));return p}(t,e,r,n,s,a,o,c,h))},te=function(t,e){return function(r,n,s){r=zt(r);for(var a,o,l,c,h,u="",p={},d=0,f=0,g=r.length;f<g;f++){if("M"==(l=r[f])[0])a=+l[1],o=+l[2];else{if(c=Jt(a,o,l[1],l[2],l[3],l[4],l[5],l[6]),d+c>n){if(e&&!p.start){if(h=Jt(a,o,l[1],l[2],l[3],l[4],l[5],l[6],n-d),u+=["C"+h.start.x,h.start.y,h.m.x,h.m.y,h.x,h.y],s)return u;p.start=u,u=["M"+h.x,h.y+"C"+h.n.x,h.n.y,h.end.x,h.end.y,l[5],l[6]].join(),d+=c,a=+l[5],o=+l[6];continue}if(!t&&!e)return{x:(h=Jt(a,o,l[1],l[2],l[3],l[4],l[5],l[6],n-d)).x,y:h.y,alpha:h.alpha}}d+=c,a=+l[5],o=+l[6]}u+=l.shift()+l}return p.end=u,(h=t?d:e?p:i.findDotsAtSegment(a,o,l[0],l[1],l[2],l[3],l[4],l[5],1)).alpha&&(h={x:h.x,y:h.y,alpha:h.alpha}),h}},ee=te(1),ie=te(),re=te(0,1);i.getTotalLength=ee,i.getPointAtLength=ie,i.getSubpath=function(t,e,i){if(this.getTotalLength(t)-i<1e-6)return re(t,e).end;var r=re(t,i,1);return e?re(r,e).end:r},Zt.getTotalLength=function(){var t=this.getPath();if(t)return this.node.getTotalLength?this.node.getTotalLength():ee(t)},Zt.getPointAtLength=function(t){var e=this.getPath();if(e)return ie(e,t)},Zt.getPath=function(){var t,e=i._getPath[this.type];if("text"!=this.type&&"set"!=this.type)return e&&(t=e(this)),t},Zt.getSubpath=function(t,e){var r=this.getPath();if(r)return i.getSubpath(r,t,e)};var ne=i.easing_formulas={linear:function(t){return t},"<":function(t){return F(t,1.7)},">":function(t){return F(t,.48)},"<>":function(t){var e=.48-t/1.04,i=M.sqrt(.1734+e*e),r=i-e,n=F(O(r),1/3)*(r<0?-1:1),s=-i-e,a=F(O(s),1/3)*(s<0?-1:1),o=n+a+.5;return 3*(1-o)*o*o+o*o*o},backIn:function(t){return t*t*(2.70158*t-1.70158)},backOut:function(t){return(t-=1)*t*(2.70158*t+1.70158)+1},elastic:function(t){return t==!!t?t:F(2,-10*t)*M.sin(2*(t-.075)*$/.3)+1},bounce:function(t){var e=7.5625,i=2.75;return t<1/i?e*t*t:t<2/i?e*(t-=1.5/i)*t+.75:t<2.5/i?e*(t-=2.25/i)*t+.9375:e*(t-=2.625/i)*t+.984375}};ne.easeIn=ne["ease-in"]=ne["<"],ne.easeOut=ne["ease-out"]=ne[">"],ne.easeInOut=ne["ease-in-out"]=ne["<>"],ne["back-in"]=ne.backIn,ne["back-out"]=ne.backOut;var se=[],ae=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(t){setTimeout(t,16)},oe=function(){for(var t=+new Date,r=0;r<se.length;r++){var n=se[r];if(!n.el.removed&&!n.paused){var s,a,o=t-n.start,l=n.ms,c=n.easing,h=n.from,u=n.diff,p=n.to,d=(n.t,n.el),f={},g={};if(n.initstatus?(o=(n.initstatus*n.anim.top-n.prev)/(n.percent-n.prev)*l,n.status=n.initstatus,delete n.initstatus,n.stop&&se.splice(r--,1)):n.status=(n.prev+(n.percent-n.prev)*(o/l))/n.anim.top,!(o<0))if(o<l){var m=c(o/l);for(var y in h)if(h[k](y)){switch(tt[y]){case q:s=+h[y]+m*l*u[y];break;case"colour":s="rgb("+[le(U(h[y].r+m*l*u[y].r)),le(U(h[y].g+m*l*u[y].g)),le(U(h[y].b+m*l*u[y].b))].join(",")+")";break;case"path":s=[];for(var x=0,b=h[y].length;x<b;x++){s[x]=[h[y][x][0]];for(var w=1,_=h[y][x].length;w<_;w++)s[x][w]=+h[y][x][w]+m*l*u[y][x][w];s[x]=s[x].join(A)}s=s.join(A);break;case"transform":if(u[y].real)for(s=[],x=0,b=h[y].length;x<b;x++)for(s[x]=[h[y][x][0]],w=1,_=h[y][x].length;w<_;w++)s[x][w]=h[y][x][w]+m*l*u[y][x][w];else{var S=function(t){return+h[y][t]+m*l*u[y][t]};s=[["m",S(0),S(1),S(2),S(3),S(4),S(5)]]}break;case"csv":if("clip-rect"==y)for(s=[],x=4;x--;)s[x]=+h[y][x]+m*l*u[y][x];break;default:var C=[][P](h[y]);for(s=[],x=d.paper.customAttributes[y].length;x--;)s[x]=+C[x]+m*l*u[y][x]}f[y]=s}d.attr(f),function(t,i,r){setTimeout(function(){e("raphael.anim.frame."+t,i,r)})}(d.id,d,n.anim)}else{if(function(t,r,n){setTimeout(function(){e("raphael.anim.frame."+r.id,r,n),e("raphael.anim.finish."+r.id,r,n),i.is(t,"function")&&t.call(r)})}(n.callback,d,n.anim),d.attr(p),se.splice(r--,1),n.repeat>1&&!n.next){for(a in p)p[k](a)&&(g[a]=n.totalOrigin[a]);n.el.attr(g),v(n.anim,n.el,n.anim.percents[0],null,n.totalOrigin,n.repeat-1)}n.next&&!n.stop&&v(n.anim,n.el,n.next,null,n.totalOrigin,n.repeat)}}}i.svg&&d&&d.paper&&d.paper.safari(),se.length&&ae(oe)},le=function(t){return t>255?255:t<0?0:t};Zt.animateWith=function(t,e,r,n,s,a){var o=this;if(o.removed)return a&&a.call(o),o;var l=r instanceof g?r:i.animation(r,n,s,a);v(l,o,l.percents[0],null,o.attr());for(var c=0,h=se.length;c<h;c++)if(se[c].anim==e&&se[c].el==t){se[h-1].start=se[c].start;break}return o},Zt.onAnimation=function(t){return t?e.on("raphael.anim.frame."+this.id,t):e.unbind("raphael.anim.frame."+this.id),this},g.prototype.delay=function(t){var e=new g(this.anim,this.ms);return e.times=this.times,e.del=+t||0,e},g.prototype.repeat=function(t){var e=new g(this.anim,this.ms);return e.del=this.del,e.times=M.floor(R(t,0))||1,e},i.animation=function(t,e,r,n){if(t instanceof g)return t;!i.is(r,"function")&&r||(n=n||r||null,r=null),t=Object(t),e=+e||0;var s,a,o={};for(a in t)t[k](a)&&Z(a)!=a&&Z(a)+"%"!=a&&(s=!0,o[a]=t[a]);return s?(r&&(o.easing=r),n&&(o.callback=n),new g({100:o},e)):new g(t,e)},Zt.animate=function(t,e,r,n){var s=this;if(s.removed)return n&&n.call(s),s;var a=t instanceof g?t:i.animation(t,e,r,n);return v(a,s,a.percents[0],null,s.attr()),s},Zt.setTime=function(t,e){return t&&null!=e&&this.status(t,W(e,t.ms)/t.ms),this},Zt.status=function(t,e){var i,r,n=[],s=0;if(null!=e)return v(t,this,-1,W(e,1)),this;for(i=se.length;s<i;s++)if((r=se[s]).el.id==this.id&&(!t||r.anim==t)){if(t)return r.status;n.push({anim:r.anim,status:r.status})}return t?0:n},Zt.pause=function(t){for(var i=0;i<se.length;i++)se[i].el.id!=this.id||t&&se[i].anim!=t||!1!==e("raphael.anim.pause."+this.id,this,se[i].anim)&&(se[i].paused=!0);return this},Zt.resume=function(t){for(var i=0;i<se.length;i++)if(se[i].el.id==this.id&&(!t||se[i].anim==t)){var r=se[i];!1!==e("raphael.anim.resume."+this.id,this,r.anim)&&(delete r.paused,this.status(r.anim,r.status))}return this},Zt.stop=function(t){for(var i=0;i<se.length;i++)se[i].el.id!=this.id||t&&se[i].anim!=t||!1!==e("raphael.anim.stop."+this.id,this,se[i].anim)&&se.splice(i--,1);return this},e.on("raphael.remove",m),e.on("raphael.clear",m),Zt.toString=function(){return"Raphaël’s object"};var ce=function(t){if(this.items=[],this.length=0,this.type="set",t)for(var e=0,i=t.length;e<i;e++)!t[e]||t[e].constructor!=Zt.constructor&&t[e].constructor!=ce||(this[this.items.length]=this.items[this.items.length]=t[e],this.length++)},he=ce.prototype;for(var ue in he.push=function(){for(var t,e,i=0,r=arguments.length;i<r;i++)!(t=arguments[i])||t.constructor!=Zt.constructor&&t.constructor!=ce||(this[e=this.items.length]=this.items[e]=t,this.length++);return this},he.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},he.forEach=function(t,e){for(var i=0,r=this.items.length;i<r;i++)if(!1===t.call(e,this.items[i],i))return this;return this},Zt)Zt[k](ue)&&(he[ue]=function(t){return function(){var e=arguments;return this.forEach(function(i){i[t][E](i,e)})}}(ue));return he.attr=function(t,e){if(t&&i.is(t,H)&&i.is(t[0],"object"))for(var r=0,n=t.length;r<n;r++)this.items[r].attr(t[r]);else for(var s=0,a=this.items.length;s<a;s++)this.items[s].attr(t,e);return this},he.clear=function(){for(;this.length;)this.pop()},he.splice=function(t,e,i){t=t<0?R(this.length+t,0):t,e=R(0,W(this.length-t,e));var r,n=[],s=[],a=[];for(r=2;r<arguments.length;r++)a.push(arguments[r]);for(r=0;r<e;r++)s.push(this[t+r]);for(;r<this.length-t;r++)n.push(this[t+r]);var o=a.length;for(r=0;r<o+n.length;r++)this.items[t+r]=this[t+r]=r<o?a[r]:n[r-o];for(r=this.items.length=this.length-=e-o;this[r];)delete this[r++];return new ce(s)},he.exclude=function(t){for(var e=0,i=this.length;e<i;e++)if(this[e]==t)return this.splice(e,1),!0},he.animate=function(t,e,r,n){(i.is(r,"function")||!r)&&(n=r||null);var s,a,o=this.items.length,l=o,c=this;if(!o)return this;n&&(a=function(){!--o&&n.call(c)}),r=i.is(r,V)?r:a;var h=i.animation(t,e,r,a);for(s=this.items[--l].animate(h);l--;)this.items[l]&&!this.items[l].removed&&this.items[l].animateWith(s,h,h),this.items[l]&&!this.items[l].removed||o--;return this},he.insertAfter=function(t){for(var e=this.items.length;e--;)this.items[e].insertAfter(t);return this},he.getBBox=function(){for(var t=[],e=[],i=[],r=[],n=this.items.length;n--;)if(!this.items[n].removed){var s=this.items[n].getBBox();t.push(s.x),e.push(s.y),i.push(s.x+s.width),r.push(s.y+s.height)}return{x:t=W[E](0,t),y:e=W[E](0,e),x2:i=R[E](0,i),y2:r=R[E](0,r),width:i-t,height:r-e}},he.clone=function(t){t=this.paper.set();for(var e=0,i=this.items.length;e<i;e++)t.push(this.items[e].clone());return t},he.toString=function(){return"Raphaël‘s set"},he.glow=function(t){var e=this.paper.set();return this.forEach(function(i,r){var n=i.glow(t);null!=n&&n.forEach(function(t,i){e.push(t)})}),e},he.isPointInside=function(t,e){var i=!1;return this.forEach(function(r){if(r.isPointInside(t,e))return i=!0,!1}),i},i.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e={w:t.w,face:{},glyphs:{}},i=t.face["font-family"];for(var r in t.face)t.face[k](r)&&(e.face[r]=t.face[r]);if(this.fonts[i]?this.fonts[i].push(e):this.fonts[i]=[e],!t.svg)for(var n in e.face["units-per-em"]=Q(t.face["units-per-em"],10),t.glyphs)if(t.glyphs[k](n)){var s=t.glyphs[n];if(e.glyphs[n]={w:s.w,k:{},d:s.d&&"M"+s.d.replace(/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},s.k)for(var a in s.k)s[k](a)&&(e.glyphs[n].k[a]=s.k[a])}return t},x.getFont=function(t,e,r,n){if(n=n||"normal",r=r||"normal",e=+e||{normal:400,bold:700,lighter:300,bolder:800}[e]||400,i.fonts){var s,a=i.fonts[t];if(!a){var o=new RegExp("(^|\\s)"+t.replace(/[^\w\d\s+!~.:_-]/g,"")+"(\\s|$)","i");for(var l in i.fonts)if(i.fonts[k](l)&&o.test(l)){a=i.fonts[l];break}}if(a)for(var c=0,h=a.length;c<h&&((s=a[c]).face["font-weight"]!=e||s.face["font-style"]!=r&&s.face["font-style"]||s.face["font-stretch"]!=n);c++);return s}},x.print=function(t,e,r,n,s,a,o,l){a=a||"middle",o=R(W(o||0,1),-1),l=R(W(l||1,3),1);var c,h=I(r)[L](""),u=0,p=0,d="";if(i.is(n,"string")&&(n=this.getFont(n)),n){c=(s||16)/n.face["units-per-em"];for(var f=n.face.bbox[L](b),g=+f[0],v=f[3]-f[1],m=0,y=+f[1]+("baseline"==a?v+ +n.face.descent:v/2),x=0,w=h.length;x<w;x++){if("\n"==h[x])u=0,k=0,p=0,m+=v*l;else{var _=p&&n.glyphs[h[x-1]]||{},k=n.glyphs[h[x]];u+=p?(_.w||n.w)+(_.k&&_.k[h[x]]||0)+n.w*o:0,p=1}k&&k.d&&(d+=i.transformPath(k.d,["t",u*c,m*c,"s",c,c,g,y,"t",(t-g)/c,(e-y)/c]))}}return this.path(d).attr({fill:"#000",stroke:"none"})},x.add=function(t){if(i.is(t,"array"))for(var e,r=this.set(),n=0,s=t.length;n<s;n++)e=t[n]||{},w[k](e.type)&&r.push(this[e.type]().attr(e));return r},i.format=function(t,e){var r=i.is(e,H)?[0][P](e):arguments;return t&&i.is(t,V)&&r.length-1&&(t=t.replace(_,function(t,e){return null==r[++e]?"":r[e]})),t||""},i.fullfill=(ge=/\{([^\}]+)\}/g,ve=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,function(t,e){return String(t).replace(ge,function(t,i){return r=t,s=n=e,i.replace(ve,function(t,e,i,r,n){e=e||r,s&&(e in s&&(s=s[e]),"function"==typeof s&&n&&(s=s()))}),s=(null==s||s==n?r:s)+"";var r,n,s})}),i.ninja=function(){return C.was?S.win.Raphael=C.is:delete Raphael,i},i.st=he,pe=document,de="DOMContentLoaded",null==pe.readyState&&pe.addEventListener&&(pe.addEventListener(de,fe=function(){pe.removeEventListener(de,fe,!1),pe.readyState="complete"},!1),pe.readyState="loading"),function t(){/in/.test(pe.readyState)?setTimeout(t,9):i.eve("raphael.DOMload")}(),e.on("raphael.DOMload",function(){y=!0}),function(){if(i.svg){var t="hasOwnProperty",e=String,r=parseFloat,n=parseInt,s=Math,a=s.max,o=s.abs,l=s.pow,c=/[, ]+/,h=i.eve,u="http://www.w3.org/1999/xlink",p={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},d={};i.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var f=function(r,n){if(n)for(var s in"string"==typeof r&&(r=f(r)),n)n[t](s)&&("xlink:"==s.substring(0,6)?r.setAttributeNS(u,s.substring(6),e(n[s])):r.setAttribute(s,e(n[s])));else(r=i._g.doc.createElementNS("http://www.w3.org/2000/svg",r)).style&&(r.style.webkitTapHighlightColor="rgba(0,0,0,0)");return r},g=function(t,n){var c="linear",h=t.id+n,u=.5,p=.5,d=t.node,g=t.paper,v=d.style,m=i._g.doc.getElementById(h);if(!m){if(n=(n=e(n).replace(i._radial_gradient,function(t,e,i){if(c="radial",e&&i){u=r(e);var n=2*((p=r(i))>.5)-1;l(u-.5,2)+l(p-.5,2)>.25&&(p=s.sqrt(.25-l(u-.5,2))*n+.5)&&.5!=p&&(p=p.toFixed(5)-1e-5*n)}return""})).split(/\s*\-\s*/),"linear"==c){var y=n.shift();if(y=-r(y),isNaN(y))return null;var x=[0,0,s.cos(i.rad(y)),s.sin(i.rad(y))],b=1/(a(o(x[2]),o(x[3]))||1);x[2]*=b,x[3]*=b,x[2]<0&&(x[0]=-x[2],x[2]=0),x[3]<0&&(x[1]=-x[3],x[3]=0)}var w=i._parseDots(n);if(!w)return null;if(h=h.replace(/[\(\)\s,\xb0#]/g,"_"),t.gradient&&h!=t.gradient.id&&(g.defs.removeChild(t.gradient),delete t.gradient),!t.gradient){m=f(c+"Gradient",{id:h}),t.gradient=m,f(m,"radial"==c?{fx:u,fy:p}:{x1:x[0],y1:x[1],x2:x[2],y2:x[3],gradientTransform:t.matrix.invert()}),g.defs.appendChild(m);for(var _=0,k=w.length;_<k;_++)m.appendChild(f("stop",{offset:w[_].offset?w[_].offset:_?"100%":"0%","stop-color":w[_].color||"#fff"}))}}return f(d,{fill:"url(#"+h+")",opacity:1,"fill-opacity":1}),v.fill="",v.opacity=1,v.fillOpacity=1,1},v=function(t){var e=t.getBBox(1);f(t.pattern,{patternTransform:t.matrix.invert()+" translate("+e.x+","+e.y+")"})},m=function(r,n,s){if("path"==r.type){for(var a,o,l,c,h,u=e(n).toLowerCase().split("-"),g=r.paper,v=s?"end":"start",m=r.node,y=r.attrs,x=y["stroke-width"],b=u.length,w="classic",_=3,k=3,S=5;b--;)switch(u[b]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":w=u[b];break;case"wide":k=5;break;case"narrow":k=2;break;case"long":_=5;break;case"short":_=2}if("open"==w?(_+=2,k+=2,S+=2,l=1,c=s?4:1,h={fill:"none",stroke:y.stroke}):(c=l=_/2,h={fill:y.stroke,stroke:"none"}),r._.arrows?s?(r._.arrows.endPath&&d[r._.arrows.endPath]--,r._.arrows.endMarker&&d[r._.arrows.endMarker]--):(r._.arrows.startPath&&d[r._.arrows.startPath]--,r._.arrows.startMarker&&d[r._.arrows.startMarker]--):r._.arrows={},"none"!=w){var C="raphael-marker-"+w,T="raphael-marker-"+v+w+_+k;i._g.doc.getElementById(C)?d[C]++:(g.defs.appendChild(f(f("path"),{"stroke-linecap":"round",d:p[w],id:C})),d[C]=1);var E,P=i._g.doc.getElementById(T);P?(d[T]++,E=P.getElementsByTagName("use")[0]):(P=f(f("marker"),{id:T,markerHeight:k,markerWidth:_,orient:"auto",refX:c,refY:k/2}),E=f(f("use"),{"xlink:href":"#"+C,transform:(s?"rotate(180 "+_/2+" "+k/2+") ":"")+"scale("+_/S+","+k/S+")","stroke-width":(1/((_/S+k/S)/2)).toFixed(4)}),P.appendChild(E),g.defs.appendChild(P),d[T]=1),f(E,h);var B=l*("diamond"!=w&&"oval"!=w);s?(a=r._.arrows.startdx*x||0,o=i.getTotalLength(y.path)-B*x):(a=B*x,o=i.getTotalLength(y.path)-(r._.arrows.enddx*x||0)),(h={})["marker-"+v]="url(#"+T+")",(o||a)&&(h.d=i.getSubpath(y.path,a,o)),f(m,h),r._.arrows[v+"Path"]=C,r._.arrows[v+"Marker"]=T,r._.arrows[v+"dx"]=B,r._.arrows[v+"Type"]=w,r._.arrows[v+"String"]=n}else s?(a=r._.arrows.startdx*x||0,o=i.getTotalLength(y.path)-a):(a=0,o=i.getTotalLength(y.path)-(r._.arrows.enddx*x||0)),r._.arrows[v+"Path"]&&f(m,{d:i.getSubpath(y.path,a,o)}),delete r._.arrows[v+"Path"],delete r._.arrows[v+"Marker"],delete r._.arrows[v+"dx"],delete r._.arrows[v+"Type"],delete r._.arrows[v+"String"];for(h in d)if(d[t](h)&&!d[h]){var A=i._g.doc.getElementById(h);A&&A.parentNode.removeChild(A)}}},y={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},x=function(t,i,r){if(i=y[e(i).toLowerCase()]){for(var n=t.attrs["stroke-width"]||"1",s={round:n,square:n,butt:0}[t.attrs["stroke-linecap"]||r["stroke-linecap"]]||0,a=[],o=i.length;o--;)a[o]=i[o]*n+(o%2?1:-1)*s;f(t.node,{"stroke-dasharray":a.join(",")})}},b=function(r,s){var l=r.node,h=r.attrs,p=l.style.visibility;for(var d in l.style.visibility="hidden",s)if(s[t](d)){if(!i._availableAttrs[t](d))continue;var y=s[d];switch(h[d]=y,d){case"blur":r.blur(y);break;case"title":var b=l.getElementsByTagName("title");if(b.length&&(b=b[0]))b.firstChild.nodeValue=y;else{b=f("title");var _=i._g.doc.createTextNode(y);b.appendChild(_),l.appendChild(b)}break;case"href":case"target":var k=l.parentNode;if("a"!=k.tagName.toLowerCase()){var S=f("a");k.insertBefore(S,l),S.appendChild(l),k=S}"target"==d?k.setAttributeNS(u,"show","blank"==y?"new":y):k.setAttributeNS(u,d,y);break;case"cursor":l.style.cursor=y;break;case"transform":r.transform(y);break;case"arrow-start":m(r,y);break;case"arrow-end":m(r,y,1);break;case"clip-rect":var C=e(y).split(c);if(4==C.length){r.clip&&r.clip.parentNode.parentNode.removeChild(r.clip.parentNode);var T=f("clipPath"),E=f("rect");T.id=i.createUUID(),f(E,{x:C[0],y:C[1],width:C[2],height:C[3]}),T.appendChild(E),r.paper.defs.appendChild(T),f(l,{"clip-path":"url(#"+T.id+")"}),r.clip=E}if(!y){var P=l.getAttribute("clip-path");if(P){var B=i._g.doc.getElementById(P.replace(/(^url\(#|\)$)/g,""));B&&B.parentNode.removeChild(B),f(l,{"clip-path":""}),delete r.clip}}break;case"path":"path"==r.type&&(f(l,{d:y?h.path=i._pathToAbsolute(y):"M0,0"}),r._.dirty=1,r._.arrows&&("startString"in r._.arrows&&m(r,r._.arrows.startString),"endString"in r._.arrows&&m(r,r._.arrows.endString,1)));break;case"width":if(l.setAttribute(d,y),r._.dirty=1,!h.fx)break;d="x",y=h.x;case"x":h.fx&&(y=-h.x-(h.width||0));case"rx":if("rx"==d&&"rect"==r.type)break;case"cx":l.setAttribute(d,y),r.pattern&&v(r),r._.dirty=1;break;case"height":if(l.setAttribute(d,y),r._.dirty=1,!h.fy)break;d="y",y=h.y;case"y":h.fy&&(y=-h.y-(h.height||0));case"ry":if("ry"==d&&"rect"==r.type)break;case"cy":l.setAttribute(d,y),r.pattern&&v(r),r._.dirty=1;break;case"r":"rect"==r.type?f(l,{rx:y,ry:y}):l.setAttribute(d,y),r._.dirty=1;break;case"src":"image"==r.type&&l.setAttributeNS(u,"href",y);break;case"stroke-width":1==r._.sx&&1==r._.sy||(y/=a(o(r._.sx),o(r._.sy))||1),r.paper._vbSize&&(y*=r.paper._vbSize),l.setAttribute(d,y),h["stroke-dasharray"]&&x(r,h["stroke-dasharray"],s),r._.arrows&&("startString"in r._.arrows&&m(r,r._.arrows.startString),"endString"in r._.arrows&&m(r,r._.arrows.endString,1));break;case"stroke-dasharray":x(r,y,s);break;case"fill":var A=e(y).match(i._ISURL);if(A){T=f("pattern");var I=f("image");T.id=i.createUUID(),f(T,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),f(I,{x:0,y:0,"xlink:href":A[1]}),T.appendChild(I),function(t){i._preload(A[1],function(){var e=this.offsetWidth,i=this.offsetHeight;f(t,{width:e,height:i}),f(I,{width:e,height:i}),r.paper.safari()})}(T),r.paper.defs.appendChild(T),f(l,{fill:"url(#"+T.id+")"}),r.pattern=T,r.pattern&&v(r);break}var L=i.getRGB(y);if(L.error){if(("circle"==r.type||"ellipse"==r.type||"r"!=e(y).charAt())&&g(r,y)){if("opacity"in h||"fill-opacity"in h){var N=i._g.doc.getElementById(l.getAttribute("fill").replace(/^url\(#|\)$/g,""));if(N){var z=N.getElementsByTagName("stop");f(z[z.length-1],{"stop-opacity":("opacity"in h?h.opacity:1)*("fill-opacity"in h?h["fill-opacity"]:1)})}}h.gradient=y,h.fill="none";break}}else delete s.gradient,delete h.gradient,!i.is(h.opacity,"undefined")&&i.is(s.opacity,"undefined")&&f(l,{opacity:h.opacity}),!i.is(h["fill-opacity"],"undefined")&&i.is(s["fill-opacity"],"undefined")&&f(l,{"fill-opacity":h["fill-opacity"]});L[t]("opacity")&&f(l,{"fill-opacity":L.opacity>1?L.opacity/100:L.opacity});case"stroke":L=i.getRGB(y),l.setAttribute(d,L.hex),"stroke"==d&&L[t]("opacity")&&f(l,{"stroke-opacity":L.opacity>1?L.opacity/100:L.opacity}),"stroke"==d&&r._.arrows&&("startString"in r._.arrows&&m(r,r._.arrows.startString),"endString"in r._.arrows&&m(r,r._.arrows.endString,1));break;case"gradient":("circle"==r.type||"ellipse"==r.type||"r"!=e(y).charAt())&&g(r,y);break;case"opacity":h.gradient&&!h[t]("stroke-opacity")&&f(l,{"stroke-opacity":y>1?y/100:y});case"fill-opacity":if(h.gradient){(N=i._g.doc.getElementById(l.getAttribute("fill").replace(/^url\(#|\)$/g,"")))&&(z=N.getElementsByTagName("stop"),f(z[z.length-1],{"stop-opacity":y}));break}default:"font-size"==d&&(y=n(y,10)+"px");var D=d.replace(/(\-.)/g,function(t){return t.substring(1).toUpperCase()});l.style[D]=y,r._.dirty=1,l.setAttribute(d,y)}}w(r,s),l.style.visibility=p},w=function(r,s){if("text"==r.type&&(s[t]("text")||s[t]("font")||s[t]("font-size")||s[t]("x")||s[t]("y"))){var a=r.attrs,o=r.node,l=o.firstChild?n(i._g.doc.defaultView.getComputedStyle(o.firstChild,"").getPropertyValue("font-size"),10):10;if(s[t]("text")){for(a.text=s.text;o.firstChild;)o.removeChild(o.firstChild);for(var c,h=e(s.text).split("\n"),u=[],p=0,d=h.length;p<d;p++)c=f("tspan"),p&&f(c,{dy:1.2*l,x:a.x}),c.appendChild(i._g.doc.createTextNode(h[p])),o.appendChild(c),u[p]=c}else for(p=0,d=(u=o.getElementsByTagName("tspan")).length;p<d;p++)p?f(u[p],{dy:1.2*l,x:a.x}):f(u[0],{dy:0});f(o,{x:a.x,y:a.y}),r._.dirty=1;var g=r._getBBox(),v=a.y-(g.y+g.height/2);v&&i.is(v,"finite")&&f(u[0],{dy:v})}},_=function(t,e){this[0]=this.node=t,t.raphael=!0,this.id=i._oid++,t.raphaelid=this.id,this.matrix=i.matrix(),this.realPath=null,this.paper=e,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!e.bottom&&(e.bottom=this),this.prev=e.top,e.top&&(e.top.next=this),e.top=this,this.next=null},k=i.el;_.prototype=k,k.constructor=_,i._engine.path=function(t,e){var i=f("path");e.canvas&&e.canvas.appendChild(i);var r=new _(i,e);return r.type="path",b(r,{fill:"none",stroke:"#000",path:t}),r},k.rotate=function(t,i,n){if(this.removed)return this;if((t=e(t).split(c)).length-1&&(i=r(t[1]),n=r(t[2])),t=r(t[0]),null==n&&(i=n),null==i||null==n){var s=this.getBBox(1);i=s.x+s.width/2,n=s.y+s.height/2}return this.transform(this._.transform.concat([["r",t,i,n]])),this},k.scale=function(t,i,n,s){if(this.removed)return this;if((t=e(t).split(c)).length-1&&(i=r(t[1]),n=r(t[2]),s=r(t[3])),t=r(t[0]),null==i&&(i=t),null==s&&(n=s),null==n||null==s)var a=this.getBBox(1);return n=null==n?a.x+a.width/2:n,s=null==s?a.y+a.height/2:s,this.transform(this._.transform.concat([["s",t,i,n,s]])),this},k.translate=function(t,i){return this.removed?this:((t=e(t).split(c)).length-1&&(i=r(t[1])),t=r(t[0])||0,i=+i||0,this.transform(this._.transform.concat([["t",t,i]])),this)},k.transform=function(e){var r=this._;if(null==e)return r.transform;if(i._extractTransform(this,e),this.clip&&f(this.clip,{transform:this.matrix.invert()}),this.pattern&&v(this),this.node&&f(this.node,{transform:this.matrix}),1!=r.sx||1!=r.sy){var n=this.attrs[t]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":n})}return this},k.hide=function(){return!this.removed&&this.paper.safari(this.node.style.display="none"),this},k.show=function(){return!this.removed&&this.paper.safari(this.node.style.display=""),this},k.remove=function(){if(!this.removed&&this.node.parentNode){var t=this.paper;for(var e in t.__set__&&t.__set__.exclude(this),h.unbind("raphael.*.*."+this.id),this.gradient&&t.defs.removeChild(this.gradient),i._tear(this,t),"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node),this)this[e]="function"==typeof this[e]?i._removedFactory(e):null;this.removed=!0}},k._getBBox=function(){if("none"==this.node.style.display){this.show();var t=!0}var e={};try{e=this.node.getBBox()}catch(t){}finally{e=e||{}}return t&&this.hide(),e},k.attr=function(e,r){if(this.removed)return this;if(null==e){var n={};for(var s in this.attrs)this.attrs[t](s)&&(n[s]=this.attrs[s]);return n.gradient&&"none"==n.fill&&(n.fill=n.gradient)&&delete n.gradient,n.transform=this._.transform,n}if(null==r&&i.is(e,"string")){if("fill"==e&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;if("transform"==e)return this._.transform;for(var a=e.split(c),o={},l=0,u=a.length;l<u;l++)(e=a[l])in this.attrs?o[e]=this.attrs[e]:i.is(this.paper.customAttributes[e],"function")?o[e]=this.paper.customAttributes[e].def:o[e]=i._availableAttrs[e];return u-1?o:o[a[0]]}if(null==r&&i.is(e,"array")){for(o={},l=0,u=e.length;l<u;l++)o[e[l]]=this.attr(e[l]);return o}if(null!=r){var p={};p[e]=r}else null!=e&&i.is(e,"object")&&(p=e);for(var d in p)h("raphael.attr."+d+"."+this.id,this,p[d]);for(d in this.paper.customAttributes)if(this.paper.customAttributes[t](d)&&p[t](d)&&i.is(this.paper.customAttributes[d],"function")){var f=this.paper.customAttributes[d].apply(this,[].concat(p[d]));for(var g in this.attrs[d]=p[d],f)f[t](g)&&(p[g]=f[g])}return b(this,p),this},k.toFront=function(){if(this.removed)return this;"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var t=this.paper;return t.top!=this&&i._tofront(this,t),this},k.toBack=function(){if(this.removed)return this;var t=this.node.parentNode;return"a"==t.tagName.toLowerCase()?t.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):t.firstChild!=this.node&&t.insertBefore(this.node,this.node.parentNode.firstChild),i._toback(this,this.paper),this.paper,this},k.insertAfter=function(t){if(this.removed)return this;var e=t.node||t[t.length-1].node;return e.nextSibling?e.parentNode.insertBefore(this.node,e.nextSibling):e.parentNode.appendChild(this.node),i._insertafter(this,t,this.paper),this},k.insertBefore=function(t){if(this.removed)return this;var e=t.node||t[0].node;return e.parentNode.insertBefore(this.node,e),i._insertbefore(this,t,this.paper),this},k.blur=function(t){var e=this;if(0!=+t){var r=f("filter"),n=f("feGaussianBlur");e.attrs.blur=t,r.id=i.createUUID(),f(n,{stdDeviation:+t||1.5}),r.appendChild(n),e.paper.defs.appendChild(r),e._blur=r,f(e.node,{filter:"url(#"+r.id+")"})}else e._blur&&(e._blur.parentNode.removeChild(e._blur),delete e._blur,delete e.attrs.blur),e.node.removeAttribute("filter");return e},i._engine.circle=function(t,e,i,r){var n=f("circle");t.canvas&&t.canvas.appendChild(n);var s=new _(n,t);return s.attrs={cx:e,cy:i,r:r,fill:"none",stroke:"#000"},s.type="circle",f(n,s.attrs),s},i._engine.rect=function(t,e,i,r,n,s){var a=f("rect");t.canvas&&t.canvas.appendChild(a);var o=new _(a,t);return o.attrs={x:e,y:i,width:r,height:n,r:s||0,rx:s||0,ry:s||0,fill:"none",stroke:"#000"},o.type="rect",f(a,o.attrs),o},i._engine.ellipse=function(t,e,i,r,n){var s=f("ellipse");t.canvas&&t.canvas.appendChild(s);var a=new _(s,t);return a.attrs={cx:e,cy:i,rx:r,ry:n,fill:"none",stroke:"#000"},a.type="ellipse",f(s,a.attrs),a},i._engine.image=function(t,e,i,r,n,s){var a=f("image");f(a,{x:i,y:r,width:n,height:s,preserveAspectRatio:"none"}),a.setAttributeNS(u,"href",e),t.canvas&&t.canvas.appendChild(a);var o=new _(a,t);return o.attrs={x:i,y:r,width:n,height:s,src:e},o.type="image",o},i._engine.text=function(t,e,r,n){var s=f("text");t.canvas&&t.canvas.appendChild(s);var a=new _(s,t);return a.attrs={x:e,y:r,"text-anchor":"middle",text:n,font:i._availableAttrs.font,stroke:"none",fill:"#000"},a.type="text",b(a,a.attrs),a},i._engine.setSize=function(t,e){return this.width=t||this.width,this.height=e||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this},i._engine.create=function(){var t=i._getContainer.apply(0,arguments),e=t&&t.container,r=t.x,n=t.y,s=t.width,a=t.height;if(!e)throw new Error("SVG container not found.");var o,l=f("svg"),c="overflow:hidden;";return r=r||0,n=n||0,f(l,{height:a=a||342,version:1.1,width:s=s||512,xmlns:"http://www.w3.org/2000/svg"}),1==e?(l.style.cssText=c+"position:absolute;left:"+r+"px;top:"+n+"px",i._g.doc.body.appendChild(l),o=1):(l.style.cssText=c+"position:relative",e.firstChild?e.insertBefore(l,e.firstChild):e.appendChild(l)),(e=new i._Paper).width=s,e.height=a,e.canvas=l,e.clear(),e._left=e._top=0,o&&(e.renderfix=function(){}),e.renderfix(),e},i._engine.setViewBox=function(t,e,i,r,n){h("raphael.setViewBox",this,this._viewBox,[t,e,i,r,n]);var s,o,l=a(i/this.width,r/this.height),c=this.top,u=n?"xMidYMid meet":"xMinYMin";for(null==t?(this._vbSize&&(l=1),delete this._vbSize,s="0 0 "+this.width+" "+this.height):(this._vbSize=l,s=t+" "+e+" "+i+" "+r),f(this.canvas,{viewBox:s,preserveAspectRatio:u});l&&c;)o="stroke-width"in c.attrs?c.attrs["stroke-width"]:1,c.attr({"stroke-width":o}),c._.dirty=1,c._.dirtyT=1,c=c.prev;return this._viewBox=[t,e,i,r,!!n],this},i.prototype.renderfix=function(){var t,e=this.canvas,i=e.style;try{t=e.getScreenCTM()||e.createSVGMatrix()}catch(i){t=e.createSVGMatrix()}var r=-t.e%1,n=-t.f%1;(r||n)&&(r&&(this._left=(this._left+r)%1,i.left=this._left+"px"),n&&(this._top=(this._top+n)%1,i.top=this._top+"px"))},i.prototype.clear=function(){i.eve("raphael.clear",this);for(var t=this.canvas;t.firstChild;)t.removeChild(t.firstChild);this.bottom=this.top=null,(this.desc=f("desc")).appendChild(i._g.doc.createTextNode("Created with Raphaël "+i.version)),t.appendChild(this.desc),t.appendChild(this.defs=f("defs"))},i.prototype.remove=function(){for(var t in h("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this)this[t]="function"==typeof this[t]?i._removedFactory(t):null};var S=i.st;for(var C in k)k[t](C)&&!S[t](C)&&(S[C]=function(t){return function(){var e=arguments;return this.forEach(function(i){i[t].apply(i,e)})}}(C))}}(),function(){if(i.vml){var t="hasOwnProperty",e=String,r=parseFloat,n=Math,s=n.round,a=n.max,o=n.min,l=n.abs,c="fill",h=/[, ]+/,u=i.eve,p=" ",d={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},f=/([clmz]),?([^clmz]*)/gi,g=/ progid:\S+Blur\([^\)]+\)/g,v=/-?[^,\s-]+/g,m="position:absolute;left:0;top:0;width:1px;height:1px",y=21600,x={path:1,rect:1,image:1},b={circle:1,ellipse:1},w=function(t,e,r){var n=i.matrix();return n.rotate(-t,.5,.5),{dx:n.x(e,r),dy:n.y(e,r)}},_=function(t,e,i,r,n,s){var a=t._,o=t.matrix,h=a.fillpos,u=t.node,d=u.style,f=1,g="",v=y/e,m=y/i;if(d.visibility="hidden",e&&i){if(u.coordsize=l(v)+p+l(m),d.rotation=s*(e*i<0?-1:1),s){var x=w(s,r,n);r=x.dx,n=x.dy}if(e<0&&(g+="x"),i<0&&(g+=" y")&&(f=-1),d.flip=g,u.coordorigin=r*-v+p+n*-m,h||a.fillsize){var b=u.getElementsByTagName(c);b=b&&b[0],u.removeChild(b),h&&(x=w(s,o.x(h[0],h[1]),o.y(h[0],h[1])),b.position=x.dx*f+p+x.dy*f),a.fillsize&&(b.size=a.fillsize[0]*l(e)+p+a.fillsize[1]*l(i)),u.appendChild(b)}d.visibility="visible"}};i.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var k,S=function(t,i,r){for(var n=e(i).toLowerCase().split("-"),s=r?"end":"start",a=n.length,o="classic",l="medium",c="medium";a--;)switch(n[a]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":o=n[a];break;case"wide":case"narrow":c=n[a];break;case"long":case"short":l=n[a]}var h=t.node.getElementsByTagName("stroke")[0];h[s+"arrow"]=o,h[s+"arrowlength"]=l,h[s+"arrowwidth"]=c},C=function(n,l){n.attrs=n.attrs||{};var u=n.node,g=n.attrs,m=u.style,w=x[n.type]&&(l.x!=g.x||l.y!=g.y||l.width!=g.width||l.height!=g.height||l.cx!=g.cx||l.cy!=g.cy||l.rx!=g.rx||l.ry!=g.ry||l.r!=g.r),C=b[n.type]&&(g.cx!=l.cx||g.cy!=l.cy||g.r!=l.r||g.rx!=l.rx||g.ry!=l.ry),E=n;for(var P in l)l[t](P)&&(g[P]=l[P]);if(w&&(g.path=i._getPath[n.type](n),n._.dirty=1),l.href&&(u.href=l.href),l.title&&(u.title=l.title),l.target&&(u.target=l.target),l.cursor&&(m.cursor=l.cursor),"blur"in l&&n.blur(l.blur),(l.path&&"path"==n.type||w)&&(u.path=function(t){var r=/[ahqstv]/gi,n=i._pathToAbsolute;if(e(t).match(r)&&(n=i._path2curve),r=/[clmz]/g,n==i._pathToAbsolute&&!e(t).match(r)){var a=e(t).replace(f,function(t,e,i){var r=[],n="m"==e.toLowerCase(),a=d[e];return i.replace(v,function(t){n&&2==r.length&&(a+=r+d["m"==e?"l":"L"],r=[]),r.push(s(t*y))}),a+r});return a}var o,l,c=n(t);a=[];for(var h=0,u=c.length;h<u;h++){o=c[h],"z"==(l=c[h][0].toLowerCase())&&(l="x");for(var g=1,m=o.length;g<m;g++)l+=s(o[g]*y)+(g!=m-1?",":"");a.push(l)}return a.join(p)}(~e(g.path).toLowerCase().indexOf("r")?i._pathToAbsolute(g.path):g.path),"image"==n.type&&(n._.fillpos=[g.x,g.y],n._.fillsize=[g.width,g.height],_(n,1,1,0,0,0))),"transform"in l&&n.transform(l.transform),C){var B=+g.cx,A=+g.cy,I=+g.rx||+g.r||0,L=+g.ry||+g.r||0;u.path=i.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",s((B-I)*y),s((A-L)*y),s((B+I)*y),s((A+L)*y),s(B*y)),n._.dirty=1}if("clip-rect"in l){var N=e(l["clip-rect"]).split(h);if(4==N.length){N[2]=+N[2]+ +N[0],N[3]=+N[3]+ +N[1];var z=u.clipRect||i._g.doc.createElement("div"),D=z.style;D.clip=i.format("rect({1}px {2}px {3}px {0}px)",N),u.clipRect||(D.position="absolute",D.top=0,D.left=0,D.width=n.paper.width+"px",D.height=n.paper.height+"px",u.parentNode.insertBefore(z,u),z.appendChild(u),u.clipRect=z)}l["clip-rect"]||u.clipRect&&(u.clipRect.style.clip="auto")}if(n.textpath){var M=n.textpath.style;l.font&&(M.font=l.font),l["font-family"]&&(M.fontFamily='"'+l["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,"")+'"'),l["font-size"]&&(M.fontSize=l["font-size"]),l["font-weight"]&&(M.fontWeight=l["font-weight"]),l["font-style"]&&(M.fontStyle=l["font-style"])}if("arrow-start"in l&&S(E,l["arrow-start"]),"arrow-end"in l&&S(E,l["arrow-end"],1),null!=l.opacity||null!=l["stroke-width"]||null!=l.fill||null!=l.src||null!=l.stroke||null!=l["stroke-width"]||null!=l["stroke-opacity"]||null!=l["fill-opacity"]||null!=l["stroke-dasharray"]||null!=l["stroke-miterlimit"]||null!=l["stroke-linejoin"]||null!=l["stroke-linecap"]){var R=u.getElementsByTagName(c);if(!(R=R&&R[0])&&(R=k(c)),"image"==n.type&&l.src&&(R.src=l.src),l.fill&&(R.on=!0),null!=R.on&&"none"!=l.fill&&null!==l.fill||(R.on=!1),R.on&&l.fill){var W=e(l.fill).match(i._ISURL);if(W){R.parentNode==u&&u.removeChild(R),R.rotate=!0,R.src=W[1],R.type="tile";var O=n.getBBox(1);R.position=O.x+p+O.y,n._.fillpos=[O.x,O.y],i._preload(W[1],function(){n._.fillsize=[this.offsetWidth,this.offsetHeight]})}else R.color=i.getRGB(l.fill).hex,R.src="",R.type="solid",i.getRGB(l.fill).error&&(E.type in{circle:1,ellipse:1}||"r"!=e(l.fill).charAt())&&T(E,l.fill,R)&&(g.fill="none",g.gradient=l.fill,R.rotate=!1)}if("fill-opacity"in l||"opacity"in l){var F=((+g["fill-opacity"]+1||2)-1)*((+g.opacity+1||2)-1)*((+i.getRGB(l.fill).o+1||2)-1);F=o(a(F,0),1),R.opacity=F,R.src&&(R.color="none")}u.appendChild(R);var $=u.getElementsByTagName("stroke")&&u.getElementsByTagName("stroke")[0],q=!1;!$&&(q=$=k("stroke")),(l.stroke&&"none"!=l.stroke||l["stroke-width"]||null!=l["stroke-opacity"]||l["stroke-dasharray"]||l["stroke-miterlimit"]||l["stroke-linejoin"]||l["stroke-linecap"])&&($.on=!0),("none"==l.stroke||null===l.stroke||null==$.on||0==l.stroke||0==l["stroke-width"])&&($.on=!1);var V=i.getRGB(l.stroke);$.on&&l.stroke&&($.color=V.hex),F=((+g["stroke-opacity"]+1||2)-1)*((+g.opacity+1||2)-1)*((+V.o+1||2)-1);var H=.75*(r(l["stroke-width"])||1);if(F=o(a(F,0),1),null==l["stroke-width"]&&(H=g["stroke-width"]),l["stroke-width"]&&($.weight=H),H&&H<1&&(F*=H)&&($.weight=1),$.opacity=F,l["stroke-linejoin"]&&($.joinstyle=l["stroke-linejoin"]||"miter"),$.miterlimit=l["stroke-miterlimit"]||8,l["stroke-linecap"]&&($.endcap="butt"==l["stroke-linecap"]?"flat":"square"==l["stroke-linecap"]?"square":"round"),"stroke-dasharray"in l){var G={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};$.dashstyle=G[t](l["stroke-dasharray"])?G[l["stroke-dasharray"]]:""}q&&u.appendChild($)}if("text"==E.type){E.paper.canvas.style.display="";var Y=E.paper.span,j=g.font&&g.font.match(/\d+(?:\.\d*)?(?=px)/);m=Y.style,g.font&&(m.font=g.font),g["font-family"]&&(m.fontFamily=g["font-family"]),g["font-weight"]&&(m.fontWeight=g["font-weight"]),g["font-style"]&&(m.fontStyle=g["font-style"]),j=r(g["font-size"]||j&&j[0])||10,m.fontSize=100*j+"px",E.textpath.string&&(Y.innerHTML=e(E.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var X=Y.getBoundingClientRect();E.W=g.w=(X.right-X.left)/100,E.H=g.h=(X.bottom-X.top)/100,E.X=g.x,E.Y=g.y+E.H/2,("x"in l||"y"in l)&&(E.path.v=i.format("m{0},{1}l{2},{1}",s(g.x*y),s(g.y*y),s(g.x*y)+1));for(var U=["x","y","text","font","font-family","font-weight","font-style","font-size"],Z=0,Q=U.length;Z<Q;Z++)if(U[Z]in l){E._.dirty=1;break}switch(g["text-anchor"]){case"start":E.textpath.style["v-text-align"]="left",E.bbx=E.W/2;break;case"end":E.textpath.style["v-text-align"]="right",E.bbx=-E.W/2;break;default:E.textpath.style["v-text-align"]="center",E.bbx=0}E.textpath.style["v-text-kern"]=!0}},T=function(t,s,a){t.attrs=t.attrs||{},t.attrs;var o=Math.pow,l="linear",c=".5 .5";if(t.attrs.gradient=s,s=(s=e(s).replace(i._radial_gradient,function(t,e,i){return l="radial",e&&i&&(e=r(e),i=r(i),o(e-.5,2)+o(i-.5,2)>.25&&(i=n.sqrt(.25-o(e-.5,2))*(2*(i>.5)-1)+.5),c=e+p+i),""})).split(/\s*\-\s*/),"linear"==l){var h=s.shift();if(h=-r(h),isNaN(h))return null}var u=i._parseDots(s);if(!u)return null;if(t=t.shape||t.node,u.length){t.removeChild(a),a.on=!0,a.method="none",a.color=u[0].color,a.color2=u[u.length-1].color;for(var d=[],f=0,g=u.length;f<g;f++)u[f].offset&&d.push(u[f].offset+p+u[f].color);a.colors=d.length?d.join():"0% "+a.color,"radial"==l?(a.type="gradientTitle",a.focus="100%",a.focussize="0 0",a.focusposition=c,a.angle=0):(a.type="gradient",a.angle=(270-h)%360),t.appendChild(a)}return 1},E=function(t,e){this[0]=this.node=t,t.raphael=!0,this.id=i._oid++,t.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=e,this.matrix=i.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!e.bottom&&(e.bottom=this),this.prev=e.top,e.top&&(e.top.next=this),e.top=this,this.next=null},P=i.el;E.prototype=P,P.constructor=E,P.transform=function(t){if(null==t)return this._.transform;var r,n=this.paper._viewBoxShift,s=n?"s"+[n.scale,n.scale]+"-1-1t"+[n.dx,n.dy]:"";n&&(r=t=e(t).replace(/\.{3}|\u2026/g,this._.transform||"")),i._extractTransform(this,s+t);var a,o=this.matrix.clone(),l=this.skew,c=this.node,h=~e(this.attrs.fill).indexOf("-"),u=!e(this.attrs.fill).indexOf("url(");if(o.translate(1,1),u||h||"image"==this.type)if(l.matrix="1 0 0 1",l.offset="0 0",a=o.split(),h&&a.noRotation||!a.isSimple){c.style.filter=o.toFilter();var d=this.getBBox(),f=this.getBBox(1),g=d.x-f.x,v=d.y-f.y;c.coordorigin=g*-y+p+v*-y,_(this,1,1,g,v,0)}else c.style.filter="",_(this,a.scalex,a.scaley,a.dx,a.dy,a.rotate);else c.style.filter="",l.matrix=e(o),l.offset=o.offset();return r&&(this._.transform=r),this},P.rotate=function(t,i,n){if(this.removed)return this;if(null!=t){if((t=e(t).split(h)).length-1&&(i=r(t[1]),n=r(t[2])),t=r(t[0]),null==n&&(i=n),null==i||null==n){var s=this.getBBox(1);i=s.x+s.width/2,n=s.y+s.height/2}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",t,i,n]])),this}},P.translate=function(t,i){return this.removed?this:((t=e(t).split(h)).length-1&&(i=r(t[1])),t=r(t[0])||0,i=+i||0,this._.bbox&&(this._.bbox.x+=t,this._.bbox.y+=i),this.transform(this._.transform.concat([["t",t,i]])),this)},P.scale=function(t,i,n,s){if(this.removed)return this;if((t=e(t).split(h)).length-1&&(i=r(t[1]),n=r(t[2]),s=r(t[3]),isNaN(n)&&(n=null),isNaN(s)&&(s=null)),t=r(t[0]),null==i&&(i=t),null==s&&(n=s),null==n||null==s)var a=this.getBBox(1);return n=null==n?a.x+a.width/2:n,s=null==s?a.y+a.height/2:s,this.transform(this._.transform.concat([["s",t,i,n,s]])),this._.dirtyT=1,this},P.hide=function(){return!this.removed&&(this.node.style.display="none"),this},P.show=function(){return!this.removed&&(this.node.style.display=""),this},P._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},P.remove=function(){if(!this.removed&&this.node.parentNode){for(var t in this.paper.__set__&&this.paper.__set__.exclude(this),i.eve.unbind("raphael.*.*."+this.id),i._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape),this)this[t]="function"==typeof this[t]?i._removedFactory(t):null;this.removed=!0}},P.attr=function(e,r){if(this.removed)return this;if(null==e){var n={};for(var s in this.attrs)this.attrs[t](s)&&(n[s]=this.attrs[s]);return n.gradient&&"none"==n.fill&&(n.fill=n.gradient)&&delete n.gradient,n.transform=this._.transform,n}if(null==r&&i.is(e,"string")){if(e==c&&"none"==this.attrs.fill&&this.attrs.gradient)return this.attrs.gradient;for(var a=e.split(h),o={},l=0,p=a.length;l<p;l++)(e=a[l])in this.attrs?o[e]=this.attrs[e]:i.is(this.paper.customAttributes[e],"function")?o[e]=this.paper.customAttributes[e].def:o[e]=i._availableAttrs[e];return p-1?o:o[a[0]]}if(this.attrs&&null==r&&i.is(e,"array")){for(o={},l=0,p=e.length;l<p;l++)o[e[l]]=this.attr(e[l]);return o}var d;for(var f in null!=r&&((d={})[e]=r),null==r&&i.is(e,"object")&&(d=e),d)u("raphael.attr."+f+"."+this.id,this,d[f]);if(d){for(f in this.paper.customAttributes)if(this.paper.customAttributes[t](f)&&d[t](f)&&i.is(this.paper.customAttributes[f],"function")){var g=this.paper.customAttributes[f].apply(this,[].concat(d[f]));for(var v in this.attrs[f]=d[f],g)g[t](v)&&(d[v]=g[v])}d.text&&"text"==this.type&&(this.textpath.string=d.text),C(this,d)}return this},P.toFront=function(){return!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&i._tofront(this,this.paper),this},P.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),i._toback(this,this.paper)),this)},P.insertAfter=function(t){return this.removed?this:(t.constructor==i.st.constructor&&(t=t[t.length-1]),t.node.nextSibling?t.node.parentNode.insertBefore(this.node,t.node.nextSibling):t.node.parentNode.appendChild(this.node),i._insertafter(this,t,this.paper),this)},P.insertBefore=function(t){return this.removed?this:(t.constructor==i.st.constructor&&(t=t[0]),t.node.parentNode.insertBefore(this.node,t.node),i._insertbefore(this,t,this.paper),this)},P.blur=function(t){var e=this.node.runtimeStyle,r=e.filter;return r=r.replace(g,""),0!=+t?(this.attrs.blur=t,e.filter=r+p+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+t||1.5)+")",e.margin=i.format("-{0}px 0 0 -{0}px",s(+t||1.5))):(e.filter=r,e.margin=0,delete this.attrs.blur),this},i._engine.path=function(t,e){var i=k("shape");i.style.cssText=m,i.coordsize=y+p+y,i.coordorigin=e.coordorigin;var r=new E(i,e),n={fill:"none",stroke:"#000"};t&&(n.path=t),r.type="path",r.path=[],r.Path="",C(r,n),e.canvas.appendChild(i);var s=k("skew");return s.on=!0,i.appendChild(s),r.skew=s,r.transform(""),r},i._engine.rect=function(t,e,r,n,s,a){var o=i._rectPath(e,r,n,s,a),l=t.path(o),c=l.attrs;return l.X=c.x=e,l.Y=c.y=r,l.W=c.width=n,l.H=c.height=s,c.r=a,c.path=o,l.type="rect",l},i._engine.ellipse=function(t,e,i,r,n){var s=t.path();return s.attrs,s.X=e-r,s.Y=i-n,s.W=2*r,s.H=2*n,s.type="ellipse",C(s,{cx:e,cy:i,rx:r,ry:n}),s},i._engine.circle=function(t,e,i,r){var n=t.path();return n.attrs,n.X=e-r,n.Y=i-r,n.W=n.H=2*r,n.type="circle",C(n,{cx:e,cy:i,r:r}),n},i._engine.image=function(t,e,r,n,s,a){var o=i._rectPath(r,n,s,a),l=t.path(o).attr({stroke:"none"}),h=l.attrs,u=l.node,p=u.getElementsByTagName(c)[0];return h.src=e,l.X=h.x=r,l.Y=h.y=n,l.W=h.width=s,l.H=h.height=a,h.path=o,l.type="image",p.parentNode==u&&u.removeChild(p),p.rotate=!0,p.src=e,p.type="tile",l._.fillpos=[r,n],l._.fillsize=[s,a],u.appendChild(p),_(l,1,1,0,0,0),l},i._engine.text=function(t,r,n,a){var o=k("shape"),l=k("path"),c=k("textpath");r=r||0,n=n||0,a=a||"",l.v=i.format("m{0},{1}l{2},{1}",s(r*y),s(n*y),s(r*y)+1),l.textpathok=!0,c.string=e(a),c.on=!0,o.style.cssText=m,o.coordsize=y+p+y,o.coordorigin="0 0";var h=new E(o,t),u={fill:"#000",stroke:"none",font:i._availableAttrs.font,text:a};h.shape=o,h.path=l,h.textpath=c,h.type="text",h.attrs.text=e(a),h.attrs.x=r,h.attrs.y=n,h.attrs.w=1,h.attrs.h=1,C(h,u),o.appendChild(c),o.appendChild(l),t.canvas.appendChild(o);var d=k("skew");return d.on=!0,o.appendChild(d),h.skew=d,h.transform(""),h},i._engine.setSize=function(t,e){var r=this.canvas.style;return this.width=t,this.height=e,t==+t&&(t+="px"),e==+e&&(e+="px"),r.width=t,r.height=e,r.clip="rect(0 "+t+" "+e+" 0)",this._viewBox&&i._engine.setViewBox.apply(this,this._viewBox),this},i._engine.setViewBox=function(t,e,r,n,s){i.eve("raphael.setViewBox",this,this._viewBox,[t,e,r,n,s]);var o,l,c=this.width,h=this.height,u=1/a(r/c,n/h);return s&&(r*(o=h/n)<c&&(t-=(c-r*o)/2/o),n*(l=c/r)<h&&(e-=(h-n*l)/2/l)),this._viewBox=[t,e,r,n,!!s],this._viewBoxShift={dx:-t,dy:-e,scale:u},this.forEach(function(t){t.transform("...")}),this},i._engine.initWin=function(t){var e=t.document;e.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!e.namespaces.rvml&&e.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),k=function(t){return e.createElement("<rvml:"+t+' class="rvml">')}}catch(t){k=function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},i._engine.initWin(i._g.win),i._engine.create=function(){var t=i._getContainer.apply(0,arguments),e=t.container,r=t.height,n=t.width,s=t.x,a=t.y;if(!e)throw new Error("VML container not found.");var o=new i._Paper,l=o.canvas=i._g.doc.createElement("div"),c=l.style;return s=s||0,a=a||0,n=n||512,r=r||342,o.width=n,o.height=r,n==+n&&(n+="px"),r==+r&&(r+="px"),o.coordsize=216e5+p+216e5,o.coordorigin="0 0",o.span=i._g.doc.createElement("span"),o.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",l.appendChild(o.span),c.cssText=i.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",n,r),1==e?(i._g.doc.body.appendChild(l),c.left=s+"px",c.top=a+"px",c.position="absolute"):e.firstChild?e.insertBefore(l,e.firstChild):e.appendChild(l),o.renderfix=function(){},o},i.prototype.clear=function(){i.eve("raphael.clear",this),this.canvas.innerHTML="",this.span=i._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},i.prototype.remove=function(){for(var t in i.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas),this)this[t]="function"==typeof this[t]?i._removedFactory(t):null;return!0};var B=i.st;for(var A in P)P[t](A)&&!B[t](A)&&(B[A]=function(t){return function(){var e=arguments;return this.forEach(function(i){i[t].apply(i,e)})}}(A))}}(),C.was?S.win.Raphael=i:Raphael=i,i;var pe,de,fe;var ge,ve}(t,t.eve)}(this),function(t){Raphael.fn.nestedSVG=function(e,i,r){var n=this;arguments[0]instanceof Array||arguments[0];return function(s,a){n.set(a);var o,l=new Raphael(e,i,r);return l.canvas.setAttribute("x",0),l.canvas.setAttribute("y",0),n.canvas.appendChild(l.canvas),o={move:function(t,e){l.canvas.setAttribute("x",t),l.canvas.setAttribute("y",e)}},t.extend(l,o),l}(0,arguments[0]instanceof Array?arguments[0]:arguments[1])}}(jQuery),jQuery,Raphael.fn.marker=function(){var t=this;return arguments[0]instanceof Array||arguments[0],function(e,i){t.set(i);var r=t.raphael.vml?document.createElement("marker"):document.createElementNS("http://www.w3.org/2000/svg","marker"),n=t.path("M2,2 L2,10 L10,6 L2,2");return n.node.setAttribute("fill","black"),t.defs.appendChild(r),r.appendChild(n.node),{scale:function(t,e){var i=r.getAttribute("transform");return r.attr("transform",updateScale(i,t,e)),this},move:function(t,e){r.setAttribute("x",t),r.setAttribute("y",e)},attr:function(t,e){r.setAttribute(t,e)},attrs:function(t){for(var e in t)r.setAttribute(e,t[e])},type:"marker",node:r}}(0,arguments[0]instanceof Array?arguments[0]:arguments[1])},function(t){Raphael.fn.group=function(){var e=this;arguments[0]instanceof Array||arguments[0];return function(i,r){e.set(r);var n,s=e.raphael.vml?document.createElement("group"):document.createElementNS("http://www.w3.org/2000/svg","g");return e.canvas.appendChild(s),s.canvas=s,n={setScale:function(t){return e.raphael.vml?this.forEach(function(e){var i=e.data("rotation")||0;e.transform("S"+t+","+t+", 0, 0, r"+i)}):s.setAttribute("transform","scale("+t+")"),this},getScale:function(){var t=s.getAttribute("transform");return null===t&&(t="scale(1)"),t.replace("scale(","").replace(")","")}},t.extend(n,e),n.scale=n.setScale,n.canvas=s,n[0]=s,n.type="group",n.node=s,n}(0,arguments[0]instanceof Array?arguments[0]:arguments[1])}}(jQuery),function(t){t.widget("diagram.activityMap",{options:{width:100,height:100,format:{},spaceInterLine:110,verticalPadding:50,background:{lineColor:"#D8D8D8"},activities:{},legendProcess:{},showByTime:!1,timeWindowInterval:2e3,cssClass:"activity-map-tooltip activity-map-activity-default-status",cssClassHighlight:"activity-map-tooltip activity-map-activity-highlight",colorCurrentActivity:"rgba(255, 0, 0, 0.2)",identifyingClassCurrentActivity:"activity-map-current-activity",colorList:"#FEC107,#FF5521,#795549,#0173BF,#7cb5ec,#434348,#90ed7d,#f7a35c,#8085e9,#f15c80,#e4d354,#2b908f,#F44236,#E91D62,#9C26B0,#6739B6,#3E50B4,#01BBD4,#019587,#4BAF4F,#8BC24A".split(","),data:{},currentActivity:""},_create:function(){var e=this,i=this.options,r=i.data||{},n=e.element.context.id||"body",s=t("<div id='legend-box'></div>");t(e.element.parent()).prepend(s),e._stickPath=!1,e._stickActivity="",e.activitiesPositionReference={},e.nodePosition={},e.mouseEventHelper={hover:function(t,e,i){var r=!1;t.hover(function(t){r||(e(t),r=!0)},function(t){i(t),r=!1})}},this.diagram=Raphael(n,i.width,i.height);var a=e._mapProcessListWithColors(e._getProcessList(r.processes),i.colorList);e._getLegendProcess({paper:"#legend-box",processList:a});t(this.diagram.canvas).append();var o=e.sortWorkItemsByDate(r.activities),l=e._getUniqueTimeReference(o);e.dateColumnsPosition=e._drawBackgroundDateColumns({paper:this.diagram,dateList:l,positionX:0,spaceInterLine:i.spaceInterLine,lineColor:i.background.lineColor});var c=e._drawActivities({paper:this.diagram,activityList:e._getActivityTree(o),processList:a,positionX:i.spaceInterLine/2,positionY:80,spaceInterLine:i.spaceInterLine,verticalPadding:50,circleRadius:10,textPosition:"top",cssClass:i.cssClass,cssClassHighlight:i.cssClassHighlight,attributes:{"font-size":"11"}});e.lines=e._drawActivityLines({paper:this.diagram,activitiesPositionReference:c,attributes:{}}),e._viewBoxWidth=e.element.outerWidth(),e._viewBoxHeight=e.element.outerHeight(),e.viewBox=this.diagram.setViewBox(-1,-1,e._viewBoxWidth,e._viewBoxHeight),e.viewBox.X=0,e.viewBox.Y=0;var h=e.diagram.canvas.getBBox&&e.diagram.canvas.getBBox()&&e.diagram.canvas.getBBox().width?e.diagram.canvas.getBBox().width:e.diagram.canvas.attributes.width,u=e.diagram.canvas.getBBox&&e.diagram.canvas.getBBox()&&e.diagram.canvas.getBBox().height?e.diagram.canvas.getBBox().height:e.diagram.canvas.attributes.height;e.element.outerWidth()>h&&e.element.outerWidth(),e.element.outerHeight()>u&&e.element.outerHeight();e._configureHandlers()},_configureHandlers:function(){var t,e,i=this,r=!1,n=0,s=0;i.element.bind("zoom",function(t,e){i._zoom(e)}),i.element.mousedown(function(n){null==i.diagram.getElementByPoint(n.pageX,n.pageY)&&(r=!0,t=n.pageX,e=n.pageY)}),i.element.mousemove(function(a){if(0!=r){n=t-a.pageX,s=e-a.pageY;var o=i._viewBoxWidth/i.element.outerWidth(),l=i._viewBoxHeight/i.element.outerHeight();n*=o,s*=l,i.diagram.setViewBox(i.viewBox.X+n,i.viewBox.Y+s,i._viewBoxWidth,i._viewBoxHeight)}}),i.element.mouseup(function(t){0!=r&&(i.viewBox.X+=n,i.viewBox.Y+=s,r=!1)})},_zoom:function(t){var e=this.element.outerHeight(),i=this.element.outerWidth();t=parseFloat(t),this._viewBoxWidth=i*(2-t),this._viewBoxHeight=e*(2-t),this.diagram.setViewBox(this.viewBox.X,this.viewBox.Y,this._viewBoxWidth,this._viewBoxHeight)},_circleCollision:function(t,e,i,r,n,s){var a=i,o=s,l=t-r,c=e-n;return Math.sqrt(l*l+c*c)<a+o},_hasNodeCollision:function(e,i,r,n){n=n||[],r=r||"";var s=!1,a=this;return t.each(n,function(t,n){n.rendered&&r!=n.guidWorkitem&&a._circleCollision(n.x,n.y,20,e,i,20)&&(s=!0)}),s},_getLegendProcess:function(e){var i,r=e.processList||{},n=t("<div></div>");t.each(r,function(e,r){(i=t('<div class="activity-map-legend-row"><a class="activity-map-legend-row-process"></a><span class="activity-map-legend-row-label">'+r.name+"</span></div>")).find(".activity-map-legend-row-process").css({"background-color":r.color,"border-color":r.color}),i.data({guidProcess:e}),n.append(i)}),Object.keys(r).length>1&&t(e.paper).append('<h2 class="activity-map-legend-title">Processes</h2>'),t(e.paper).append(n),this.element.bind("activity.mouseenter",function(e,i){t(".activity-map-legend-row").filter(function(){return t(this).data("guidProcess")==i.guidProcess}).each(function(){t(this).addClass("activity-map-highlight")})}).bind("activity.mouseleave",function(){t(".activity-map-highlight").removeClass("activity-map-highlight")})},_getProcessList:function(t){return t=t||{}},_mapProcessListWithColors:function(e,i){var r,n={};return e=e||[],i=i||[],t.each(e,function(t,e){r=r&&r.length>0?r:i.slice(0),n[t]={name:e,color:r.pop()}}),n},_getActivityList:function(t){return t=t||{}},_getActivityTree:function(e){var i=[];e=e||{};return t.each(e,function(r,n){var s,a,o;n.children=(s="parentWorkItem",a=n.guidWorkitem,o=[],s=s||"",t.each(e,function(t,e){void 0!==e[s]&&e[s]==a&&(e.referenced=!0,o.push(e))}),o),i.push(n)}),i},_addNodePosition:function(t,e){t=t||"",this.nodePosition[t]=e},_getNodePosition:function(t){return t?this.nodePosition[t]:this.nodePosition},_getActivityPositionEngine:function(t){var e=t.activity,i=t.previousActivity,r={x:t.positionX||10,y:t.positionY||10},n=t.verticalPadding||20,s=(t.spaceInterLine,t.activityList||[]);if(!i){var a=6*e.name.length;return r.x=r.x>a/2?r.x:a/2,r}var o=this._getColumnPositionByGuidWorkItem(e.guidWorkitem),l=function(t){r.y=t?t.y:r.y,r.y=r.y+n};if(i.guidProcess==e.guidProcess&&i.idCase==e.idCase&&e.parentWorkItem==i.guidWorkitem)this._hasNodeCollision(o,r.y,e.guidWorkitem,s)&&l();else if(i.parentWorkItem==e.parentWorkItem)l();else{this._getNodePosition(e.parentWorkItem);l()}return r.x=o,r},_sortWorkItemsByParentGuidProcess:function(t,e){t=t||[];try{t.sort(function(t,i){return t.guidProcess==e?-1:i.guidProcess==e?1:0})}catch(t){t.toString()}return t},sortWorkItemsByDate:function(t){var e,i,r,n;t=t||[];try{t.sort(function(t,s){return e=new Date(t.creationDate),i=new Date(s.creationDate),r=e.getTime(),n=i.getTime(),r<n?-1:r>n?1:0})}catch(t){t.toString()}return t},_getUniqueTimeReference:function(e){e=e||{};var i,r,n={},s=0,a=this.options.timeWindowInterval;return t.each(e,function(t,e){if(i=new Date(e.creationDate),r)if(i.getTime()<s+a)n[r].push(e);else{n[e.creationDate]=[],n[e.creationDate].push(e),r=e.creationDate;o=new Date(e.creationDate);s=o.getTime()}else{n[e.creationDate]=[],n[e.creationDate].push(e),r=e.creationDate;var o=new Date(e.creationDate);s=o.getTime()}}),n},_getColumnPositionByGuidWorkItem:function(e){var i=0;return e=e||"",t.each(this.dateColumnsPosition,function(t,r){t==e&&(i=r)}),i},_drawBackgroundDateColumns:function(e){var i,r,n,s,a,o=e.dateList||[],l=e.paper||Raphael("body",0,0),c={x:e.positionX||0},h={},u=e.spaceInterLine||50,p=e.lineColor||"#000000",d=this.diagram.canvas.getBBox&&this.diagram.canvas.getBBox()&&this.diagram.canvas.getBBox().height?this.diagram.canvas.getBBox().height:this.diagram.canvas.attributes.height,f=this.element.outerHeight()>d?this.element.outerHeight()+150:d+150,g=0;return t.each(o,function(e,o){if(t.each(o,function(t,e){var i=12*e.name.length;u=u>i/2?u:i/2}),i=i||t.extend(!0,{},c),r=new Date(e),n=t.datepicker.formatDate("M, dd",r),s=e.split(" ")[1],a=i.x+u/2,g>0){var d=l.path(printf("M%d,%d L%d,%d",i.x,0,i.x,f)).attr({stroke:p,"stroke-width":"1px","stroke-opacity":.4});t(d.node).addClass("activity-map-background-line")}l.text(a,10,n).attr({"font-size":"20px"}).node.setAttribute("class","activity-map-activity-date"),l.text(a,30,s).attr({"font-size":"16px"}).node.setAttribute("class","activity-map-activity-time"),t.each(o,function(t,e){h[e.guidWorkitem]=a}),i.x=i.x+u,g+=1}),h},_drawActivities:function(e){var i,r,n,s,a=this,o=e.paper||Raphael("body",0,0),l=e.activityList||[],c=e.textPosition||"top",h={x:e.positionX||0,y:e.positionY||10},u=e.processList||{},p=e.verticalPadding||20,d=e.spaceInterLine||50,f=e.circleRadius||10,g=2*f,v=e.attributes||{},m=e.cssClass||"",y=o.set(),x=function(e){e.rendered||(i=i||t.extend(!0,{},h),i=a._getActivityPositionEngine({previousActivity:s,activity:e,positionX:i.x,positionY:i.y,verticalPadding:p,spaceInterLine:d,activityList:l}),e.x=i.x,e.y=i.y,w(i,e),e.children.length>0&&(e.children=a._sortWorkItemsByParentGuidProcess(e.children,e.guidProcess),t.each(e.children,function(t,e){x(e)})))},b=function(t,e){t.data({guidProcess:e.guidProcess,guidWorkitem:e.guidWorkitem,idCase:e.idCase,idWorkflow:e.idWorkFlow})},w=function(e,i){n=u[i.guidProcess].color;var l=o.circle(e.x,e.y,f).attr({fill:n,stroke:n});if(b(t(l.node),i),b(l,i),l.toFront(),a.options.currentActivity==i.idCase){var c=o.circle(e.x,e.y,f+5).attr({fill:a.options.colorCurrentActivity,stroke:a.options.colorCurrentActivity});c.node.setAttribute("class",a.options.identifyingClassCurrentActivity),b(t(c.node),i),b(c,i),c.toBack(),y.push(c)}return l.node.setAttribute("class",m),y.push(l),l.hover(function(){var e=this.data();a.element.trigger("activity.mouseenter",[e]),a._stickPath||(t(this.node).addClass("activity-map-activity-highlight"),a._highlight({guidWorkitem:e.guidWorkitem,highlight:!0}))},function(){var e=this.data();a.element.trigger("activity.mouseleave",[e]),a._stickPath||(t(this.node).removeClass("activity-map-activity-highlight"),a._highlight({guidWorkitem:e.guidWorkitem,highlight:!1}))}).click(function(){var t=this.data();a._stickAllPath(t.guidWorkitem)}),t("#bz-activity-map").mouseover(function(){t(".activity-map-tooltip").mouseout()}),r=_(i.name,e,i.guidWorkitem,i.creationDate),a._addNodePosition(i.guidWorkitem,{positionReference:e,positionReferenceText:r,color:n,parentWorkItem:i.parentWorkItem,circleRadius:f}),s=i,i.rendered=!0,e},_=function(e,i,n,s){switch(c){case"top":r={x:i.x,y:i.y-g};break;case"bottom":r={x:i.x,y:i.y+g};break;case"left":r={x:i.x-g,y:i.y,"text-anchor":"end"};break;case"right":r={x:i.x+g,y:i.y,"text-anchor":"start"}}return r=t.extend({fill:"#3E5664"},v,r),o.text(r.x,r.y,e+" ").attr(r),r};return t.each(l,function(t,e){x(e)}),a.activities=y,o.setFinish(),a._getNodePosition()},_stickAllPath:function(t){var e=this;e._stickPath=""!=e._stickActivity&&e._stickActivity!==t||!e._stickPath,e._stickActivity=t,e.activities.items.forEach(function(i,r){i.data("guidWorkitem")!==t&&i.node.setAttribute("class",e.options.cssClass)}),e.lines.items.forEach(function(t,i){t.data("visible")?(t.toBack(),t.node.setAttribute("class",e.options.cssClass)):t.toFront()}),e._highlight({guidWorkitem:t,highlight:e._stickPath})},_highlight:function(t){var e=this;if(t.guidWorkitem){var i=t.highlight||!1;e.activities&&e.activities.items.forEach(function(r){if(r.data("guidWorkitem")==t.guidWorkitem)if(i){var n=e.options.cssClassHighlight;-1!=r.node.getAttribute("class").split(" ").indexOf(e.options.identifyingClassCurrentActivity)&&(n=e.options.identifyingClassCurrentActivity+" "+e.options.cssClassHighlight),r.node.setAttribute("class",n)}else-1!=r.node.getAttribute("class").split(" ").indexOf(e.options.identifyingClassCurrentActivity)?r.node.setAttribute("class",e.options.identifyingClassCurrentActivity):r.node.setAttribute("class",e.options.cssClass)}),e.lines&&e.lines.items.filter(function(e){return e.data("workItem")==t.guidWorkitem&&e.data("visible")}).forEach(function(t){i?(t.toFront(),t.node.setAttribute("class",e.options.cssClassHighlight)):(t.toBack(),t.node.setAttribute("class",e.options.cssClass)),e._highlight({guidWorkitem:t.data("parentWorkItem"),highlight:i})})}},_getPath:function(e,i,r){var n,s,a,o=[];e=e||"",i=i||[];var l=[];return t.each(i,function(t,i){i.maxY<e.maxY&&i.maxY>e.minY&&i.minX<e.minX&&i.maxX>e.minX&&o.push(i.strPath)}),o.length>0?(n=Raphael.pathIntersection(e.strPath,o),t.each(n,function(t,i){s=0==t?e.minY:n[t-1].y+5,a=i.y-5,l.push(printf("M%d,%d L%d,%d",e.minX,s,e.minX,a)),l.push(printf("M%d,%d A%d,%d 0 0,%d %d,%d",e.minX,a,5,5,0,e.minX,a+10))}),l.push(printf("L%d,%d L%d,%d",e.minX,e.maxY,e.maxX,e.maxY))):l.push(e.strPath),l},_drawActivityLines:function(e){var i,r,n,s,a,o,l,c=this,h=e.paper||Raphael("body",0,0),u=e.activitiesPositionReference||{},p="M%d,%d L%d,%d L%d,%d",d=e.circleRadius||10,f=e.attributes||{},g=[];f=t.extend(f,{"arrow-end":"classic-wide-long","stroke-linejoin":"round"});var v=h.set();return t.each(u,function(t,e){if(""!=e.parentWorkItem&&u[e.parentWorkItem]){i=u[e.parentWorkItem],r=i.positionReference,i.positionReference.y==e.positionReference.y?(s=r.x+d,a=e.positionReference.x-d-3,o=r.y,l=e.positionReference.y,n=printf(p,s,o,a,l)):r.x==e.positionReference.x?(s=r.x,o=r.y+d,l=e.positionReference.y-d-3,n=printf("M%d,%d L%d,%d",s,o,s,l)):(s=r.x,a=e.positionReference.x-d-3,o=r.y+d,l=e.positionReference.y,n=printf(p,s,o,r.x,e.positionReference.y,a,l));var m={strPath:n,minX:s,maxX:a,minY:o,maxY:l};n=c._getPath(m,g,h),g.push(m);var y=h.path(n).attr(f).toBack();y.data({workItem:t,parentWorkItem:e.parentWorkItem,visible:!0}),y.node.setAttribute("class","activity-map-connector"),y.node.setAttribute("stroke","#7cb5ec");var x=h.path(n).attr({"stroke-opacity":0,"stroke-width":15});x.data({workItem:t,parentWorkItem:e.parentWorkItem,visible:!1}),c.mouseEventHelper.hover(x,function(t){c._stickPath||(c._highlight({guidWorkitem:x.data("workItem"),highlight:!0}),x.toFront())},function(t){c._stickPath||(c._highlight({guidWorkitem:x.data("workItem"),highlight:!1}),x.toFront())}),x.click(function(){var t=this.data();c._stickAllPath(t.workItem),this.toFront()}),v.push(y),v.push(x)}}),t("#raphael-marker-endclassic55 use").attr("fill","#7cb5ec"),h.setFinish(),v},destroy:function(){t.Widget.prototype.destroy.call(this)}})}(jQuery),function(t){t.widget("diagram.processMap",{options:{data:{}},_create:function(){var t=this.options.data||{},e=this.indexingData(t);return this.element.addClass("tree"),this.drawEngine(e),this._configureHandlers(),this},_configureHandlers:function(){var t=this;t.element.bind("zoom",function(e,i){t._zoom(i)}),t.element.draggable()},_zoom:function(e){t(this.element).css({"font-size":e+"em"})},indexingData:function(e){var i,r,n,s=this;s.indexedData={maxVerticalLevels:0,maxHorizontalNodes:0,parentNode:{},latestChild:{},data:e||{},nodesByLevel:{},nodesById:{}};var a=function(e,i){var r=[];return e=e||"",t.each(s.indexedData.data,function(t,n){void 0!==n[e]&&n[e]==i&&r.push(n)}),r};return t.each(s.indexedData.data,function(t,e){i=a("guidCase",e.guidParentCase),r=a("guidParentCase",e.guidCase),0==i.length?(n=0,s.indexedData.parentNode=e):n=i[0].relation?i[0].relation.depth+1:0,s.indexedData.data[t].relation={parent:i,children:r,depth:n,limitX:{min:0,max:0}},void 0===s.indexedData.nodesByLevel[n]&&(s.indexedData.nodesByLevel[n]=[]),s.indexedData.nodesByLevel[n].push(s.indexedData.data[t]),s.indexedData.nodesByLevel[n].length>s.indexedData.maxHorizontalNodes&&(s.indexedData.maxHorizontalNodes=s.indexedData.nodesByLevel[n].length),n>s.indexedData.maxVerticalLevels&&(s.indexedData.maxVerticalLevels=n,s.indexedData.latestChild=s.indexedData.data[t]),s.indexedData.nodesById[e.guidCase]=s.indexedData.data[t]}),s.indexedData},drawEngine:function(e){var i,r,n;function s(t,e){var i={idcase:e.idCase,idworkflow:e.idWorkFlow,enddate:e.finishDate,startdate:e.creationDate,process:e.name};return t.data(i),t.addClass("subprocess-tooltip"),t}i=t("<ul>"),r=s(t("<a>"),e.parentNode).html(e.parentNode.name),n=t("<li class='center'>").append(r),i.append(n),n.append(function e(i){if(i.relation.children.length){for(var r,n,a,o,l=t("<ul>"),c=0;c<i.relation.children.length;c++)r=s(t("<a>"),i.relation.children[c]),o=t("<span class='arrow'>"),n=r.html(i.relation.children[c].name),(a=t("<li>")).append(o),a.append(n),a.append(e(i.relation.children[c])),l.append(a);return l}return null}(e.parentNode)),this.element.css({"min-width":"5000px",transform:"translateY(20%)","-ms-transform":"translateY(20%)","-moz-transform":"translateY(20%)","-webkit-transform":"translateY(20%)"}),this.element.html(i),$element=t(".bz-subprocess-map"),$parent=$element.parent();var a=$parent.width(),o=$element.width();$parent.scrollLeft((o-a)/2)}})}(jQuery),function(t){t.widget("diagram.zoom",{options:{min:50,max:150,step:10,value:100,onZoom:function(t){}},_create:function(){this.options;this._bindSlider(),this._bindTooltip()},_bindSlider:function(){options=this.options,this.element.slider({min:options.min,max:options.max,step:options.step,value:options.value,change:function(e,i){options.onZoom(i.value);var r=i.value.toString()+"%";t("#zoom-value").text(r)}})},_bindTooltip:function(){var e=this,i=t("<div class='zoom-tooltip'><label id='zoom-value'></label></div>");t(".bz-zoom-container").append(i),t(".bz-zoom-container").mouseenter(function(){i.addClass("is-visible-output");var r=e.element.slider("option","value")+"%";t("#zoom-value").text(r)}).mouseleave(function(){i.removeClass("is-visible-output")})},destroy:function(){t.Widget.prototype.destroy.call(this)}})}(jQuery),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.graphicquery",{},{init:function(t,e,i){var r=this;r.subprocesses=[],r.currentTasks=[],r.path=[],r.callStack=[],r.currentWorkflow={idCase:i.data.idCase,idWorkflow:i.data.idWorkflow},r._super(t,e,i),r.loadTemplates({"graphicquery-wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widgets.graphicquery").concat("#ui-bizagi-workportal-widget-graphicquery-wrapper"),"graphicquery-tooltip-currenttask":bizagi.getTemplate("bizagi.workportal.desktop.widgets.graphicquery").concat("#ui-bizagi-workportal-widget-graphicquery-tooltip-currenttask"),"graphicquery-tooltip-subcases":bizagi.getTemplate("bizagi.workportal.desktop.widgets.graphicquery").concat("#ui-bizagi-workportal-widget-graphicquery-tooltip-subcases"),"graphicquery-subcases":bizagi.getTemplate("bizagi.workportal.desktop.widgets.graphicquery").concat("#ui-bizagi-workportal-widget-graphicquery-subcases"),"graphicquery-parentsummary":bizagi.getTemplate("bizagi.workportal.desktop.widgets.graphicquery").concat("#ui-bizagi-workportal-widget-graphicquery-parentsummary"),"graphicquery-summary":bizagi.getTemplate("bizagi.workportal.desktop.widgets.graphicquery").concat("#ui-bizagi-workportal-widget-graphicquery-summary"),"graphicquery-tooltip-users":bizagi.getTemplate("bizagi.workportal.desktop.widgets.graphicquery").concat("#ui-bizagi-workportal-widget-graphicquery-tooltip-users"),"graphicquery-actionbar":bizagi.getTemplate("bizagi.workportal.desktop.widgets.graphicquery").concat("#ui-bizagi-workportal-widget-graphicquery-actionbar"),useNewEngine:!1})},getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY},renderContent:function(){var t=this.getTemplate("graphicquery-wrapper");return this.content=$.tmpl(t)}}),bizagi.workportal.widgets.graphicquery.extend("bizagi.workportal.widgets.graphicquery",{},{postRender:function(){var t=this;t.dateFormat=t.getResource("dateFormat")+" "+t.getResource("timeFormat"),t.$header=$(".bz-gq-header",t.content),t.$actionBar=$("#bz-gq-actionbar-container",t.$header),t.$pvCanvas=$("#bz-gq-processviewer-canvas",t.content),t.$summary=$("#bz-gq-summary-container",t.$header),t.renderProcessViewer(),t.eventsHandler()},refreshContent:function(t){var e=this;e.path=[],e.subprocesses=[],e.currentTasks=[],e.currentWorkflow={idCase:t.idCase,idWorkflow:t.idWorkflow,idParentWorkItem:t.idParentWorkItem},e.renderProcessViewer(),e.$pvCanvas.processviewer("destroy"),e.$actionBar.empty(),e.$summary.empty()},setCallStack:function(){this.callStack.push(this.currentWorkflow)},renderHeader:function(t,e){var i=this.callStack.length;i&&(t.parentCase=t.parentCase||{},$.extend(t.parentCase,this.callStack[i-1])),this.renderActionBar(t.parentCase,t.pathWorkItems,e),this.renderSummary(t)},renderActionBar:function(t,e,i){var r=this.getTemplate("graphicquery-actionbar"),n=this.filterItems(e,i),s={combo:[],id:"positions"};s.combo=n,this.$actionBar.html($.tmpl(r,{parentCase:t,items:n})),this.renderSelectCombo(s)},renderSelectCombo:function(t){var e=this,i=e.getContent(),r=$.Deferred(),n=$("#bz-gq-select-item",i),s=t.combo[0],a=s.guidTask;return n.uicombo({isEditable:!1,isSearchable:!1,data:t,itemValue:function(t){return t.guidTask},itemText:function(t){return t.nameTask},onComplete:function(){r.resolve()},onChange:function(t){var i=t.ui.data("value"),r=$("#"+i);""!=i&&i!=a&&(a=i,e.$pvCanvas.processviewer("setPosition",r,i))},initValue:s}),r},filterItems:function(t,e){return itemsArray=[],itemsArray.push({guidTask:"",nameTask:this.getResource("workportal-general-select")}),t.forEach(function(t){var i,r;r=t.idTaskType,-1!=[2,3,7,10,14,15,37,38,39,40,43].indexOf(r)&&0==t.wiClosed&&(i=t,e.filter(function(t){return t.id==i.guidTask}).length>0)&&itemsArray.push(t)}),itemsArray},renderSummary:function(t){var e=this,i=e.getTemplate("graphicquery-summary"),r=$.tmpl(i,t);if(bizagi.util.formatInvariantDate(r,e.dateFormat),e.$summary.html(r),t.parentCase){var n=e.getTemplate("graphicquery-parentsummary");e.$summary.append($.tmpl(n,t.parentCase))}},renderProcessViewer:function(){var t=this,e=(t.getContent(),"processId="+t.currentWorkflow.idWorkflow),i="idCase="+t.currentWorkflow.idCase+"&idWorkFlow="+t.currentWorkflow.idWorkflow;i+=t.currentWorkflow.idParentWorkItem?"&idParentWorkItem="+t.currentWorkflow.idParentWorkItem:"",$.when(t.dataService.processDefinition(e),t.dataService.graphicInfo(e),t.dataService.getGraphicQueryInfo(i)).done(function(e,i,r){$.extend(t.currentWorkflow,{idProcess:r[0].idProcess,nameProcess:r[0].nameProcess,radicationNumber:r[0].currentCase.radicationNumber}),t.renderHeader(r[0],e[0].flowElements),t.pathWorkItems=r[0].pathWorkItems,t.$pvCanvas.processviewer({height:t.getPVHeight(),jsonBizagi:{processDefinition:e[0],processGraphicsInfo:i[0]},zoomRange:5})}).fail(function(e){var i=JSON.parse(e.responseText);t.publish("closeCurrentDialog"),bizagi.showMessageBox(i.message,"Bizagi","warning")})},toggleHighlight:function(){for(var t=this,e=[],i=0,r=t.currentTasks.length;i<r;i++)e.push(t.currentTasks[i].guidTask);t.highlighted?(t.highlighted=!1,t.$pvCanvas.processviewer("unSelectShape",e,t.currentTasks)):(t.highlighted=!0,t.$pvCanvas.processviewer("selectShape",e,t.currentTasks))},eventsHandler:function(){var t=this;t.applyViewerTooltip(),t.$actionBar.on("click","#bz-gq-button-parent, #bz-gq-button-path, #bz-gq-button-status",function(e){if("bz-gq-button-status"===this.id)t.toggleHighlight();else if("bz-gq-button-parent"===this.id){if(t.callStack.length)var i=t.callStack.pop(),r=i.idWorkflow,n=i.idCase;else n=$(this).data("idcase"),r=$(this).data("idworkflow");t.refreshContent({idWorkflow:r,idCase:n})}else"bz-gq-button-path"===this.id&&($("i",this).toggleClass("bz-gq-icon-path-stop"),t.drawCasePath())}),t.$pvCanvas.on("animationComplete",function(e){$("#bz-gq-button-path i",t.$actionBar).removeClass("bz-gq-icon-path-stop")}),t.$pvCanvas.on("pvComplete",function(e){t.highlighted=!1,t.getRelevantData(),t.toggleHighlight(),t.showSubCases(),e.stopPropagation()})},applyViewerTooltip:function(t){var e=this;e.$pvCanvas.tooltip({items:"div.processviewer-shape-selected, div.has-subprocess, div.processviewer-highlighted",content:function(t,i){return e.getTooltipContent($(this))},show:{duration:120,effect:"none"},tooltipClass:"bz-gq-tooltip-wrapper",hide:{delay:250,duration:120},close:function(t,e){e.tooltip.hover(function(){$(this).stop(!0).fadeTo(120,1)},function(){$(this).fadeOut(120,function(){$(this).remove()})})}})},getTooltipContent:function(t){var e,i=this,r="",n=t.find(".processviewer-hotspot-label").text(),s=t.prop("id"),a=$.Deferred(),o=t.attr("class")||"";return e=-1==o.indexOf("gateway")&&-1==o.indexOf("start")&&-1==o.indexOf("end"),t.hasClass("has-subprocess")?(r=i.getSubCasesContent(n,s),i.bindTooltipEvent(r)):!t.hasClass("processviewer-shape-selected")||t.hasClass("end")||t.hasClass("start")||t.hasClass("scripttask")||t.hasClass("servicetask")||t.hasClass("sendtask")||t.hasClass("receivetask")?(t.hasClass("processviewer-highlighted")||t.hasClass("processviewer-shape-selected"))&&(t.hasClass("manualtask")||e)&&(r=i.renderPreviousTaskTooltip(n,s,a)):r=i.renderCurrentTaskTooltip(n,s,a),a.promise().done(function(t){bizagi.util.formatInvariantDate(t,i.dateFormat)}),r},getSubCasesContent:function(t,e){for(var i=this.getTemplate("graphicquery-tooltip-subcases"),r="",n=[],s=0,a=this.subprocesses.length;s<a;s++){var o=this.subprocesses[s];o.guidTask===e&&(taskType=o.subProcess.taskType,r=o.subProcess.taskName,n=o.subProcess.items,s=a)}return $.tmpl(i,{taskName:t,taskType:taskType,subprocess:r,cases:n})},renderCurrentTaskTooltip:function(t,e,i){var r=this,n=$("<div></div>");return $.when(r.getCurrentTaskContent(e)).done(function(e){var s=r.getTemplate("graphicquery-tooltip-currenttask"),a={taskName:t,entryDate:e.wiEntryDate,expireDate:e.wiEstimatedSolutionDate,users:bizagi.override.showAssignees?e.usersAssignees:[]};n=$.tmpl(s,a),$(".bz-gq-tooltip-wrapper").html(n),i.resolve(n)}),n},getCurrentTaskContent:function(t){for(var e=this,i=(e.getTemplate("graphicquery-tooltip-currenttask"),$.Deferred()),r=0,n=e.currentTasks.length;r<n;r++)if(t===e.currentTasks[r].guidTask){0===e.currentTasks[r].usersAssignees.length?e.dataService.getUserInfoByTask(e.currentWorkflow.idCase,t).done(function(t){e.currentTasks[r].usersAssignees=t,i.resolve(e.currentTasks[r])}).fail(function(t){i.reject(e.currentTasks[r])}):i.resolve(e.currentTasks[r]);break}return i.promise()},showSubCases:function(){for(var t=this,e=t.getTemplate("graphicquery-subcases"),i=0,r=t.subprocesses.length;i<r;i++){var n=t.subprocesses[i].guidTask,s=t.$pvCanvas.find("#"+n),a=t.subprocesses[i].subProcess.items.length;s.addClass("has-subprocess"),s.prepend($.tmpl(e,{ncases:a}))}},renderPreviousTaskTooltip:function(t,e,i){var r=this,n=$("<div></div>");return $.when(r.getUsersDataForPreviousTask(e)).done(function(e){var s=r.getTemplate("graphicquery-tooltip-users");n=$.tmpl(s,$.extend(e,{taskName:t})),$(".bz-gq-tooltip-wrapper").html(n),i.resolve(n)}),n},getUsersDataForPreviousTask:function(t){for(var e=this,i=$.Deferred(),r=0,n=e.pathWorkItems.length;r<n;r++)if(t===e.pathWorkItems[r].guidTask){0===e.pathWorkItems[r].usersAssignees.length?e.dataService.getUserInfoByTask(e.currentWorkflow.idCase,t).done(function(t){e.pathWorkItems[r].usersAssignees=t,i.resolve(e.pathWorkItems[r])}).fail(function(t){i.reject(e.pathWorkItems[r])}):i.resolve(e.pathWorkItems[r]);break}return i.promise()},getPVHeight:function(){var t=this.$header.height()+45;return this.content.parent().height()-t},bindTooltipEvent:function(t){var e=this;$(".bz-gq-tooltip-list li",t).on("click",function(){$(this).closest(".ui-tooltip").remove();var t={idWorkflow:$(this).data("idworkflow"),idCase:$(this).data("idcase"),idParentWorkItem:$(this).data("idparentworkitem")};e.currentWorkflow.task=$(this).parent().data("parenttaskname"),e.currentWorkflow.idParentWorkItem=t.idParentWorkItem,e.setCallStack(),e.refreshContent(t)})},getRelevantData:function(){for(var t=this,e=t.pathWorkItems.length-1;e>=0;e--)t.pathWorkItems[e].subProcess&&t.subprocesses.push(t.pathWorkItems[e]),t.pathWorkItems[e].wiClosed||t.currentTasks.push(t.pathWorkItems[e])},drawCasePath:function(){var t=this;if(t.path.length)t.$pvCanvas.processviewer("animateRoute");else{var e="idCase="+t.currentWorkflow.idCase+"&idWorkFlow="+t.currentWorkflow.idWorkflow;$.when(t.dataService.getCasePath(e)).done(function(e){for(var i=0,r=e.length;i<r;i++)0===i&&""===e[0].guidTaskFrom&&(t.path.push(e[i+1]?e[i+1].guidTaskFrom:""),t.path.push(e[i].guidTransition),t.path.push(e[i].guidTaskTo)),t.path.push(e[i].guidTaskFrom),t.path.push(e[i].guidTransition),t.path.push(e[i].guidTaskTo);t.path=t.cleanPathArray(t.path),t.path=t.removeRepeatedItemsInPath(t.path),t.$pvCanvas.processviewer("animateRoute",t.path)})}},clearCasePath:function(){this.$pvCanvas.processviewer("stopRouteAnimation")},cleanPathArray:function(t){for(var e=[],i=0,r=t.length;i<r;i++)t[i]&&e.push(t[i]);return e},removeRepeatedItemsInPath:function(t){var e={boolean:{},number:{},string:{}},i=[];return t.filter(function(t){var r=typeof t;return r in e?!e[r].hasOwnProperty(t)&&(e[r][t]=!0):!(i.indexOf(t)>=0)&&i.push(t)})}});
//# sourceMappingURL=../../../../Maps/desktop/processviewer.desktop.production.js.map
