$.bizagi||($.bizagi={ui:{}}),$.bizagi.ui={controls:{uitable:{namespace:"bizagi.ui.controls.uitable",availableComponents:["uicombo","uiradio","uicheckbox"],css:"biz-ui-controls-table",tmpl:"bizagi.ui.controls.table.template",tmpl2:"bizagi.ui.controls.table.tr.template",tmpl3:"bizagi.ui.controls.table.list.template"},uicombo:{namespace:"bizagi.ui.controls.uicombo",css:"biz-ui-controls-combo",tmpl:"bizagi.ui.controls.combo.template",tmpl2:"bizagi.ui.controls.combo.list.template"},uicheckbox:{namespace:"bizagi.ui.controls.uicheckbox",css:"biz-ui-controls-checkbox",tmpl:"bizagi.ui.controls.checkbox.template"},uiradio:{namespace:"bizagi.ui.controls.uiradio",css:"biz-ui-controls-radio",tmpl:"bizagi.ui.controls.radio.template"},uitreeview:{namespace:"bizagi.ui.controls.uitreeview",css:"biz-ui-controls-treeview",tmpl:"bizagi.ui.controls.treeview.template"},uimultiselect:{namespace:"bizagi.ui.controls.multiselect",css:"biz-ui-controls-multiselect",tmpl:"bizagi.ui.controls.multiselect.template"}}},$.Class("bizagi.workportal.command.security",{},{init:function(e){this.dataService=e,this.rawData={}},getSecurity:function(){var e=this,t=new $.Deferred;return e.security={},e.jsonSecurityList={},bizagi.menuSecurity?t.resolve(bizagi.menuSecurity):$.when(e.dataService.getMenuAuthorization()).done(function(i){bizagi.currentUser.associatedStakeholders&&bizagi.currentUser.associatedStakeholders.length>0&&i.permissions.push({associatedStakeholders:[]}),e.rawData=i,bizagi.menuSecurity=e.convertSecurityData(i),e.jsonSecurityList=i,$.each(e.security,function(e,t){authMenu[e]=t}),$(document).trigger("securityLoaded",{}),t.resolve(bizagi.menuSecurity)}),t.promise()},convertSecurityData:function(e){var t={},i=function(e){$.each(e,function(e,a){"object"==typeof a?("number"!=typeof e&&(t[e]=!0),i(a)):t[a]=!0})};return i(e.permissions),t},checkSecurityPerm:function(e){e=e||"";var t=$.Deferred();return bizagi.menuSecurity?t.resolve(!!bizagi.menuSecurity[e]):$(document).bind("securityLoaded",function(){t.resolve(!!bizagi.menuSecurity[e])}),t.promise()},getRawData:function(){return this.rawData}}),$.Class("bizagi.workportal.command.printform",{},{init:function(e){this.renderFactory=e},print:function(e){var t=this,i=$.extend({},e);$(document).triggerHandler("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PRINT,modalParameters:{title:bizagi.localization.getResource("render-actions-print"),refreshInbox:!1},params:i,referrer:bizagi.hasOwnProperty("referrerParams")&&bizagi.referrerParams.hasOwnProperty("referrer")?bizagi.referrerParams.referrer:"inboxGrid",buttons:[{text:bizagi.localization.getResource("workportal-widget-dialog-box-print"),click:function(){var e=$(this),i=t.renderFactory.getTemplate("print-frame"),a=t.renderFactory.getTemplate("print-frame-header"),r=function(){var t,r="printer-"+(new Date).getTime(),o=$.tmpl(i,{printID:r}),n=$.tmpl(a,{environment:bizagi.loader.environment,productBuild:bizagi.loader.productBuildToAbout,build:bizagi.loader.build});if(o.appendTo($("body:first")),bizagi.util.isIE()){if(!(t=window.frames[r]))for(var s=0,d=window.frames.length;s<d;s++)if(window.frames[s]&&window.frames[s].name==r){t=window.frames[s];break}}else t=window.frames[r];var c=t.document||t.contentWindow.document;c.open();var l='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">';if(l+="<html style='overflow: visible !important'> <head> <title> </title>",l+=n[0].innerHTML,l+="</head> <body class='bz-wp-widget-print bz-wp-widget-print-load' style='overflow: visible !important'>",l+=$(".bz-wp-widget-print").html(),l+="</body></html>",c.write(l),c.close(),$(".ui-bizagi-cell-readonly",c).css("maxHeight","100%"),bizagi.util.isIE()){var g=window.open("","","top=0,left=0,width=10,height=10");"<style>","html{background: #293f55; color: #fff; text-align: center;}","</style>";g.document.open(),g.document.write('<style>html{background: #293f55; color: #fff; text-align: center;}</style><div id="loading-emp" style="padding:10px auto; width:100%; text-align:center; font-family:Arial; font-size:12px;">'+bizagi.localization.getResource("webpart-render-loading")+"</div>"),g.document.close(),g.document.open(),g.document.write(l),g.document.close(),g.print(),setTimeout(function(){g.close()},1e4)}else t.focus(),setTimeout(function(){t.print()},500);setTimeout(function(){o.remove()},1e3),e.removeAttr("disabled")};e.attr("disabled","disabled"),0===$("#bz-wp-widget-print").length?setTimeout(function(){r()},1e3):r()}}]})}}),$.Class.extend("bizagi.workportal.controllers.controller",{},{init:function(e,t){this.workportalFacade=e,this.dataService=t,this.resources=bizagi.localization,this.componentContainers={},this.subscribers=[],this.disposed=!1,this.tmpl={},this.templatesDeferred=null},getWorkportal:function(){return this.workportalFacade.workportal},publish:function(e,t){return this.disposed?null:$(document).triggerHandler(e,t)},subscribe:function(e,t){if(this.disposed)return null;$(document).bind(e,t),this.subscribers.push({event:e})},subscribeOneTime:function(e,t){if(this.disposed)return null;$(document).one(e,t),this.subscribers.push({event:e})},unsubscribe:function(e,t){if(this.disposed)return null;t?$(document).unbind(e,t):$(document).unbind(e)},render:function(){var e=this,t=new $.Deferred;return e.renderingDeferred=new $.Deferred,$.when(e.areTemplatedLoaded()).pipe(function(){return e.renderContent()}).done(function(){e.postRender(),t.resolve(e.getContent()),e.renderingDeferred.resolve()}),t.promise()},getContent:function(){return this.content},getResource:function(e){return this.resources.getResource(e)},renderContent:function(){return""},postRender:function(){},getComponentSelector:function(e){return"[data-bizagi-component="+e+"]"},getComponentContainer:function(e){var t=this.getContent();return t&&0!=t.length?$(this.getComponentSelector(e),t):null},resizeLayout:function(){this.publish("resizeLayout")},performResizeLayout:function(){},dispose:function(){var e=this;null!=e.subscribers&&$.each(e.subscribers,function(t,i){e.unsubscribe(i.event)}),setTimeout(function(){bizagi.util.dispose(e),e.disposed=!0},bizagi.override.disposeTime||50)},loadTemplates:function(e){var t=this.templatesDeferred=new $.Deferred,i=[],a=null==e.useNewEngine||e.useNewEngine;for(var r in e)"useNewEngine"!=r&&i.push(this.loadTemplate({name:r,path:e[r],useNewEngine:a}));return $.when.apply($,i).done(function(){t.resolve()}),t.promise()},loadTemplate:function(e){var t=this;return t.tmpl[e.name]?t.tmpl[e.name]:e.useNewEngine?bizagi.templateService.getTemplateWidget(e.path).done(function(i){t.tmpl[e.name]=i}):bizagi.templateService.getTemplate(e.path).done(function(i){t.tmpl[e.name]=i})},getTemplate:function(e){return this.tmpl.hasOwnProperty(e)?this.tmpl[e]:null},isRendered:function(){return!!this.renderingDeferred&&this.renderingDeferred.promise()},areTemplatedLoaded:function(){return this.templatesDeferred}}),bizagi.workportal.controllers.controller.extend("bizagi.workportal.controllers.main",{},{init:function(e,t){var i=this;i.componentRegex=/{{component (\w+)}}/g,this._super(e,t),this.subscribe("changeWidget",function(e,t){bizagi.currentWidget=t.widgetName;var a=new $.Deferred;return i.subscribeOneTime("onWidgetIncludedInDOM",function(e,t){a.resolve()}),$.when(bizagi.util.liveSave(t.widgetName),bizagi.util.autoSave()).done(function(){$(document).data("auto-save",""),bizagi.util.liveProcessesEvents.saveEvent.saveLivePromise=null,t.widgetName!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID&&t.widgetName!=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX||bizagi.cookie("bizagiDefaultWidget",t.widgetName,{expires:30}),bizagi.util.setContext({widget:t.widgetName}),i.setWidget(t)}),a.promise()}),this.subscribe("addDialogToDialogStack",function(e,t){i.addDialogToDialogStack(t)}),this.subscribe("showDialogWidget",function(e,t){i.showDialogWidget(t)}),this.subscribe("closeCurrentDialog",function(e,t){return i.closeCurrentDialog(t)}),this.subscribe("closeAllDialogs",function(e,t){i.closeAllDialogs()}),this.subscribe("popupWidget",function(e,t){i.popupWidget(t)}),this.subscribe("popWidget",function(e,t){i.popWidget(t)}),this.subscribe("pushWidget",function(e,t){i.pushWidget(t)}),this.subscribe("executeAction",function(e,t){i.executeAction(t)}),this.subscribe("resizeLayout",function(){i.performResizeLayout()}),this.subscribe("disposeWidget",function(){i.disposeWidget()}),this.subscribe("appendWidgetTo",function(e,t){return i.appendWidgetTo(t)}),this.subscribe("notification",function(e,t){NotificationDispatcher.dispatch(t.notification,t.type)}),this.subscribe("refreshQueryFormShortCut",function(e,t){return i.refreshQueryFormShortCut(t)})},renderContent:function(){var e=this,t=e.workportalFacade.getTemplate("workportal"),i=e.content=$.tmpl(t,{});e.workarea=e.workportalFacade.getWorkareaController();var a=e.menu=e.workportalFacade.getMenuController();return $.when(a.render()).done(function(){a.getContent().appendTo(e.getComponentContainer("menu"))}),$(window).resize(function(){e.resizeLayout()}),i},setWidget:function(e){this.currentWidget=e.widgetName,this.currentWidgetParams=$.extend({},e,{menu:this.getMenu()}),bizagi.assert(!bizagi.util.isEmpty(e.widgetName),"No widget name defined for changeWidget call"),this.renderWorkarea()},executeAction:function(e){var t=this;e.action==bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING?bizagi.loader.start("activity").then(function(){t.workportalFacade.getAction(e.action).execute(e)}):e.action==bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH&&bizagi.loader.start("inbox").then(function(){t.workportalFacade.getAction(e.action).execute(e)})},renderWorkarea:function(){var e=this,t=e.workarea;if(t){var i=e.getComponentContainer("workarea");e.cleanWidgets(),i.empty(),bizagi.util.isEmpty(e.currentWidget)||"none"==e.currentWidget||(e.currentWidgetParams=$.extend({},e.currentWidgetParams,{menu:e.getMenu()}),e.currentWidget===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID||e.currentWidget===bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX?bizagi.loader.start("inbox").then(function(){e.loadWidgetFromFacade(t,i)}):e.loadWidgetFromFacade(t,i))}},loadWidgetFromFacade:function(e,t){var i=this;$.when(i.workportalFacade.getWidget(i.currentWidget,i.currentWidgetParams)).pipe(function(t){return e.setWidget(t),e.render()}).done(function(){var a=e.getContent();a&&(a.appendTo(t),i.resizeLayout(),i.publish("onWidgetIncludedInDOM"))})},showDialogWidget:function(e){},closeCurrentDialog:function(e){},popupWidget:function(e){},addDialogToDialogStack:function(e){},closeAllDialogs:function(){},pushWidget:function(e){this.currentWidget=e.widgetName,this.currentWidgetParams=$.extend({},e,{menu:this.getMenu()}),bizagi.assert(!bizagi.util.isEmpty(e.widgetName),"No widget name defined for pushWidget call")},popWidget:function(e){this.currentWidget=e.widgetName,this.currentWidgetParams=$.extend({},e,{menu:this.getMenu()}),bizagi.assert(!bizagi.util.isEmpty(e.widgetName),"No widget name defined for popupWidget call")},disposeWidget:function(e){this.currentWidget=e.widgetName,this.currentWidgetParams=$.extend({},e,{menu:this.getMenu()}),bizagi.assert(!bizagi.util.isEmpty(e.widgetName),"No widget name defined for disposeWidget call")},appendWidgetTo:function(e){},performResizeLayout:function(){var e=this,t=e.getContent();e.resizeContainer(t,$(window).height()),e.menu&&e.menu.performResizeLayout(),e.workarea&&e.workarea.performResizeLayout()},resizeContainer:function(e,t){var i=this,a=e.children(".ui-bizagi-component-adjustable"),r=t;if(a.length>0){var o=0;$.each(e.children(),function(e,t){$(t).hasClass("ui-bizagi-component-adjustable")||"none"===$(t).css("display")||(o+=$(t).height())}),r=t-o;var n="";$.each(a,function(e,t){"visible"==(n=""!=$(t).css("overflow-y")?$(t).css("overflow-y"):"hidden")&&(n="hidden"),$(t).addClass("ui-bizagi-adjustable");var i="auto"===$(t).css("margin-top")?0:Number($(t).css("margin-top").replace("px","")),a=r-i;$(t).css({height:a,"overflow-y":n})})}$.each(e.children(),function(e,t){$(t).find(".ui-bizagi-component-adjustable").length>0&&($(t).addClass("ui-bizagi-component-adjustable"),i.resizeContainer($(t),r))})},getMenu:function(){return this.menu},refreshQueryFormShortCut:function(e){}}),bizagi.workportal.controllers.controller.extend("bizagi.workportal.controllers.menu",{},{init:function(e,t){var i=this;i._super(e,t),this.subscribe("showMainMenu",function(e,t){var a=new $.Deferred;return $(i.getContent()).closest("#ui-bizagi-wp-menu").show(),a.promise()})},renderContent:function(){var e=this,t=e.workportalFacade.getTemplate("menu"),i=new $.Deferred;return $.when(e.dataService.getCurrentUser()).done(function(a){var r=(new bizagi.services.preferences).getValues();bizagi.currentUser=a,$.datepicker.setDefaults(bizagi.localization.getResource("datePickerRegional"));var o=bizagi.localization.getResource("numericFormat");o&&(o.decimalSymbol=r.decimalSeparator||a.decimalSeparator||o.decimalSymbol,o.symbol=r.symbol||a.symbol||o.symbol,o.digitGroupSymbol=r.thousandSeparator||a.groupSeparator||o.digitGroupSymbol,bizagi.localization.setResource("numericFormat",o),BIZAGI_DEFAULT_CURRENCY_INFO&&(BIZAGI_DEFAULT_CURRENCY_INFO.decimalDigits=a.decimalDigits,BIZAGI_DEFAULT_CURRENCY_INFO.decimalSeparator=o.decimalSymbol,BIZAGI_DEFAULT_CURRENCY_INFO.symbol=o.symbol,BIZAGI_DEFAULT_CURRENCY_INFO.groupSeparator=o.digitGroupSymbol)),a.uploadMaxFileSize&&(BIZAGI_SETTINGS.UploadMaxFileSize=a.uploadMaxFileSize,bizagi.util.changeData({uploadMaxFileSize:BIZAGI_SETTINGS.UploadMaxFileSize})),e.overrideUserPreferences(),e.security=new bizagi.workportal.command.security(e.dataService),$.when(e.security.getSecurity()).done(function(r){!1===bizagi.override.enableFeatureDisplayOptions&&(r.DisplayOptions=!1);var o=e.content=$.tmpl(t,$.extend(a,{environment:bizagi.loader.environment||"",build:bizagi.loader.build,base64image:bizagi.themeLogo||"img/img/barra/logo-bizagi.svg",photo:"data:image/png;base64,"+(bizagi.currentUser.userPicture?bizagi.currentUser.userPicture:"iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRF////////VXz1bAAAAAJ0Uk5T/wDltzBKAAAA+0lEQVR42uzaSxLCMAwE0c79L82SFMXHJpKHhJ59at4utmS2cBAgQMCBT3dZDuBJ1gF4mSUA3qYfALUCauvnCZT3Twqo758T0NA/JaCjf0ZwIgC0COjpHxecBgBNAgF09Y8KBAgQIECAAAFnAXgiEiDAq5mA8wEuOCERIMBBpYAfAMTH9QLygPjOSEB+b5gHxFe3I4Lt4oD0+v4HAPEXFAIECBDw70+58oDw7zh7JMteTrPTcr5MDYBDOQqgIAcAFOU7AKWZBlCeKQAtGQXQmAEAzfkAYEHeAWC5gOX1DwQS/XsBkf6dgEz/XSBAgAABAgQIECBAQBxwE2AAjnkjnL/SDJsAAAAASUVORK5CYII="),hasPicture:!!bizagi.currentUser.userPicture,initials:bizagi.currentUser.userFullName?bizagi.currentUser.userFullName.getInitials():"",security:r}));i.resolve(o)})}).fail(function(){e.dataService.logout()}),i.promise()},overrideUserPreferences:function(){(new bizagi.services.preferences).overrideLocalization()},changeWidget:function(e){this.publish("changeWidget",e)},showDialogWidget:function(e){this.publish("showDialogWidget",e)},performResizeLayout:function(){var e=this;if(void 0!==jQuery.browser&&$.browser.msie&&parseInt($.browser.version,10)<=8)var t=window.setInterval(function(){if(null!==e.content){var i=$("#ui-bizagi-wp-app-menu-bt-container .text",e.content),a=$("#userprofile",e.content),r=$("#ui-bizagi-wp-menu-username",a),o=$(".text",r),n=$("#logout",a),s=$("#about",a);$(window).width()<1400?(i.css({"line-height":0,display:"block"}),$(window).width()<1195?(n.css({width:"20px"}),s.css({width:"24px"}),$(".ui-button-text",s).hide(),$(".ui-icon",n).css({top:"12px"}),$(".ui-button-text",n).hide(),o.css({display:"none"}),r.css({height:"19px"})):(s.removeAttr("style"),$(".ui-icon",s).removeAttr("style"),$(".ui-button-text",s).show(),n.removeAttr("style"),$(".ui-icon",n).removeAttr("style"),$(".ui-button-text",n).show())):(i.css({"line-height":"59px",display:"inline-block"}),r.removeAttr("style"),r.css({"padding-left":"25px",width:"auto"}),o.removeAttr("style"),s.removeAttr("style"),$(".ui-icon",s).removeAttr("style"),$(".ui-button-text",s).show(),n.removeAttr("style"),$(".ui-icon",n).removeAttr("style"),$(".ui-button-text",n).show()),window.clearInterval(t)}},300);e.adjustMenuWP()},adjustMenuWP:function(){if(1===$("#ui-bizagi-wp-app-menu-bt-container").length){var e=$("#ui-bizagi-wp-widget-searchContainer").outerWidth()+$("#user").outerWidth()+$("#ui-bizagi-wp-app-menu-logo-container").outerWidth()+70,t=$("#ui-bizagi-wp-app-menu-container").width()-e;$("#ui-bizagi-wp-app-menu-bt-container").width(t),$("span.text",i).show();for(var i=$("#ui-bizagi-wp-app-menu-bt-container li"),a=indexLastButton=i.length-1,r=!0;r&&!(a<0);)$("#ui-bizagi-wp-app-menu-bt-container").position().top>0||i.eq(indexLastButton).position().top>0?($("span.text",i).eq(a).hide(),a-=1):r=!1}}}),bizagi.workportal.controllers.controller.extend("bizagi.workportal.controllers.workarea",{},{setWidget:function(e){this.widget=e},disposeWidget:function(){this.widget&&(this.widget.dispose(),delete this.widget)},cleanWidgets:function(){this.widget&&this.widget.clean()},renderContent:function(){var e=this,t=new $.Deferred;return e.widget?$.when(e.widget.render()).done(function(){e.content=e.widget.getContent(),t.resolve(e.content)}):(e.content=$("<div/>"),t.resolve(e.content)),t.promise()},performResizeLayout:function(){this.widget&&this.widget.performResizeLayout()}}),$.Class.extend("bizagi.workportal.webpart.helper",{},{init:function(e){this.dataService=e.dataService,this.resources=e.resources,this.workportalFacade=e.workportalFacade,this.templates={}},hideCasesColumn:function(e,t){for(i=0;i<e.columns.length;i++)if(e.columns[i].name==t){e.columns[i].visible=!1;break}return e},hideCasesColumn:function(e,t){for(i=0;i<e.columns.length;i++)if(e.columns[i].name==t){e.columns[i].visible=!1;break}return e},transformCasesInfo:function(e){var t=e.data,i=e.imageColumn,a={transformed:!0};if(t.transformed)return t;var r;a.columns=[{name:"id",displayName:"id",visible:!1}];for(var o=0;o<t.cases.columnTitle.length;o++){var n=t.cases.columnTitle[o];a.columns.push({name:n.fieldName,displayName:n.displayName,dataType:(r=n,r.fieldName==i?"upload":"I_idTask"==r.fieldName?"workitems":r.type)}),1==bizagi.util.parseBoolean(n.isOrdered)&&(a.orderBy=n.fieldName,a.orderType=0==n.orderType?"asc":"desc")}for(a.columns.push({name:"workitems",displayName:"workitems",visible:!1,dataType:"workitems"}),a.columns.push({name:"permissions",displayName:"permissions",visible:!1,dataType:"permissions"}),a.rows=[],o=0;o<t.cases.rows.length;o++){var s=t.cases.rows[o],d=[];d.push(s.id);for(var c=0;c<s.fields.length;c++)d.push(s.fields[c]);a.rows.push(d)}return a.totalPages=t.cases.totalPages,a.page=t.cases.page,a},drawGridView:function(e){var t=e.template,i=e.data;for(r=0;r<i.columns.length;r++)i.columns[r].visible=void 0===i.columns[r].visible||bizagi.util.parseBoolean(i.columns[r].visible),"upload"==i.columns[r].dataType&&(i.columns[r].visible=!1),"workitems"==i.columns[r].dataType&&(i.columns[r].visible=!1),"permissions"==i.columns[r].dataType&&(i.columns[r].visible=!1);0==i.orderType&&(i.orderType="asc"),1==i.orderType&&(i.orderType="desc"),i.orderBy=bizagi.util.isEmpty(i.orderBy)?"":i.orderBy,i.orderType=bizagi.util.isEmpty(i.orderType)?"asc":i.orderType,i.totalPages=bizagi.util.isEmpty(i.totalPages)?0:i.totalPages;for(var a=[],r=1;r<=i.totalPages;r++)a.push({number:r,active:r==i.page});return $.tmpl(t,$.extend(i,{pages:a,actions:e.actions,filters:e.filters,title:e.title,getCaseId:function(e){return e[0]},getEntityId:function(e){return e[0]},splitHeaderName:function(e){var t=e,i=e.split("_");return i.length>1&&(t=i[1]),t},getWorkItems:function(e){var t="[",i=e[e.length-2].workitems;if(i&&i.length>0)for(var a in i){a>0&&(t+=",");var r='{"idWorkItem":';r+=i[a].idWorkItem,r+=',"idTask":',r+=i[a].idTask,t+=r+="}"}return t+="]"}}))},drawThumbnailsView:function(e){var t=this,i=e.template,a=e.data;for(o=0;o<a.columns.length;o++)a.columns[o].visible=void 0===a.columns[o].visible||bizagi.util.parseBoolean(a.columns[o].visible),a.columns[o].name==e.imageLabelColumn&&(a.columns[o].dataType="imageLabel"),"workitems"==a.columns[o].dataType&&(a.columns[o].visible=!1);a.orderBy=bizagi.util.isEmpty(a.orderBy)?"":a.orderBy,a.orderType=bizagi.util.isEmpty(a.orderType)?"asc":a.orderType,a.totalPages=bizagi.util.isEmpty(a.totalPages)?0:a.totalPages;for(var r=[],o=1;o<=a.totalPages;o++)r.push({number:o,active:o==a.page});return $.tmpl(i,$.extend(a,{pages:r,getImage:function(e){return t.getFileImage(e)},actions:e.actions,getCaseId:function(e){return e[0]},getEntityId:function(e){return e[0]},getWorkItems:function(e){var t="[",i=e[e.length-1].workitems;if(i&&i.length>0)for(var a in i){a>0&&(t+=",");var r='{"idWorkItem":';r+=i[a].idWorkItem,r+=',"idTask":',r+=i[a].idTask,t+=r+="}"}return t+="]"}}))},getEmptyFile:function(){return"/_layouts/Proxy/jquery/overrides/css/desktop/images/EmptyAsset.png"},getFileImage:function(e){return e&&0!=e.length?e:this.getEmptyFile()},getFile:function(e){return e&&0!=e.length?this.dataService.getFile(e[0]):this.getEmptyFile()},removeWaitContainer:function(e){$(e)&&$(e).addClass("ui-bizagi-sharepoint-loading-container-hidden")},addWaitContainer:function(e){$(e)&&$(e).removeClass("ui-bizagi-sharepoint-loading-container-hidden")},loadTemplate:function(e,t){var i=this;return bizagi.templateService.getTemplate(t).done(function(t){i.templates[e]=t})},getFailServerErrorDeferred:function(e,t){var i,a=this,r=e.message,o="";-1!=e.sharepointProxyPrefix.indexOf("URL")?(o=e.sharepointProxyPrefix.substr(e.sharepointProxyPrefix.indexOf("URL")+4,e.sharepointProxyPrefix.length),i="bizagi.workportal.desktop.error-message-sharepoint"):i="bizagi.workportal.desktop.error-message-portal",r=o+": "+r,a.loadTemplate("error-message",bizagi.getTemplate(i)).done(function(i){var o=a.content=$.tmpl(i,{message:r,address:e.helpAddress});t.resolve(o)}).fail(function(e){t.resolve("<div>Unhandled error</div>")})},getPaginationTemplate:function(){return self.loadTemplate("pagination-template",bizagi.getTemplate("inbox-common-pagination-inbox"))},publishShowRenderEvent:function(e,t,i){e||alert("Event param cannot be undefined");var a=t.publish("ui-bizagi-can-change-activityform");a?a.done(function(){t.publish(e,i)}):console.log("autosave verification send error")},isWebpartInIFrame:function(){try{return window.self!==window.top}catch(e){return!0}},displayWebPartPopUpExternalIframe:function(e,t,i,a){t.workportal=null,t.canvas=null,t.postMessageEventName="postmessage-bizagi-openParentPopUp",t.webPartToDraw=e,t.iframeidentifier=a.iframeidentifier,a.send(JSON.stringify(t))},displayWebPartPopUpinIFrame:function(webpartName,params,callback){var webpartObject,mask=document.createElement("div");mask.className="containerPopUp",mask.style.height="100%";var popUpParams=params;function preClosePopUp(e,t){2===e.eventPhase&&closePopUp(e,t)}mask.addEventListener?mask.addEventListener("click",preClosePopUp,!1):mask.attachEvent("onclick",preClosePopUp);var canvas=document.createElement("div");canvas.className="activitiFormContainer";var closeCanvas=document.createElement("div");closeCanvas.className="closeCanvas",closeCanvas.addEventListener?closeCanvas.addEventListener("click",function(e,t){closePopUp(e,t)},!1):closeCanvas.attachEvent("onclick",function(e,t){closePopUp(e,t)}),canvas.appendChild(closeCanvas),mask.appendChild(canvas);var webpartCanvasDiv=document.createElement("div");webpartCanvasDiv.className="webpartCanvasDiv",webpartCanvasDiv.id="webpartCanvasPopUp",canvas.appendChild(webpartCanvasDiv);var pathiFrame="";pathiFrame=params.pathiFrame?params.pathiFrame:window.location.href.substring(0,window.location.href.indexOf("jquery"));var queryStringParams=window.location.toString().split("?")[1];pathiFrame+="jquery/webparts/desktop/portal/pages/webpart.htm",pathiFrame=pathiFrame+"?type="+webpartName,params.idCase&&(pathiFrame=pathiFrame+"&idCase="+params.idCase),params.idWorkitem&&(pathiFrame=pathiFrame+"&idWorkitem="+params.idWorkitem),params.idWfClass&&(pathiFrame=pathiFrame+"&idWfClass="+params.idWfClass),queryStringParams&&(pathiFrame=pathiFrame+"&"+queryStringParams),pathiFrame=pathiFrame+"&remoteServer="+window.location.toString();var iframe=document.createElement("iframe");function closePopUp(ev,params){var postmessageSocket=new bizagi.postmessage({remoteServer:pathiFrame,destination:iframe.contentWindow,origin:window});postmessageSocket.receive=function(msg){var params=eval("("+msg.data+")");"postmessage-bizagi-closeIFramePopUp"==params.postMessageEventName&&mask.parentNode&&(iframe.src=void 0,mask.parentNode.removeChild(mask),callback&&callback(this,popUpParams))};var iframeclosemsg={postMessageEventName:"postmessage-bizagi-canCloseIFramePopUp"};postmessageSocket.send(JSON.stringify(iframeclosemsg))}iframe.className="csswebpartIframePopUp",iframe.id="iframePopUp",iframe.src=pathiFrame,iframe.resizeInPopUp=function(e){var t=$(".activitiFormContainer").height()||0;$(iframe).height(t)},webpartCanvasDiv.appendChild(iframe),document.body.appendChild(mask),iframe.resizeInPopUp(params),$(window).resize(function(){iframe.resizeInPopUp(params)})},displayWebPartPopUp:function(e,t,i){var a,r=document.createElement("div");r.className="containerPopUp",r.style.height="100%";var o=t;function n(e,t){2===e.eventPhase&&s(e,t)}function s(e,t){a.canHide?$.when(a.canHide()).done(function(){r.parentNode.removeChild(r),i&&i(this,o),a.destroy()}).fail(function(){r.parentNode.removeChild(r),i&&i(this,o),a.destroy()}):(r.parentNode.removeChild(r),i&&i(this,o),a.destroy())}r.addEventListener?r.addEventListener("click",n,!1):r.attachEvent("onclick",n);var d=document.createElement("div");d.className="activitiFormContainer";var c=document.createElement("div");c.className="closeCanvas",c.addEventListener?c.addEventListener("click",function(e,t){s()},!1):c.attachEvent("onclick",function(e,t){s()}),d.appendChild(c),r.appendChild(d);var l=document.createElement("div");l.className="webpartCanvasDiv",l.id="webpartCanvasPopUp",d.appendChild(l);var g=$.extend({},t,{webpart:e,canvas:$(l),namespace:"PopUp",data:null,adjustButtonsToContent:!0});document.body.appendChild(r),bizagi.startWaiting(l),t.workportal.executeWebpart(g).done(function(e){a=e.webpart,c.onclick=function(e,t){}})},displayWebPartDialog:function(e,t,i){var a,r=t.dialogParams,o=document.createElement("div");o.className="activitiFormContainer";var n=document.createElement("div");n.className="webpartCanvasDiv",n.id="webpartCanvasPopUp",o.appendChild(n);var s=$.extend({},t,{webpart:e,canvas:$(n),namespace:"PopUp",data:null,adjustButtonsToContent:!0});t.workportal.executeWebpart(s).done(function(e){a=e.webpart,r.showCloseButton&&r.buttons.push({text:bizagi.localization.getResource("workportal-widget-dialog-box-close"),click:function(e,t){a.content.dialog("close")}}),a.content.dialog(r)})}}),bizagi="undefined"!=typeof bizagi?bizagi:{},bizagi.webparts=void 0!==bizagi.webparts?bizagi.webparts:{},bizagi.webparts.addConfigurationMessage=function(e,t){var i=this.ownerDocument,a=$("body",i),r=e.canvas||$("<div/>").appendTo(a),o=bizagi.getTemplate("bizagi.sharepoint.configurationerror");$.when(bizagi.templateService.getTemplate(o)).then(function(e){$.tmpl(e,{message:bizagi.localization.getResource(t)}).appendTo(r)})},bizagi="undefined"!=typeof bizagi?bizagi:{},bizagi.webpart=void 0!==bizagi.webpart?bizagi.webpart:{},bizagi.webpart.subscribe=function(e,t){$(document).bind(e,t)},bizagi.webpart.publish=function(e,t){return $(document).triggerHandler(e,t)},bizagi.webpart.whenCreated=function(e,t){bizagi.webpart.subscribe("bizagi-webpart-created",function(i){i.webpart.Class.fullname=="bizagi.workportal.webparts."+e&&t&&t(i)})},bizagi.webpart.whenExecuted=function(e,t){bizagi.webpart.subscribe("bizagi-webpart-executed",function(i){i.webpart.Class.fullname=="bizagi.workportal.webparts."+e&&t&&t(i)})},bizagi.workportal.controllers.controller.extend("bizagi.workportal.webparts.webpart",{},{init:function(workportalFacade,dataService,params){var self=this;this._super(workportalFacade,dataService,params),this.helper=new bizagi.workportal.webpart.helper(this),this.canvas=params.canvas,this.project=params.project,this.sharepointProxyPrefix=params.sharepointProxyPrefix,this.namespace=params.namespace,this.isVisible=!0,this.isWebpartInIFrame=void 0!==params.isWebpartInIFrame?params.isWebpartInIFrame:self.helper.isWebpartInIFrame(),this.adjustButtonsToContent=params.adjustButtonsToContent,this.remoteServer=params.remoteServer,this.remoteServer&&(self.postmessageSocket=new bizagi.postmessage({remoteServer:this.remoteServer,destination:window.parent,origin:window}),self.postmessageSocket.iframeidentifier=BIZAGI_IFRAME_IDENTIFIER,self.postmessageSocket.receive=function(msg){var params=eval("("+msg.data+")");if((!params.parameters||params.parameters.iframeidentifier!=BIZAGI_IFRAME_IDENTIFIER)&&params.postMessageEventName)switch(params.postMessageEventName){case"postmessage-bizagi-canCloseIFramePopUp":self.canHide&&self.Class.shortName==params.webPartDestine&&$.when(self.canHide()).done(function(){var e={postMessageEventName:"postmessage-bizagi-closeIFramePopUp",parameters:{}};e.parameters.iframeidentifier=BIZAGI_IFRAME_IDENTIFIER,self.postmessageSocket.send(JSON.stringify(e));var t={postMessageEventName:"ui-bizagi-reload-cases"};t.parameters=self.params||{},self.postmessageSocket.send(JSON.stringify(t))});break;case"postmessage-bizagi-openParentPopUp":break;default:self.publish(params.postMessageEventName,params.parameters,!0)}},self.sendDimensionsiFrame())},sendDimensionsiFrame:function(e){var t=this;if(t.remoteServer&&!t.adjustButtonsToContent&&(!t.namespace||e)&&t.isWebpartInIFrame&&t.canvas[0]){var i=t.canvas[0];i.attachEvent?i.onresize=function(){t.sendDimensionsiFramePostMessage()}:bizagi.addResizeListener(i,function(e){t.sendDimensionsiFramePostMessage()})}},sendDimensionsiFramePostMessage:function(){var e={};e.iframeName=BIZAGI_IFRAME_IDENTIFIER,e.iframeHeight=$("body").height(),"newcaselist"==this.Class.shortName?e.iframeWidth=$(document).width():e.iframeWidth=void 0,this.postmessageSocket.send(JSON.stringify(e))},publish:function(e,t,i){if(e=this.namespace?this.namespace+"."+e:e,!i&&-1==e.indexOf("bizagi-webpart-created")&&-1==e.indexOf("bizagi-webpart-executed")&&this.postmessageSocket){var a={};a.postMessageEventName=e,t&&(t.canvas=null,t.workportal=null),a.parameters=$.extend(t,{project:this.project,iframeidentifier:BIZAGI_IFRAME_IDENTIFIER}),this.postmessageSocket.send(JSON.stringify(a))}return this._super(e,$.extend(t,{project:this.project}))},subscribe:function(e,t){var i=this;e=this.namespace?this.namespace+"."+e:e,this._super(e,function(e,a){if(i.project==a.project&&i.isVisible)return t(e,a)})},unsubscribe:function(e,t){e=this.namespace?this.namespace+"."+e:e,this._super(e,t)},refresh:function(e){var t=this.getContent();t.empty(),this.prepareForRefresh(),$.when(this.render(e)).done(function(e){$.contains(window.document,t[0])?bizagi.util.replaceSelector($("body",window.document),t,e):($("#"+t.attr("id"),window.document).empty(),bizagi.util.replaceSelector($("body",window.document),"#"+t.attr("id"),e))})},render:function(e){var t=this;return t.params=e,e.creating?(t.content=t.empty(),t.publish("bizagi-webpart-created",{webpart:t}),t.content):$.when(t.renderContent(e)).pipe(function(i){return"string"==typeof i&&(i=$(i)),t.content=i,t.postRender(e),t.publish("bizagi-webpart-executed",{webpart:t}),t.sendDimensionsiFrame(),t.getContent()})},renderContent:function(e){},postRender:function(e){},getContent:function(){return this.content},empty:function(){return $("<div/>")},getTemplate:function(e){return this.workportalFacade.getTemplate(e)},createWebpart:function(e){return this.workportalFacade.workportal.createWebpart(e)},executeWebpart:function(e){return this.workportalFacade.workportal.executeWebpart(e)},manageError:function(e,t,i){var a=this,r="";if(-1==(r=e.responseText?e.responseText:e).indexOf("AUTHENTICATION_ERROR"))a.helper.getFailServerErrorDeferred({message:r,sharepointProxyPrefix:a.sharepointProxyPrefix},t),a.endWaiting(),i&&t.done(function(e){i.append(e),a.endWaiting()});else{var o=a.content="<div class='ui-bizagi-webpart-error-message'>The current user does not exist as a registered user in the bizagi project</div>";i&&i.append(o),a.endWaiting(),t.resolve(o)}},onWaiting:function(){bizagi.startWaiting(document.getElementById(this.canvas[0].id))},endWaiting:function(){this.canvas.children(".ui-bizagi-sharepoint-loading-container").remove()},hide:function(e){this.canvas.hide(),e&&this.canvas.parent().hide(),this.isVisible=!1},show:function(){this.canvas.show(),this.canvas.parent().show(),this.isVisible=!0},isVisible:function(){return this.isVisible},destroy:function(){},prepareForRefresh:function(){}}),bizagi.workportal.controllers.controller.extend("bizagi.workportal.actions.action",{BIZAGI_WORKPORTAL_ACTION_ROUTING:"routing",BIZAGI_WORKPORTAL_ACTION_SEARCH:"search"},{render:function(){bizagi.assert(!1,"An action can't be rendered because it has no view")},postRender:function(){bizagi.assert(!1,"An action can't be rendered because it has no view")},execute:function(){}}),bizagi.workportal.actions.action.extend("bizagi.workportal.actions.routing",{},{execute:function(e){var t=this;t.params=e||{},$.when(t.dataService.routing.getRoute(e)).done(function(i){var a=$.Deferred();switch(i=i||{},"undefined"!=t.params.isOfflineForm&&1==t.params.isOfflineForm?i.moduleParams=$.extend(i.moduleParams,{formsRenderVersion:t.params.formsRenderVersion,isOfflineForm:t.params.isOfflineForm,idCase:t.params.idCase,idWorkitem:t.params.idWorkitem,guid:t.params.guid})||{}:i.moduleParams=i.moduleParams||{},i.module){case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDER:case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION:case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNC:t.publish("changeWidget",i.moduleParams),t.publish("closeAllDialogs");break;case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROJECT_DASHBOARD:bizagi.util.enableWorkPortalMenu();var r=$.extend(e,i.moduleParams);bizagi.util.setContext(r),t.publish("changeWidget",i.moduleParams),t.publish("closeAllDialogs");break;case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_START_FORM:var o={title:t.getResource("workportal-widget-newcase-title"),width:850,height:750,refreshInbox:!1,onClose:i.moduleParams.onClose,dialogOpened:a};t.publish("showDialogWidget",{widgetName:i.module,data:i.moduleParams.data,modalParameters:o,closeVisible:!1,dialogClass:"ui-bizagi-start-form-dialog"}),a.promise().done(function(e){t.publish("onWidgetIncludedInDOM"),e.widgetReference.postRender()});break;case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ROUTING:o={title:t.getResource("workportal-widget-routing-window-selector"),width:670,height:450,refreshInbox:!1,onClose:i.moduleParams.onClose};t.isThereAsync(i.moduleParams.data)?t.asyncWidget(i.moduleParams):t.publish("showDialogWidget",{widgetName:i.module,data:i.moduleParams.data,modalParameters:o,onClose:o.onClose})}})},isThereAsync:function(e){var t,i=e.workItems,a=0,r=i.length,o=!1;if(r>0)for(;a<r;)"true"===(t=i[a++]).isAsynch&&(o=o||[]).push(t);return o},asyncWidget:function(e){e.widgetName="async",this.publish("changeWidget",e)}}),bizagi.workportal.actions.action.extend("bizagi.workportal.actions.search",{},{execute:function(e){var t=this;t.params=e;var i={radNumber:$.trim(e.radNumber),idWorkflow:"",taskState:"all",onlyFavorites:!1,order:e.order||"",orderFieldName:e.orderFieldName||"",orderType:e.orderType||"0",page:e.page||1,group:bizagiConfig.groupByCaseNumber?"T_RADNUMBER":null};$.when(t.dataService.getCustomizedColumnsData(i)).done(function(a){bizagi.lstIdCases=a.cases.lstIdCases;var r=0;$(a.cases.columnTitle).each(function(i,o){o.radNumber=$.trim(e.radNumber),"T_idTask"==o.order&&$(a.cases.rows).each(function(e,i){t.isArray(i.fields[r])||(a.cases.rows[e].fields[r]={workitems:[{TaskName:i.fields[r],State:a.cases.rows[e].taskState}]})}),r++}),bizagi.referrerParams=bizagi.referrerParams||{},bizagi.referrerParams.radNumber=e.radNumber,bizagi.referrerParams.page=e.page||1,a.IsFavorite=!1,a.IsOpen=!1,bizagi.referrerParams.referrer=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,0==a.cases.lstIdCases.length?t.showNoResults(i):1==a.cases.rows.length?t.showSearch(a,e):a.cases.rows.length>=1&&t.showSearch(a,i)})},showSearch:function(e,t){bizagi.referrerParams.requestGlobalForm=!0,bizagi.referrerParams.referrerBackButton=bizagi.referrerParams.referrerBackButton||bizagi.context.widget||bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID,this.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:e,referrerParams:t}).done(function(){bizagi.util.isEmpty($("#footer #casesPagination").html().trim())&&$("#footer #casesPagination").hide()}),"tablet"!=bizagi.detectDevice()&&"tablet_ios"!=bizagi.detectDevice()&&"tablet_android"!=bizagi.detectDevice()||$("#menu-items #search").trigger("closePopUp")},showNoResults:function(e){var t=$("#menuQuery").css("color");$("#menuQuery").css("color","#f88f88"),setTimeout(function(){$("#menuQuery").css("color",t)},5e3),"smartphone_ios"!=bizagi.detectDevice()&&"smartphone_android"!=bizagi.detectDevice()||this.showSearch({noresults:e.radNumber},e)},redirectToProcess:function(e){this.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:e,onlyUserWorkItems:"false"})},formatRequest:function(e){return e},formatCategories:function(e){return e},isArray:function(e){return"object"==typeof e},isDate:function(e){var t=!1,i="string"==typeof(e=e||"")?e.split("/"):"";try{if(3==i.length)new Date(e).getYear()>0&&(t=!0)}catch(e){t=!1}return t}}),bizagi.workportal.controllers.controller.extend("bizagi.workportal.widgets.widget",{BIZAGI_WORKPORTAL_WIDGET_INTEGRATION:"widgetIntegration",BIZAGI_WORKPORTAL_WIDGET_WEBPART:"webpart",BIZAGI_WORKPORTAL_WIDGET_INBOX:"inbox",BIZAGI_WORKPORTAL_WIDGET_ADVANCE_SEARCH:"advanceSearch",BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:"homeportal",BIZAGI_WORKPORTAL_WIDGET_ACTIVITY:"project.activity",BIZAGI_WORKPORTAL_WIDGET_PROJECT_DASHBOARD:"projectDashboard",BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:"inboxGrid",BIZAGI_WORKPORTAL_WIDGET_ROUTING:"routing",BIZAGI_WORKPORTAL_WIDGET_SEARCH:"search",BIZAGI_WORKPORTAL_WIDGET_RENDER:"activityform",BIZAGI_WORKPORTAL_WIDGET_START_FORM:"startForm",BIZAGI_WORKPORTAL_WIDGET_RENDERFORM:"renderform",BIZAGI_WORKPORTAL_WIDGET_NEWCASE:"newCase",BIZAGI_WORKPORTAL_WIDGET_QUERIES:"queries",BIZAGI_WORKPORTAL_WIDGET_QUERIES_DEFINITION:"queriesDefinition",BIZAGI_WORKPORTAL_WIDGET_QUERIES_SHORTCUT:"queriesShortcut",BIZAGI_WORKPORTAL_WIDGET_QUERYFORM:"queryform",BIZAGI_WORKPORTAL_WIDGET_LISTCASES:"listCases",BIZAGI_WORKPORTAL_WIDGET_ASYNC:"async",BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME:"genericiframe",BIZAGI_WORKPORTAL_WIDGET_SUBMENU:"subMenu",BIZAGI_WORKPORTAL_WIDGET_PRINT:"print",BIZAGI_WORKPORTAL_WIDGET_FONTSIZE:"fontsize",BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION:"oldrenderintegration",BIZAGI_WORKPORTAL_WIDGET_PAGE:"page",BIZAGI_WORKPORTAL_WIDGET_ENTITIES:"entities",BIZAGI_WORKPORTAL_WIDGET_REPORTS:"reports",BIZAGI_WORKPORTAL_WIDGET_REPORTS_MENU:"reportsMenu",BIZAGI_WORKPORTAL_WIDGET_REPORTS_CHART:"reportsChart",BIZAGI_WORKPORTAL_WIDGET_SMARTFOLDERS:"smartfolders",BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASES:"adminReassignCases",BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE:"reassignCase",BIZAGI_WORKPORTAL_WIDGET_ASYNCECM_UPLOAD:"asyncECMUpload",BIZAGI_WORKPORTAL_WIDGET_PROCESS_TREE:"processTree",BIZAGI_WORKPORTAL_WIDGET_ENTITIES_TREE:"entitiesTree",BIZAGI_WORKPORTAL_WIDGET_USERS_TABLE:"usersTable",BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG:"activityLog",BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG:"authenticationLog",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES:"entityAdmin",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS:"encryptPasswords",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS:"userPendingRequests",BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH:"adminCaseSearch",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES:"asyncActivities",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER:"defaultsAssignUser",BIZAGI_WORKPORTAL_WIDGET_ADMIN_TRANSFER_CASE_SECURITY_PERMISSIONS:"transferCaseSecurityPermissions",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES:"userProfiles",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS:"adminAlarms",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES:"userlicenses",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DIMENSIONS:"dimensions",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES:"documentTemplates",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES:"processes",BIZAGI_WORKPORTAL_WIDGET_START_PROCESS:"startProcess",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES:"businessPolicies",BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE:"languageAdmin",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_DECISION_TABLE:"businessPoliciesDecisionTable",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_POLITICS:"businessPoliciesPolitics",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_RULES:"businessPoliciesRules",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_TABS:"businessPoliciesTabs",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICIES_VOCABULARIES:"businessPoliciesVocabularies",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES:"adminPreferences",BIZAGI_WORKPORTAL_WIDGET_ADMIN_DISPLAY_OPTIONS:"adminDisplayOptions",BIZAGI_WORKPORTAL_WIDGET_TREE:"tree",BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY:"graphicquery",BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW:"processModeler",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION:"adminUsers",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION:"usersDelegation",BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION_SEARCH_USER:"usersDelegationSearchUser",BIZAGI_WORKPORTAL_WIDGET_ADMIN_STAKEHOLDERS:"adminStakeholders",BIZAGI_WORKPORTAL_WIDGET_BIZAGI_EVENTS:"events",BIZAGI_WORKPORTAL_WIDGET_BIZAGI_RELEASE:"release",BIZAGI_WORKPORTAL_WIDGET_PROJECT_PROCESS_DIAGRAM_HELPER:"processDiagramHelper",BIZAGI_WORKPORTAL_WIDGET_PROJECT_ACTIVITY_MAP_TOOLTIP:"activityMapTooltip",BIZAGI_WORKPORTAL_WIDGET_PROJECT_USERSUMMARY:"usersummary",BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST:"mySearchList",BIZAGI_WORKPORTAL_WIDGET_LOADFORM:"loadForm",BIZAGI_WORKPORTAL_WIDGET_TEMPLATE_ENGINE:"templates",BIZAGI_WORKPORTAL_WIDGET_DIALOGNAV:"dialognav",BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS:"holidays",BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME:"projectName",BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS:"oauth2Applications",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_PROCESSES:"adhocProcesses",BIZAGI_WORKPORTAL_WIDGET_TIMELINE:"timeline",BIZAGI_WORKPORTAL_WIDGET_ADHOC_PROCESS_MODELER:"adhocProcessModeler",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_ENTITIES:"adhocEntities",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUPS:"adhocUserGroups",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_CREATE_PROCESS:"adhocCreateProcess",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_BOOLEAN_EXP:"adhocBooleanExp",BIZAGI_WORKPORTAL_WIDGET_ADHOC_CREATE_PROCESS:"adhocCreateProcess",BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUP_REPORT:"adhocUserGroupReport",BIZAGI_WORKPORTAL_WIDGET_PROFLY:"adhocprofly",BIZAGI_WORKPORTAL_WIDGET_SESSION_TIMEOUT:"sessionTimeOut",BIZAGI_WORKPORTAL_WIDGET_SESSION_TIMEOUT_EXPIRED:"sessionTimeOutExpired",BIZAGI_WORKPORTAL_WIDGET_USER_PRIVACY:"userPrivacy",BIZAGI_WORKPORTAL_WIDGET_ACCESS_DENIED:"accessDenied",BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICES:"adminBusinessPolices",BIZAGI_WORKPORTAL_WIDGET_USERS_MODAL:"usersModal"},{init:function(e,t,i){this._super(e,t),this.params=i,i&&i.menu&&(this.menu=i.menu),this.observableElement=$({}),this.widgetReadyDeferred=new $.Deferred,this.isBlocked=!1},publish:function(e,t){if(this.disposed)return null;$(document).triggerHandler(e,$.extend(t,{referrer:this.getWidgetName()}))},changeWidget:function(e,t){t=t||{};var i=$.extend(t,{widgetName:e});this.publish("changeWidget",i)},executeAction:function(e,t){t=t||{};var i=$.extend(t,{action:e});this.publish("executeAction",i)},showGraphicQuery:function(e){var t=this;!0===e.isAdhoc?bizagi.loader.start("processmodelerview").then(function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROCESS_MODELER_VIEW,data:e,modalParameters:{title:"Process viewer",refreshInbox:!1},maximizeOnly:!0,onClose:function(){bizagi.workportal.desktop.dialogStack.pop()}})}):bizagi.loader.start("processviewer").then(function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GRAPHIC_QUERY,data:e,modalParameters:{title:t.getResource("render-graphic-query"),refreshInbox:!1},maximizeOnly:!0,onClose:function(){bizagi.workportal.desktop.dialogStack.pop()}})})},isProcessOnTheFlyCase:function(){return!0},showTimeLine:function(e){var t=this;bizagi.loader.startAndThen("timeline").then(function(){t.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_TIMELINE,data:e,modalParameters:{title:t.getResource("workportal-project-casedashboard-timeline"),refreshInbox:!1},maximizeOnly:!0,onClose:function(){bizagi.workportal.desktop.dialogStack.pop()}})})},routingExecute:function(e){if(null==e)return!1;var t=e.find("#idCase").val()||this.params.idCase,i=e.find("#idWorkflow").val()||this.params.idWorkflow,a=e.find("#idWorkItem").val()||e.parent().find("#idWorkItem").val(),r=e.find("#idTask").val(),o=e.find("#eventAsTasks").val()||!1;return this.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t,idWorkflow:i,idWorkItem:a,idTask:r,eventAsTasks:o}),!0},getWidgetName:function(){return this.Class.fullName},sub:function(e){this.observableElement.off.apply(this.observableElement,arguments),this.observableElement.on.apply(this.observableElement,arguments)},unsub:function(){this.observableElement.off.apply(this.observableElement,arguments)},pub:function(){return this.observableElement.triggerHandler.apply(this.observableElement,arguments)},pubDeadLockDetection:function(){var e=new $.Deferred;if(self.isBlocked)e.reject();else{self.isBlocked=!0;var t=this.pub.apply(this,arguments),i=Array.isArray(t)?t:[t];$.when.apply($,i).done(function(t){self.isBlocked=!1,e.resolve()})}return e.promise()},clean:function(){if(this.observableElement){var e=$._data(this.observableElement[0],"events");if(e)for(var t in e)"notify"!=t&&"showDialogWidget"!=t&&"showNotification"!=t&&this.unsub(t)}},isReady:function(){return this.widgetReadyDeferred.promise()},setWidgetReady:function(){this.widgetReadyDeferred.resolve()}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.webpart",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_WEBPART},init:function(e,t,i){this._super(e,t,i),this.webpartName=i.webpart},renderContent:function(){var e=this.content=$("<div />");return this.getWorkportal().executeWebpart($.extend(this.params,{canvas:e,webpart:this.webpartName})),e}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.print",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PRINT},renderContent:function(){var e=this.getTemplate("print");return this.content=$.tmpl(e)}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.fontsize",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_FONTSIZE},renderContent:function(){var e=this.getTemplate("fontsize");return this.content=$.tmpl(e)}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.routing",{},{init:function(e,t,i){this._super(e,t,i)},getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ROUTING},renderContent:function(){var e=this,t=e.getTemplate("routing"),i=new $.Deferred;return(e.params.data.checkProcess||e.params.data.checkWorkItems)&&$.when(e.dataService.getCaseSubprocesses({idCase:e.params.data.idCase})).done(function(a){e.params.data.subProcessPersonalized=a.subProcesses,e.params.data.workItems.forEach(function(e){e.idTask||(e.idTask="")});var r=e.content=$.tmpl(t,e.params.data,{formatDate:e.formatDate});i.resolve(r)}),i.promise()},formatDate:function(e){return bizagi.util.formatDateFromInvariantStringDate(e.estimatedSolutionDate)}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.render",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDER},init:function(e,t,i){if(bizagi.util.isEmpty(i.idCase))if(bizagi.util.isEmpty(window.location.hash)){if(!bizagi.util.isEmpty(window.location.search)){var a=bizagi.util.getQueryString();a.idCase?(i.idCase=a.idCase,this.isConfiguredFromHash=!0):a.guid&&(i.guid=a.guid,this.isConfiguredFromHash=!0),a.idWorkitem&&(i.idWorkitem=a.idWorkitem)}}else{var r=bizagi.util.getHashParams();r.length>1&&(i.idCase=r[1],this.isConfiguredFromHash=!0),r.length>2&&(i.idWorkitem=r[2])}this._super(e,t,i)},renderContent:function(){var e,t=this,i=t.getTemplate("render"),a=new $.Deferred;return bizagi.util.isEmpty(t.params.idCase)&&bizagi.util.isEmpty(t.params.guid)?(t.changeWidget(bizagi.workportal.currentInboxView),null):(e=t.params.idCase?{idCase:t.params.idCase,eventAsTasks:t.params.eventAsTasks,onlyUserWorkItems:t.params.onlyUserWorkItems,idWorkitem:t.params.idWorkitem,isOfflineForm:t.params.isOfflineForm||!1}:{guid:t.params.guid,eventAsTasks:t.params.eventAsTasks,onlyUserWorkItems:t.params.onlyUserWorkItems,idWorkitem:t.params.idWorkitem,isOfflineForm:t.params.isOfflineForm||!1},bizagi.util.isEmpty(t.params.idWorkitem)&&t.isConfiguredFromHash?(bizagi.util.isEmpty(t.params.idCase)?bizagi.util.isEmpty(t.params.guid)||t.executeAction(bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,{guid:t.params.guid}):t.executeAction(bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,{idCase:t.params.idCase}),null):(t.content=$.tmpl(i),$.when(t.dataService.summaryCaseDetails(e)).done(function(e){if(bizagi.util.setContext({idCase:e.idCase||null,caseNumber:e.caseNumber||null,widget:t.getWidgetName(),idWorkitem:t.params.idWorkitem||null,idTask:t.params.idTask||null,isOfflineForm:t.params.isOfflineForm||!1}),e.params=t.params,e.countEvents>=1)for(var i=0;i<e.currentState.length;i++)"true"==e.currentState[i].isEvent&&e.currentState[i].idWorkItem==e.params.idWorkitem&&(e.countEvents=e.countEvents-1);e.showEvents=e.countEvents>=1;var r=$.grep(e.currentState,function(t){return t.idWorkItem===e.params.idWorkitem&&t.allowReleaseActivity});e.allowReleaseActivity=1===r.length&&r[0].allowReleaseActivity,a.resolve(t.renderSummary(e))}),t.content.parents("body").length>0?t.renderForm():t.subscribeOneTime("onWidgetIncludedInDOM",function(){t.renderForm({idCase:t.params.idCase,idWorkitem:t.params.idWorkitem,idTask:t.params.idTask,radNumber:t.params.radNumber,withOutGlobalForm:t.params.withOutGlobalForm||!1,isOfflineForm:t.params.isOfflineForm||!1,messageForm:t.params.messageForm||""})}),a.promise()))},renderSummary:function(e){var t=this,i=t.getContent(),a={},r="",o=new bizagi.workportal.command.security(t.dataService);e.showComments=!0,$.when(o.checkSecurityPerm("PrintableVersion"),o.checkSecurityPerm("StateLog"),o.checkSecurityPerm("GraphicQuery")).done(function(o,n,s){if(e.printableVersion=o,e.stateLog=n,e.graphicQuery=s,0!=e.idCase){var d=$.tmpl(t.caseSummaryTemplate,$.extend(e,{security:bizagi.menuSecurity})).appendTo(t.getComponentContainer("summary"));bizagi.util.formatInvariantDate(i,t.getResource("dateFormat")+" "+t.getResource("timeFormat")),$("#details",d).delegate(".summaryLink","click",function(){t.routingExecute($(this))}),$("#ui-bizagi-details-tabs",i).tabs({active:-1,create:function(e,t){$(this).tabs("option","active",0)},activate:function(i,o){switch(bizagi.util.setContext({commentsFocus:!1}),o.newPanel.prop("id")){case"comments":null==a.comments&&($.extend(t,{},bizagi.workportal.comments),e.canvas=$("#comments",t.getComponentContainer("summary")),e.readOnly=!!$(o.tab).data("isclosed"),$.when(t.renderComments(e)).done(function(e){a.comments=e})),bizagi.util.setContext({commentsFocus:!0});break;case"subprocess":null==a.subprocess&&$.when(t.dataService.summarySubProcess({idCase:t.params.idCase})).done(function(e){$.each(e.subProcesses,function(t,i){for(var a=e.subProcesses[t].custData,r=0;r<a.length;r++)null==a[r]&&(a[r]="")}),(r=$.tmpl(t.caseSummaryTemplateSubprocess,e)).appendTo($("#subprocess",t.getComponentContainer("summary"))),a.subprocess=r,r.delegate(".summaryLink","click",function(){t.routingExecute($(this))})});break;case"assignees":null==a.assignees&&$.when(t.dataService.summaryAssigness({idCase:t.params.idCase})).done(function(e){var i=[];$.each(e.events.split(", "),function(e,t){-1===$.inArray(t,i)&&i.push(t)}),e.events=i.join(", ");var o=[];$.each(e.activities.split(", "),function(e,t){-1===$.inArray(t,o)&&o.push(t)}),e.activities=o.join(", "),(r=$.tmpl(t.caseSummaryTemplateAssigness,e)).appendTo($("#assignees",t.getComponentContainer("summary"))),a.assignees=r});break;case"events":null==a.events&&$.when(t.dataService.summaryCaseEvents({idCase:t.params.idCase})).done(function(e){(r=$.tmpl(t.caseSummaryTemplateEvents,e)).appendTo($("#events",t.getComponentContainer("summary"))),a.events=r,r.delegate(".summaryLink","click",function(){t.routingExecute($(this))})});break;case"activities":null==a.activities&&$.when(t.dataService.summaryActivities({data:e,idWorkitem:t.params.idWorkitem})).done(function(e){e.idCase=t.params.idCase,e.idWorkflow=t.params.idWorkflow;var i=bizagi.localization.getResource("dateFormat")+" "+bizagi.localization.getResource("timeFormat");r=$.tmpl(t.caseSummaryTemplateActivities,e),bizagi.util.formatInvariantDate(r,i),r.appendTo($("#activities",t.getComponentContainer("summary"))),a.activities=r,r.delegate(".summaryLink","click",function(){t.routingExecute($(this))})})}}})}else setTimeout(function(){$("div.ui-bizagi-wp-app-inbox-description-container                     div.ui-bizagi-loading-message                     div.ui-bizagi-loading-message-center                     div.ui-bizagi-loading-icon").hide()},1e3)})},renderForm:function(e){var t,i=this,a=i.getComponentContainer("render");if(e.withOutGlobalForm){var r=i.workportalFacade.getTemplate("info-message"),o=""!==e.messageForm?e.messageForm:i.resources.getResource("render-without-globalform");void 0!==i.params&&void 0!==i.params.isOfflineForm&&1==i.params.isOfflineForm&&(o=bizagi.util.getMessageFromNetworkState(i.dataService.online)),$.tmpl(r,{message:o}).appendTo(a),(t=$.Deferred()).fail()}else{var n=null!=typeof i.dataService.serviceLocator.proxyPrefix?i.dataService.serviceLocator.proxyPrefix:"",s=null!=typeof i.dataService.database?i.dataService.database:"",d=i.rendering=new bizagi.rendering.facade({proxyPrefix:n,database:s});t=d.execute($.extend(e,{canvas:a,menu:i.menu})),a.bind("routing",function(e,t){var a={action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:i.params.idCase,fromTask:i.params.fromTask||i.params.idTask,fromWorkItemId:i.params.fromWorkItemId||i.params.idWorkitem,isOfflineForm:i.params.isOfflineForm,formsRenderVersion:i.params.formsRenderVersion,onClose:function(){i.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView})}};a=$.extend(a,t),i.publish("executeAction",a)}),a.bind("oldrenderintegration",function(){if(null==bizagi.oldrenderevent){bizagi.oldrenderevent=!0;var e=window.addEventListener?"addEventListener":"attachEvent";(0,window[e])("attachEvent"==e?"onmessage":"message",function(e){e.stopPropagation(),i.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:e.data})},!1)}i.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION,idCase:i.params.idCase,idWorkitem:i.params.idWorkitem,idTask:i.params.idTask,onlyUserWorkItems:i.params.onlyUserWorkItems,referrer:i.params.referrer,eventAsTasks:i.params.eventAsTasks})})}return i.renderingFacade=d,i.resizeLayout(),t},routingExecute:function(e){if(null==e)return!1;var t=e.find("#idCase").val()||this.params.idCase,i=e.find("#idWorkflow").val()||this.params.idWorkflow,a=e.find("#idWorkItem").val()||e.parent().find("#idWorkItem").val(),r=e.find("#idTask").val(),o=e.find("#eventAsTasks").val()||!1;return this.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t,idWorkflow:i,idWorkItem:a,idTask:r,eventAsTasks:o}),!0},dispose:function(){var e=this;setTimeout(function(){e.rendering&&(e.rendering.canvas.off(),e.rendering.dispose())},bizagi.override.disposeTime||50),e._super()}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.startForm",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_START_FORM},init:function(e,t,i){this.idProcess=i.data.idProcess,this._super(e,t,i),this.loadTemplates({startForm:bizagi.getTemplate("bizagi.workportal.desktop.widget.startForm").concat("#ui-bizagi-workportal-widget-start-form"),useNewEngine:!1})},renderContent:function(){var e=this,t=e.getTemplate("startForm");e.content=$.tmpl(t),e.content.parents("body").length>0?e.renderForm():e.subscribeOneTime("onWidgetIncludedInDOM",function(){e.renderForm({idCase:e.params.idCase,idWorkitem:e.params.idWorkitem,idTask:e.params.idTask,withOutGlobalForm:e.params.withOutGlobalForm||!1,isOfflineForm:e.params.isOfflineForm||!1,messageForm:e.params.messageForm||""})})},renderForm:function(e){var t,i=this,a=i.getComponentContainer("render");if(e.withOutGlobalForm){var r=i.workportalFacade.getTemplate("info-message"),o=""!==e.messageForm?e.messageForm:i.resources.getResource("render-without-globalform");void 0!==i.params&&void 0!==i.params.isOfflineForm&&!0===i.params.isOfflineForm&&(o=bizagi.util.getMessageFromNetworkState(i.dataService.online)),$.tmpl(r,{message:o}).appendTo(a),(t=$.Deferred()).fail()}else{var n=void 0!==i.dataService.serviceLocator.proxyPrefix?i.dataService.serviceLocator.proxyPrefix:"",s=void 0!==i.dataService.database?i.dataService.database:"",d=i.rendering=new bizagi.rendering.facade({proxyPrefix:n,database:s});e.action="LOADSTARTFORM",e.idProcess=i.idProcess,t=d.execute($.extend(e,{canvas:a,menu:i.menu})),a.bind("routing",function(e,t){i.publish("closeCurrentDialog");var a={action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:i.params.idCase||t.idCase,fromTask:i.params.fromTask||i.params.idTask,fromWorkItemId:i.params.fromWorkItemId||i.params.idWorkitem,isOfflineForm:i.params.isOfflineForm,formsRenderVersion:i.params.formsRenderVersion,onClose:function(){i.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView})}};a=$.extend(a,t),i.publish("executeAction",a)}),a.bind("oldrenderintegration",function(){if(void 0===bizagi.oldrenderevent){bizagi.oldrenderevent=!0;var e=window.addEventListener?"addEventListener":"attachEvent";(0,window[e])("attachEvent"==e?"onmessage":"message",function(e){e.stopPropagation(),i.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:e.data})},!1)}i.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION,idCase:i.params.idCase,idWorkitem:i.params.idWorkitem,idTask:i.params.idTask,onlyUserWorkItems:i.params.onlyUserWorkItems,referrer:i.params.referrer,eventAsTasks:i.params.eventAsTasks})})}return i.renderingFacade=d,i.resizeLayout(),t},routingExecute:function(e){if(void 0===e)return!1;var t=e.find("#idCase").val()||this.params.idCase,i=e.find("#idWorkflow").val()||this.params.idWorkflow,a=e.find("#idWorkItem").val()||e.parent().find("#idWorkItem").val(),r=e.find("#idTask").val(),o=e.find("#eventAsTasks").val()||!1;return this.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t,idWorkflow:i,idWorkItem:a,idTask:r,eventAsTasks:o}),!0},dispose:function(){var e=this;if(e.rendering&&(e.rendering.canvas.off(),e.rendering.form&&e.rendering.form.dispose(),this.IsDisposed))return;e._super()}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.mySearchList",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST},renderContent:function(){var e=this.getTemplate("mySearchListWrapper");return this.content=$.tmpl(e)}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.loadForm",{},{init:function(e,t,i){this.workportalFacade=e,this.dataService=t,this.params=i||{},this.form,this.searchCriteriasApplied=i.searchCriteriasApplied||[]},getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_LOADFORM},preProcessValue:function(e,t){return"combo"!=t.properties.type&&"radio"!=t.properties.type||(e={id:e[0]}),e},renderContent:function(){var e=this,t=e.workportalFacade.getTemplate("loadForm");e.content=$.tmpl(t),bizagi.loader.start("rendering").then(function(){var t=bizagi.rendering.form.extend({createRenderElement:function(e){var t=e.render.properties;t.rangeQuery&&"none"!=t.rangeQuery&&(t.xpath=t.xpath+"@"+t.rangeQuery),this._super(e)}}),i=new(bizagi.rendering.facade.extend({processForm:function(i,a,r){var o=$.extend(r,{renderFactory:a,dataService:r.dataService||this.dataService,data:i}),n=new t(o);return e.searchCriteriasApplied.length>0&&$.each(e.searchCriteriasApplied,function(t,i){var a=n.getRenderById(i.id);a&&a.setValue(e.preProcessValue(i.value,a))}),n.render(),n}})),a={h_action:"QUERYFORM",h_contexttype:"entity",h_idForm:e.params.guidForm,dataType:"text"};e.dataService.getQueryForm(a).done(function(t){var a=t.replace(/\"type\"\s*:\s*\"([':.,-\[\]\w\s]*)\"/g,function(e,t,i,a){return e.replace(t,t.replace(/query/i,"").toLowerCase())});a=a.replace(/\"includedInResult\"\s*:\s*(true)/g,'"includedInResult":false');var r=JSON.parse(a);r.form.buttons=[];var o={canvas:$(e.content),data:r};return i.execute(o).done(function(t){e.form=t}),e.content})})}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.subMenu",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SUBMENU},renderContent:function(){var e=this.workportalFacade.getTemplate("menu.submenu");return this.content=$.tmpl(e)}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.search",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH},renderContent:function(){var e=this.workportalFacade.getTemplate("search");return this.content=$.tmpl(e)},routingExecute:function(e){if(null==e)return!1;var t=e.find("#idCase").val(),i=e.find("#idWorkItem").val(),a=e.find("#idTask").val(),r=e.find("#eventAsTasks").val()||!1;this.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t,idWorkItem:i,idTask:a,eventAsTasks:r})}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.page",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PAGE},init:function(e,t,i){this._super(e,t,i),this.loadTemplates({page:bizagi.getTemplate("bizagi.workportal.desktop.widget.page").concat("#ui-bizagi-workportal-widget-page"),useNewEngine:!1})},renderContent:function(){var e=this.getTemplate("page"),t=this.content=$.tmpl(e,{});return this.renderStaticForm(this.params),t},renderStaticForm:function(e){var t=this,i=t.getComponentContainer("render"),a=new bizagi.rendering.facade(e.context);e=e||{},$.extend(e,{canvas:i}),a.execute(e),i.bind("close",function(){t.publish("closeCurrentDialog")})}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.renderform",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDER_FORM},init:function(e,t,i){if(bizagi.util.isEmpty(i.idForm))if(bizagi.util.isEmpty(window.location.hash)){if(!bizagi.util.isEmpty(window.location.search)){var a=bizagi.util.getQueryString();a.idEntity&&(i.idEntity=a.idEntity,this.isConfiguredFromHash=!0),a.surrogateKey&&(i.surrogateKey=a.surrogateKey)}}else{var r=bizagi.util.getHashParams();r.length>1&&(i.idCase=r[1],this.isConfiguredFromHash=!0),r.length>2&&(i.idWorkitem=r[2])}this._super(e,t,i)},renderContent:function(){var e=this,t=e.getTemplate("renderform");new $.Deferred;if(bizagi.util.isEmpty(e.params.idForm))return e.changeWidget(bizagi.workportal.currentInboxView),null;e.content=$.tmpl(t),e.content.parents("body").length>0?e.renderForm():e.subscribeOneTime("onWidgetIncludedInDOM",function(){e.renderForm({idEntity:e.params.idEntity,surrogateKey:e.params.surrogateKey})})},renderForm:function(e){var t=this,i=null!=typeof t.dataService.serviceLocator.proxyPrefix?t.dataService.serviceLocator.proxyPrefix:"",a=new bizagi.rendering.facade({proxyPrefix:i}),r=t.getComponentContainer("render");a.execute($.extend(e,{canvas:r})),r.bind("routing",function(){t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t.params.idCase,onClose:function(){t.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView})}})}),t.renderingFacade=a,t.resizeLayout()}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.genericiframe",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME},init:function(e,t,i){this._super(e,t,i),this.loadTemplates({genericiframe:bizagi.getTemplate("bizagi.workportal.desktop.widget.genericiframe"),useNewEngine:!1})},renderContent:function(){var e=this.getTemplate("genericiframe"),t={widgetURL:this.params.widgetURL};return this.content=$.tmpl(e,t)}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.oldrenderintegration",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_OLDRENDERINTEGRATION},renderContent:function(){var e=this,t=e.getTemplate("integration-old-render"),i={};i.url=e.params.url||"App/ListaDetalle/Detalle.aspx?PostBack=1&idCase="+e.params.idCase+"&idWorkitem="+e.params.idWorkitem+"&idTask="+e.params.idTask;var a=e.content=$.tmpl(t,i);return bizagi.workportal.currentInboxView=e.getWidgetName(),a}}),bizagi.workportal.widgets.fontsize.extend("bizagi.workportal.widgets.fontsize",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({fontsize:bizagi.getTemplate("bizagi.workportal.desktop.widget.fontsize"),useNewEngine:!1})},postRender:function(){var e=this.getContent(),t=$("body").data("sizeselected")||"font-large";this.fontsizeTemplate=this.getTemplate("fontsize"),$(".ui-bizagi-wp-font-content a",e).removeClass("active"),$(".ui-bizagi-wp-font-content ."+t+" a",e).addClass("active");var i=$(".font-switcher",e);$(i).click(function(){var t=$(this).parent().attr("class");return $("body").data("sizeselected",t),$(".ui-bizagi-wp-font-content a",e).removeClass("active"),$(".ui-bizagi-wp-font-content ."+t+" a",e).addClass("active"),$("html, body").removeClass("font-medium font-large font-x-large").addClass(t),!0})}}),bizagi.workportal.controllers.main.extend("bizagi.workportal.controllers.main",{},{init:function(e,t){var i=this;i._super(e,t),this.subscribe("showOldWindow",function(e,t){i.showOldWindow(t)}),bizagi.injector.get("sessionTimeOutService"),i.loadTemplates({"session-timeout":bizagi.getTemplate("bizagi.workportal.desktop.widget.sessionTimeout").concat("#session-timeout")}),i.loadTemplates({"session-timeout-expired":bizagi.getTemplate("bizagi.workportal.desktop.widget.sessionTimeoutExpired").concat("#session-timeout-expired")}),$().dialog()},renderContent:function(){if(bizagi.util.isIE()&&bizagi.util.getIEVersion()<9)return this.renderIENotCompatibleTemplate();return this._super()},renderIENotCompatibleTemplate:function(){var e=this,t=e.workportalFacade.getTemplate("workportal.notCompatibleIE"),i=e.content=$.tmpl(t,{url:BIZAGI_PATH_TO_BASE+"defaulthtml.aspx"});return $(window).resize(function(){e.resizeLayout()}),i},postRender:function(){},addDialogToDialogStack:function(e){bizagi.workportal.desktop.dialogStack=bizagi.workportal.desktop.dialogStack||[],bizagi.workportal.desktop.dialogStack.push(e)},showDialogWidget:function(e){var t=new bizagi.workportal.desktop.widgets.dialog(this.dataService,this.workportalFacade);return t.renderWidget(e),this.addDialogToDialogStack(t),t},closeCurrentDialog:function(e){if(bizagi.workportal.desktop.dialogStack=bizagi.workportal.desktop.dialogStack||[],bizagi.workportal.desktop.dialogStack.length>0){var t=bizagi.workportal.desktop.dialogStack.pop();try{t.close()}catch(e){}}bizagi.closeQuirksModePopup()},closeAllDialogs:function(){if(bizagi.workportal.desktop.dialogStack=bizagi.workportal.desktop.dialogStack||[],bizagi.workportal.desktop.dialogStack.length>0)for(iDialog=0,iTotalDialog=bizagi.workportal.desktop.dialogStack.length;iDialog<iTotalDialog;iDialog++){var e=bizagi.workportal.desktop.dialogStack.pop();try{e.close()}catch(e){}}$(".ui-dialog-content").dialog("close")},popupWidget:function(e){var t=new bizagi.workportal.desktop.widgets.popup(this.dataService,this.workportalFacade,e.options);t.renderWidget(e),e.options&&e.options.closed&&$.when(t.closed()).done(function(){e.options.closed()})},showOldWindow:function(e){var t=bizagi.util.extendQueryString(e.url,{referrer:"workportal"});bizagi.showQuirksModePopup(t,e.windowParameters)},cleanWidgets:function(){if(this.workarea.cleanWidgets(),bizagi.workportal.desktop.popup)if(bizagi.workportal.desktop.popup.instance)void 0!==bizagi.workportal.desktop.popup.instance.dontClose&&(bizagi.workportal.desktop.popup.instance.dontClose=!1,bizagi.workportal.desktop.popup.instance.close());else{var e=$(".modal .complex-frame");e.length>0&&e.closest(".modal").remove()}},refreshQueryFormShortCut:function(){bizagi.workportal.widgets.queries.shortcut.instance&&bizagi.workportal.widgets.queries.shortcut.instance.renderStoredQueries()}}),bizagi.workportal.controllers.menu.extend("bizagi.workportal.controllers.menu",{},{postRender:function(){var e=this,t=new $.Deferred,i=e.getContent(),a=$("#ui-bizagi-wp-widget-searchContainer",i),r=e.workportalFacade.getTemplate("menu.security"),o=$("#main_menu",i),n=bizagi.menuSecurity;switch($.tmpl(r,n,{reportsSecurity:function(){return n.AnalysisReports}}).appendTo(o),e.workportalFacade.workportal.getWidgetByDataUser()){case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL:$("#menuListHome",o).addClass("activeMenu").siblings().removeClass("activeMenu");break;case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID:case bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX:$("#menuListInbox",o).addClass("activeMenu").siblings().removeClass("activeMenu")}n.LogOut||$("#logout",i).hide(),$("#main_menu a",i).click(function(e){e.preventDefault()}),n.Search||$("#ui-bizagi-wp-widget-searchContainer",i).hide(),$("#main_menu li",i).on("click",e.setActiveSection),n.Inbox||$("#menuListInbox",i).hide(),$("#main_menu li#menuListWidget",i).click(function(){e.showWidgetsPopup()}),$("#main_menu li#menuListNew",i).click(function(){bizagi.loader.start("newcase").then(function(){e.showNewCasePopup()})}),bizagi.util.parseBoolean(bizagi.override.enableMySearch)&&bizagi.currentUser.associatedStakeholders&&bizagi.currentUser.associatedStakeholders.length>0&&$("#ui-bizagi-wp-widget-searchContainer",i).click(function(){e.showMySearchPopup()}),$("#main_menu li#menuListHome",i).click(function(){var t=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;e.publish("changeWidget",{widgetName:t})}),$("#main_menu li#menuListInbox",i).click(function(){var t,i,a=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,r=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID,o=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;i=$.isFunction(bizagi.cookie)&&bizagi.cookie("bizagiDefaultWidget")!==o?bizagi.cookie("bizagiDefaultWidget"):r,bizagi.loader.start("inbox").then(function(){switch(i){case a:t=a;break;case r:t=r;break;case o:t=o;break;default:t=r}e.publish("changeWidget",{widgetName:t})}),e.resetNavigatorInfo()}),$("#main_menu li#menuListQueries",i).click(function(){e.showQueriesPopup()}),$("#tempEntities",i).click(function(){e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ENTITIES,modalParameters:{title:e.getResource("workportal-menu-preferences"),width:"1020px",showCloseButton:!1}})}),$("#menuListAdmin",i).click(function(){e.renderAdminMenu()}),$("#menuListQuickProcess",i).click(function(){e.renderQuickProcessMenu()}),$("#menuListReports",i).click(function(){e.renderReportsMenu()}),$("#menuUserPrivacy",i).click(function(){e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_USER_PRIVACY,closeVisible:!1,maximize:!1,modalParameters:{title:e.getResource("workportal-project-discussion-privacy"),width:600,height:"auto"}})}),$("#menuListPreferences",i).click(function(){var t=e.dataService.getUrl({endPoint:"ListPreferences"}),i=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PREFERENCES;bizagi.loader.start("admin").then(function(){e.publish("showDialogWidget",{widgetName:i,widgetURL:t,closeVisible:!1,maximize:!1,modalParameters:{title:e.getResource("workportal-menu-preferences"),width:600,height:710}})})}),$("#displayOptions",i).click(function(){var t=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DISPLAY_OPTIONS;bizagi.loader.start("admin").then(function(){e.publish("showDialogWidget",{widgetName:t,closeVisible:!1,maximize:!1,modalParameters:{title:e.getResource("workportal-menu-display-options"),width:600,height:280}})})}),$("#user",i).click(function(){e.showUserProfileMenu()}),$("#qr",i).click(function(){e.showQRCodePopup()}),t.resolve(i);var s=$("#menuQuery",a);return $(".ui-bizagi-wp-bt-font",i).click(function(){e.renderFontMenu()}),window.CURRENT_THEME_REMOVE_IT="theme1",$(".ui-bizagi-wp-bt-classic-theme,.ui-bizagi-wp-bt-modern-theme,.ui-bizagi-wp-bt-booking-theme",i).hide(),$(".ui-bizagi-wp-bt-classic-theme",i).click(function(){$("body").append("<div id='workportal-theme-layer' ></div>"),$("#workportal-theme-layer").addClass("workportal-theme-layer-visible"),window.CURRENT_THEME_REMOVE_IT="theme1";var t=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;e.publish("changeWidget",{widgetName:t}),$(".ui-bizagi-wp-bt-modern-theme").show(),$(".ui-bizagi-wp-bt-booking-theme").show(),$(".ui-bizagi-wp-bt-classic-theme").hide(),$("#user-profile").hide("fast")}),$(".ui-bizagi-wp-bt-modern-theme",i).click(function(){$("body").append("<div id='workportal-theme-layer' ></div>"),$("#workportal-theme-layer").addClass("workportal-theme-layer-visible"),window.CURRENT_THEME_REMOVE_IT="theme2";var t=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;e.publish("changeWidget",{widgetName:t}),$(".ui-bizagi-wp-bt-modern-theme").hide(),$(".ui-bizagi-wp-bt-classic-theme").show(),$(".ui-bizagi-wp-bt-booking-theme").show(),$("#user-profile").hide("fast")}),$(".ui-bizagi-wp-bt-booking-theme",i).click(function(){$("body").append("<div id='workportal-theme-layer' ></div>"),$("#workportal-theme-layer").addClass("workportal-theme-layer-visible"),window.CURRENT_THEME_REMOVE_IT="theme3";var t=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL;e.publish("changeWidget",{widgetName:t}),$(".ui-bizagi-wp-bt-booking-theme").hide(),$(".ui-bizagi-wp-bt-classic-theme").show(),$(".ui-bizagi-wp-bt-modern-theme").show(),$("#user-profile").hide("fast")}),$("#logout",i).click(function(){$.when(bizagi.util.autoSave()).done(function(){$(document).data("auto-save",""),e.dataService.logout()})}),$("#about",i).click(function(){e.showAboutPopup()}),$(s).bind("keypress",function(t){if(13==t.keyCode){var i=s.val();""!=i&&i!=e.getResource("workportal-menu-search")&&e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:s.val(),onlyUserWorkItems:!1}),e.resetNavigatorInfo()}}),$(window).trigger("resize"),t.promise()},resetNavigatorInfo:function(){bizagi.util.emptyNavigatorInfo()},setActiveSection:function(){$(this).parent().find("li").removeClass("activeMenu"),$(this).addClass("activeMenu")},showUserProfileMenu:function(){var e=this.getContent(),t=$("div#user-profile",e);t.show("fast",function(){t.click(function(e){e.stopPropagation()})}),$(document).on("click",function(e){$(e.target).is("#user-profile")||0!==$(e.target).closest("#user").length||t.hide("fast"),e.stopPropagation()})},showQRCodePopup:function(){var e=this,t=this.dataService.serviceLocator.getUrl("login-qr-image64");$.ajax({url:t,success:function(t){var i=e.workportalFacade.getTemplate("menu.modal.qr"),a=$.tmpl(i,{});$(a).find("#QRCode").attr("src","data:image/png;base64,"+t),$(a).dialog({width:590,modal:!0,title:null,dialogClass:"qr-dialog",allowmaximize:!1,maximized:!1,resizable:!1,draggable:!1})}})},showMenuPopup:function(e){var t=this,i=t.getContent(),a=new bizagi.workportal.desktop.popup(t.dataService,t.workportalFacade,{sourceElement:e.buttonSelector,my:e.my||"center top",at:e.at||"center bottom",offset:e.offset,height:e.height,width:e.width});if(t.currentPopup!=e.buttonSelector){t.currentPopup=e.buttonSelector;var r=t.workportalFacade.getTemplate(e.template);a.render(r),$(e.buttonSelector,i).addClass("active"),$.when(a.closed()).done(function(){t.currentPopup=null,$(e.buttonSelector,i).removeClass("active")})}else bizagi.workportal.desktop.popup.closePopupInstance()},showUserPopup:function(){this.showMenuPopup({buttonSelector:"#ui-bizagi-wp-menu-username",template:"menu.modal.user",offset:"0 0",height:80,width:90})},showWidgetsPopup:function(e){e=e||{};this.showMenuPopup({buttonSelector:e.buttonSelector||"#main_menu li#menuListWidget",template:e.template||"menu.modal.widgets",offset:e.offset||"18 -34",height:e.height||160,width:e.width||175})},showNewCasePopup:function(){var e=this,t=e.getContent();$("#main_menu li#menuListNew",t).addClass("active"),"newCase"!=e.currentPopup?(e.currentPopup="newCase",e.publish("popupWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_NEWCASE,options:{sourceElement:"#main_menu li#menuListNew","max-height":"746",height:"auto",width:"339",offset:"18 -4",activeScroll:!1,closed:function(){e.currentPopup=null,$("#main_menu li#menuListNew",t).removeClass("active")}}})):bizagi.workportal.desktop.popup.closePopupInstance()},showMySearchPopup:function(){var e=this,t=e.getContent();$("#ui-bizagi-wp-widget-searchContainer",t).addClass("active"),"mySearch"!=e.currentPopup?(e.currentPopup="mySearch",e.publish("popupWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_MYSEARCHLIST,options:{sourceElement:"#ui-bizagi-wp-widget-searchContainer","max-height":"346",height:"auto",width:"339",top:"52",offset:"18 10",activeScroll:!0,closed:function(){e.currentPopup=null,$("#ui-bizagi-wp-widget-searchContainer",t).removeClass("active")}}})):bizagi.workportal.desktop.popup.closePopupInstance()},showQueriesPopup:function(){var e=this,t=e.getContent();if($("#main_menu li#menuListQueries",t).addClass("active"),"queries"!=e.currentPopup){var i=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERIES;1==bizagi.util.parseBoolean(bizagi.override.disableFrankensteinQueryForms)&&(i=bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERIES_DEFINITION),bizagi.loader.start("queries").then(function(){e.currentPopup="queries",e.publish("popupWidget",{widgetName:i,options:{sourceElement:"#main_menu li#menuListQueries","max-height":"346",height:"auto",width:"339",offset:"18 -4",activeScroll:!0,closed:function(){e.currentPopup=null,$("#main_menu li#menuListQueries",t).removeClass("active")}}})})}else bizagi.workportal.desktop.popup.closePopupInstance()},showAboutPopup:function(){var e=this.workportalFacade.getTemplate("menu.modal.about"),t=$.tmpl(e,{build:bizagi.loader.productBuildToAbout,currentYear:bizagi.loader.currentYearVersion});$(t).dialog({width:430,height:200,modal:!0,title:bizagi.localization.getResource("workportal-menu-about"),allowmaximize:!1,maximized:!1,resizable:!1,draggable:!1})},checkRootCategory:function(e,t){if(null!=e.permissions)for(var i=0;i<e.permissions.length;i++)if(null!=e.permissions[i][t])return!0;return!1},getsRootCategory:function(e,t){for(var i=0;i<e.permissions.length;i++)if(null!=e.permissions[i][t])return e.permissions[i][t];return{}},getSubMenuData:function(e,t){var i=this,a=[],r="workportal-menu-submenu-";return e=e||i.security.getRawData()||{},i.checkRootCategory(e,t)&&($.each(i.getsRootCategory(e,t),function(e,t){"MultilanguageEntities"!==t&&"Multilanguage"!==t&&a.push({categoryKey:t,categoryName:i.getResource(r+t),categoryUrl:i.dataService.getUrl({endPoint:t})})}),i.validateLanguageSettings(t,r,a)),a},validateLanguageSettings:function(e,t,i){"Admin"!==e||!0!==bizagi.menuSecurity.MultilanguageEntities&&!0!==bizagi.menuSecurity.Multilanguage||i.push({categoryKey:"Multilanguage",categoryName:this.getResource(t+"Multilanguage"),categoryUrl:this.dataService.getUrl({endPoint:"Multilanguage"})})},renderAdminMenu:function(){var e=this,t=e.getContent(),i=e.getSubMenuData(e.jsonSecurityList,"Admin");if($("#main_menu li#menuListAdmin",t).addClass("active"),"subMenu"==e.currentPopup)return bizagi.workportal.desktop.popup.closePopupInstance(),void(e.currentPopup=null);e.currentPopup="subMenu",e.publish("popupWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SUBMENU,options:{sourceElement:"#main_menu li#menuListAdmin","max-height":"346",height:"auto",width:"339",offset:"18 -4",activeScroll:!0,closed:function(){e.currentPopup=null,$("#main_menu li#menuListAdmin",t).removeClass("active")},menuData:i}})},renderQuickProcessMenu:function(){for(var e=this,t=e.getContent(),i=e.getSubMenuData(e.jsonSecurityList,"AdhocProcess"),a={AdhocProcessAdmin:-1,AdhocUserGroupAdmin:-1,AdhocUserGroupReport:-1},r=0;r<i.length;r+=1)a[i[r].categoryKey]=r;if(a.AdhocProcessAdmin>-1&&i.push({categoryKey:"AdhocCreateProcess",categoryName:e.getResource("workportal-menu-submenu-AdhocCreateProcess"),categoryUrl:void 0}),$("#main_menu li#menuListQuickProcess",t).addClass("active"),"subMenu"==e.currentPopup)return bizagi.workportal.desktop.popup.closePopupInstance(),void(e.currentPopup=null);e.currentPopup="subMenu",e.publish("popupWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SUBMENU,options:{sourceElement:"#main_menu li#menuListQuickProcess","max-height":"346",height:"auto",width:"339",offset:"18 -4",activeScroll:!0,closed:function(){e.currentPopup=null,$("#main_menu li#menuListQuickProcess",t).removeClass("active")},menuData:i}})},renderReportsMenu:function(){var e=this,t=e.getContent();bizagi.loader.start("reports").then(function(){var i=bizagi.util.isIE8()?bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REPORTS:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REPORTS_MENU;$("#main_menu li#menuListReports",t).addClass("active"),"subMenu"!=e.currentPopup?(e.currentPopup="subMenu",e.publish("popupWidget",{widgetName:i,options:{sourceElement:"#main_menu li#menuListReports","max-height":"346",height:"auto",width:"339",offset:"18 -4",activeScroll:!0,closed:function(){e.currentPopup=null,$("#main_menu li#menuListReports",t).removeClass("active")},menuData:e.getSubMenuData(e.jsonSecurityList,"AnalysisReports")}})):bizagi.workportal.desktop.popup.closePopupInstance()})},renderFontMenu:function(){var e=this,t=e.getContent();$(".ui-bizagi-wp-bt-font",t).addClass("active"),"fontsize"!=e.currentPopup?(e.currentPopup="fontsize",e.publish("popupWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_FONTSIZE,options:{sourceElement:".ui-bizagi-wp-bt-font",offset:"0 16",closed:function(){e.currentPopup=null,$(".ui-bizagi-wp-bt-font",t).removeClass("active")}}})):bizagi.workportal.desktop.popup.closePopupInstance()},renderSubMenu:function(e,t,a){var r=this,o=(r.getContent(),[]);for(i in t)t.hasOwnProperty(i)&&o.push({categoryKey:t[i].id,categoryName:t[i].text,categoryClassName:t[i].className});e.addClass("active"),"subMenu"!=r.currentPopup?(r.currentPopup="subMenu",r.publish("popupWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SUBMENU,options:{sourceElement:e,"max-height":"346",height:"auto",width:"339",offset:"18 -4",activeScroll:!0,closed:function(){r.currentPopup=null,e.removeClass("active")},menuData:o,customClickHandler:function(e){a&&a(r,e)}}})):bizagi.workportal.desktop.popup.closePopupInstance()},showEntitiesPopup:function(e){var t=this.getContent();$("#main_menu li#temp",t).addClass("active"),"genericiframe"!=this.currentPopup?(this.currentPopup="genericiframe",this.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:e})):bizagi.workportal.desktop.popup.closePopupInstance()}}),bizagi.workportal.controllers.main.extend("bizagi.workportal.controllers.main",{},{}),$(window).bind("resize",function(){bizagi.workportal.desktop.popup.closePopupInstance()}),$.Class.extend("bizagi.workportal.desktop.popup",{closePopupInstance:function(){bizagi.workportal.desktop.popup.instance&&bizagi.workportal.desktop.popup.instance.close()}},{init:function(e,t,i){this.dataService=e,this.workportalFacade=t,i=i||{},this.sourceElement=i.sourceElement,this.my=i.my||"center top",this.at=i.at||"center bottom",this.offset=i.offset||"18 -20",this.activeScroll=i.activeScroll||!1,this.arrowPosition=i.arrowPosition||!1,i.position&&(this.position=i.position),i.insertAfter&&(this.insertAfter=i.insertAfter),this.dontClose=i.dontClose||!1,this.scrollElement=i.scrollElement||".content"},render:function(e,t){var i=this,a=window.document,r=i.workportalFacade.getTemplate("popup");t=t||{},i.closeDeferred=new $.Deferred,i.Class.closePopupInstance(),bizagi.workportal.desktop.popup.instance=this,$.extend(t,t,{activeScroll:i.activeScroll}),i.popup=$.tmpl(r,t),$(".content",i.popup).append(e),i.insertAfter?$(i.insertAfter).after(i.popup):i.popup.appendTo("body",a),i.showPopup(i.popup)},showPopup:function(e){var t=window.document,i=this;(i.popupWidth&&e.width(i.popupWidth),i.popupHeight&&e.height(i.popupHeight),i.sourceElement?i.insertAfter?(e.find(".selectarrow").hide(),e.css({display:"inline-block",float:"left",position:"relative",left:"37%",top:"20px","z-index":1})):(e.position({my:i.my,at:i.at,of:$(i.sourceElement),collision:"none",offset:i.offset}),i.position&&e.css("position",i.position)):(e.css("left",($(window).width()-e.width())/2),e.css("top",($(window).height()-e.height())/2)),i.arrowPosition)&&$(".selectarrow",e).css(i.arrowPosition);setTimeout(function(){e.click(function(e){e.stopPropagation()}),$(t).one("click",function(){i.close()})},100)},closed:function(){return this.closeDeferred},close:function(){window.document;this.dontClose||(this.popup.remove(),bizagi.workportal.desktop.popup.instance=null,this.closeDeferred.resolve())},getContent:function(){return this.popup}}),bizagi.workportal.widgets.print.extend("bizagi.workportal.widgets.print",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({print:bizagi.getTemplate("bizagi.workportal.desktop.widget.print").concat("#bz-wp-widget-print"),useNewEngine:!1})},postRender:function(){var e=this,t=e.getContent(),i=null!=typeof e.dataService.serviceLocator.proxyPrefix?e.dataService.serviceLocator.proxyPrefix:"",a=new bizagi.rendering.facade({proxyPrefix:i});$.when(a.execute($.extend({canvas:t,printversion:!0},$.extend(e.params.params,{p_all_rows:1e6})))).done(function(){e.formatTabs(),e.formatGroups(),e.appendCaseDetails(),e.formatECM(),e.formatButton(),e.formatGrid(),e.formatRenderContainer(),$(".ui-bizagi-button-container",t).remove()})},formatTabs:function(){var e=$("<div>"),t=0,i=this.getContent(),a=$(".ui-tabs",i);$.each(a,function(){var r=$("ul",$(this)),o=$(">div",$(this));$.each($("li",r),function(){a.tabs("option","active",t),$(e).append("<h3>"+$(this).text()+"</h3>"),$(e).append(o[t++])}),$(".ui-tabs",i).empty(),$(".ui-tabs",i).append(e),a.tabs("destroy")})},appendCaseDetails:function(){var e=this,t=e.getContent();e.dataService.summaryCaseDetails({idCase:e.params.params.idCase}).done(function(i){var a,r,o,n=$("<ul></ul>").addClass("ui-bz-print-case-details");function s(t){$("<li></li>").text(e.resources.getResource("workportal-widget-inboxcommon-process")+" "+t).appendTo(n)}$("<li></li>").text(e.resources.getResource("workportal-widget-inboxcommon-case-number")+" "+i.caseNumber).appendTo(n),e.params&&e.params.params&&0!=e.params.params.idWorkitem&&$("<li></li>").text(e.resources.getResource("workportal-widget-inboxcommon-activities-name")+" "+(a=e.params.params.idWorkitem,r=i.currentState,o="",$.each(r,function(e,t){t.idWorkItem==a&&(o=t.state||t.displayName)}),o)).appendTo(n),$("<li></li>").text(e.resources.getResource("workportal-widget-inboxcommon-created-by")+" "+i.createdBy.Name).appendTo(n),$("<li></li>").html(e.resources.getResource("workportal-widget-inboxcommon-creation-date")+'<span class="formatDate">'+i.creationDate+"</span>").appendTo(n),void 0!==i.estimatedSolutionDate&&$("<li></li>").html(e.resources.getResource("workportal-widget-inboxcommon-state-expires-on")+'<span class="formatDate">'+i.estimatedSolutionDate+"</span>").appendTo(n),i.idPlan?$.when(e.dataService.getPlan({idPlan:i.idPlan})).done(function(e){s(e.name)}):s(i.process),i.processPath&&"undefined"!==i.processPath&&$("<li></li>").text(e.resources.getResource("workportal-widget-inboxcommon-process-path")+" "+i.processPath).appendTo(n),$(".ui-bizagi-container:first",t).prepend(n),bizagi.util.formatInvariantDate(t,e.getResource("dateFormat")+" "+e.getResource("timeFormat"))})},formatGroups:function(){var e=this.getContent(),t=$("h3.ui-bizagi-container-group-header",e);$.each(t,function(){var e=$(this).text();$(this).empty(),$(this).append(e)})},formatECM:function(){var e=this.getContent(),t=$(".ui-bizagi-render-upload",e);$(t).bind("ecmLoaded",function(e){var t=$("img",e.container),i=$(".filename a:last",e.container),a=$(i).parent("li").text().replace(/^\s+|\s+$/g,"");t.unbind("click"),i.unbind("click"),$(i).parent("li").text(a)})},formatButton:function(){var e=this.getContent(),t=$(".ui-bizagi-render-button",e);$.each(t,function(e,t){var i=$(t).val(),a=$(t).parent();$(a).empty(),$(a).append("<div class='ui-bizagi-render-button'>"+i+"</div>")})},formatGrid:function(){var e=this.getContent(),t=$(".ui-bizagi-grid-table",e);pageContent=$(".ui-pg-table",e),closeButton=$(".ui-jqgrid-titlebar-close",e),$("th.ui-bizagi-column-hidden, th.ui-bizagi-grid-key, td.ui-bizagi-grid-key, .bz-rn-grid-container-foother",e).remove(),$("[data-action], ul li, .ui-bizagi-grid-column, tr, th",t).unbind("click"),$(closeButton).remove()},formatRenderContainer:function(){var e=this.getContent();$(".ui-bizagi-notifications-container",e).remove()}}),bizagi.workportal.desktop.popup.extend("bizagi.workportal.desktop.widgets.popup",{},{renderWidget:function(e){var t,i=this;$.when(i.workportalFacade.getWidget(e.widgetName,e)).pipe(function(e){return t=e,i.register(t),t.render()}).done(function(){var a=t.getContent();i.render(a,e.options)})},register:function(e){e.registerCallback&&e.registerCallback(this)}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.homeportal",{contexts:{HOME:{widgets:{dashboard:{layout:"content",name:"bizagi.workportal.widgets.dashboard"},stuff:{layout:"dashboard",name:"bizagi.workportal.widgets.stuff",canvas:"stuff"},plans:{layout:"dashboard",name:"bizagi.workportal.widgets.decontextualized.plans",canvas:"plans"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},sidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.sidebarhome"},usersummary:{layout:"sidebar",name:"bizagi.workportal.widgets.usersummary",canvas:"content1"},myshortcuts:{layout:"sidebar",name:"bizagi.workportal.widgets.shortcuts",canvas:"content2"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0},belongs:{toLeftSidebarCD:!1,toRightSidebarCD:!1,toTaskSidebarCD:!1}},"TEMPLATEENGINE-VIEW":{widgets:{templates:{layout:"content",name:"bizagi.workportal.widgets.templates"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},paginator:{layout:"templates",name:"bizagi.workportal.widgets.paginator",canvas:"paginator"},sortbar:{layout:"templates",name:"bizagi.workportal.widgets.sortbar",canvas:"sortbar"},mysearchfilter:{layout:"templates",name:"bizagi.workportal.widgets.mysearchfilter",canvas:"mysearchfilter"},sidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.sidebar"},stuff:{layout:"sidebar",name:"bizagi.workportal.widgets.stuff",canvas:"content1"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:1},belongs:{toLeftSidebarCD:!1,toRightSidebarCD:!1,toTaskSidebarCD:!1}},"ENTITY-ENGINE-VIEW":{widgets:{templates:{layout:"content",name:"bizagi.workportal.widgets.templates"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},sidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.sidebar"},stuff:{layout:"sidebar",name:"bizagi.workportal.widgets.stuff",canvas:"content1"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:1},belongs:{toLeftSidebarCD:!1,toRightSidebarCD:!1,toTaskSidebarCD:!1}},"SEARCH-ENGINE-VIEW":{widgets:{templates:{layout:"content",name:"bizagi.workportal.widgets.templates"},paginator:{layout:"templates",name:"bizagi.workportal.widgets.paginator",canvas:"paginator"},sortbar:{layout:"templates",name:"bizagi.workportal.widgets.sortbar",canvas:"sortbar"},mysearchfilter:{layout:"templates",name:"bizagi.workportal.widgets.mysearchfilter",canvas:"mysearchfilter"},sidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.sidebar"},mysearchcriteria:{layout:"sidebar",name:"bizagi.workportal.widgets.mysearchcriteria",canvas:"content1"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:1},belongs:{toLeftSidebarCD:!1,toRightSidebarCD:!1,toTaskSidebarCD:!1}},"CASES-TEMPLATE-VIEW":{widgets:{templates:{layout:"content",name:"bizagi.workportal.widgets.casestemplate"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},paginator:{layout:"templates",name:"bizagi.workportal.widgets.paginator",canvas:"paginator"},sortbar:{layout:"templates",name:"bizagi.workportal.widgets.sortbar",canvas:"sortbar"},sidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.sidebar"},proccesseslist:{layout:"sidebar",name:"bizagi.workportal.widgets.processeslist",canvas:"content1"},filtercases:{layout:"sidebar",name:"bizagi.workportal.widgets.filtercases",canvas:"sidebarfooter"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:1},belongs:{toLeftSidebarCD:!1,toRightSidebarCD:!1,toTaskSidebarCD:!1}},"PLANS-VIEW":{widgets:{topmenu:{layout:"content",name:"bizagi.workportal.widgets.plans.topmenu"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},manager:{layout:"topmenu",name:"bizagi.workportal.widgets.plans.manager",canvas:"plansList"},sidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.sidebar"},filters:{layout:"sidebar",name:"bizagi.workportal.widgets.plans.filters",canvas:"content1"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:1},belongs:{toLeftSidebarCD:!1,toRightSidebarCD:!1,toTaskSidebarCD:!1}},ACTIVITY:{widgets:{activity:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.activity",canvas:"contentprincipal"},leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent1"},activityDescription:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activity.description",canvas:"sidebarcontent2"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent3"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent4"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent5"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent6"},subprocesses:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.subprocesses",canvas:"sidebarcontent7"},relatedPlan:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activity.plan.sidebar",canvas:"sidebarcontentextra"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},OVERVIEW:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},overview:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.overview",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent1"},activityDescription:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activity.description",canvas:"sidebarcontent2"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent3"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent4"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent5"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent6"},subprocesses:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.subprocesses",canvas:"sidebarcontent7"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},COMMENTS:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},discussions:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.discussions",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},discussionSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.discussion.sidebar",canvas:"sidebarcontent1"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent2"},activityDescription:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activity.description",canvas:"sidebarcontent3"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent4"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent5"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent6"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent7"},subprocesses:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.subprocesses",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},FILES:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},files:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.files",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},filesPreview:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.filesPreview",canvas:"sidebarcontent1"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent2"},activityDescription:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activity.description",canvas:"sidebarcontent3"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent4"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent5"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent6"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent7"},subprocesses:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.subprocesses",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},PROCESSMAP:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},processMap:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.processMap",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent1"},activityDescription:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activity.description",canvas:"sidebarcontent2"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent3"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent4"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent5"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent6"},subprocesses:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.subprocesses",canvas:"sidebarcontent7"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},LOG:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},log:{layout:"contentDashboard",name:"bizagi.workportal.widgets.activity.log",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},TIMELINE:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},timeline:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.timeline",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},timelineSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.timeline.sidebar",canvas:"sidebarcontent1"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent2"},activityDescription:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activity.description",canvas:"sidebarcontent3"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent4"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent5"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent6"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent7"},subprocesses:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.subprocesses",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},PLANCREATE:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},plan:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.plan",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},caseState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.caseState",canvas:"sidebarcontent1"},activityDescription:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activity.description",canvas:"sidebarcontent2"},activityState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activityState",canvas:"sidebarcontent3"},processState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.processState",canvas:"sidebarcontent4"},users:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.users",canvas:"sidebarcontent5"},events:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.events",canvas:"sidebarcontent6"},subprocesses:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.subprocesses",canvas:"sidebarcontent7"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!0}},PLANOVERVIEW:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},planActivities:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.plan.activities",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},planSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.sidebar",canvas:"sidebarcontentextra"},planAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.action",canvas:"sidebarcontent1"},planState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.state",canvas:"sidebarcontent3"},planProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.progress",canvas:"sidebarcontent4"},planTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.time",canvas:"sidebarcontent5"},planParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.parent",canvas:"sidebarcontent6"},planUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.users",canvas:"sidebarcontent7"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},PLANACTIVITIES:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},planActivities:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.plan.activities",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},planSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.sidebar",canvas:"sidebarcontentextra"},planAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.action",canvas:"sidebarcontent1"},planState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.state",canvas:"sidebarcontent3"},planProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.progress",canvas:"sidebarcontent4"},planTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.time",canvas:"sidebarcontent5"},planParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.parent",canvas:"sidebarcontent6"},planUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.users",canvas:"sidebarcontent7"}},nav:{level:1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},PLANFILES:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},files:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.files",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},filesPreview:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.filesPreview",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent3"},empty3:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent4"},empty4:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent5"},empty5:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent6"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent7"},empty7:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},PLANCOMMENTS:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},discussions:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.discussions",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},planSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.sidebar",canvas:"sidebarcontentextra"},discussionSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.discussion.sidebar",canvas:"sidebarcontent1"},planAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.action",canvas:"sidebarcontent3"},planState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.state",canvas:"sidebarcontent4"},planProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.progress",canvas:"sidebarcontent5"},planTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.time",canvas:"sidebarcontent6"},planUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.users",canvas:"sidebarcontent7"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},PLANTIMELINE:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},timeline:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.timeline",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent1"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent3"},empty3:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent4"},empty4:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent5"},empty5:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent6"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent7"},empty7:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"}},nav:{level:1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},PLANSIDEBAR:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.plan",canvas:"contentsidebar"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},planSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.sidebar",canvas:"sidebarcontentextra"},planAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.action",canvas:"sidebarcontent1"},planState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.state",canvas:"sidebarcontent3"},planProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.progress",canvas:"sidebarcontent4"},planTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.time",canvas:"sidebarcontent5"},planParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.parent",canvas:"sidebarcontent6"},planUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.users",canvas:"sidebarcontent7"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},EDITACTIVITY:{widgets:{rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},activitiesForm:{layout:"rightSidebar",name:"bizagi.workportal.desktop.widgets.project.plan.activities.form",canvas:"sidebarcontent1"},empty1:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontentextra"},empty2:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent3"},empty3:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent4"},empty4:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent5"},empty5:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent6"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent7"}},nav:{level:0,refreshLastItemBreadcrumb:!1},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLAN:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},activity:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.activity",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent1"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent3"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent4"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent5"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent6"},relatedPlan:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.activity.plan.sidebar",canvas:"sidebarcontent7"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANCREATE:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},plan:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.plan",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent1"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent3"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent4"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent5"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent6"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent7"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANOVERVIEW:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},overview:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.plan.activities",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},planSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.sidebar",canvas:"sidebarcontentextra"},planAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.action",canvas:"sidebarcontent1"},planState:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.state",canvas:"sidebarcontent3"},planProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.progress",canvas:"sidebarcontent4"},planTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.time",canvas:"sidebarcontent5"},planParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.parent",canvas:"sidebarcontent6"},planUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.users",canvas:"sidebarcontent7"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANCOMMENTS:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},discussions:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.discussions",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},discussionSidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.discussion.sidebar",canvas:"sidebarcontent1"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent3"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent4"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent5"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent6"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent7"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANFILES:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},files:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.files",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},filesPreview:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.filesPreview",canvas:"sidebarcontent1"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent3"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent4"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent5"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent6"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent7"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANPROCESSMAP:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},processMap:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.processMap",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent1"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent3"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent4"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent5"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent6"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent7"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANLOG:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},log:{layout:"contentDashboard",name:"bizagi.workportal.widgets.activity.log",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent1"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent3"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent4"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent5"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent6"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent7"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},ACTIVITYPLANTIMELINE:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.left.sidebar"},menu:{layout:"leftSidebar",name:"bizagi.workportal.widgets.project.dashboard.menu.activity.plan",canvas:"contentsidebar"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.project.content.dashboard"},timeline:{layout:"contentDashboard",name:"bizagi.workportal.widgets.project.timeline",canvas:"contentprincipal"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.right.sidebar"},activitySidebar:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.sidebar",canvas:"sidebarcontentextra"},activityAction:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.action",canvas:"sidebarcontent1"},activityTime:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.time",canvas:"sidebarcontent3"},activityProgress:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.progress",canvas:"sidebarcontent4"},activityParent:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.parent",canvas:"sidebarcontent5"},activityUsers:{layout:"rightSidebar",name:"bizagi.workportal.widgets.project.plan.activity.users",canvas:"sidebarcontent6"},empty6:{layout:"rightSidebar",name:"bizagi.workportal.widgets.dummy",canvas:"sidebarcontent7"}},nav:{level:0},belongs:{toLeftSidebarCD:!0,toRightSidebarCD:!0,toTaskSidebarCD:!1}},REFRESHALL:{widgets:{leftSidebar:{layout:"leftsidebar",name:"bizagi.workportal.widgets.dummy"},contentDashboard:{layout:"content",name:"bizagi.workportal.widgets.dummy"},rightSidebar:{layout:"contentrightsidebar",name:"bizagi.workportal.widgets.dummy"}},nav:{level:0}}}},{init:function(e,t,i){var a=this;a._super(e,t,i),a.CONTEXT_HOME="HOME",(i=i||{}).supportNav=!0,a.setContextsByNotifyEvents(),a.loadTemplates({homeportal:bizagi.getTemplate("bizagi.workportal.desktop.widget.homeportal").concat("#homeportal-frame")}),"homeportal"==i.widgetName&&(bizagi.referrerParams||(bizagi.referrerParams={}),bizagi.referrerParams.referrer=a.getWidgetName()),a.manager=bizagi.injector.get("widgetManager",i),a.manager.sub("notifyChange",$.proxy(a.onNotifyChange,a)),a.sub("notify",$.proxy(a.onNotifyChange,a)),bizagi.injector.registerInstance("homeportal",a)},setContextsByNotifyEvents:function(){var e=this;for(var t in e.params=e.params||{},e.params.contextsSidebarActivity=[],e.params.contextsWithoutLeftSidebarCaseDashboard=[],e.params.contextsLeftSidebarCaseDashboard=[],e.params.contextsWithoutRightSidebarCaseDashboard=[],e.params.contextsRightSidebarCaseDashboard=[],this.Class.contexts)this.Class.contexts.hasOwnProperty(t)&&(this.Class.contexts[t].belongs&&this.Class.contexts[t].belongs.toTaskSidebarCD&&e.params.contextsSidebarActivity.push(t),this.Class.contexts[t].belongs&&this.Class.contexts[t].belongs.toLeftSidebarCD?e.params.contextsLeftSidebarCaseDashboard.push(t):e.params.contextsWithoutLeftSidebarCaseDashboard.push(t),this.Class.contexts[t].belongs&&this.Class.contexts[t].belongs.toRightSidebarCD?e.params.contextsRightSidebarCaseDashboard.push(t):e.params.contextsWithoutRightSidebarCaseDashboard.push(t))},getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL},renderContent:function(){var e=$.Deferred(),t=this.getTemplate("homeportal");return this.content=t.render({}),e.resolve(this.content),e.promise()},postRender:function(){var e=this;e.manager.necesaryClean(),e.manager.setLayout(e.getContent());var t=new bizagi.workportal.services.behaviors.projectDashboard(e.dataService);$.when(t.getContextToShow(e.params)).done(function(i){if(i.responseGetCaseSummaryDetails&&!1===i.responseGetCaseSummaryDetails.hasAccessToCase)e.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ACCESS_DENIED});else{var a=i.contextToShow.toLowerCase();"home"===a&&bizagiConfig.themesEnabled?t.getCurrentTheme().done(function(r){"classic"==r.name?e.loadContext(a,e,i):(t.setCurrentTheme(r),e.setWidgetReady())}):e.loadContext(a,e,i)}}),e.subscribe("openCloseSidebar",function(){$(".content-scroll",e.getContent()).trigger("resize")})},loadContext:function(e,t,i){var a,r,o=t.Class.contexts;bizagi.loader.startAndThen(e).then(function(){i.contextToShow!==t.CONTEXT_HOME?(i.responseGetCaseSummaryDetails.hasGlobalForm=void 0,$.extend(t.params,i.responseGetCaseSummaryDetails,i.params)):(r=0,a=bizagi.localization.getResource("workportal-widget-home-title")),$("#ui-bizagi-wp-project-homeportal-main").show(),$.when(t.manager.updateView({context:i.contextToShow,data:o[i.contextToShow],args:$.extend(t.params,{histName:a,level:r,showContextByMenuDashboard:i.contextToShow})})).done(function(){t.publish("showMainMenu"),t.setWidgetReady(),t.manager.pub("homeportalReady")})})},onNotifyChange:function(e,t){var i=this,a=t.type;return i.isValidContext(a)?bizagi.loader.startAndThen(a.toLowerCase()).then(function(){new bizagi.workportal.services.behaviors.projectDashboard(i.dataService).removeCurrentTheme(),$.when(i.manager.updateView($.extend({context:a,data:i.Class.contexts[a]},t))).done(function(){$("#ui-bizagi-wp-project-homeportal-main").show(),i.publish("showMainMenu")})}):i.manager.emit($.extend(t,{context:a}))},isValidContext:function(e){return null!==this.Class.contexts[e]&&"object"==typeof this.Class.contexts[e]},dispose:function(){this.manager.dispose(),this._super()}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.dialognav",{contexts:{"TEMPLATEENGINE-VIEW":{widgets:{navigator:{layout:"navigator",name:"bizagi.workportal.widgets.navigator",refresh:!1,newInstance:!0},template:{layout:"template",name:"bizagi.workportal.widgets.templates",newInstance:!0},paginator:{layout:"paginator",name:"bizagi.workportal.widgets.paginator",newInstance:!0}},nav:{level:1}}}},{init:function(e,t,i){var a=this;(i=i||{}).supportNav=!0,a._super(e,t,i),a.loadTemplates({dialognavdata:bizagi.getTemplate("bizagi.workportal.desktop.widget.dialognav").concat("#dialognavdata-frame")}),a.manager=new bizagi.workportal.widgets.manager(a.workportalFacade,a.dataService,"",i),a.manager.sub("notifyChange",$.proxy(a.onNotifyChange,a)),a.sub("notify",$.proxy(a.onNotifyChange,a))},getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_DIALOGNAV},renderContent:function(){var e=this.getTemplate("dialognavdata");return this.content=e.render({}),this.content},postRender:function(){var e=this,t=e.params.data.data||{},i=e.params.data.eventType||"",a={fromActionLauncher:!0,guidEntityCurrent:t.guidEntityCurrent,histName:t.displayName,level:1,page:1,reference:t.reference,referenceType:t.referenceType,showDateNavigator:!1,surrogateKey:t.surrogateKey,xpath:t.xpath,eventType:i};e.manager.setLayout(e.getContent()),e.manager.updateView({context:"TEMPLATEENGINE-VIEW",data:e.Class.contexts["TEMPLATEENGINE-VIEW"],args:a})},onNotifyChange:function(e,t){var i=t.type;return this.isValidContext(i)?this.manager.updateView($.extend({context:i,data:this.Class.contexts[i]},t)):this.manager.emit($.extend(t,{context:i}))},isValidContext:function(e){var t=this.Class.contexts;return null!==t[e]&&"object"==typeof t[e]},dispose:function(){this.manager.dispose(),this._super()}}),bizagi.workportal.widgets.routing.extend("bizagi.workportal.widgets.routing",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({routing:bizagi.getTemplate("bizagi.workportal.desktop.widget.routing"),useNewEngine:!1})},postRender:function(){var e=this,t=e.getContent(),i=$("#ui-bizagi-wp-app-routing-activity-wf tbody tr",t),a=$("#ui-bizagi-wp-app-routing-process-wf tbody tr",t),r=e.params.data.fromSearchWidget?"false":"true",o=e.params.data.fromSearchWidget?"true":"false";$("tr:nth-child(even)",t).addClass("event"),$(".workonitRow",t).button(),$(i).click(function(){e.showWorkitem({idCase:$(this).children(":first").children("#idCase").val(),idWorkitem:$(this).children(":first").children("#idWorkItem").val(),idTask:$(this).children(":first").children("#idTask").val(),idWorkflow:$(this).children(":first").children("#idWorkflow").val(),onlyUserWorkItems:r,eventAsTasks:o}),e.publish("closeCurrentDialog")}),$(a).click(function(){e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:$(this).children(":first").children("#idCase").val(),onlyUserWorkItems:r,eventAsTasks:o}),e.publish("closeCurrentDialog")})},showWorkitem:function(e){this.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:e.idCase,idWorkItem:e.idWorkitem,idWorkflow:e.idWorkflow,idTask:e.idTask,referrer:this.params.referrer}),this.publish("closeCurrentDialog")},showAsyncWidget:function(e){this.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNC,data:data,modalParameters:parameters})}}),bizagi.workportal.widgets.render.extend("bizagi.workportal.widgets.render",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({release:bizagi.getTemplate("bizagi.workportal.desktop.widget.render").concat("#bz-wp-widget-release"),"inbox-common-case-summary-subprocess":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-subprocess"),"inbox-common-case-summary-assignees":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-assignees"),"inbox-common-case-summary-events":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-events"),"inbox-common-case-summary-activities":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-activities"),"render-case-summary":bizagi.getTemplate("bizagi.workportal.desktop.widget.render").concat("#ui-bizagi-workportal-widget-render-case-description"),useNewEngine:!1})},renderContent:function(){var e=this;return e.caseSummaryTemplate=e.getTemplate("render-case-summary"),e.caseSummaryTemplateSubprocess=e.getTemplate("inbox-common-case-summary-subprocess"),e.caseSummaryTemplateAssigness=e.getTemplate("inbox-common-case-summary-assignees"),e.caseSummaryTemplateActivities=e.getTemplate("inbox-common-case-summary-activities"),e.caseSummaryTemplateEvents=e.getTemplate("inbox-common-case-summary-events"),e.paginationTemplate=e.workportalFacade.getTemplate("inbox-common-pagination-inbox"),e._super()},postRender:function(){var e=this,t=e.getContent();e.params.referrerParams=e.params.referrerParams||{},e.summaryDisplayed=!0,$("#ui-bizagi-wp-app-render-desc-panel",t).bizagiScrollbar(),$(".scrollRender",t).bizagiScrollbar({autohide:!1}),e.configureSlider(),e.configureHeader(),e.resizeLayout(),window.setTimeout(function(){bizagi.util.identicalObjects($("#ui-bizagi-details-tabs",t).find(".ui-tabs-nav").offset(),{top:0,left:0})||$("#ui-bizagi-details-tabs",t).tabs().scrollabletab({tooltipNext:e.getResource("workportal-scrollabletab-nex"),tooltipPrevious:e.getResource("workportal-scrollabletab-prev")})},500),$(".ui-bizagi-wp-app-inbox-cases-ico-view",t).click(function(){e.showGraphicQuery({idCase:e.params.idCase,idWorkflow:e.params.idWorkflow})}),$(".back",t).data("idCase",e.getBackCase()),$(".next",t).data("idCase",e.getNextCase()),$(".back, .next",t).click(function(){var t=$(this).data("idCase");t>0&&e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t})}),$(".refresh",t).click(function(){var t={action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:e.params.idCase,idTask:e.params.idTask,idWorkflow:e.params.idWorkflow,idWorkItem:e.params.idWorkitem,referrer:e.params.referrer||"inboxGrid"};e.publish("executeAction",t)}),$(".ui-bizagi-wp-app-inbox-bt-back, #innerContentInbox h2",t).click(function(){if(bizagi&&bizagi.referrerParams)var t=bizagi.referrerParams.referrer||bizagi.cookie("bizagiDefaultWidget");switch("queryform"==t&&(t=bizagi.workportal.currentInboxView||"inboxGrid"),t){case"inbox":case"inboxGrid":e.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"search":e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:bizagi.referrerParams.radNumber||"",page:bizagi.referrerParams.page||1,onlyUserWorkItems:!1});break;case"queryform":e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,queryFormAction:"loadPrevious"});break;case"folders":var i=bizagi.referrerParams.urlParameters+"&page="+bizagi.referrerParams.page;$.when(e.dataService.getCasesByFolder(i)).done(function(t){t.customized=!0,t.urlParameters=bizagi.referrerParams.urlParameters,t.title=bizagi.referrerParams.name,t.casesGroupedByFolder=!0,t.idFolder=bizagi.referrerParams.id,e.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:t,referrerParams:{}})});break;default:e.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID,restoreStatus:!0})}}),$(".refresh,.return",t).hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")}),$(".next,.back",t).hover(function(){$(this).data("idCase")>0&&$(this).addClass("active")},function(){$(this).removeClass("active")}),null!=e.dataService.lastQueryFullKey&&$("#bt-case-action-showquery",t).click(function(){e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,queryFormAction:"loadPrevious"})}),$("#bt-case-action-log",t).click(function(){e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ACTIVITY_LOG,data:{idCase:e.params.idCase,idWorkflow:e.params.idWorkflow},modalParameters:{title:bizagi.localization.getResource("render-actions-log")}})}),$("#bt-case-action-reassing",t).click(function(){var t=e.params.idCase,i=e.params.idWorkitem;e.params.idtask;$.when(e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REASSIGN_CASE,data:{idCase:t,idWorkItem:i},closeVisible:!1,maximize:!0,modalParameters:{title:bizagi.localization.getResource("render-actions-reassign"),width:"910px",id:"CaseAdmin"}}))}),$("#bt-case-action-release",t).click(function(t){t.stopPropagation();var i=e.getTemplate("release"),a=$.tmpl(i);$(a).dialog({resizable:!1,modal:!0,title:e.getResource("render-actions-release"),buttons:[{text:e.getResource("workportal-widget-dialog-box-release-ok"),click:function(){var t={idCase:e.params.idCase,idWorkItem:e.params.idWorkitem};$.when(e.dataService.releaseActivity(t)).done(function(i){switch(i.status?i.status:""){case"Success":e.publish("changeWidget",{widgetName:bizagi.workportal.currentInboxView});break;case"ConfigurationError":var a=e.getResource("workportal-widget-dialog-box-release-configuration-error-message").replace("{0}",t.idWorkItem);bizagi.showMessageBox(a,e.getResource("workportal-widget-dialog-box-release-error"),"error",!1);break;default:a=e.getResource("workportal-widget-dialog-box-release-error-message").replace("{0}",t.idWorkItem);bizagi.showMessageBox(a,e.getResource("workportal-widget-dialog-box-release-error"),"error",!1)}}).fail(function(){var i=e.getResource("workportal-widget-dialog-box-release-error-message").replace("{0}",t.idWorkItem);bizagi.showMessageBox(i,e.getResource("workportal-widget-dialog-box-release-error"),"error",!1)}),$(this).dialog("close")}},{text:e.getResource("workportal-widget-dialog-box-release-cancel"),click:function(){$(this).dialog("close")}}]})}),e.printFormCommand=new bizagi.workportal.command.printform(e.workportalFacade),$("#bt-case-action-print",t).click(function(){var t={idCase:e.params.idCase,idWorkitem:e.params.idWorkitem,idTask:e.params.idTask};e.printFormCommand.print(t)}),$("#bt-case-action-help",t).click(function(){var t=$(this).find("#helpUrl").val();e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:t,modalParameters:{title:bizagi.localization.getResource("render-actions-help")}})})},configureSlider:function(){var e=this,t=e.getContent();if(t){var i=e.getComponentContainer("summary");$("#panelArrowContainer",t).click(function(){i.is(":visible")?e.hideSummary():e.showSummary()})}},hideSummary:function(e){var t=this,i=t.getContent();if(i){var a=t.getComponentContainer("summary"),r=$("#ui-bizagi-wp-app-render-form",i),o=$("#panelArrowContainer",i),n=$("#panelArrow",i);e=void 0!==e&&e,t.summaryDisplayed&&(e?(a.parent().hide("drop",{},300),$.when(o.animate({left:"0px"},300)).done(function(){r.addClass("ui-bizagi-state-extended"),$("#ui-bizagi-wp-app-render-form-content",i).css("padding-left","0px")})):(a.parent().hide(),o.css("left","0px"),r.addClass("ui-bizagi-state-extended"),$("#ui-bizagi-wp-app-render-form-content",i).css("padding-left","0px")),n.removeClass("panelArrowLeft"),n.addClass("panelArrowRight"),t.summaryDisplayed=!1,t.renderingFacade&&t.renderingFacade.resize({forceResize:!0}))}},showSummary:function(e){var t=this,i=t.getContent();if(i){var a=t.getComponentContainer("summary"),r=$("#ui-bizagi-wp-app-render-form",i),o=$("#panelArrowContainer",i),n=$("#panelArrow",i);e=void 0!==e&&e,t.summaryDisplayed||(a.parent().show(),$("#ui-bizagi-wp-app-render-form-content",i).css("padding-left","380px"),o.css("left","380px"),r.removeClass("ui-bizagi-state-extended"),n.removeClass("panelArrowRight"),n.addClass("panelArrowLeft"),t.summaryDisplayed=!0,$("#ui-bizagi-details-tabs",i).closest("#stTabswrapper").length>0||$("#ui-bizagi-details-tabs",i).tabs().scrollabletab({tooltipNext:t.getResource("workportal-scrollabletab-nex"),tooltipPrevious:t.getResource("workportal-scrollabletab-prev")}),t.renderingFacade&&t.renderingFacade.resize({forceResize:!0}))}},configureHeader:function(){this.getContent()},performResizeLayout:function(){var e=this,t=$(window).width();this._super(),t<=1366?e.summaryDisplayed?e.hideSummary(!1):e.renderingFacade&&e.renderingFacade.resize({forceResize:!0}):e.summaryDisplayed?e.renderingFacade&&e.renderingFacade.resize({forceResize:!0}):e.showSummary(!1)},openOldWorkportalForm:function(){var e=this,t=BIZAGI_PATH_TO_BASE+"App/ListaDetalle/Detalle.aspx?PostBack=1&idCase="+e.params.idCase;void 0!==e.params.idWorkitem&&(t=t+"&idWorkitem="+e.params.idWorkitem),void 0!==e.params.idTask&&(t=t+"&idTask="+e.params.idTask),alert(t),window.open(t,"oldStyleBizAgi","width=1024,height=768, Menubar=NO, Location=NO, Status=NO")},getListKey:function(){if(bizagi.lstIdCases=bizagi.lstIdCases||{},bizagi.lstIdCases.length>1)for(var e=0;e<bizagi.lstIdCases.length;e++)if(this.params.idCase==bizagi.lstIdCases[e])return e;return-1},getNextCase:function(){var e=this.getListKey();return bizagi.lstIdCases.length==e+1||1==bizagi.lstIdCases.length?-1:bizagi.lstIdCases[e+1]},getBackCase:function(){var e=this.getListKey();return 0==e?-1:bizagi.lstIdCases[e-1]||-1}}),bizagi.workportal.widgets.startForm.extend("bizagi.workportal.widgets.startForm",{},{postRender:function(){var e=this.getContent();this.params.referrerParams=this.params.referrerParams||{},$("#ui-bizagi-wp-app-render-form-content",e).css("padding-left","0px"),$(".renderNavigation .back,.renderNavigation .next",e).hide()}}),bizagi.workportal.widgets.renderform.extend("bizagi.workportal.widgets.renderform",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({renderform:bizagi.getTemplate("bizagi.workportal.desktop.widget.renderform").concat("#ui-bizagi-workportal-widget-renderform"),useNewEngine:!1})},postRender:function(){var e=this,t=e.getContent();e.params.referrerParams=e.params.referrerParams||{},e.summaryDisplayed=!0,$("#ui-bizagi-wp-app-render-desc-panel",t).bizagiScrollbar(),$(".scrollRender",t).bizagiScrollbar({autohide:!1}),e.configureSlider(),e.configureHeader(),e.resizeLayout(),$("#ui-bizagi-details-tabs",t).tabs().scrollabletab({tooltipNext:e.getResource("workportal-scrollabletab-nex"),tooltipPrevious:e.getResource("workportal-scrollabletab-prev")}),$(".ui-bizagi-wp-app-inbox-cases-ico-view",t).click(function(){window.open("App/Cockpit/graphicquery.aspx?analysisType=2&CaseId="+e.params.idCase)}),$(".back",t).data("idCase",e.getBackCase()),$(".next",t).data("idCase",e.getNextCase()),$(".back, .next",t).click(function(){var t=$(this).data("idCase");t>0&&e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t})}),$(".refresh",t).click(function(){e.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_RENDER,idCase:e.params.idCase,idWorkitem:e.params.idWorkitem,idTask:e.params.idTask,referrer:bizagi.referrerParams.referrer})}),$(".ui-bizagi-wp-app-inbox-bt-back, #innerContentInbox h2",t).click(function(){var t=bizagi.referrerParams.referrer||bizagi.cookie("bizagiDefaultWidget");switch(t){case"inbox":case"inboxGrid":e.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"search":e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:bizagi.referrerParams.radNumber||"",page:bizagi.referrerParams.page||1,onlyUserWorkItems:!1});break;case"queryform":e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,queryFormAction:"loadPrevious"});break;case"folders":var i=bizagi.referrerParams.urlParameters+"&page="+bizagi.referrerParams.page;$.when(e.dataService.getCasesByFolder(i)).done(function(t){t.customized=!0,t.urlParameters=bizagi.referrerParams.urlParameters,t.title=bizagi.referrerParams.name,t.casesGroupedByFolder=!0,t.idFolder=bizagi.referrerParams.id,e.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:t,referrerParams:{}})});break;default:e.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,restoreStatus:!0})}}),$(".refresh,.return",t).hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")}),$(".next,.back",t).hover(function(){$(this).data("idCase")>0&&$(this).addClass("active")},function(){$(this).removeClass("active")}),null!=e.dataService.lastQueryFullKey&&$("#bt-case-action-showquery",t).click(function(){e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,queryFormAction:"loadPrevious"})}),$("#bt-case-action-log",t).click(function(){var t="App/Log/log.aspx?idCase="+e.params.idCase+"&logtype=s";e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:t,modalParameters:{title:bizagi.localization.getResource("render-actions-log")},afterLoad:function(e){this.backURL=function(){e.controller.publish("closeCurrentDialog")}}})}),$("#bt-case-action-reassing",t).click(function(){var t="App/Admin/ListUsers.aspx?WorkItemAdmin="+e.params.idCase+"|"+e.params.idWorkitem+"|&UserAdminAction=2";e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:t,modalParameters:{title:bizagi.localization.getResource("render-actions-reassign")},onClose:function(){e.executeAction(bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,{idCase:e.params.idCase,idWorkitem:e.params.idWorkitem,idTask:e.params.idTask})}})}),$("#bt-case-action-print",t).click(function(){var t="App/Admin/ListUsers.aspx?WorkItemAdmin="+e.params.idCase+"|"+e.params.idWorkitem+"|&UserAdminAction=2";e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:t,modalParameters:{title:bizagi.localization.getResource("render-actions-reassign")},onClose:function(){e.executeAction(bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,{idCase:e.params.idCase,idWorkitem:e.params.idWorkitem,idTask:e.params.idTask})}})}),$("#bt-case-action-help",t).click(function(){var t=$(this).find("#helpUrl").val();e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:t,modalParameters:{title:bizagi.localization.getResource("render-actions-help")}})})},configureSlider:function(){var e=this,t=e.getContent();if(t){var i=e.getComponentContainer("summary");$("#panelArrowContainer",t).click(function(){i.is(":visible")?e.hideSummary():e.showSummary()})}},hideSummary:function(e){var t=this,i=t.getContent();if(i){var a=t.getComponentContainer("summary"),r=$("#ui-bizagi-wp-app-render-form",i),o=$("#panelArrowContainer",i),n=$("#panelArrow",i);t.summaryDisplayed&&(a.parent().hide(),o.css("left","0px"),r.addClass("ui-bizagi-state-extended"),$("#ui-bizagi-wp-app-render-form-content",i).css("padding-left","0px"),n.removeClass("panelArrowLeft"),n.addClass("panelArrowRight"),t.summaryDisplayed=!1,t.renderingFacade&&t.renderingFacade.resize({forceResize:!0}))}},showSummary:function(e){var t=this,i=t.getContent();if(i){var a=t.getComponentContainer("summary"),r=$("#ui-bizagi-wp-app-render-form",i),o=$("#panelArrowContainer",i),n=$("#panelArrow",i);e=void 0!==e&&e,t.summaryDisplayed||(e?(a.parent().show("drop",{},500),$("#ui-bizagi-wp-app-render-form-content",i).css("padding-left","380px"),$.when(o.animate({left:"380px"},300)).done(function(){r.removeClass("ui-bizagi-state-extended")})):(a.parent().show(),$("#ui-bizagi-wp-app-render-form-content",i).css("padding-left","380px"),o.css("left","380px"),r.removeClass("ui-bizagi-state-extended")),n.removeClass("panelArrowRight"),n.addClass("panelArrowLeft"),t.summaryDisplayed=!0,t.renderingFacade&&t.renderingFacade.resize({forceResize:!0}))}},configureHeader:function(){this.getContent()},performResizeLayout:function(){var e=this,t=$(window).width();this._super(),t<=1024?e.summaryDisplayed?e.hideSummary(!1):e.renderingFacade&&e.renderingFacade.resize({forceResize:!0}):e.summaryDisplayed?e.renderingFacade&&e.renderingFacade.resize({forceResize:!0}):e.showSummary(!1)},openOldWorkportalForm:function(){var e=BIZAGI_PATH_TO_BASE+"defaulthtml.aspx?FrameURL=App/ListaDetalle/Detalle.aspx?idCase="+this.params.idCase;window.open(e,"oldStyleBizAgi","width=1024,height=768, Menubar=NO, Location=NO, Status=NO")},getListKey:function(){if(bizagi.lstIdCases=bizagi.lstIdCases||{},bizagi.lstIdCases.length>1)for(var e=0;e<bizagi.lstIdCases.length;e++)if(this.params.idCase==bizagi.lstIdCases[e])return e;return-1},getNextCase:function(){var e=this.getListKey();return bizagi.lstIdCases.length==e+1||1==bizagi.lstIdCases.length?-1:bizagi.lstIdCases[e+1]},getBackCase:function(){var e=this.getListKey();return 0==e?-1:bizagi.lstIdCases[e-1]}}),bizagi.workportal.widgets.mySearchList.extend("bizagi.workportal.widgets.mySearchList",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({mySearchListWrapper:bizagi.getTemplate("bizagi.workportal.desktop.widget.mySearchList").concat("#ui-bizagi-workportal-widget-mysearchlist-searchlists-wrapper"),mySearchList:bizagi.getTemplate("bizagi.workportal.desktop.widget.mySearchList").concat("#ui-bizagi-workportal-widget-mysearchlist-searchlists"),useNewEngine:!1})},postRender:function(){this.loadtemplates(),this.renderSearchLists()},loadtemplates:function(){this.mySearchListTmpl=this.getTemplate("mySearchList")},renderSearchLists:function(){var e=this,t=e.getContent();$.when(e.dataService.getSearchLists()).done(function(i){var a=i,r=$.tmpl(e.mySearchListTmpl,{searchLists:a});t.append(r),e.configureHandlers()})},closeModal:function(){$(this.content).closest(".modal").hide()},configureHandlers:function(){var e=this,t=e.getContent();$(".ui-bizagi-wp-widget-my-search-list-item",t).on("click",$.proxy(e.onListItemClick,e)),$("#menuQuery").keypress(function(){e.closeModal()})},onListItemClick:function(e){var t=this;t.closeModal();var i=$(e.currentTarget),a=i.data("guidform"),r=i.data("id"),o=i.data("displayname"),n=i.data("guidentity"),s={widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_LOADFORM,summaryDecorator:!1,guidForm:a,displayname:o,guidEntity:n,closeVisible:!1,buttons:[{text:bizagi.localization.getResource("workportal-menu-search"),click:function(e){var i=$(this).dialog("option","widget").form||{};if(0!==Object.keys(i).length&&i&&i.validateForm()){var s=[];$.forceCollectData=!0,i.collectRenderValuesQueryForm(s),$.forceCollectData=!1;var d=[],c=[];$.each(s,function(e,a){if("function"!=typeof a.value){var r=i.getRenders(a.xpath),o=t.getFilterControl(r,a);t.dataService.defineFilterObject({properties:o.properties,value:o.value},d,function(e){c.push($.extend(e,{id:o.properties.id,rangeQuery:o.properties.rangeQuery,displayValue:o.getDisplayValue(),displayName:o.properties.displayName,editable:!!o.properties.editable}))})}}),t.performQuery({guidSearch:r,guidForm:a,guidEntity:n,displayname:o,metadataFilters:c,filters:d,page:1,pageSize:10,calculateFilters:!0,histName:o,onlyLocalResults:!0}),$(this).dialog("close")}}},{text:bizagi.localization.getResource("workportal-widget-dialog-box-close"),click:function(){$(this).dialog("close")}}],modalParameters:{title:o}};t.publish("showDialogWidget",s),t.publish("onWidgetIncludedInDOM")},performQuery:function(e){var t={type:"SEARCH-ENGINE-VIEW",args:e};$.when(this.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_HOMEPORTAL})).done(function(){var e=bizagi.injector.get("homeportal");bizagi.injector.get("widgetManager")._context="home",$.when(e.isReady()).done(function(){e.pub("notify",t)})})},getFilterControl:function(e,t){if(1===e.length)return e[0];var a=t.searchType.toUpperCase();for(i=0;i<e.length;i++){var r=e[i].properties,o=r.typeSearch||r.rangeQuery||"NONE";if((o=o.toUpperCase())===a&&!bizagi.util.isEmpty(e[i].value))return e[i]}}}),bizagi.workportal.widgets.loadForm.extend("bizagi.workportal.widgets.loadForm",{postRender:function(){}}),bizagi.workportal.widgets.subMenu.extend("bizagi.workportal.widgets.subMenu",{},{postRender:function(){this.notifier=bizagi.injector.get("notifier"),this.renderSubMenuContent(),this.scrollVertical({autohide:!1})},scrollVertical:function(){var e=this.getContent();$("#categories",e).bizagiScrollbar({autohide:!1})},renderSubMenuContent:function(){var e=this,t=e.getContent(),i=e.workportalFacade.getTemplate("menu.submenu.list"),a=$("#categories",t),r={},o={ThemeBuilder:function(e){(e=e||{}).url&&e.windowOpenBlank.location},asyncECMUpload:function(t){t=t||{},e.showWidgetPopup(t.url,t.title,t.id)}};try{bizagi.override.enableMultipleCasesReassigment&&(e.params.options.menuData.push({categoryKey:"CaseAdmin",categoryName:e.getResource("workportal-menu-submenu-adminReassignCases"),categoryUrl:"adminReassignCases"}),o.CaseAdmin=function(t){t=t||{},e.showWidgetPopup(t.url,t.title,t.id)})}catch(e){}try{bizagi.override.enableAsyncECMUploadJobs&&e.params.options.menuData.push({categoryKey:"asyncECMUpload",categoryName:e.getResource("workportal-menu-submenu-asyncECMUpload"),categoryUrl:"asyncECMUpload"})}catch(e){}try{var n=e.getSubItemsAuthorized();e.deleteMenuOption("UserAdmin"),e.deleteMenuOption("Stakeholder"),e.deleteMenuOption("AuthenticationLogQuery"),e.deleteMenuOption("EncryptionAdmin"),e.deleteMenuOption("UserPendingRequests"),e.deleteMenuOption("CaseAdmin"),e.deleteMenuOption("AsynchronousWorkitemRetries"),e.deleteMenuOption("UserDefaultAssignation"),e.deleteMenuOption("Profiles"),e.deleteMenuOption("AlarmAdmin"),e.deleteMenuOption("Licenses"),e.deleteMenuOption("UnlockFormsAdmin"),e.deleteMenuOption("GRDimensionAdmin"),e.deleteMenuOption("DocumentTemplates"),e.deleteMenuOption("ProcessAdmin"),e.deleteMenuOption("Multilanguage"),e.deleteMenuOption("EntityAdmin"),e.deleteMenuOption("Holidays"),e.deleteMenuOption("ProjectName"),e.deleteMenuOption("OAuthApplications"),e.deleteMenuOption("AdhocProcessAdmin"),e.deleteMenuOption("AdhocEntityAdmin"),e.deleteMenuOption("AdhocUserGroupAdmin"),e.deleteMenuOption("AdhocCreateProcess"),e.deleteMenuOption("UserDelegates"),e.deleteMenuOption("AdhocUserGroupReport"),$.each(e.params.options.menuData,function(t,i){"BusinessPolicies"==i.categoryKey&&(e.params.options.menuData[t].categoryClassName="bz-icon-policy-outline"),"ThemeBuilder"==i.categoryKey&&(e.params.options.menuData[t].categoryClassName="bz-icon-paint-outline")}),-1!=$.inArray("BusinessPolicies",n)&&bizagi.features.enableOldBusinessPoliciesAdministration||e.deleteMenuOption("BusinessPolicies"),-1!==$.inArray("BusinessPolicies",n)&&bizagi.features.enableNewBusinessPoliciesAdministration&&e.params.options.menuData.unshift({categoryKey:"Vocabularies",categoryClassName:"icon-vocabulary",categoryName:e.getResource("workportal-widget-admin-business-policies-vocabulary"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICES,typeIcon:"svg"}),-1!==$.inArray("UserAdmin",n)&&e.params.options.menuData.unshift({categoryKey:"UserAdmin",categoryClassName:"bz-icon-users-outline",categoryName:e.getResource("workportal-menu-submenu-UserAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_ADMINISTRATION}),-1!=$.inArray("Stakeholder",n)&&e.params.options.menuData.push({categoryKey:"StakeholderAdmin",categoryClassName:"bz-icon-stakeholders-outline",categoryName:e.getResource("workportal-menu-submenu-StakeholderAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_STAKEHOLDERS}),-1!=$.inArray("EntityAdmin",n)&&e.params.options.menuData.unshift({categoryKey:"EntityAdmin",categoryClassName:"bz-icon-database-outline",categoryName:e.getResource("workportal-menu-submenu-EntityAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENTITIES}),-1!=$.inArray("AuthenticationLogQuery",n)&&e.params.options.menuData.push({categoryKey:"AuthenticationLogQuery",categoryClassName:"bz-icon-authentication-outline",categoryName:e.getResource("workportal-menu-submenu-AuthenticationLogQuery"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_AUTHENTICATION_LOG}),-1!=$.inArray("EncryptionAdmin",n)&&e.params.options.menuData.push({categoryKey:"EncryptionAdmin",categoryClassName:"bz-icon-lock-outline",categoryName:e.getResource("workportal-menu-submenu-EncryptionAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ENCRYPT_PASSWORDS}),-1!=$.inArray("UserPendingRequests",n)&&e.params.options.menuData.push({categoryKey:"UserPendingRequests",categoryClassName:"bz-icon-unlock-outline",categoryName:e.getResource("workportal-menu-submenu-UserPendingRequests"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_REQUESTS}),-1!=$.inArray("CaseAdmin",n)&&e.params.options.menuData.push({categoryKey:"CaseAdmin",categoryClassName:"bz-icon-case-outline",categoryName:e.getResource("workportal-menu-submenu-CaseAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH}),-1!=$.inArray("UnlockFormsAdmin",n)&&e.params.options.menuData.push({categoryKey:"UnlockFormsAdmin",categoryName:e.getResource("workportal-menu-submenu-UnlockFormsAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_UNLOCK_FORMS}),-1!=$.inArray("AsynchronousWorkitemRetries",n)&&e.params.options.menuData.push({categoryKey:"AsynchronousWorkitemRetries",categoryClassName:"bz-icon-asynchronous-outline",categoryName:e.getResource("workportal-menu-submenu-AsynchronousWorkitemRetries"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ASYNC_ACTIVITIES}),-1!=$.inArray("UserDefaultAssignation",n)&&e.params.options.menuData.push({categoryKey:"UserDefaultAssignation",categoryClassName:"bz-icon-user-manage-outline",categoryName:e.getResource("workportal-menu-submenu-UserDefaultAssignation"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DEFAULTS_ASSIGNATION_USER}),-1!=$.inArray("Profiles",n)&&e.params.options.menuData.push({categoryKey:"Profiles",categoryClassName:"bz-icon-user-outline",categoryName:e.getResource("workportal-menu-submenu-Profiles"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_PROFILES}),-1!=$.inArray("AlarmAdmin",n)&&e.params.options.menuData.push({categoryKey:"AlarmAdmin",categoryClassName:"bz-icon-alarm-outline",categoryName:e.getResource("workportal-menu-submenu-AlarmAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ALARMS}),-1!=$.inArray("Licenses",n)&&e.params.options.menuData.push({categoryKey:"Licenses",categoryClassName:"bz-icon-license-outline",categoryName:e.getResource("workportal-menu-submenu-Licenses"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USER_LICENSES}),-1!=$.inArray("GRDimensionAdmin",n)&&e.params.options.menuData.push({categoryKey:"GRDimensionAdmin",categoryClassName:"bz-icon-dimension-outline",categoryName:e.getResource("workportal-menu-submenu-GRDimensionAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DIMENSIONS}),-1!=$.inArray("DocumentTemplates",n)&&e.params.options.menuData.push({categoryKey:"DocumentTemplates",categoryClassName:"bz-icon-admin-template-outline",categoryName:e.getResource("workportal-menu-submenu-DocumentTemplates"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_DOCUMENT_TEMPLATES}),-1!=$.inArray("ProcessAdmin",n)&&e.params.options.menuData.push({categoryKey:"ProcessAdmin",categoryClassName:"bz-icon-case-time-outline",categoryName:e.getResource("workportal-menu-submenu-ProcessAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROCESSES}),-1!=$.inArray("Holidays",n)&&e.params.options.menuData.push({categoryKey:"Holidays",categoryName:e.getResource("workportal-menu-submenu-holidays"),categoryClassName:"bz-icon-holidays-outline",categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_HOLIDAYS}),-1!=$.inArray("ProjectName",n)&&e.params.options.menuData.push({categoryKey:"ProjectName",categoryName:e.getResource("workportal-menu-submenu-ProjectName"),categoryClassName:"bz-icon-project-name-outline",categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_PROJECTNAME}),-1!=$.inArray("OAuthApplications",n)&&e.params.options.menuData.push({categoryKey:"OAuthApplications",categoryName:e.getResource("workportal-menu-submenu-OAuth2Applications"),categoryClassName:"bz-icon-admin-template-outline",categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_OAUTH2APPLICATIONS}),-1!=$.inArray("Multilanguage",n)&&e.params.options.menuData.push({categoryKey:"LanguageAdmin",categoryClassName:"bz-icon-world-outline",categoryName:e.getResource("workportal-menu-submenu-LanguageAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_LANGUAGE}),-1!=$.inArray("AdhocProcessAdmin",n)&&e.params.options.menuData.push({categoryKey:"AdhocProcessAdmin",categoryClassName:"bz-icon-bz-light-box",categoryName:e.getResource("workportal-menu-submenu-AdhocProcessAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_PROCESSES}),-1!=$.inArray("AdhocEntityAdmin",n)&&e.params.options.menuData.push({categoryKey:"AdhocEntityAdmin",categoryClassName:"bz-icon-bz-edit-entity",categoryName:e.getResource("workportal-menu-submenu-AdhocEntityAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_ENTITIES}),-1!=$.inArray("AdhocCreateProcess",n)&&e.params.options.menuData.push({categoryKey:"AdhocCreateProcess",categoryClassName:"bz-icon bz-icon-reload",categoryName:e.getResource("workportal-menu-submenu-AdhocCreateProcess"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_CREATE_PROCESS}),-1!=$.inArray("AdhocUserGroupAdmin",n)&&e.params.options.menuData.push({categoryKey:"AdhocUserGroupAdmin",categoryClassName:"bz-icon-bz-user-jobs",categoryName:e.getResource("workportal-menu-submenu-AdhocUserGroupAdmin"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUPS}),-1!=$.inArray("AdhocUserGroupReport",n)&&e.params.options.menuData.push({categoryKey:"AdhocUserGroupReport",categoryClassName:"bz-icon-reports",categoryName:e.getResource("workportal-menu-reports"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_ADHOC_USER_GROUP_REPORT}),-1!=$.inArray("UserDelegates",n)&&e.params.options.menuData.push({categoryKey:"UsersDelegation",categoryClassName:"bz-icon bz-icon-group",categoryName:e.getResource("workportal-menu-submenu-UserDelegation"),categoryUrl:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_USERS_DELEGATION}),o.UserAdmin=o.StakeholderAdmin=o.AuthenticationLogQuery=o.EncryptionAdmin=o.UserPendingRequests=o.UnlockFormsAdmin=o.AsynchronousWorkitemRetries=o.UserDefaultAssignation=o.Profiles=o.AlarmAdmin=o.Licenses=o.GRDimensionAdmin=o.DocumentTemplates=o.ProcessAdmin=o.LanguageAdmin=o.EntityAdmin=o.AdhocProcessAdmin=o.AdhocEntityAdmin=o.AdhocUserGroupAdmin=o.AdhocCreateProcess=o.AdhocUserGroupReport=function(t){t=t||{},$.extend(t,{showCloseButton:!1}),"Licenses"!==t.id&&"AlarmAdmin"!==t.id&&"AdhocProcessAdmin"!==t.id||$.extend(t,{maximize:!1}),e.showCustomWidgetPopup(t)},o.CaseAdmin=function(t){t=t||{},t=$.extend(!0,t,{showCloseButton:!1,title:e.getResource("workportal-menu-submenu-CaseAdmin"),height:780,showCloseButton:!1,id:"CaseAdmin"}),e.showCustomWidgetPopup(t)},o.Holidays=function(t){t=t||{},t=$.extend(!0,t,{showCloseButton:!1,title:e.getResource("workportal-menu-submenu-holidays"),width:"1080px",height:910,showCloseButton:!1,id:"Holidays"}),e.showCustomWidgetPopup(t)},o.OAuthApplications=function(t){t=t||{},t=$.extend(!0,t,{showCloseButton:!1,title:e.getResource("workportal-menu-submenu-OAuth2Applications"),width:"980px",height:700,showCloseButton:!1,id:"OAuthApplications"}),e.showCustomWidgetPopup(t)},o.ProjectName=function(t){t=t||{},t=$.extend(!0,t,{showCloseButton:!1,title:e.getResource("workportal-menu-submenu-ProjectName"),width:"600px",height:400,showCloseButton:!1,id:"ProjectName"}),e.showCustomWidgetPopup(t)},o.UsersDelegation=function(t){t=t||{},t=$.extend(!0,t,{showCloseButton:!1,title:e.getResource("workportal-menu-submenu-UserDelegation"),width:"740px",height:910,showCloseButton:!1,id:"UsersDelegation"}),e.showCustomWidgetPopup(t)},o.BusinessPolicies=function(t){e.showContentPopup(t.url,t.title,t.id)},o.Vocabularies=function(t){e.loadBusinessPolicesWidget()}}catch(e){}r.listmenu=e.params.options.menuData;var s=$.tmpl(i,r);a.append(s),e.params.options.customClickHandler?(e.checkIsAlive(),$("li",a).click(function(){var t=$(this).data("id");bizagi.loader.start("admin").then(function(){bizagi.workportal.desktop.popup.closePopupInstance(),e.params.options.customClickHandler(t)})})):$("li",a).click(function(){e.checkIsAlive();var t,i=$(this).find("#categoryUrl").val(),a=$(this).find(".title").text(),r=$(this).data("id")||"";(bizagi.util.isIE11()||bizagi.util.isEdge())&&localStorage.setItem("auxBizagiAuthentication",window.sessionStorage.bizagiAuthentication),-1!==i.indexOf("ThemeBuilder")&&(t=window.open(i,"_blank")),-1===i.toLowerCase().indexOf("adhoc")?bizagi.loader.start("admin").then(function(){o[r]?o[r]({windowOpenBlank:t,url:i,title:a,id:r}):e.showContentPopup(i,a,r),bizagi.workportal.desktop.popup.closePopupInstance()}):e.loadDashboardQuickProcess(i)})},loadDashboardQuickProcess:function(e){if("adhocUserGroupReport"===e)$(document).find("iframe").length>0&&-1!==$(document).find("iframe")[0].contentWindow.location.href.indexOf("quickprocess")?(bizagi.util.liveProcessesEvents.routeEvents.route="/reports",document.dispatchEvent(bizagi.util.liveProcessesEvents.routeEvents)):this.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY,data:{route:"reports",params:{module:"none"}}});else if("adhocUserGroups"===e)$(document).find("iframe").length>0&&-1!==$(document).find("iframe")[0].contentWindow.location.href.indexOf("quickprocess")?(bizagi.util.liveProcessesEvents.routeEvents.route="/manage-groups",document.dispatchEvent(bizagi.util.liveProcessesEvents.routeEvents)):this.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY,data:{route:"manage-groups",params:{module:"none"}}});else if("adhocProcesses"===e)this.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY});else if("adhocCreateProcess"===e)if($(document).find("iframe").length>0&&(-1!==$(document).find("iframe")[0].contentWindow.location.href.indexOf("quickprocess")||-1!==$(document).find("iframe")[0].contentWindow.location.href.indexOf("quick-process")))document.dispatchEvent(bizagi.util.liveProcessesEvents.newLiveProcess),bizagi.workportal.desktop.popup.closePopupInstance();else{var t={widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADHOC_CREATE_PROCESS,closeVisible:!1,maximize:!1,modalParameters:{height:300,title:bizagi.localization.getResource("workportal-quickprocess-create-qp"),width:400}};this.publish("showDialogWidget",t)}},loadBusinessPolicesWidget:function(){this.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_BUSINESS_POLICES})},needsQuicksMode:function(e){return e.toLowerCase().indexOf("businesspoliciesselector.aspx")>=0||(e.toLowerCase().indexOf("bamprocess.aspx")>=0||(e.toLowerCase().indexOf("bamtask.aspx")>=0||(e.toLowerCase().indexOf("analyticsprocess.aspx")>=0||e.toLowerCase().indexOf("analyticssensor.aspx")>=0)))},getPageHacks:function(e,t){var i={title:t};return{callback:function(e){this.openBACase=function(t,i){var a=null;i.indexOf("idWorkitem=")>-1&&(a=(a=i.substring(i.indexOf("idWorkitem=")+11)).substring(0,a.indexOf("&"))),e.controller.publish("executeAction",{action:e.routingAction,idCase:t,idWorkItem:a}),e.controller.publish("closeCurrentDialog")},this.changeToWidget=function(t){e.controller.publish("changeWidget",{widgetName:t||e.bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID}),e.controller.publish("closeCurrentDialog")}},params:i=$.extend(i,{routingAction:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,bizagi:bizagi})}},showContentPopup:function(e,t,i){var a=this;i=i||"";var r=a.getPageHacks(e,t);if(bizagi.util.isIE()&&bizagi.util.getInternetExplorerVersion()<10&&a.needsQuicksMode(e))a.publish("showOldWindow",{url:e,windowParameters:$.extend(r.params,{controller:a,afterLoad:r.callback})});else{if("genericiframe"==a.currentPopup)return void bizagi.workportal.desktop.popup.closePopupInstance();a.currentPopup="genericiframe",a.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_GENERICIFRAME,widgetURL:e,injectCss:[".ui-bizagi-old-render*","."+t,"@font-face"],modalParameters:{refreshInbox:!1,id:i,title:t},afterLoad:r.callback,afterLoadParams:r.params})}},showWidgetPopup:function(e,t,i){this.publish("showDialogWidget",{widgetName:e,modalParameters:{title:t,width:"1080px",showCloseButton:!1}})},showCustomWidgetPopup:function(e){var t=$(window).width()-15*$(window).width()/100+"px",i={widgetName:e.url,data:{idCase:e.id},closeVisible:e.showCloseButton,maximize:void 0===e.maximize||e.maximize,modalParameters:{title:e.title,width:e.width||t,height:e.height,id:e.id}};e.buttons&&(i.buttons=e.buttons),this.publish("showDialogWidget",i)},deleteMenuOption:function(e){for(var t=this.params.options.menuData,i=0;i<t.length;i++)t[i].categoryKey==e&&this.params.options.menuData.splice(i,1)},getSubItemsAuthorized:function(){var e=[];return $.each(this.params.options.menuData,function(t,i){e.push(i.categoryKey)}),e},checkIsAlive:function(){var e={idUser:bizagi.currentUser.idUser,fromDate:Date.now(),toDate:Date.now()};this.dataService.getEffectiveDuration(e)}}),bizagi.workportal.widgets.genericiframe.extend("bizagi.workportal.widgets.genericiframe",{},{postRender:function(){var e=this,t=e.getContent(),i=$("iframe",t),a=e.params.injectCss?e.params.injectCss:[".ui-bizagi-old-render*","@font-face"];if(i.parent().addClass("loading-iframe"),i.hide(),i.load(function(){i.parent().removeClass("loading-iframe"),i.fadeIn()}),e.params.afterLoad&&null!=e.params.afterLoad&&i.load(function(){i.callInside(e.params.afterLoad,$.extend(e.params.afterLoadParams,{controller:e}))}),null!=a){var r="",o="";"object"==typeof a?$.each(a,function(e,t){r+=bizagi.getStyle(t),o+=t.replace(".","")+" "}):(r+=bizagi.getStyle(a),o+=a.replace(".","")),i.load(function(){var e=$(this).contents();$("head",e).append("<style type='text/css'>"+r+"</style>"),$("body",e).addClass(o.replace("*","")),$("body input",e).each(function(){var e=$(this),t=(e.attr("type")?"ui-"+e.attr("type"):"")+" "+(e.attr("name")?"ui-"+e.attr("name").replace(/_\d+$/,""):"");e.addClass(t)}),$('body img[src$="Button.gif"]',e).parent().remove()}).attr("frameborder","0")}}}),bizagi.workportal.widgets.search.extend("bizagi.workportal.widgets.search",{},{init:function(e,t,i){var a=this;a._super(e,t,i),a.radNumber=i.referrerParams.radNumber||i.radNumber||"",a.isAdhocProcess=!0,a.adhocIds=[],a.loadTemplates({"inbox-grid-cases":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.grid").concat("#ui-bizagi-workportal-widget-inbox-grid-cases"),"inbox-common-case-summary":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description"),"inbox-common-case-summary-subprocess":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-subprocess"),"inbox-common-case-summary-assignees":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-assignees"),"inbox-common-case-summary-events":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-case-description-events"),"inbox-common-case-summary-oldrender":bizagi.getTemplate("bizagi.workportal.desktop.widget.inbox.common").concat("#ui-bizagi-workportal-widget-inbox-common-oldrender"),"search-details":bizagi.getTemplate("bizagi.workportal.desktop.widget.search").concat("#ui-bizagi-workportal-widget-search-details"),useNewEngine:!1})},postRender:function(){var e=this,t=e.getContent(),a=$("#searchDetails",t),r={},o=$("#casesPagination",t),n=e.params.data.cases.totalPages,s=e.params.data.cases.page;for($(e.params.data.cases.rows).each(function(t,i){i.isAdhocProcess||(i.isAdhocProcess=!1),i.isAdhocProcess&&e.adhocIds.push({caseId:i.id,processId:i.idAdhocProcess})}),e.searchTemplate=e.workportalFacade.getTemplate("search"),e.searchDetailsTemplate=e.getTemplate("search-details"),e.searchPagination=e.workportalFacade.getTemplate("inbox-common-pagination-grid"),e.caseSummaryTemplate=e.getTemplate("inbox-common-case-summary"),e.caseSummaryTemplateSubprocess=e.getTemplate("inbox-common-case-summary-subprocess"),e.caseSummaryTemplateAssigness=e.getTemplate("inbox-common-case-summary-assignees"),e.caseSummaryTemplateEvents=e.getTemplate("inbox-common-case-summary-events"),e.paginationTemplate=e.workportalFacade.getTemplate("inbox-common-pagination-inbox"),a.empty(),e.params.data.title=e.params.data.title||bizagi.localization.getResource("workportal-widget-search"),$(".title",t).html(e.params.data.title),i=0;i<e.params.data.cases.rows.length;i++){for(j=0;j<e.params.data.cases.rows[i].fields.length;j++)e.params.data.cases.rows[i].fields[j]=null==e.params.data.cases.rows[i].fields[j]?"":e.params.data.cases.rows[i].fields[j];e.params.data.cases.rows[i].graphicQuery=bizagi.menuSecurity.GraphicQuery,e.params.data.cases.rows[i].timeLine=bizagi.menuSecurity.TimeLine&&bizagi.override.enableFeatureShowTimelineButton}e.params.data.cases=bizagi.util.formatMonetaryCells(e.params.data.cases,BIZAGI_DEFAULT_CURRENCY_INFO),e.params.data.cases.groupByCaseNumber=bizagiConfig.groupByCaseNumber,$.when($.tmpl(e.searchDetailsTemplate,e.params.data.cases,{setFormat:e.formatValue,isArray:e.isArray,formatCategories:e.formatCategories,isDate:bizagi.util.isDate,getRadNumberColumnIndex:function(){for(var e=this.data,t=-1,i=0,a=e.columnTitle.length;i<a;i++)"I_RadNumber"==e.columnTitle[i].fieldName&&(t=i);return t},showColumn:function(e){var t=this.getRadNumberColumnIndex();return this.data.groupByCaseNumber&&t==e?" style=display:none; ":""},createGroupedHeader:function(e){var t=this.data,i=!1,a=this.getRadNumber(t.rows[e]);t.groupByCaseNumber&&(0==e?i=!0:a!=this.getRadNumber(t.rows[e-1])&&(i=!0));return i},getRadNumber:function(e){var t=this.getRadNumberColumnIndex();return t>=0?e.fields[t]:""}}).appendTo(a)).done(function(){bizagi.util.formatInvariantDate(t,e.getResource("dateFormat")+" "+e.getResource("timeFormat")),$(".ui-bizagi-wp-app-inbox-activity-name",a).click(function(){var t=$(this).find("#idCase").val()||"",i=$(this).find("#idWorkItem").val()||"",a=$(this).find("#idTask").val()||"",r=$(this).closest("tr").data("idworkflow");"0"!==i&&"0"!==a&&(""!=i&&""!=a&&(void 0===bizagi.cache?bizagi.cache={}:void 0!==bizagi.cache[t]&&bizagi.cache[t].idWorkitem==parseInt(i)&&bizagi.cache[t].idTask==parseInt(a)&&void 0!==bizagi.cache[t].isComplex&&(i="")),e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t,idWorkItem:i,idTask:a,idWorkflow:r,eventAsTasks:!0,onlyUserWorkItems:"true"}))}),$(".ui-bizagi-wp-app-inbox-grouped",a).bind("click",function(){$(this).data("radnumber");var t={taskState:e.params.taskState,idWorkItem:$(this).find("#idWorkItem").val(),idCase:$(this).find("#idCase").val(),idTask:$(this).find("#idTask").val(),onlyFavorites:e.onlyFavorites,idWorkflow:e.idWorkflow,referrer:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID};$.extend(bizagi.referrerParams,bizagi.referrerParams,t);var i=$(this).find("#idCase").val();e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:i})}),$(".js-show-timeline",a).click(function(t){var i=$(this).parent().find("#idCase").val(),a=$.trim($(this).closest("tr").find(".I_RadNumber").text());e.showTimeLine({radNumber:a,idCase:i})}),$(".ui-bizagi-wp-app-inbox-cases-ico-view",a).click(function(){var t=$(this).parent().find("#idCase").val(),i=$(this).closest("tr").data("idworkflow");if($(this).closest("tr").data("isadhoc")){for(var a=0;a<e.adhocIds.length;a++)if(parseInt(t)==e.adhocIds[a].caseId){processId=e.adhocIds[a].processId,e.showGraphicQuery({idCase:t,idWorkflow:i,isAdhoc:!0,idProcess:processId});break}}else e.showGraphicQuery({idCase:t,idWorkflow:i});return!1}),$(".inbox-grid-tooltip-button",t).tooltip(),$(".workonitRow",t).click(function(){var i=$(this).parents("td").first().find("#idCase").val(),a=$(this).closest("tr").data("idworkflow");$(".inbox-grid-tooltip-button",t).tooltip("close"),e.showCase(i,a)}),$(a).delegate(".ui-bizagi-wp-app-inbox-cases-start","click",function(t){t.stopPropagation();var i={},a=this;$(a).removeClass("ui-bizagi-wp-app-inbox-cases-start").addClass("ui-bizagi-wp-app-inbox-cases-start-wait"),"false"==$(a).parent().find("#isFavorite").val()?(i={idObject:$(a).parent().find("#idCase").val(),favoriteType:"CASES"},$.when(e.dataService.addFavorite(i)).done(function(e){$(a).parent().find("#guidFavorite").val(e.idFavorites),$(a).removeClass("bz-icon-star-outline").addClass("bz-icon-star"),$(a).parent().find("#isFavorite").val("true"),$(a).removeClass("ui-bizagi-wp-app-inbox-cases-start-wait").addClass("ui-bizagi-wp-app-inbox-cases-start")})):(i={idObject:$(a).parent().find("#guidFavorite").val(),favoriteType:"CASES"},$.when(e.dataService.delFavorite(i)).done(function(e){"true"!=e.deleted&&1!=e.deleted||($(a).parent().find("#guidFavorite").val(""),$(a).removeClass("bz-icon-star").addClass("bz-icon-star-outline"),$(a).parent().find("#isFavorite").val("false"),$(a).removeClass("ui-bizagi-wp-app-inbox-cases-start-wait").addClass("ui-bizagi-wp-app-inbox-cases-start"))}))}),$(".folders-case-ungroup",a).click(function(){var t=this,i={idFolder:$(this).data("folder-id"),idCase:$(this).data("case-id")},a=bizagi.localization.getResource("workportal-search-desasociate-case");$.when(bizagi.showConfirmationBox(a,null,!1)).done(function(){$.when(e.dataService.dissasociateCaseFromFolder(i)).done(function(e){$(t).closest("tr").remove()})}).fail(function(){})}),$(".ui-bizagi-wp-app-inbox-bt-back",t).click(function(){var t=bizagi.referrerParams.referrerBackButton||bizagi.cookie("bizagiDefaultWidget");switch(t){case"inbox":case"inboxGrid":e.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"search":e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:bizagi.referrerParams.radNumber||"",page:bizagi.referrerParams.page||1,onlyUserWorkItems:!1});break;case"queryform":e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,queryFormAction:"loadPrevious"});break;case"folders":var i=bizagi.referrerParams.urlParameters+"&page="+bizagi.referrerParams.page;$.when(e.dataService.getCasesByFolder(i)).done(function(t){t.customized=!0,t.urlParameters=bizagi.referrerParams.urlParameters,t.title=bizagi.referrerParams.name,t.casesGroupedByFolder=!0,t.idFolder=bizagi.referrerParams.id,e.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:t,referrerParams:{}})});break;case"activityform":e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:bizagi.referrerParams.idCase||void 0,idWorkItem:bizagi.referrerParams.idWorkItem||void 0,idTask:bizagi.referrerParams.idTask||void 0,eventAsTasks:!0,onlyUserWorkItems:"true"});break;default:e.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,restoreStatus:!0})}}),$(".sortColumnsData",a).click(function(){var t={action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:$(this).find("#radNumber").val(),orderFieldName:$(this).find("#orderFieldName").val(),orderType:0==$(this).find("#orderType").val()?1:0,order:$(this).find("#order").val(),onlyUserWorkItems:!1};e.publish("executeAction",t)}),r.pagination=n>1,r.page=e.params.referrerParams.page||s,r.pages={};for(var i=14>n?n:14,d=1;d<=i;d++)r.pages[d]={pageNumber:d};r.gridPagination="gridCasePagination",r.previousPage=s>1?s-1:1,r.nextPage=s<n?s+1:n,r.totalPages=n;var c=$.tmpl(e.searchPagination,r).html();$(o).append(c),$("ul").bizagiPagination({maxElemShow:50,totalPages:r.totalPages,actualPage:r.page,listElement:$("ul",o),clickCallBack:function(t){if(null!=e.params.data.customized&&e.params.data.customized){var i=e.params.data.urlParameters+"&page="+t.page;$.when(e.dataService.getCustomizedColumnsData({smartfoldersParameters:i})).done(function(i){i.customized=!0,i.urlParameters=e.params.data.urlParameters,i.title=e.params.data.title,bizagi.referrerParams.page=t.page,i.casesGroupedByFolder=!0,i.idFolder=e.params.data.id,e.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:i,referrerParams:{}})})}else e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:e.params.referrerParams.radNumber,page:t.page,onlyUserWorkItems:!1})}}),a.bizagiScrollbar({autohide:!1})})},showCase:function(e,t){var i=this,a=i.getContent(),r=$("#contentDesc",a),o={},n="";i.idCase=e,r.empty(),0!=i.idCase&&$.when(i.dataService.summaryCaseDetails({idCase:i.idCase})).done(function(s){s.hasComments="true"==s.hasComments;var d=new bizagi.workportal.command.security(i.dataService);s.graphicQuery=d.checkSecurityPerm("GraphicQuery"),s.enableFeatureShowTimelineButton=bizagi.override.enableFeatureShowTimelineButton,s.currentState&&s.currentState.length>0&&s.currentState.forEach(function(e){e.idTask||(e.idTask=0),e.state||(e.state=e.displayName||" ")}),"undefined"!==s.process&&""!==s.process&&void 0!==s.process||(s.process=!1),"undefined"!==s.processPath&&""!==s.processPath&&void 0!==s.processPath||(s.processPath=!1);var c=$.tmpl(i.caseSummaryTemplate,$.extend(s,{security:bizagi.menuSecurity})).appendTo(r);bizagi.util.formatInvariantDate(a,i.getResource("dateFormat")+" "+i.getResource("timeFormat")),$("#details",c).delegate(".summaryLink","click",function(){i.routingExecute($(this)),l.dialog("close")});var l=c;$(".scrollSummary",l).css({height:"","overflow-y":"visible"}),$("#ui-bizagi-details-tabs",a).tabs({active:-1,create:function(e,t){$(this).tabs("option","active",0)},activate:function(e,t){switch(null==t?"formSummary":t.newPanel.attr("id")){case"comments":null==o.comments&&($.extend(i,{},bizagi.workportal.comments),s.canvas=$("#comments"),s.readOnly=!0,$.when(i.renderComments(s)).done(function(e){o.comments=e})),bizagi.util.setContext({commentsFocus:!0});break;case"formSummary":if(null==o.formSummary){var a=$("#formSummary",r);a.bind("oldrenderintegration",function(e){if(!e.isPropagationStopped()){e.stopPropagation();var t=i.getTemplate("inbox-common-case-summary-oldrender"),r={};bizagi.oldrenderevent=!0;var o=window.addEventListener?"addEventListener":"attachEvent";(0,window[o])("attachEvent"==o?"onmessage":"message",function(e){e.stopPropagation(),i.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:e.data})},!1),$.when(i.dataService.getWorkitems({idCase:i.idCase,onlyUserWorkItems:!0,eventAsTasks:!0})).done(function(e){if("object"==typeof e.workItems&&e.workItems.length>=1){var o=e.workItems[0].idWorkItem,n=e.workItems[0].idTask,s=e.workItems[0].idCase;r.url=i.dataService.serviceLocator.getUrl("old-render")+"?PostBack=1&idCase="+s+"&idWorkitem="+o+"&idTask="+n+"&isSummary=1"}else r.url=i.dataService.serviceLocator.getUrl("old-render")+"?PostBack=1&idCase="+i.idCase+"&isSummary=1";a.empty(),$.tmpl(t,r).appendTo(a),i.iframeOldRender($("iframe",a))})}});var d={idCase:i.idCase};$.when(i.dataService.getCaseFormsRenderVersion(d)).done(function(e){1==e.formsRenderVersion?a.trigger("oldrenderintegration"):$.when(i.renderSummaryForm($("#formSummary",c))).done(function(){n=$("#formSummary",c).html(),o.formSummary=n})})}break;case"subprocess":null==o.subprocess&&$.when(i.dataService.summarySubProcess({idCase:i.idCase})).done(function(e){(n=$.tmpl(i.caseSummaryTemplateSubprocess,e)).appendTo($("#subprocess",c)),o.subprocess=n,n.delegate(".summaryLink","click",function(){i.routingExecute($(this)),l.dialog("close")})});break;case"assignees":null==o.assignees&&$.when(i.dataService.summaryAssigness({idCase:i.idCase,preview:!0})).done(function(e){var t=[];$.each(e.events.split(", "),function(e,i){-1===$.inArray(i,t)&&t.push(i)}),e.events=t.join(", ");var a=[];$.each(e.activities.split(", "),function(e,t){-1===$.inArray(t,a)&&a.push(t)}),e.activities=a.join(", "),(n=$.tmpl(i.caseSummaryTemplateAssigness,e)).appendTo($("#assignees",c)),o.assignees=n});break;case"events":null==o.events&&$.when(i.dataService.summaryCaseEvents({idCase:i.idCase})).done(function(e){(n=$.tmpl(i.caseSummaryTemplateEvents,e)).appendTo($("#events",c)),o.events=n,n.delegate(".summaryLink","click",function(){i.routingExecute($(this)),l.dialog("close")})})}}}),$(".inbox-grid-tooltip-button",a).tooltip(),$("#ui-bizagi-wp-app-inbox-description-container .ui-bizagi-wp-app-inbox-cases-ico-view",a).click(function(){if(i.adhocIds.length>0)for(var a=0;a<i.adhocIds.length;a++)e==i.adhocIds[a].caseId?i.showGraphicQuery({idCase:e,idWorkflow:t,isAdhoc:!0,idProcess:i.adhocIds[a].processId}):i.showGraphicQuery({idCase:e,idWorkflow:t});else i.showGraphicQuery({idCase:e,idWorkflow:t})}),$(".workonitRow",c).click(function(){var e=$(this).parent().find("#idWorkItem").val(),a={taskState:i.params.taskState,idWorkItem:e,idCase:s.idCase,onlyFavorites:i.onlyFavorites,idWorkflow:i.idWorkflow,referrer:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID};$.extend(bizagi.referrerParams,bizagi.referrerParams,a),l.dialog("close");var r,o=$.grep(s.currentState,function(t,i){return t.idWorkItem==e})[0];r=o&&o.idCase?o.idCase:s.idCase,i.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:r,idWorkflow:t,idWorkItem:e})}),$(".js-show-timeline",c).click(function(t){var a=$.trim($(this).closest("div.ui-bizagi-wp-app-inbox-processes-title").find("span.js-case-number").text());i.showTimeLine({radNumber:a,idCase:e})});var g={};g[bizagi.localization.getResource("workportal-case-dialog-box-close")]=function(){r.empty(),c.remove(),$("#ui-bizagi-wp-app-inbox-description-container").remove()},l.dialog({modal:!0,title:s.process,width:1e3,height:600,draggable:!0,resizable:!0,buttons:g,close:function(){r.empty(),c.remove(),$("#ui-bizagi-wp-app-inbox-description-container").remove()}})})},formatRequest:function(e){return e},formatCategories:function(e){return e},isArray:function(e){return"object"==typeof e},renderSummaryForm:function(e){var t=this,i=null!=typeof t.dataService.serviceLocator.proxyPrefix?t.dataService.serviceLocator.proxyPrefix:"";bizagi.loader.start("rendering").then(function(){var a=new bizagi.rendering.facade({proxyPrefix:i});a.execute({canvas:e,summaryForm:!0,idCase:t.idCase}),t.renderingFacade=a,setTimeout(function(){t.resizeLayout()},1e3)})},iframeOldRender:function(e){this.getContent();var t,i=bizagi.readQueryString();$.each(e,function(){$(this).is("iframe")&&(t=$(this))}),t.load(function(){var e=$(this).contents(),t=$.browser.mozilla||$.browser.webkit?"../../css/render_%theme%.css":"css/render_%theme%.css";t=t.replace("%theme%",i.theme||"bizagiDefault"),$("body",e).append("<link type='text/css' rel='stylesheet' href='"+t+"'>")})}}),bizagi.workportal.widgets.oldrenderintegration.extend("bizagi.workportal.widgets.oldrenderintegration",{},{init:function(e,t,i){var a=this;this._super(e,t,i),a.taskState="all",a.icoTaskState="",a.idWorkflow=0,a.idCase=0,a.loadTemplates({"integration-old-render":bizagi.getTemplate("bizagi.workportal.desktop.widget.oldrenderintegration").concat("#ui-bizagi-workportal-widget-oldrender"),useNewEngine:!1})},postRender:function(){var e=this,t=e.getContent();e.params.restoreStatus?bizagi.referrerParams=bizagi.referrerParams||{}:bizagi.referrerParams=bizagi.referrerParams?{page:bizagi.referrerParams.page}:{},e.params.taskState=e.params.taskState||bizagi.referrerParams.taskState||"all",$(".back",t).data("idCase",e.getBackCase()),$(".next",t).data("idCase",e.getNextCase()),$(".back, .next",t).click(function(){var t=$(this).data("idCase");t>0&&e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:t})}),$(".refresh",t).click(function(){e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:e.params.idCase,idTask:e.params.idTask,idWorkItem:e.params.idWorkitem,referrer:e.params.referrer||"inboxGrid"})}),$(".ui-bizagi-wp-app-inbox-bt-back, #innerContentInbox > h2",t).click(function(){var t=bizagi.referrerParams.referrer||bizagi.cookie("bizagiDefaultWidget");switch(t){case"inbox":case"inboxGrid":e.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"search":e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:bizagi.referrerParams.radNumber||"",page:bizagi.referrerParams.page||1,onlyUserWorkItems:!1});break;case"queryform":e.publish("showDialogWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,queryFormAction:"loadPrevious"});break;case"folders":var i=bizagi.referrerParams.urlParameters+"&page="+bizagi.referrerParams.page;$.when(e.dataService.getCasesByFolder(i)).done(function(t){t.customized=!0,t.urlParameters=bizagi.referrerParams.urlParameters,t.title=bizagi.referrerParams.name,t.casesGroupedByFolder=!0,t.idFolder=bizagi.referrerParams.id,e.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:t,referrerParams:{}})});break;default:e.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,restoreStatus:!0})}}),$(".refresh,.return",t).hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")}),$(".next,.back",t).hover(function(){$(this).data("idCase")>0&&$(this).addClass("active")},function(){$(this).removeClass("active")}),e.insertIframeOldRender()},getInjectJavaScript:function(e){return{callback:function(t){this.changeToWidget=function(e){t.controller.publish("changeWidget",{widgetName:t.bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX_GRID})},this.openBACase=function(i,a){var r=null;a.indexOf("idWorkitem=")>-1&&(r=(r=a.substring(a.indexOf("idWorkitem=")+11)).substring(0,r.indexOf("&"))),t.controller.publish("executeAction",{action:t.routingAction,idCase:i,idWorkItem:r}),e.controller.publish("closeCurrentDialog")}},args:{routingAction:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,bizagi:bizagi}}},insertIframeOldRender:function(){var e,t=this,i=t.getContent(),a=bizagi.readQueryString();$.each(i,function(){$(this).is("iframe")&&(e=$(this))}),e.load(function(){var i=$(this).contents(),r=t.getInjectJavaScript(),o=$.browser.mozilla||$.browser.webkit?"../../css/render_%theme%.css":"css/render_%theme%.css";o=o.replace("%theme%",a.theme||"bizagiDefault"),$("head",i).append("<link type='text/css' rel='stylesheet' href='"+o+"'>"),e.callInside(r.callback,$.extend(r.args,{controller:t})),i.bind("click",function(){bizagi.workportal.desktop.popup.closePopupInstance()}),$("head",i).append("<script type='text/javascript' src='../../js/renderintegration.js'><\/script>"),$('body img[src*="Button.gif"], body td[style*="CellShadow.gif"], body img[src*="tab_active"], body img[src*="tab_inactive"]',i).parent().remove(),e.css("overflow-y","auto")})},getListKey:function(){if(bizagi.lstIdCases=bizagi.lstIdCases||{},bizagi.lstIdCases.length>1)for(var e=0;e<bizagi.lstIdCases.length;e++)if(this.params.idCase==bizagi.lstIdCases[e])return e;return-1},getNextCase:function(){var e=this.getListKey();return bizagi.lstIdCases.length==e+1||1==bizagi.lstIdCases.length?-1:bizagi.lstIdCases[e+1]},getBackCase:function(){var e=this.getListKey();return 0==e?-1:bizagi.lstIdCases[e-1]}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.createcase",{},{init:function(e,t,i){var a=this;a._super(e,t,i),a._processId=i.idObject,a._mapping=i.mapping||[],a._idParentCase=i.idParentCase,a._mappingstakeholders=i.mappingstakeholders,a._guidprocess=i.guidprocess,a.loadTemplates({createcase:bizagi.getTemplate("bizagi.workportal.desktop.widget.createcase").concat("#createcase-wrapper")})},renderContent:function(){var e=this.getTemplate("createcase");return this.content=e.render(),this.content},postRender:function(){var e=this,t=new $.Deferred,i=e.getContent();return bizagi.loader.start("rendering").then(function(){$.when(e.dataService.getStartForm(e._getServiceParams())).then(function(t){return e._getRenderingFacade().execute({canvas:e._getCanvasForm(),data:t,type:""})}).done(function(a){e.startForm=a,i.find("#createcase-content").append(a.container),t.resolve(i)})}),t.promise()},_getRenderingFacade:function(){return this._rendering||(this._rendering=new bizagi.rendering.facade({proxyPrefix:bizagi.RPproxyPrefix,database:""})),this._rendering},_getServiceParams:function(){var e=this,t=e.getMapping();return t.h_action="LOADSTARTFORM",e._idParentCase&&(t.h_idParentCase=e._idParentCase),e._mappingstakeholders&&(t.h_mappingstakeholders=e._mappingstakeholders),e._guidprocess?t.h_guidprocess=e._guidprocess:t.h_idProcess=e._processId,t},getMapping:function(){for(var e={},t=0,i=this._mapping.length;t<i;t++){var a=this._mapping[t];a.surrogateKey&&(e[a.xpath]=JSON.stringify(a.surrogateKey))}return e},_getCanvasForm:function(){var e=this.getContent().find("#createcase-content");return e.on("routing",$.proxy(this.onCaseCreated,this)),e},onCaseCreated:function(e,t){this.pub("closeDialog",t)},dispose:function(){this.startForm&&(this.pub("createCaseDisposed"),this.startForm.dispose()),this._super()}}),bizagi.injector.register("bizagi.workportal.widgets.createcase",["workportalFacade","dataService",bizagi.workportal.widgets.createcase],!0),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.updateform",{},{init:function(e,t,i){var a=this;a._super(e,t,i),a._guidForm=i.guidForm,a._entityGuid=i.entityGuid,a._surrogateKey=i.surrogateKey,a._mapping=i.mapping,a._readonlyform=i.readonlyform,a.loadTemplates({updateform:bizagi.getTemplate("bizagi.workportal.desktop.widget.updateform").concat("#updateform-wrapper"),content:bizagi.getTemplate("bizagi.workportal.desktop.widget.updateform").concat("#form-content")})},renderContent:function(){var e=this.getTemplate("updateform");return this.content=e.render(),this.content},postRender:function(){var e=this,t=new $.Deferred,i=e.getContent();return e.dataService.getEntityForm(e._getServiceParams()).then(function(t){return e._getRenderingFacade().execute({canvas:i.find("#updateform-content"),data:t,type:""})}).done(function(e){i.find("#updateform-content").append(e.container),t.resolve(i)}),t.promise()},_getRenderingFacade:function(){var e=this;return e._rendering||(e._rendering=new bizagi.rendering.facade({proxyPrefix:bizagi.RPproxyPrefix,database:""})),e._rendering.subscribe("rendering-formRendered",$.proxy(e._overrideHandlers,e)),e._rendering},_getServiceParams:function(){var e=this,t={h_action:"LOADENTITYFORM",h_contexttype:"entity"};return t.h_guidForm=e._guidForm,t.h_showDisabled=!1,t.h_guidEntity=e._entityGuid,t.h_readonlyform=e._readonlyform,e._mapping&&(t.h_mapping=JSON.stringify(e._mapping)),e._surrogateKey&&(t.h_surrogateKey=e._surrogateKey),t},_getCanvasForm:function(){return this.getTemplate("content").render()},_overrideHandlers:function(){var e=this,t=void 0===e._rendering?null:e._rendering.form;if(t){e.idPageCache=e.idPageCache||t.idPageCache;var i=t.properties,a=t.processButton;t.processButton=function(r){if("cancel"!=r.action)return i.surrogateKey=e._surrogateKey,i.contextType="entity",t.bind("refresh",function(){t.endLoading(),e.pub("closeDialog",{refresh:!0}),t.dispose()}),a.apply(t,arguments);t.endLoading(),e.pub("closeDialog",{refresh:!1}),t.dispose()}}},dispose:function(){this._rendering&&this._rendering.form&&this._rendering.form.dispose(),bizagi.util.dispose(this)}}),bizagi.injector.register("bizagi.workportal.widgets.updateform",["workportalFacade","dataService",bizagi.workportal.widgets.updateform],!0),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.templates",{},{init:function(e,t,i,a,r,o,n,s,d){var c=this;c._super(e,t,d),c.loadTemplates({templateEngine:bizagi.getTemplate("bizagi.workportal.desktop.widget.templateEngine").concat("#templateengine-wrapper"),templateEngineElement:bizagi.getTemplate("bizagi.workportal.desktop.widget.templateEngine").concat("#templateengine-wrapper-element"),templateEngineTooltip:bizagi.getTemplate("bizagi.workportal.desktop.widget.templateEngine").concat("#templateengine-wrapper-tooltip"),templateEmptyData:bizagi.getTemplate("bizagi.workportal.desktop.widget.templateEngine").concat("#templateengine-empty-message")}),c.selectorCheckboxItems=".template-box-header input:checkbox",c.actionService=i,c.casetoolbar=a,c.usersCasesService=r,c.actionsEventsService=o,c.processActionService=s,c.accumulatedcontext=n,c._currentPage=1,c.entitiesSelected={}},renderContent:function(){var e=this.getTemplate("templateEngine");return this.content=e.render({}),this.content},postRender:function(){this.configureHandlers()},configureHandlers:function(){var e=this;e.getContent().find("#template-dataviewer-list").on("click",e.selectorCheckboxItems,$.proxy(e.onEntityChecked,e)),e.sub("GET-COMMON-ACTIONS",$.proxy(e.getCommonActions,e)),e.sub("TEMPLATEENGINE-VIEW",function(t,i){return e.params.event="TEMPLATEENGINE-VIEW",e.updateData(i)}),e.sub("SEARCH-ENGINE-VIEW",function(t,i){return e.params.event="SEARCH-ENGINE-VIEW",e.updateData(i)}),e.sub("UPDATE-DATATEMPLATE-VIEW",function(t,i){return e.updateData(i)}),e.sub("SET-VALUES",function(t,i){return e.setValues(i)}),e.actionService.subscribe("onFormActionExecuted",$.proxy(e.onFormActionExecuted,e)),e.processActionService.subscribe("onFormRuleExecuted",$.proxy(e.onFormRuleExecuted,e)),e.processActionService.subscribe("onFormExecuted",$.proxy(e.onFormExecuted,e));var t=$("#home-navbar").outerHeight(),i=$("#ui-bizagi-wp-menu").height()-t;$("#content-wrapper").scroll(function(){var e=$(".template-sticky-header-tools"),t=e.height();$("#content-wrapper").scrollTop()>=i?(e.addClass("fixed-header-tools"),$(this).css("padding-top",t+"px")):(e.removeClass("fixed-header-tools"),$(this).css("padding-top",""))})},updateData:function(e){var t=this,i=e.args||{},a=new $.Deferred;$("#template-dataviewer-list",t.getContent()).empty(),t.actionService.init(),t.entitiesSelected={},t._referrer=i.guidSearch?"search":i.referenceType?"dataNavigation":t._referrer,t._page=i.page||t._page,t._totalRecords=i.totalRecords,t._filters=i.filters||t._filters,t._defaultFilterApplied=void 0!==i.defaultFilterApplied?i.defaultFilterApplied:void 0===t._defaultFilterApplied||t._defaultFilterApplied,t._guidSearch=i.guidSearch||t._guidSearch,t._fromActionLauncher=void 0!==i.fromActionLauncher?i.fromActionLauncher:t._fromActionLauncher,t._reference=i.reference||t._reference||"",t._surrogateKey=i.surrogateKey||t._surrogateKey,t._referenceType=i.referenceType||t._referenceType,t._xpath=i.xpath||t._xpath,t._guidEntityCurrent=i.guidEntityCurrent||t._guidEntityCurrent,t._pageSize=i.pageSize||t._pageSize,t._onlyLocalResults=i.onlyLocalResults||t._onlyLocalResults;var r={guidSearch:t._guidSearch,fromActionLauncher:t._fromActionLauncher,reference:t._reference,surrogateKey:t._surrogateKey,referenceType:t._referenceType,page:t._page,filters:t._filters,filtersAppliedCounter:i.filtersAppliedCounter,totalRecords:t._totalRecords,calculateFilters:void 0===i.calculateFilters||i.calculateFilters,defaultFilterApplied:t._defaultFilterApplied,xpath:t._xpath,guidEntityCurrent:t._guidEntityCurrent,pageSize:t._pageSize,onlyLocalResults:t._onlyLocalResults};return $.when(t.getEntityData(r)).then(function(a){var r=$.Deferred();return a&&a.reference===t._reference?(t.pub("notify",{type:"PAGINATOR-UPDATE",args:$.extend(bizagi.clone(i),a,{event:e.type})}),$.when(t.processEntities($.extend(a,{referenceType:t._referenceType}))).done(function(e){r.resolve(e,a.reference)})):r.reject(),r.promise()}).done(function(e,r){r===t._reference&&(t.checkAll=!1,$.when(t.renderEntities(e,i)).done(function(){t.pub("notify",{type:"ENABLE-BATCHS-ACTIONS",args:{commonActions:t.setValues({args:{value:t.checkAll}})}}),a.resolve(e)}))}),a.promise()},getTemplateEngine:function(){var e=this;if(e.templateEngine)return e.templateEngine;var t=new bizagi.render.services.service({proxyPrefix:bizagi.RPproxyPrefix}),i=new bizagi.rendering.desktop.factory(t),a=new $.Deferred;return $.when(i.initAsyncStuff()).done(function(){e.templateEngine=new bizagi.templateEngine({renderFactory:i,cache:!0,router:e.router}),e.templateEngine.subscribe("onLoadDataNavigation",function(t,i){var a=i.data||{},r={reference:a.reference,surrogateKey:a.surrogateKey,referenceType:a.referenceType,histName:a.displayName,guidEntityCurrent:a.guidEntityCurrent,filters:[],page:1,calculateFilters:!0};void 0!==a.xpath&&a.xpath&&(r.xpath=a.xpath),e.accumulatedcontext.addContext({entityGuid:i.data.guidEntityCurrent,surrogateKey:[i.data.surrogateKey]});var o=e.pub("notify",{type:"NAVIGATOR_GETLEVEL"}),n=o&&o.length>0?parseInt(o[0]):1;e.pub("notify",{type:a.contextEvent,args:$.extend(r,{level:n+1})})}),a.resolve(e.templateEngine)}),a.promise()},getEntityData:function(e){var t=this,i=e.filters,a=e.filtersAppliedCounter,r=e.calculateFilters;return"search"===t._referrer?t.dataService.getSearchData(e).then(function(o){return t.setFiltersData(o.filters,i,a,o.totalRecords,r,null),$.extend(o,{reference:e.reference})}):t.dataService.getCollectionEntityData(e).then(function(o){if(t._reference===o.reference){var n=o.totalRecords;if(n>0)"FACT"===e.referenceType?t.dataService.getFiltersEntityData(e).then(function(o){t._reference===o.reference&&(t.processFiltersData(o,i,a,n,r,e.defaultFilterApplied),t.updateCounterFiltersApplied(i))}).fail(function(){t.hideSortBar()}):t.hideSortBar();else a>0?(t.setFiltersData([],i,a,n,!1,null),t.updateCounterFiltersApplied(i)):t.hideSortBar();return $.extend(o,{reference:e.reference})}})},hideSortBar:function(){this.pub("notify",{type:"HIDE-SORT-BUTTONS",args:{}}),this.pub("notify",{type:"HIDE-FILTER-BUTTONANDBAR",args:{}})},processFiltersData:function(e,t,i,a,r,o){if(o){for(var n,s={properties:{xpath:"",type:"entity",typeSearch:"exact"},value:[]},d=-1,c=0;n=e[++d];){var l=n.data;if("Entity"===n.type)for(var g,u=-1;g=l.defaultValues[++u];)g.applied&&(s.properties.xpath=n.attribute,s.value.push({id:g.id}),c++)}c>0&&t.push(s),i=void 0!==i?i+c:c,this.setFiltersData(e,t,i,a,r,o)}else this.setFiltersData(e,[],i,a,r,null)},setFiltersData:function(e,t,i,a,r,o){var n={filters:e||[],filtersApplied:t,filtersAppliedCounter:i||0,totalRecords:a||0,calculateFilters:r||!1};o&&(n.defaultFilterApplied=o),this.pub("notify",{type:"SET-FILTERS-DATA",args:n})},processEntities:function(e){var t=this,i=[],a=[],r=new $.Deferred,o="ENTITY"===e.referenceType?"Content":"List";return e.reference===t._reference?bizagi.loader.start("rendering").then(function(){$.when(t.getTemplateEngine()).then($.proxy(function(t){return $.when.apply($,$.map(e.entities,$.proxy(function(e){a.push({surrogateKey:e.surrogateKey,entityId:e.guid});var i=$.extend(e,{isDefaultTemplate:null===e.guidTemplate,templateType:o}),r={contextEvent:this.params.event};return t.render(i,r)},this)))},t)).done(function(){for(var o,n=$.makeArray(arguments),s=0,d=e.entities.length;s<d;s++)o=1===d?n[s]:n[s][0],i.push({tmpl:o,data:e.entities[s]});var c=!1;void 0!==t.idCasesOfProcessEntitiesPromise&&"pending"===t.idCasesOfProcessEntitiesPromise.state()&&t.lastParamsSendit&&JSON.stringify(a)===t.lastParamsSendit&&(r.reject(),c=!0),c||(t.lastParamsSendit=JSON.stringify(a),t.idCasesOfProcessEntitiesPromise=t.dataService.getIdCasesOfProcessEntities(a),$.when(t.idCasesOfProcessEntitiesPromise).done(function(){r.resolve(i)}))})}):r.reject(),r.promise()},renderEntities:function(e,t){for(var i=this,a=$.Deferred(),r=[],o=$("#template-dataviewer-list",i.getContent()),n=i.entitiesLength=e.length,s=$(),d=0;d<n;d++){var c=i.renderTemplate(e[d],!1,t);s.push.apply(s,c)}return s.length>0?(o.append(s),r.push(i.getIdCasesOfProcessEntities(e,t.fromActionLauncher,o)),$.when.apply($,r).done(function(){a.resolve()})):(o.append(i.getEmptyDataMessage()),a.resolve()),a.promise()},renderTemplate:function(e,t,i){var a=e.data||{},r=a.surrogateKey,o=a.guid,n=i.fromActionLauncher,s=this.getTemplate("templateEngineElement").render({fromActionLauncher:n,guidEntity:o,isChecked:this.checkAll,surrogateKey:r});return s.find("#template").append(e.tmpl),s},getIdCasesOfProcessEntities:function(e,t,i){var a=this,r=$.Deferred();return void 0===a.collectionGetActionsDeferred&&(a.collectionGetActionsDeferred=[]),a.idCasesOfProcessEntitiesPromise.then(function(t){for(var r,o=[],n=-1;r=t[++n];){var s=r.caseId;if(void 0!==s&&s>0){var d=e.find(function(e){return e.data.surrogateKey===r.surrogateKey});if(void 0!==d){var c=d.data||{},l=$("#template-box-wrapper-"+c.surrogateKey,i),g=a.casetoolbar.getCaseToolbar({casetoolbarData:{idcase:s,referrer:"RenderTemplate"}});$(".template-box-header .casetoolbar",l).append(g),$(a.selectorCheckboxItems,l).data("caseid",s),o.push(s),$.extend(c,{idCase:s})}}}a.actionsEventsService.render(o)}).always(function(){var i,o=-1;Object.keys(e).length;for(a.collectionGetActionsDeferred.length>0&&(a.collectionGetActionsDeferred=[]);i=e[++o];){var n=i.data||{};a.collectionGetActionsDeferred.push(a.getEntityActionsAndEvents(t,!1,n.guidEntity,n.surrogateKey,n.idCase))}$.when.apply($,a.collectionGetActionsDeferred).done(function(){r.resolve(),a.collectionGetActionsDeferred=[]})}),r.promise()},getEntityActionsAndEvents:function(e,t,i,a,r){var o=this,n=$.Deferred(),s=o.getContent();return e||setTimeout(function(){var e=s.find("#template-box-wrapper-"+a+" .template-box-footer"),d={actionData:{guidEntity:i,surrogateKey:a},loadEvents:!1,isRefresh:t};void 0!==r&&r>0&&(d.actionData.idCase=r,d.loadEvents=!0),e.startLoading({delay:0,overlay:!0}),$.when(o.actionService.getActionsView(d)).done($.proxy(function(t,i){var r=i.actionsView,d=i.actionsData;if(t===o._reference){var c=s.find("#template-box-wrapper-"+a+" .template-box-element .template-box-footer");r?(c.empty().append(r),d.length>0&&-1!=o.getCheckBox(c).data("surrogatekey")?(o.showCheckItem(c),o.pub("notify",{type:"SOME-ITEM-ALLOW-SELECT",args:{}})):o.removeCheckItem(c)):o.removeCheckItem(c),e.endLoading(),n.resolve()}},o,bizagi.clone(o._reference)))},0),n.promise()},getCheckBox:function(e){return e.closest(".template-box-element").find(this.selectorCheckboxItems)},removeCheckItem:function(e){this.getCheckBox(e).after("<div></div>").remove()},showCheckItem:function(e){this.getCheckBox(e).show()},getCommonActions:function(){var e=this,t={};for(var i in t.actions=e.actionService.getCommonActions(e.entitiesSelected),t.surrogateKeys=[],t.checkAll=void 0,e.entitiesSelected)t.surrogateKeys.push("string"==typeof i?parseInt(i):i);return t.guidEntity=void 0!==i?e.entitiesSelected[i].guidEntity:"",0===t.surrogateKeys.length?(e.checkAll=!1,t.checkAll=!1):t.surrogateKeys.length==e.entitiesLength?(e.checkAll=!0,t.checkAll=!0):t.surrogateKeys.length!==e.entitiesLength&&(e.checkAll=!1,t.checkAll=!1),t.itemsSelected=e.entitiesSelected,t},onEntityChecked:function(e){var t=$(e.target),i=t.data("surrogatekey"),a=t.data("guidentity"),r=t.is(":checked"),o=t.data("caseid"),n={surrogateKey:i,guidEntity:a};void 0!==o&&o>0&&(n.idCase=o),this.entitiesSelected[i]=n,r||delete this.entitiesSelected[i],this.pub("notify",{type:"ENABLE-BATCHS-ACTIONS",args:{commonActions:this.getCommonActions()}})},setValues:function(e){var t=this,i=t.getContent(),a=(e.args||{}).value;if(i){t.entitiesSelected={};var r=i.find(t.selectorCheckboxItems);return $.map(r,function(e){if($(e).prop("checked",a),a){var i=$(e).data("surrogatekey"),r=$(e).data("guidentity"),o=$(e).data("caseid");t.entitiesSelected[i]={surrogateKey:i,guidEntity:r,idCase:o}}}),t.checkAll=a,t.getCommonActions()}},onFormActionExecuted:function(e,t){t.refresh&&this.refreshRegister(t)},onFormRuleExecuted:function(e,t){t.refresh&&this.refreshRegister(t.action)},onFormExecuted:function(e,t){t.refresh&&this.refreshRegister(t.action)},refreshRegister:function(e){var t=this;if("search"==t._referrer)t.updateData({args:{calculateFilters:!1}});else if("dataNavigation"==t._referrer)t.updateData({args:{calculateFilters:!0}});else{var i="#template-box-wrapper-"+e.surrogateKey,a=$(i),r=a.find(".template-box-header > input:checkbox").is(":checked"),o={operator:"",filters:[{key:"id",value:e.surrogateKey}]};a.startLoading({delay:250,overlay:!0}),$.when(t.getEntityData({reference:e.reference,surrogateKey:e.surrogateKey,referenceType:e.referenceType,xpath:e.xpath,guidEntityCurrent:e.guidEntityCurrent,page:t._page,filters:o})).then(function(e){return t.processEntities(e)}).done(function(o){var n=t.renderTemplate(o[0],!0,e);a.replaceWith(n),a.endLoading(),r&&(a=$(i)).find(".template-box-header > input").prop("checked",!0)}).always(function(){a.endLoading()})}},router:function(){},getEmptyDataMessage:function(){return this.getTemplate("templateEmptyData").render()[0].outerHTML},updateCounterFiltersApplied:function(e){var t={type:"UPDATE-COUNTER-FILTERS-APPLIED",args:{filtersApplied:e}};this.pub("notify",t)},clean:function(){var e=this,t=e.getContent();e._currentPage=1,e.checkAll=!1,$("#content-wrapper").unbind("scroll"),t&&(t.find("#template-dataviewer-list").off("click",e.selectorCheckboxItems),e.unsub("TEMPLATEENGINE-VIEW"),e.unsub("SEARCH-ENGINE-VIEW"),e.unsub("UPDATE-DATATEMPLATE-VIEW"),e.unsub("GET-COMMON-ACTIONS"),e.unsub("SET-VALUES"),e.actionService.unsubscribe("onFormActionExecuted"),e.processActionService.unsubscribe("onFormRuleExecuted"),e.processActionService.unsubscribe("onFormExecuted"))}}),bizagi.injector.register("bizagi.workportal.widgets.templates",["workportalFacade","dataService","actionService","casetoolbar","usersCasesService","actionsEventsService","accumulatedcontext","processActionService",bizagi.workportal.widgets.templates]),bizagi="undefined"!=typeof bizagi?bizagi:{},bizagi.override=void 0!==bizagi.override?bizagi.override:{},bizagi.override.customWorkportalHandlers={},bizagi.override.customizeWorkportalHandler=function(e,t){bizagi.override.customWorkportalHandlers[e]=t},bizagi.workportal.services.context&&(bizagi.workportal.services.context.original=$.extend(!0,{},bizagi.workportal.services.context.prototype),$.extend(bizagi.workportal.services.context.prototype,{getUrl:function(e){return"workportal"==this.context&&bizagi.override.customWorkportalHandlers[e]?bizagi.override.customWorkportalHandlers[e]:bizagi.workportal.services.context.original.getUrl.apply(this,arguments)}})),bizagi.override.customizeWorkportalWidget=function(widget,extensionMethod){var widgetImplementation=bizagi.workportal.desktop.facade.getWidgetImplementation(widget);widgetImplementation&&eval(widgetImplementation).extend(widgetImplementation,{},{postRender:function(){this._super();var e=this.getContent();extensionMethod&&extensionMethod(this,e)}})},bizagi.override.customButtons=[],bizagi.override.addCustomMenuButton=function(e){bizagi.override.customButtons.push(e)},bizagi.workportal.controllers.menu&&(bizagi.workportal.controllers.menu.original=$.extend(!0,{},bizagi.workportal.controllers.menu.prototype),$.extend(bizagi.workportal.controllers.menu.prototype,{postRender:function(){var e=this,t=e.workportalFacade.getTemplate("menu.custom-button");return $.when(bizagi.workportal.controllers.menu.original.postRender.apply(this,arguments)).pipe(function(i){var a=$("[data-bizagi-component=menuItems]",i);return $.each(bizagi.override.customButtons,function(i,r){if("function"!=typeof r.isAvailable||r.isAvailable()){var o=$.tmpl(t,r);null==r.submenu?o.click(function(){r.click&&r.click(e)}):o.click(function(){e.renderSubMenu(o,r.submenu,r.click)}),a.append(o)}}),i})}})),bizagi.override.addDataService=function(e,t){if(bizagi.workportal.services.service){bizagi.workportal.services.service.original=$.extend(!0,{},bizagi.workportal.services.service.prototype);var i={};i[e]=t,$.extend(bizagi.workportal.services.service.prototype,i)}},$.Class.extend("bizagi.ui.controls.tmplloader",{},{init:function(){this.templates=[]},loadTemplates:function(e){var t=this,i=e||{},a=new $.Deferred,r=[];return $.each(i,function(e,i){var a=t.loadTemplate(e,i);r.push(a)}),$.when.apply($,r).done(function(){a.resolve()}),a.promise()},loadTemplate:function(e,t){var i=this.templates,a=new $.Deferred;return i[e]?(a.resolve(),a.promise()):bizagi.templateService.getTemplate(t).done(function(t){i[e]=t})},getTemplate:function(e){var t=this.templates;return t[e]?t[e]:null}}),function(e){e.widget("diagram.dragScroll",{options:{},_create:function(){var t=this,i=this.options,a=!1;t.curYPos=0,t.curXPos=0,e(t.element).css({cursor:"move"}),e(t.element).bind("mousedown",function(e){a=!0,t.options.$scrollable.data({clicked:a}),t.curYPos=e.pageY,t.curXPos=e.pageX,t.scrollLeft=t.options.$scrollable.scrollLeft(),t.scrollTop=t.options.$scrollable.scrollTop(),i.$scrollable.bind("mousemove",function(e){a&&t._move(e.pageX,e.pageY)})}),e(t.element).bind("mouseup",function(e){a=!1,t.options.$scrollable.data({clicked:a}),i.$scrollable.unbind("mousemove")})},_move:function(e,t){var i=this,a=i.scrollLeft+i.curXPos-e,r=i.scrollTop+i.curYPos-t;0!=a&&0!=r&&(i.options.$scrollable.scrollTop(r),i.options.$scrollable.scrollLeft(a))},destroy:function(){e.Widget.prototype.destroy.call(this)}})}(jQuery),bizagi.override.enableFolder=!1,bizagi.override.enableSmartFolders=!1,bizagi.override.enableListOfRecentProcesses=!1,bizagi.override.enableCustomizeReports=!1,bizagi.override.enableMultipleCasesReassigment=!1,bizagi.override.enableAsyncECMUploadJobs=!1,bizagi.override.enablePrintFromEditForm=!1,bizagi.enableDebug=!1,bizagi.override.disableFrankensteinQueryForms=!0,bizagi.override.enableE2EInterface=!0,bizagi.override.disableOldInbox=!0,bizagi.override.disposeTime=50,bizagi.override.enableBatchRequest=!0,bizagi.override.forceBatchRequest=!1,bizagi.override.showAssignees=!0,bizagi.override.enableMySearch=!0,bizagi.override.enableSecurityCaseDashBoard=!1,bizagi.override.enableQueriesClassicMenu=!1,bizagi.override.disableAbortCases=!1,bizagi.override.enableAdhocProcess=!1,bizagi.override.enableCCBCCFeatureOnLiveProcesses=!0,bizagi.override.enableReviewModeFeatureOnLiveProcesses=!0,bizagi.override.enableFilterByProcessGroupOnLiveProcesses=!1,bizagi.override.enableLocalizationInModelerOnLiveProcesses=!0,bizagi.override.enablePredefinedPerformersOnLiveProcesses=!0,bizagi.override.enableFeatureShowTimelineButton=!0,bizagi.override.enableFeatureDisplayOptions=!1,bizagi.override.enableMaximizeModalsOption=!1,bizagi.override.enableStartPageDisplayOption=!1,bizagi.override.enablePing=!1,bizagi.override.enableECMMetadataMultiaction=!0,bizagi.override.validateGridsOnButtonClick=!1,bizagi.override.enableCustomFormats=!1,bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.dashboard",{data:{home:[{type:"cases",title:"workportal-widget-dashboard-cases",items:[{title:"workportal-widget-dashboard-pendings-title",iconclass:"pendings-ico",icon:"watch-pending-outline",data:"pendings"},{title:"workportal-widget-dashboard-favorites-title",iconclass:"star-ico",icon:"star",data:"following"}]}]}},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({dashboard:bizagi.getTemplate("bizagi.workportal.desktop.widget.dashboard").concat("#dashboard-wrapper")})},renderContent:function(){var e;return e=this.getTemplate("dashboard"),this.content=e.render(this.getData()),this.content},getData:function(){var e={},t=this.Class.data.home.slice(0);return e.home=$.map(t,function(e){e.title=bizagi.localization.getResource(e.title);for(var t=0,i=e.items.length;t<i;t++)e.items[t].title=bizagi.localization.getResource(e.items[t].title);return e}),e},postRender:function(){this.getContent().closest(".wdg-dash-board").on("click",".wdg-db-card",$.proxy(this.onShowCases,this)),$(window).trigger("resize")},clean:function(){var e=this.getContent();e&&e.closest(".wdg-dash-board").off("click",".wdg-db-card")},onShowCases:function(e){var t=$(e.target),i=t.closest(".wdg-db-card").data("route"),a=t.closest(".wdg-db-card").find(".wdg-db-title");this.pub("notify",{type:"CASES-TEMPLATE-VIEW",args:{histName:$.trim(a.text()),page:1,level:2,route:i,idworkflow:""}})}}),bizagi.injector.register("bizagi.workportal.widgets.dashboard",["workportalFacade","dataService",bizagi.workportal.widgets.dashboard]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.stuff",{},{init:function(e,t,i,a){this.accumulatedcontext=i,this._super(e,t,a),this.loadTemplates({stuff:bizagi.getTemplate("bizagi.workportal.desktop.widget.stuff").concat("#stuff-wrapper")})},renderContent:function(){var e=this,t=e.getTemplate("stuff");return $.when(e.getData()).done(function(i){return e.content=i.collections.length>0?t.render(i):"",e.content})},postRender:function(){var e=this,t=e.getContent();$(".wdg-stf-card",t).on("click",$.proxy(e.onClickEntity,e)),e.sub("TEMPLATEENGINE-VIEW",$.proxy(e.selectItem,e))},getData:function(){var e=this;return $.when(e.dataService.getUserStuff({icon:!0})).then(function(t){return t=e.buildModel(t)||{},{title:bizagi.localization.getResource("workportal-widget-dashboard-stuff"),collections:t}})},selectItem:function(){$(".wdg-stf-card",this.content).removeClass("wdg-stf-selected"),$("#"+arguments[1].args.reference,this.content).addClass("wdg-stf-selected")},buildModel:function(e){var t={},i=[];e=e||{},this.model={};for(var a=0,r=e.length;a<r;a++){var o=e[a];o.guid=Math.guid(),t[o.guid]=o,i.push(o)}return this.model.collections=t,i},onClickEntity:function(e){var t=$(e.target).closest(".wdg-stf-card"),i=this.model.collections[t.data("guid")],a={calculateFilters:!0,filters:[],fromActionLauncher:!1,histName:t.data("title")||i.displayName,level:1,page:1,reference:i.reference,referenceType:i.referenceType,surrogateKey:i.surrogateKey};void 0!==i.entityId&&i.entityId&&(a.guidEntityCurrent=i.entityId),void 0!==i.xpath&&i.xpath&&(a.xpath=i.xpath),this.accumulatedcontext.clean(),this.pubDeadLockDetection("notify",{type:"TEMPLATEENGINE-VIEW",args:a})},clean:function(){var e=this.getContent();e&&($(".wdg-stf-card",e).off("click"),this.unsub("TEMPLATEENGINE-VIEW"))}}),bizagi.injector.register("bizagi.workportal.widgets.stuff",["workportalFacade","dataService","accumulatedcontext",bizagi.workportal.widgets.stuff]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.project.base",{},{init:function(e,t,i){var a=this;i=i||{},a.differenceMillisecondsServer=i.differenceMillisecondsServer,a.uploadMaxFilesSize=bizagi.currentUser.uploadMaxFileSize,a.supportFileExt=[".jpg",".pdf",".txt",".png",".pptx",".docx",".gif",".rtfx",".xlsx",".zip",".rar"],a.radNumber=i.radNumber,a._super(e,t,i)},renderContent:function(){var e=this;if(!e.differenceMillisecondsServer)return $.when(e.dataService.getDateServer()).done(function(t){e.differenceMillisecondsServer=bizagi.util.dateFormatter.getDifferenceBetweenDates(new Date,new Date(t.date),"milliseconds")})},getDateServer:function(){return(new Date).getTime()+this.differenceMillisecondsServer},mergePropertiesActivitiesWithWorkitems:function(e,t){e.forEach(function(e){var i=t.filter(function(t){return t.guidActivity===e.id});i.length>0&&$.extend(e,{startDate:i[0].wiEntryDate||null,finishDate:i[0].wiSolutionDate||null,idWorkItem:i[0].idWorkItem,workItemState:i[0].workItemState,idCase:i[0].idCase,estimatedFinishDate:i[0].wiEstimatedSolutionDate||e.estimatedFinishDate})})}}),bizagi.injector.register("bizagi.workportal.widgets.project.base",["workportalFacade","dataService",bizagi.workportal.widgets.project.base],!0),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.decontextualized.plans",{data:{title:"workportal-widget-dashboard-decontextualized-plans-title",items:[{title:"workportal-widget-dashboard-decontextualized-plans-pendings-title",description:"workportal-widget-dashboard-decontextualized-plans-pendings-description",iconclass:"star-ico",icon:"pending",data:"PENDING"},{title:"workportal-widget-dashboard-decontextualized-plans-running-title",description:"workportal-widget-dashboard-decontextualized-plans-running-description",iconclass:"star-ico",icon:"executing",data:"EXECUTING"},{title:"workportal-widget-dashboard-decontextualized-plans-completed-title",description:"workportal-widget-dashboard-decontextualized-plans-completed-description",iconclass:"star-ico",icon:"closed",data:"CLOSED"}]}},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({"decontextualized.plans":bizagi.getTemplate("bizagi.workportal.desktop.widget.decontextualized.plans").concat("#plans-wrapper")})},renderContent:function(){var e,t,i=this;return e=i.getTemplate("decontextualized.plans"),bizagi.menuSecurity.Plans?((t=i.getData()).title,i.content=e.render(t)):i.content=$("<div></div>"),i.content},postRender:function(){var e=this.getContent();$.when(this.getServerDateDifference()).then(function(e){}),$(".wdg-plans-card",e).on("click",$.proxy(this.onClickCard,this))},getData:function(){var e={},t=this.Class.data;return e.items=$.map(t.items,function(e){return e.title=bizagi.localization.getResource(e.title),e.description=bizagi.localization.getResource(e.description),e}),e.title=bizagi.localization.getResource(t.title),e},onClickCard:function(e){var t=$(e.target).closest(".wdg-plans-card"),i={histName:t.data("title"),planState:t.data("data"),flowContext:"FLOW-DECONTEXTUALIZED-PLANS",isOpen:!0,level:1};this.pub("notify",{type:"PLANS-VIEW",args:$.extend(this.params,i)})},getServerDateDifference:function(){var e=this;return e.dataService.getDateServer().done(function(t){e.params.differenceMillisecondsServer=bizagi.util.dateFormatter.getDifferenceBetweenDates(new Date,new Date(t.date),"milliseconds")})},clean:function(){var e=this.getContent();e&&$(".wdg-plans-card",e).off("click")}}),bizagi.injector.register("bizagi.workportal.widgets.decontextualized.plans",["workportalFacade","dataService",bizagi.workportal.widgets.decontextualized.plans]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.navigator",{},{init:function(e,t,i,a){var r=this;r._super(e,t,a),r.flagDisplayDate=!0,r.printFormCommand=new bizagi.workportal.command.printform(r.workportalFacade),r.fromClickBreadCrumb=!1,r.caseLink=a.caseLink,r.loadTemplates({navigator:bizagi.getTemplate("bizagi.workportal.desktop.widget.navigator").concat("#navigator-wrapper"),child:bizagi.getTemplate("bizagi.workportal.desktop.widget.navigator").concat("#navigator-child"),"popup-release":bizagi.getTemplate("bizagi.workportal.desktop.widget.navigator").concat("#navigator-popup-release")}),r.accumulatedcontext=i,r.releaseDialogBox={}},renderContent:function(){var e=this,t=e.getTemplate("navigator");return e.content=t.render($.extend(e.getDataObj(),{security:bizagi.menuSecurity})),bizagi.navigator=bizagi.navigator||{info:{}},e.info=bizagi.navigator.info,e._level=Object.keys(e.info).length-1,$(".navbar-print",e.content).on("click",$.proxy(e.printCase,e)),$(".navbar-back",e.content).on("click",$.proxy(e.goToBack,e)),$(".navbar-assignation-everyone > .ae-action",e.content).on("click",$.proxy(e.assignationEveryoneAction,e)),e.releaseDialogBox.formContent=e.getTemplate("popup-release").render({}),e.content},postRender:function(){var e=this,t=e.getContent().find("ul");e.sub("NAVIGATE",$.proxy(e.refresh,e)),e.sub("UPDATE_LASTCRUMBPARAMS_INFO",$.proxy(e.updateLastCrumbParamsInfo,e)),e.sub("NAVIGATOR_GETLEVEL",function(){return e.getLevel()}),e.sub("NAVIGATOR_BACK",$.proxy(e.goToPreviousCrumb,e)),t.on("click","li",$.proxy(e.crumbEvent,e)),e.plugins={},e.plugins.popupRelease={form:{buttonAccept:$("#button-accept-release",e.releaseDialogBox.formContent),buttonCancel:$("#button-cancel-release",e.releaseDialogBox.formContent)}},e.plugins.popupRelease.form.buttonAccept.on("click",$.proxy(e.onClickAcceptRelease,e)),e.plugins.popupRelease.form.buttonCancel.on("click",$.proxy(e.onClickCancelRelease,e))},getBreadCrumbInfo:function(){return bizagi.navigator.info},setBreadCrumbInfo:function(e){bizagi.navigator.info=e},drawBreadCrumb:function(e,t){this.getTemplate("navigator");if($(this.content).find("ul").html(""),t)for(var i=-1;i<Object.keys(e).length-1;i+=1){var a=e[i];a.surrogateKey=i;var r=this.drawCrumb(a);$(this.content).find("ul").append(r)}},drawCrumb:function(e){var t=e.args.histName;return this.getTemplate("child").render({surrogateKey:e.surrogateKey,name:t,isPrincipalHome:!1})},crumbEvent:function(e){var t=this.info[$(e.target).data("surrogatekey")];this.goToCrumb(t,e)},goToCrumb:function(e,t){if(e){var i=e.args,a=!1,r=this.getParentContext(e.context);if(("TEMPLATEENGINE-VIEW"==r||"SEARCH-ENGINE-VIEW"==r)&&(a=!0,t&&t.target)){var o=parseInt($(t.target).data("surrogatekey"),10)+1;this.accumulatedcontext.cutContext(o)}this.deleteRemainingCrumbs(e),this.pub("notify",{skipRefresh:a,type:r,args:$.extend(i,{showContextByMenuDashboard:r})})}},goToPreviousCrumb:function(){var e=Object.keys(this.info).length,t=this.info[e-3];t||(t=this.info[e-2]),this.goToCrumb(t)},deleteRemainingCrumbs:function(e){var t=this;$.each(t.info,function(i,a){e.surrogateKey<parseInt(i,10)&&delete t.info[i]})},getParentContext:function(e){return"OVERVIEW"===e||"COMMENTS"===e||"FILES"===e||"TIMELINE"===e?"ACTIVITY":"ACTIVITYPLANOVERVIEW"===e||"ACTIVITYPLANCOMMENTS"===e||"ACTIVITYPLANFILES"===e||"ACTIVITYPLANTIMELINE"===e?"ACTIVITYPLAN":"PLANSIDEBAR"===e||"EDITACTIVITY"===e||"PLANACTIVITIES"===e||"PLANCOMMENTS"===e||"PLANFILES"===e||"PLANTIMELINE"===e?"PLANACTIVITIES":e},resetBreadCrumb:function(e){this.info={},this.info[-1]=this.copyDataObjectWithoutReference(e)},updateInfo:function(e){var t=this,i=Object.keys(t.info).length;if(e.args.level&&e.args.level<i&&e.args.level>0){for(var a=e.args.level-1;a<i-1;a+=1)delete t.info[a];i=e.args.level}var r=t.info[i-2],o=t.info[i-3];if("HOME"==e.context||"SEARCH-ENGINE-VIEW"===e.context&&void 0===e.args.reference)this.resetBreadCrumb(e);else if("ACTIVITY"==e.context||"ACTIVITYPLAN"==e.context)o&&t.getParentContext(e.context)==t.getParentContext(o.context)?t.cleanBreadCumb(o,e,3):r&&t.getParentContext(e.context)==t.getParentContext(r.context)?t.cleanBreadCumb(r,e,2):t.info[i-1]=t.copyDataObjectWithoutReference(e);else if("TEMPLATEENGINE-VIEW"==e.context||"SEARCH-ENGINE-VIEW"===e.context){var n=t.info[-1];if(n&&"TEMPLATEENGINE-VIEW"!=n.context&&"SEARCH-ENGINE-VIEW"!=n.context&&"HOME"!=n.context&&(t.info={},i=Object.keys(t.info).length,r=null),"FACT"==e.args.referenceType||"VIRTUAL"==e.args.referenceType){var s=t.hasGuidEntityInBreadCrumb(e.args.guidEntityCurrent),d=t.copyDataObjectWithoutReference(e);1==e.args.level?(t.info={},t.info[-1]=d):r&&r.args&&r.args.level==e.args.level?t.cleanBreadCumb(r,e,2):s?(d.surrogateKey=s.surrogateKey,t.info[d.surrogateKey]=d,t.deleteRemainingCrumbs(d)):t.info[i-1]=d}else"ENTITY"==e.args.referenceType&&("DATA-NAVIGATION"==e.args.eventType||t.hasXpathInBreadCrumb(e.args.xpath)||(t.info[i-1]=t.copyDataObjectWithoutReference(e)))}else r&&t.getParentContext(e.context)==t.getParentContext(r.context)?t.cleanBreadCumb(r,e,2):t.info[i-1]=t.copyDataObjectWithoutReference(e);t.setBreadCrumbInfo(t.info)},updateLastCrumbParamsInfo:function(e,t){var i=Object.keys(this.info).length;i>0&&$.extend(this.info[i-2].args,this.copyDataObjectWithoutReference(t.args))},hasXpathInBreadCrumb:function(e){for(var t=-1;t<Object.keys(bizagi.navigator.info).length-1;t+=1){if(bizagi.navigator.info[t].args.xpath==e)return!0}return!1},hasGuidEntityInBreadCrumb:function(e){for(var t=-1;t<Object.keys(bizagi.navigator.info).length-1;t+=1){var i=bizagi.navigator.info[t];if(i.args.guidEntityCurrent==e)return i}return!1},cleanBreadCumb:function(e,t,i){var a=Object.keys(this.info).length;e=this.copyDataObjectWithoutReference(t),this.info[a-i]=e,this.deleteRemainingCrumbs(e)},drawDateNavigator:function(e){var t=1==Object.keys(this.info).length;!1===e.args.showDateNavigator&&(t=!1),this.onDisplayDate(t)},recalculateHomeNavbar:function(e){var t=this;"TEMPLATEENGINE-VIEW"==e.context&&"SEARCH-ENGINE-VIEW"==e.context||(t.setWidthToNavigationPanel(),$(window).resize(function(){t.setWidthToNavigationPanel()}),t.subscribe("openCloseSidebar",function(){t.setWidthToNavigationPanel()}),"HOME"==e.context&&($("#ui-bizagi-wp-project-homeportal-main").addClass("disabled-right-sidebar"),$("#ui-bizagi-wp-project-homeportal-main").removeClass("enabled-right-sidebar")))},setWidthToNavigationPanel:function(){var e=this.content.parent();$(this.content,e).width($(e).width()+60)},setEnabledLeftSidebar:function(e){e.data&&e.data.belongs&&(e.data.belongs.toLeftSidebarCD?$("#ui-bizagi-wp-project-homeportal-main").addClass("enabledLeftSidebar"):$("#ui-bizagi-wp-project-homeportal-main").removeClass("enabledLeftSidebar"))},setEnabledRightSidebar:function(e){e.data&&e.data.belongs&&(e.data.belongs.toRightSidebarCD?($("#ui-bizagi-wp-project-homeportal-main").removeClass("disabled-right-sidebar"),$("#ui-bizagi-wp-project-homeportal-main").addClass("enabled-right-sidebar")):($("#ui-bizagi-wp-project-homeportal-main").removeClass("enabled-right-sidebar"),$("#ui-bizagi-wp-project-homeportal-main").addClass("disabled-right-sidebar")))},setEnabledBreadCrumb:function(e){var t=this;"ACTIVITY"==e.context||"ACTIVITYPLAN"==e.context?(t.setEnabledBackButton(),$(".nav-items-ctn",t.content).hide(),$(".nav-items-ctn",t.content).removeClass("toLeft"),$(".nav-items-ctn",t.content).addClass("clearfix")):($(".navbar-back",t.content).hide(),$(".nav-items-ctn",t.content).show(),$(".nav-items-ctn",t.content).addClass("toLeft"),$(".nav-items-ctn",t.content).removeClass("clearfix"))},setEnabledBackButton:function(){!0===this.caseLink?(this.caseLink=!1,$(".navbar-back",this.content).hide()):$(".navbar-back",this.content).show()},getLevel:function(){return Object.keys(this.info).length},refresh:function(e,t){var i=this;t.args,t.data;i.params=t.args,this.recalculateHomeNavbar(t),this.setEnabledLeftSidebar(t),this.setEnabledRightSidebar(t),this.setEnabledBreadCrumb(t),"ACTIVITY"!=t.context&&"ACTIVITYPLAN"!=t.context||(t.args.histName=i.getActivityName(t)),i.setStateBarNavigator(t.context),t.skipRefresh||t.args.histName&&""!=t.args.histName&&i.updateInfo(t);var a="DATA-NAVIGATION"!=t.args.eventType;i.drawBreadCrumb(i.info,a),i.drawDateNavigator(t)},goToBack:function(){var e=this;if(bizagi&&bizagi.referrerParams){var t=bizagi.referrerParams.referrer||bizagi.cookie("bizagiDefaultWidget");switch(t){case"inbox":case"inboxGrid":e.publish("changeWidget",{widgetName:t,restoreStatus:!0});break;case"homeportal":e.goToPreviousCrumb();break;case"search":e.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_SEARCH,radNumber:bizagi.referrerParams.radNumber||"",page:bizagi.referrerParams.page||1,onlyUserWorkItems:!1});break;case"queryform":var i={widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_QUERYFORM,notMigratedUrl:!1,queryFormAction:bizagi.referrerParams.queryForm.actionForm,notMigratedUrl:"",queryParams:bizagi.referrerParams.queryForm.queryParams,pageToShow:bizagi.referrerParams.queryForm.pageToShow,queryForm:bizagi.referrerParams.queryForm.queryForm,recalculateQueryForm:!0};$.extend(i,i,bizagi.referrerParams.queryForm.data),e.publish("showDialogWidget",i);break;case"reports":i={widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_REPORTS_CHART,endPoint:bizagi.referrerParams.reports.endPoint,filters:{},tab:bizagi.referrerParams.reports.tab};bizagi.referrerParams.reports.fromBackButton=!0,e.publish("changeWidget",i);break;case"folders":var a=bizagi.referrerParams.urlParameters+"&page="+bizagi.referrerParams.page;$.when(e.dataService.getCasesByFolder(a)).done(function(t){t.customized=!0,t.urlParameters=bizagi.referrerParams.urlParameters,t.title=bizagi.referrerParams.name,t.casesGroupedByFolder=!0,t.idFolder=bizagi.referrerParams.id,e.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_SEARCH,data:t,referrerParams:{}})});break;default:e.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_INBOX,restoreStatus:!0})}}},getActivityName:function(e){for(var t,i=e.args.idWorkitem,a=0;a<e.args.currentState.length;a++){var r=e.args.currentState[a];if(r&&r.idWorkItem==i){r.displayName?t=r.displayName:r.state&&(t=r.state);break}}return t},setStateBarNavigator:function(e){var t=this;"ACTIVITY"==e||"ACTIVITYPLAN"==e?(t.showButtonPrintForm(!0),t.showUrlHelp(!0),t.showButtonAssignationEveryone(!0),t.flagDisplayDate=!1,t.onDisplayDate(!1)):(t.showButtonPrintForm(!1),t.showUrlHelp(!1),t.showButtonAssignationEveryone(!1),t.flagDisplayDate=!0,t.onDisplayDate(!0))},getDataObj:function(){var e=this.getResource("datePickerRegional"),t=new Date;return{date:e.dayNames[t.getDay()]+", "+e.monthNames[t.getMonth()]+" "+t.getDate()+", "+t.getFullYear()}},copyDataObjectWithoutReference:function(e){return $.extend(!0,{},e)},showButtonPrintForm:function(e){var t=this.getContent().find(".navbar-print");!0===e?t.show():t.hide()},showUrlHelp:function(e){var t=this,i=t.getContent().find(".navbar-help");if(!0===e){for(var a="",r=0;r<t.params.currentState.length;r++)t.params.currentState[r].idTask===t.params.idTask&&(a=bizagi.util.validateUrlWellFormed(t.params.currentState[r].helpUrl));bizagi.util.isEmpty(a)||(i.show(),$(".navbar-help a").attr("href",a))}else i.hide()},printCase:function(){var e={idCase:this.params.idCase,idWorkitem:this.params.idWorkitem,idTask:this.params.idTask};this.printFormCommand.print(e)},showButtonAssignationEveryone:function(e){var t=this.getContent(),i=this.params.assignationEveryone||{};!0===e&&i.enabledReadOnlyForAsigneeToEveryone&&i.isAssignationMethodEveryone&&i.canWorkOnThisTask?($(".navbar-assignation-everyone",t).removeClass("nae--loading"),i.currentUserIsCurrentAsignee?$(".navbar-assignation-everyone > .ae-action",t).text(this.getResource("render-actions-release")):$(".navbar-assignation-everyone > .ae-action",t).text(this.getResource("render-actions-take-ownership")),$(".navbar-assignation-everyone",t).show()):$(".navbar-assignation-everyone",t).hide()},assignationEveryoneAction:function(){var e=this,t=e.params.assignationEveryone||{};$(".navbar-assignation-everyone",e.getContent()).addClass("nae--loading"),t.enabledReadOnlyForAsigneeToEveryone&&t.isAssignationMethodEveryone&&t.canWorkOnThisTask&&(t.currentUserIsCurrentAsignee?e.releaseDialogBox.formContent.dialog({resizable:!1,draggable:!1,height:"auto",width:"660px",modal:!0,title:e.getResource("workportal-widget-dialog-box-release-ok"),maximize:!0,close:function(){$(".navbar-assignation-everyone",e.getContent()).removeClass("nae--loading"),e.releaseDialogBox.formContent.dialog("destroy"),e.releaseDialogBox.formContent.detach()}}):e.actionTakeOwnership())},onClickAcceptRelease:function(){var e=this,t={idCase:e.params.idCase,idWorkItem:e.params.idWorkitem};$.when(e.dataService.releaseActivity(t)).done(function(i){var a;switch(i.status?i.status:""){case"Success":e.pub("notify",{type:e.params.showContextByMenuDashboard,args:$.extend(e.params,{refreshAllWidgets:!0})}),e.params.assignationEveryone.currentUserIsCurrentAsignee=!1;break;case"ConfigurationError":a=e.getResource("workportal-widget-dialog-box-release-configuration-error-message").replace("{0}",t.idWorkItem),bizagi.showMessageBox(a,e.getResource("workportal-widget-dialog-box-release-error"),"error",!1);break;default:a=e.getResource("workportal-widget-dialog-box-release-error-message").replace("{0}",t.idWorkItem),bizagi.showMessageBox(a,e.getResource("workportal-widget-dialog-box-release-error"),"error",!1)}e.waitForLoadCompletely()}).fail(function(){var i=e.getResource("workportal-widget-dialog-box-release-error-message").replace("{0}",t.idWorkItem);bizagi.showMessageBox(i,e.getResource("workportal-widget-dialog-box-release-error"),"error",!1),e.waitForLoadCompletely()}),e.releaseDialogBox.formContent.dialog("destroy"),e.releaseDialogBox.formContent.detach()},actionTakeOwnership:function(){var e=this,t={idCase:e.params.idCase,idWorkItem:e.params.idWorkitem};$.when(e.dataService.takeOwnershipActivity(t)).done(function(i){var a;switch(i.status?i.status:""){case"Success":e.pub("notify",{type:e.params.showContextByMenuDashboard,args:$.extend(e.params,{refreshAllWidgets:!0})}),e.params.assignationEveryone.currentUserIsCurrentAsignee=!0;break;default:a=e.getResource("workportal-widget-dialog-box-takeownership-error-message").replace("{0}",t.idWorkItem),bizagi.showMessageBox(a,e.getResource("workportal-general-error-page-title"),"error",!1)}e.waitForLoadCompletely()}).fail(function(){e.waitForLoadCompletely()})},waitForLoadCompletely:function(){var e=this.content,t=function(){var i=$("body #loadModuleStatus > *"),a=$(e).closest(".content-portal").find("#home-content").find(".ui-bizagi-loading-message");0===i.length&&0===a.length?$(".navbar-assignation-everyone",e).removeClass("nae--loading"):setTimeout(function(){$(".navbar-assignation-everyone",e).addClass("nae--loading"),t()},100)};t()},onClickCancelRelease:function(){$(".navbar-assignation-everyone",this.getContent()).removeClass("nae--loading"),this.releaseDialogBox.formContent.dialog("destroy"),this.releaseDialogBox.formContent.detach()},onDisplayDate:function(e){var t=this.getContent().find(".navbar-date");e&&this.flagDisplayDate?t.show():t.hide()},clean:function(){var e=this,t=e.getContent();if(t){var i=t.find("ul");e.unsub("UPDATE_LASTCRUMBPARAMS_INFO"),e.unsub("NAVIGATE"),e.unsub("NAVIGATOR_GETLEVEL"),e.unsub("NAVIGATOR_BACK"),i.off("click","li"),$(".navbar-print",e.content).off("click",$.proxy(e.printCase,e))}}}),bizagi.injector.register("bizagi.workportal.widgets.navigator",["workportalFacade","dataService","accumulatedcontext",bizagi.workportal.widgets.navigator]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.sidebarhome",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({sidebarhome:bizagi.getTemplate("bizagi.workportal.desktop.widget.sidebarhome").concat("#sidebarhome-wrapper")})},renderContent:function(){var e=this.getTemplate("sidebarhome");return this.content=$(e.render({})),this.content},postRender:function(){}}),bizagi.injector.register("bizagi.workportal.widgets.sidebarhome",["workportalFacade","dataService",bizagi.workportal.widgets.sidebarhome],!0),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.usersummary",{},{init:function(e,t,i){var a=this;a.workportalFacade=e,a.dataService=t,a.params=i,a._super(e,t,i),a.loadTemplates({usersummary:bizagi.getTemplate("bizagi.workportal.desktop.widget.usersummary").concat("#usersummary-wrapper")})},renderContent:function(){var e=this,t=e.getTemplate("usersummary");return $.when(e.getData()).done(function(i){e.content=t.render(i)})},postRender:function(){$(".wdg-usmry-stk-container",this.getContent()).on("click","div.wdg-usmry-see-more",$.proxy(this.showStakeholders,this))},showStakeholders:function(){var e=$(".wdg-usmry-stk-overlay",this.getContent());e.show("fast",function(){e.click(function(e){e.stopPropagation()}),$(document).one("click",function(){e.hide("fast")})})},getData:function(){var e=this;return bizagi.currentUser?this.getInfoToUser(bizagi.currentUser):e.dataService.getCurrentUser().then(function(t){return bizagi.currentUser=t,e.getInfoToUser(t)})},getInfoToUser:function(e){var t=[],i=e.associatedStakeholders.length,a=e.associatedStakeholders.slice(0,2),r=e.associatedStakeholders.slice(2,i),o=i>2;$.each(a,function(e,i){t.push(i.displayName)});var n={user:e.userName,stakeholders:t.length>0?t.join(", "):"--",stakeholdersHidden:r.length>0?r:"",showMore:o,orgArray:t,initials:e.initials};return e.userPicture&&(n.photo="data:image/png;base64,"+e.userPicture),n}}),bizagi.injector.register("bizagi.workportal.widgets.usersummary",["workportalFacade","dataService",bizagi.workportal.widgets.usersummary]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.shortcuts",{},{init:function(e,t,i,a,r,o){var n=this;n.requestsInProgressProcessGuid={},n.params=o,n.processActionService=i,n.accumulatedcontext=a,n.notifier=r,n._super(e,t,o),n.loadTemplates({myshortcuts:bizagi.getTemplate("bizagi.workportal.desktop.widget.shortcuts").concat("#shortcuts-wrapper")})},renderContent:function(){var e=this,t=e.getTemplate("myshortcuts");return $.when(e.getData()).done(function(i){return e.content=i.length>0?t.render({shortcuts:i}):"",e.content})},postRender:function(){var e=this.getContent();$(".wdg-srcts-container",e).on("click",$.proxy(this.onClickShortcut,this))},getData:function(){var e=this;return e.dataService.getMyShortcutsByCategory({icon:!0}).then(function(t){e.model={};for(var i,a=-1;i=t[++a];)for(var r,o=-1;r=i.items[++o];){var n=Math.guid();r.id=n,e.model[n]=r}return t})},onClickShortcut:function(e){var t=this,i=$(e.target).closest(".wdg-srcts-container"),a=t.model[i.data("id")];t.target=i,t.requestsInProgressProcessGuid[a.idProcess]||(t.startLoading(t.target,a.idProcess),a&&t.dataService.actionsHasStartForm({processId:a.idProcess}).done(function(e,i){if(e.startForm){var r={displayName:a.displayName,hasStartForm:e.startForm,showConfirmation:a.showConfirmation};$.when(t.processActionService.executeProcessAction({action:r,mappingstakeholders:!0,guidprocess:a.idProcess})).done(function(){t.stopLoading(t.target,a.idProcess)})}else t.dataService.actionCreateCase(a).done(function(e){$.when(t.processActionService.launchActionsAfterCreateCase({idCase:e.caseId,caseNumber:e.caseNumber,action:a})).done(function(){t.stopLoading(t.target,a.idProcess)})})}).fail(function(){t.notifier.showErrorMessage(printf(bizagi.localization.getResource("workportal-widget-sortbar-execute-error-message"),a.displayName)),t.stopLoading(t.target,a.idProcess)}))},clean:function(){var e=this.getContent();e&&$(".wdg-srcts-container",e).off("click")},startLoading:function(e,t){e.prepend('<div class="bz-wp-ls-list-item-loading"><div class="ui-bizagi-loading-icon"></div></div>'),this.requestsInProgressProcessGuid[t]=!0},stopLoading:function(e,t){e.find(".bz-wp-ls-list-item-loading").remove(),delete this.requestsInProgressProcessGuid[t]}}),bizagi.injector.register("bizagi.workportal.widgets.shortcuts",["workportalFacade","dataService","processActionService","accumulatedcontext","notifier",bizagi.workportal.widgets.shortcuts]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.right.sidebar",{},{init:function(e,t,i,a){(this.behaviorCollapsiblePanels=i,this._super(e,t,a),this.loadTemplates({"right-sidebar":bizagi.getTemplate("bizagi.workportal.desktop.widget.right.sidebar").concat("#rightsidebar-wrapper")}),null!==JSON.parse(localStorage.getItem("userpreferences")))&&("yes"===JSON.parse(localStorage.getItem("userpreferences")).collapseSidebars&&($("#ui-bizagi-wp-project-homeportal-main").addClass("ui-bizagi-wp-project-collapse-rightpanel"),$("#right-sidebar-wrapper").addClass("always-collpase")))},renderContent:function(){var e=this.getTemplate("right-sidebar");return this.content=e.render({}),this.content},postRender:function(){var e=this;e.params&&e.params.contextsRightSidebarCaseDashboard&&e.params.contextsRightSidebarCaseDashboard.forEach(function(t){e.sub(t,$.proxy(e.updateView,e))})},updateView:function(e,t){this.enableOrDisableRightSidebar(t.context),this.eventsHandler(),"ACTIVITY"!==t.context&&"ACTIVITYPLAN"!==t.context||this.addBottomPadding()},addBottomPadding:function(){$(".content-dashboard-right-sidebar .content-right-sidebar").css("padding-bottom","30px")},onCollapsePanel:function(e){var t=e?$(e.currentTarget):$("#project-collapse-rightpanel");this.behaviorCollapsiblePanels.addClassesCollapseSideBar(this.content,"-rightpanel",!1),t.closest(".ui-bizagi-wp-project-open-rightpanel").length>0&&this.pub("notify",{type:"EXPANDED_RIGHT_SIDEBAR"}),$("#right-sidebar-wrapper").removeClass("always-collpase"),this.publish("openCloseSidebar")},disableSidebar:function(){$("#ui-bizagi-wp-project-homeportal-main").addClass("disabled-right-sidebar"),$("#ui-bizagi-wp-project-homeportal-main").removeClass("enabled-right-sidebar")},enableSidebar:function(){$("#ui-bizagi-wp-project-homeportal-main").removeClass("disabled-right-sidebar"),$("#ui-bizagi-wp-project-homeportal-main").addClass("enabled-right-sidebar")},openRightSidebar:function(){$("#right-sidebar-wrapper").removeClass("always-collpase"),this.behaviorCollapsiblePanels.addClassesCollapseSideBar(this.content,"-rightpanel",!0)},closeRightSidebar:function(){this.behaviorCollapsiblePanels.collapseSideBar("-rightpanel")},enableOrDisableRightSidebar:function(e){var t=this,i=!1;t.params.contextsWithoutRightSidebarCaseDashboard.forEach(function(a){a===e&&(t.disableSidebar(),i=!0)}),!1===i&&t.enableSidebar()},eventsHandler:function(){var e=this;$(".ui-bizagi-wp-project-panel-collapse",e.content).off("click",$.proxy(e.onCollapsePanel,e)),$(".ui-bizagi-wp-project-panel-collapse",e.content).on("click",$.proxy(e.onCollapsePanel,e)),e.sub("OPEN_RIGHT_SIDEBAR",$.proxy(e.openRightSidebar,e)),e.sub("CLOSE_RIGHT_SIDEBAR",$.proxy(e.closeRightSidebar,e)),e.sub("DISABLED_RIGHT_SIDEBAR",$.proxy(e.disableSidebar,e)),e.sub("ENABLED_RIGHT_SIDEBAR",$.proxy(e.enableSidebar,e))},clean:function(){var e=this;e.params&&e.params.contextsRightSidebarCaseDashboard&&e.params.contextsRightSidebarCaseDashboard.forEach(function(t){e.unsub(t,$.proxy(e.updateView,e))}),$(".ui-bizagi-wp-project-panel-collapse",e.content).off("click",$.proxy(e.onCollapsePanel,e)),e.unsub("OPEN_RIGHT_SIDEBAR",$.proxy(e.openRightSidebar,e)),e.unsub("CLOSE_RIGHT_SIDEBAR",$.proxy(e.closeRightSidebar,e)),e.unsub("DISABLED_RIGHT_SIDEBAR",$.proxy(e.disableSidebar,e)),e.unsub("ENABLED_RIGHT_SIDEBAR",$.proxy(e.enableSidebar,e))}}),bizagi.injector.register("bizagi.workportal.widgets.right.sidebar",["workportalFacade","dataService","behaviorCollapsiblePanels",bizagi.workportal.widgets.right.sidebar],!0),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.left.sidebar",{},{init:function(e,t,i,a){(this._super(e,t,a),this.behaviorCollapsiblePanels=i,this.loadTemplates({"left-sidebar":bizagi.getTemplate("bizagi.workportal.desktop.widget.left.sidebar").concat("#leftsidebar-wrapper")}),null!==JSON.parse(localStorage.getItem("userpreferences")))&&("yes"===JSON.parse(localStorage.getItem("userpreferences")).collapseSidebars&&($("#ui-bizagi-wp-project-homeportal-main").addClass("ui-bizagi-wp-project-collapse-leftpanel"),$("#left-sidebar-wrapper").addClass("always-collpase")))},renderContent:function(){var e=this.getTemplate("left-sidebar");return this.content=e.render({}),this.content},postRender:function(){this.eventsHandler()},eventsHandler:function(){$(".ui-bizagi-wp-project-panel-collapse",this.content).on("click",$.proxy(this.onCollapsePanel,this))},onCollapsePanel:function(e){var t="project-collapse-rightpanel"===(e?$(e.currentTarget):$("#project-collapse-leftpanel")).prop("id")?"-rightpanel":"-leftpanel";this.behaviorCollapsiblePanels.addClassesCollapseSideBar(this.content,t,!1),$("#left-sidebar-wrapper").removeClass("always-collpase"),this.publish("openCloseSidebar")},clean:function(){$(".ui-bizagi-wp-project-panel-collapse",this.content).off("click",$.proxy(this.onCollapsePanel,this))}}),bizagi.injector.register("bizagi.workportal.widgets.left.sidebar",["workportalFacade","dataService","behaviorCollapsiblePanels",bizagi.workportal.widgets.left.sidebar],!0),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.dummy",{},{init:function(e,t,i){this._super(e,t,i)},renderContent:function(){return this.content=$("<div></div>"),this.content}}),bizagi.injector.register("bizagi.workportal.widgets.dummy",["workportalFacade","dataService",bizagi.workportal.widgets.dummy]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.sidebar",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({sidebar:bizagi.getTemplate("bizagi.workportal.desktop.widget.sidebar").concat("#sidebar-wrapper")})},renderContent:function(){var e=this.getTemplate("sidebar");return this.content=$(e.render({})),this.content},postRender:function(){}}),bizagi.injector.register("bizagi.workportal.widgets.sidebar",["workportalFacade","dataService",bizagi.workportal.widgets.sidebar],!0),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.admin.cases",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ASYNC},renderContent:function(){var e=this.getTemplate("admin.cases");return this.content=$.tmpl(e)}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.admin.caseSearch",{},{getWidgetName:function(){return bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_ADMIN_CASE_SEARCH},renderContent:function(){var e,t=this.getTemplate("admin.case.search");return e=this.content=$.tmpl(t,{}),this.loadtemplates(),e},loadtemplates:function(){}}),bizagi.workportal.widgets.admin.caseSearch.extend("bizagi.workportal.widgets.admin.caseSearch",{},{init:function(e,t,i){var a=this;a.adhocIds=[],a._super(e,t,i),a.selectedCaseAdmin=[],a.selectedWorkItemAdmin=[],a.columnsID={caseNumber:"I_radNumber",process:"I_wfClsDisplayName",task:"I_tskDisplayName",processCreationDate:"I_casCreationDate",taskDueDate:"I_wiEstimatedSolutionDate",processDueDate:"I_casSolutionDate",userName:"I_userName",userfullName:"I_fullName",userLocation:"I_locName"},a.loadTemplates({"admin.case.search":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search"),"admin.case.search.fields":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-fields"),"admin.case.search.button":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-buttons"),"admin.case.search.result":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-result"),"admin.case.search.pagination":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-pagination"),"admin.case.search.invalidate":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-invalidate"),"admin.case.search.reassign":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-reassign"),"admin.case.search.reassign.form":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-reassign-form"),"admin.case.search.action.result":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-action-result"),"admin.case.search.loader":bizagi.getTemplate("bizagi.workportal.desktop.widgets.admin.caseSearch").concat("#ui-bizagi-workportal-widget-admin-case-search-loader"),useNewEngine:!1})},loadtemplates:function(){var e=this;e.generalContentTmpl=e.getTemplate("admin.case.search"),e.fieldsContentTmpl=e.getTemplate("admin.case.search.fields"),e.buttonContentTmpl=e.getTemplate("admin.case.search.button"),e.resultContentTmpl=e.getTemplate("admin.case.search.result"),e.paginationTmpl=e.getTemplate("admin.case.search.pagination"),e.invalidateContentTmpl=e.getTemplate("admin.case.search.invalidate"),e.reassignContentTmpl=e.getTemplate("admin.case.search.reassign"),e.reassignFormTmpl=e.getTemplate("admin.case.search.reassign.form"),e.actionResultContentTmpl=e.getTemplate("admin.case.search.action.result"),e.loaderTmpl=e.getTemplate("admin.case.search.loader"),e.loader=$.tmpl(e.loaderTmpl,{})},postRender:function(){var e=this;e.defaultMaxRows=10,e.maxElemShow=e.defaultMaxRows,e.maxPageToShow=5,e.processNavigation=[],e.setupData()},showNotifier:function(){window.parent.bizagi.injector.get("notifier").showSucessMessage(bizagi.localization.getResource("workportal-widget-admincasesearch-invalidation-message"),"")},showConfirmationMessage:function(){var e=this;$.when(bizagi.showConfirmationBox(bizagi.localization.getResource("workportal-widget-admincasesearch-action-invalidation-confirmation"),bizagi.localization.getResource("workportal-general-word-information"),"info")).done(function(){e.showLoading(),e.invalidateSelectedCase(e.paramsToInvalidateSelectedCases())})},initPositionsCombo:function(){var e=this;$.when(e.dataService.getUserPositions()).done(function(t){var i={combo:[],id:"positions"};i.combo.push({id:"",name:"........."}),$.each(t.positions,function(e,t){i.combo.push({id:t.idPosition,name:t.displayName})}),e.renderPositionsCombo(i)}).fail(function(e){bizagi.log(e)})},renderPositionsCombo:function(e){var t=this.getContent(),i=$.Deferred(),a=$("#userPositionInput",t);return a.empty(),a.uicombo({isEditable:!1,data:e,itemValue:function(e){return e.id},itemText:function(e){return e.name},onComplete:function(){i.resolve()},onChange:function(e){var i=e.ui.data("value");$("#userPositionInput",t).val(i)},initValue:e.combo[0]}),i},setupData:function(){var e=this;e.setupInitialData(),e.setupDatePicker(),e.setupProcessTree(),e.setupCaseSecurity(),e.setupMainButtons(),e.initPositionsCombo()},setupInitialData:function(){var e,t=this,i=t.getContent();t.buttonBackAction="backToMainForm",t.selectedUserId="",t.selectedUserName="",t.selectedTasks="",t.selectedTasksToShow="",t.searchParams="",t.processTree="",t.processTreeDelete="",t.caseSecurity="",$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-subtitle")),$("#mainForm",i).remove(),$("#dinamicContent",i).remove(),$("#case-search-log-data-buttonset",i).remove(),e=$.tmpl(t.fieldsContentTmpl,{}),i.html(e),$("#cases-tabs",i).tabs({activate:function(e,a){"deleteCasesTab"===a.newTab[0].id?(t.isOut=!1,t.showLoading(),t.getProcessRunningInvalidateCases()&&($("#tree",i).hide(),$("#invalidateMessage",i).show())):(clearTimeout(t.timer),t.isOut=!0)}});var a=$("#cases-tabs-ul",i);$("#li-deleteCases",a).click(function(){$("#case-search-log-data-buttonset",i).hide()}),$("#li-case-search",a).click(function(){$("#case-search-log-data-buttonset",i).show()}),bizagiConfig.isProduction&&($("#deleteCases",i).remove(),$("#deleteCasesTab",i).remove())},setupDatePicker:function(){var e=this.getContent(),t=bizagi.localization.getResource("dateFormat").replaceAll("yyyy","yy").replaceAll("MM","mm");$(".biz-wp-form-datepicker",e).datepicker({controlType:"select",dateFormat:t})},setupProcessTree:function(){var e=this,t=e.getContent();bizagi.treeRoutSelected=[],$("#treeLinksId").remove();var i=$.extend({},e.params);i.svgIconsMode=!0,i.canvas=$("#processTree",t),e.processTree=new bizagi.workportal.widgets.processtree(e.workportalFacade,e.dataService,i),e.processTree.render().done(function(){var i=$.extend({},e.params);i.canvas=$("#processTreeDelete",t),i.svgIconsMode=!0,i.searchKeyResource="workportal-widget-admincasesearch-cancel-cases-for",i.newDesign=!0,e.processTreeDelete=new bizagi.workportal.widgets.processtree(e.workportalFacade,e.dataService,i),e.processTreeDelete.render()})},setupCaseSecurity:function(){var e=this,t=e.getContent();$("#treeLinksId").remove();var i=$.extend({},e.params);i.content=$("#caseSecurity",t),e.caseSecurity=new bizagi.workportal.widgets.admin.transfer.case.security.permissions(e.workportalFacade,e.dataService,i),e.caseSecurity.render()},setupUsersSearchForm:function(){var e=this,t=e.getContent(),i=$.Deferred();$("#biz-wp-users-table-form").html(""),e.usersTable=new bizagi.workportal.widgets.userstable(e.workportalFacade,e.dataService,$.extend(e.params,{canvas:$("#biz-wp-users-table-form",t),userLinkLabel:[bizagi.localization.getResource("workportal-widget-admincasesearch-reassign")],parentDef:i})),e.usersTable.render(),$.when(i).done(function(t,i){e.assignEventReassignLinks(t,i)})},findResults:function(e,t,i){var a=this;t.Page=i||1,$.when(a.dataService.getAdminCasesList(t)).done(function(i){if($(i.rows).each(function(e,t){t.isAdhocProcess||(t.isAdhocProcess=!1),t.isAdhocProcess&&a.adhocIds.push({caseId:t.idCase,processId:t.idAdhocProcess})}),$("#generalTitle").show(),$(".biz-wp-table").remove(),$(".case-search-action-wrapper").remove(),$("#biz-wp-table-summary-wrapper").remove(),a.totalRecords=i.records,a.totalPages=i.total,i.rows.length>0){a.showCasesSearchResultFrame(e,i),a.setupActionsButton(e);var r,o=a.maxPageToShow>a.totalPages?a.totalPages:a.maxPageToShow,n=$("#biz-wp-table-pager-wrapper"),s={};s.pagination=a.totalPages>1,s.page=i.page,s.pages={};for(var d=1;d<=o;d++)s.pages[d]={pageNumber:d};r=$.tmpl(a.paginationTmpl,s).html(),n.append(r),$("ul").bizagiPagination({maxElemShow:a.maxElemShow,totalPages:a.totalPages,actualPage:i.page,listElement:$("#biz-wp-table-pager-wrapper"),clickCallBack:function(i){a.findResults(e,t,i.page)}})}else bizagi.showMessageBox(bizagi.localization.getResource("workportal-widget-authentication-log-none"),bizagi.localization.getResource("workportal-general-word-information"),"warning")}).fail(function(e){bizagi.log(e)})},showCasesSearchResultFrame:function(e,t){var i=this,a=!!bizagi.override.disableAbortCases,r=i.preprocessResultList(t.headers,t),o=$.tmpl(i.resultContentTmpl,{headers:t.headers,rows:r,groupByCaseNumber:bizagiConfig.groupByCaseNumber,securityGraphicQuery:bizagi.menuSecurity.GraphicQuery,resultList:t},{getRadNumberColumnIndex:function(){for(var e=this.data,t=-1,i=0,a=e.headers.length;i<a;i++)"I_radNumber"==e.headers[i].fieldName&&(t=i);return t},showColumn:function(e){var t=this.getRadNumberColumnIndex();return this.data.groupByCaseNumber&&t==e?" hidden ":""},createGroupedHeader:function(e){var t=this.data.resultList,i=!1,a=this.getRadNumber(t.rows[e]);this.data.groupByCaseNumber&&(0==e?i=!0:a!=this.getRadNumber(t.rows[e-1])&&(i=!0));return i},getRadNumber:function(e){var t=this.getRadNumberColumnIndex();return t>=0?e.data[t]:""}}),n=$.tmpl(i.invalidateContentTmpl,{}),s=$.tmpl(i.reassignContentTmpl,{});$("#mainForm",e).hide(),$("#dinamicContent",e).html(o),a||$(".case-search-action-wrapper",e).append(n),$(".case-search-action-wrapper",e).append(s),$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-table-title")),$("#btn-admin-case-search-clear",e).hide(),$("#btn-admin-case-search",e).hide(),$("#btn-admin-case-back",e).css("display","inline"),i.setupActivitiesLink(e),i.setupGraphicQueryEvent(e),i.selectedItemsPersistence(e)},selectedItemsPersistence:function(e){var t="";$.each(this.selectedCaseAdmin,function(i,a){t="input:checkbox[name=CaseAdmin][value="+a+"]",$(t,e).prop("checked",!0)}),$.each(this.selectedWorkItemAdmin,function(i,a){t="input:checkbox[name=workItemAdmin][value='"+a+"']",$(t,e).prop("checked",!0)})},preprocessResultList:function(e,t){for(var i=[],a=t.rows.length,r=0;r<a;r++)i.push(this.processResultItem(e,t.rows[r]));return i},processResultItem:function(e,t){var i,a,r,o,n=this,s=t.data,d=t.idCase,c=t.idWorkFlow,l=t.radNumber,g=t.idParentCase,u=t.isSubprocess,p=[],m=[],h=[],b=-1,w=0,f=!1;for(m.push({id:"checkCaseAdmin",value:d,radNumber:l,idParentCase:g,isSubProcess:u});b++<e.length-1;)switch(e[b].fieldName){case n.columnsID.caseNumber:m.push({id:"caseNumber",value:{idCase:d,caseNumber:s[w]}}),w++;break;case n.columnsID.process:m.push({id:"idWorkItem",value:s[w]}),w++;break;case n.columnsID.userName:case n.columnsID.userfullName:case n.columnsID.task:case n.columnsID.taskDueDate:if(void 0===i){for(var v=s.length;v-- >0;)if(Array.isArray(s[v])){i=s[v],f=!0;break}w++}f?(r=i[0],n.columnsID.userName==e[b].fieldName?(m=m.concat(n.processTaskObjectUser(r)),-1==h.indexOf(n.columnsID.userName)&&h.push(n.columnsID.userName)):n.columnsID.userfullName==e[b].fieldName?(m=m.concat(n.processTaskObjectUser(r)),-1==h.indexOf(n.columnsID.userfullName)&&h.push(n.columnsID.userfullName)):n.columnsID.task==e[b].fieldName?(m=m.concat(n.processTaskObject(r,d)),-1==h.indexOf(n.columnsID.task)&&h.push(n.columnsID.task)):n.columnsID.taskDueDate==e[b].fieldName&&(m=m.concat(n.processTaskObjectDate(r)),-1==h.indexOf(n.columnsID.taskDueDate)&&h.push(n.columnsID.taskDueDate))):e[b].fieldName==n.columnsID.taskDueDate&&(m=m.concat({estimatedSolutionDate:s[b]}),-1==h.indexOf(n.columnsID.taskDueDate)&&h.push(n.columnsID.taskDueDate));break;case n.columnsID.processCreationDate:m.push({id:"processCreationDate",value:s[w]}),w++;break;case n.columnsID.processDueDate:m.push({id:"processDueDate",value:s[w]}),w++;break;default:var k=bizagi.util.formatValueByDataType(s[w],e[b].type);m.push({id:"customField",value:k}),w++}if(m.push({id:"viewProcess",value:{idCase:d,idworkflow:c}}),p.push({attr:"first_row",data:m}),(a=i?i.length:0)>1){o=h.length;for(var y=1;y<a;y++){var I=[];for(v=-1;v++<o-1;)h[v]==n.columnsID.task?I.push(n.processTaskObject(i[y],d)):h[v]==n.columnsID.taskDueDate?I.push(n.processTaskObjectDate(i[y])):h[v]==n.columnsID.userName?I.push(n.processTaskObjectUser(i[y])):h[v]==n.columnsID.userfullName&&I.push(n.processTaskObjectUser(i[y]));p.push({attr:"next_row",data:I})}}return{data:p,totalTask:a}},processTaskObject:function(e,t){var i={taskName:e.taskName,colorState:e.colorState,taskType:e.taskType,idCase:t,idWorkItem:e.idWorkItem,idTask:e.idTask};return"Wait"===e.taskType&&(i.skip=!0),i},processTaskObjectDate:function(e){var t={};return e.estimatedSolutionDate?t.estimatedSolutionDate=e.estimatedSolutionDate:t.estimatedSolutionDate="","Wait"===e.taskType&&(t.skip=!0),t},processTaskObjectUser:function(e){var t={};return e.assignee?t.userName=e.assignee:t.userName="",t},invalidateCases:function(e){var t=this,i="",a="",r={cases:[]};if($("input:checkbox[name=CaseAdmin]:checked",e).each(function(){var e=$(this).val();$(this).data("subprocess")&&(i=i+" "+$(this).data("parentcase")+","),r.cases.push({idCase:e})}),0==r.cases.length)bizagi.showMessageBox(bizagi.localization.getResource("workportal-widget-admincasesearch-invalidate-empty-msg"),bizagi.localization.getResource("workportal-general-word-information"),"warning");else{a=bizagi.util.isEmpty(i)?bizagi.localization.getResource("workportal-widget-admincasesearch-invalidate-confirm-msg"):bizagi.localization.getResource("workportal-widget-admincasesearch-invalidate-subprocess-confirm-msg")+i.substring(0,i.length-1);$.when(bizagi.showConfirmationBox(a,bizagi.localization.getResource("workportal-general-word-information"),"warning",null,{dialogClass:"widget-admincasesearch-invalidate-cases-confirm",width:400,minWidth:400})).done(function(){var i=$("#txtReason",e).val(),a={action:"abort",cases:JSON.stringify(r),reason:i};$.when(t.dataService.abortReassignItems(a)).done(function(i){t.showActionResultFrame(e,i.response,"invalidate")}).fail(function(e){bizagi.log(e)})})}},showReassignTasksFrame:function(e){var t={cases:[]},i=[];$.each(this.selectedWorkItemAdmin,function(e,a){a=a.split("|"),t.cases.push({idCase:a[0],idWorkItem:a[1]}),i.push({taskItem:a[0]+": "+a[2],idWorkItem:a[1]})}),0==i.length?bizagi.showMessageBox(bizagi.localization.getResource("workportal-widget-admincasesearch-reassign-empty-msg"),bizagi.localization.getResource("workportal-general-word-information"),"warning"):(this.selectedTasks=t,this.selectedTasksToShow=i,this.showReassignForm(e,i))},showReassignForm:function(e,t){this.buttonBackAction="backToCases";var i=$.tmpl(this.reassignFormTmpl,{tasks:t});$("#dinamicContent",e).hide(),$("#dinamicContent2",e).html(i),$("#btn-admin-case-search-clear",e).hide(),$("#btn-admin-case-search",e).hide(),$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-reassign-title")),this.setupUsersSearchForm()},reassignTasks:function(){var e=this,t=e.getContent(),i={action:"reassignItems",cases:JSON.stringify(e.selectedTasks),idNewUser:e.selectedUserId};$.when(e.dataService.abortReassignItems(i)).done(function(i){e.showActionResultFrame(t,i.response,"reassign")}).fail(function(e){bizagi.log(e)})},showActionResultFrame:function(e,t,i){var a=t.length>1?"-several":"",r="",o="",n=[];if("invalidate"==(a=i+a))for(var s=0;s<t.length;s++)1==t[s].deleted?(r=t[s].idCase,r+=s+1<t.length?", ":"",n[0]=!0):(o=t[s].idCase,o+=s+1<t.length?", ":"",n[1]=!1);else if("invalidate-several"==a)for(s=0;s<t.length;s++)1==t[s].deleted?(r+=t[s].idCase,r+=s+1<t.length?", ":"",n[0]=!0):(o+=t[s].idCase,o+=s+1<t.length?", ":"",n[1]=!1);else if("reassign"==a)for(s=0;s<t.length;s++)1==t[s].reassigned?(r+=t[s].idCase,r+=s+1<t.length?", ":"",n[0]=!0):(o=t[s].idCase,o+=s+1<t.length?", ":"",n[1]=!1);else if("reassign-several"==a){r+="<br/><br/>",o+="<br/><br/>";for(s=0;s<t.length;s++)1==t[s].reassigned?(r+=t[s].idCase+"<br/>",n[0]=!0):(o+=t[s].idCase+"<br/>",n[1]=!1);r+="<br/>",o+="<br/>"}var d=$.tmpl(this.actionResultContentTmpl,{action:a,resultStatus:n,exceptionMessage:o.substring(o.indexOf("|")+1)});d=d[0].innerHTML.replace("{0}","<strong>"+r+"</strong>");var c=o.substring(0,-1===o.indexOf("|")?void 0:o.indexOf("|"));d=(d=(d=d.replace("{3}","<strong>"+c+"</strong>")).replace("{1}",this.selectedUserName)).replace("{1}",this.selectedUserName),"invalidate"==i&&$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-invalidate-result-title")),$("#mainForm",e).html(""),$("#dinamicContent",e).css("display","inline"),$("#dinamicContent",e).html(d),$("#dinamicContent2",e).remove(),$("#usersTable",e).remove(),$("#btn-admin-case-back",e).css("display","none"),$("#btn-admin-case-search-clear",e).css("display","none"),$("#btn-admin-case-search",e).css("display","none"),$("#btn-admin-case-finish",e).css("display","inline")},setupMainButtons:function(){var e=this,t=e.getContent(),i=$.tmpl(e.buttonContentTmpl,{});t.append(i);var a=$("#case-search-log-data-buttonset",t);$("#btn-admin-case-search-clear",a).click(function(){$(".biz-wp-input-text",t).val(""),$(".biz-wp-form-datepicker",t).val(""),$("#userPositionInput",t).val(""),$("#userPositionInput",t).find(".biz-wp-combo-input").val("........."),e.setupProcessTree()}),$("#btn-admin-case-search",a).click(function(){var i="",a="",r="",o="",n="",s=e.processTree.getTreeRouteSelected();s.length>0&&(2==s.length?(i=s[1],r=s[0],a=""):(i=s[s.length-1],a="",r=s[0]));var d=parseInt($("#resultsNumber").val());bizagi.util.isNumeric(d)?e.maxElemShow=d:e.maxElemShow=e.defaultMaxRows;var c=$("#sinceDate");c=(c=c.datepicker("getDate"))?bizagi.util.dateFormatter.formatInvariant(c,!1):"";var l=$("#toDate");l=(l=l.datepicker("getDate"))?bizagi.util.dateFormatter.formatInvariant(l,!1):"";var g={h_action:"getCases",I_ProcessState:"Running",h_idApp:"",I_Users:"ALL",eventAsTask:!0,orderType:1,order:"",orderField:"",group:bizagiConfig.groupByCaseNumber?"T_RADNUMBER":null,I_radNumber:$.trim($("#caseInput").val()),I_idWFClass:r,I_USERNAME:$("#userNameInput").val(),I_USERFULLNAME:$("#userFullNameInput").val(),I_USERPOSITION:$("#userPositionInput").val(),I_From__CreationDate:c||$("#sinceDate").val(),I_To__CreationDate:l||$("#toDate").val(),h_idWFClassAuth:"",I_idCategory:a,I_idApplication:i,PageSize:e.maxElemShow};""==g.I_From__CreationDate||bizagi.util.isDate(g.I_From__CreationDate)?""==g.I_To__CreationDate||bizagi.util.isDate(g.I_To__CreationDate)?(e.searchParams=g,e.selectedCaseAdmin=[],e.selectedWorkItemAdmin=[],e.findResults(t,g)):(o=bizagi.localization.getResource("workportal-general-invalid-date"),n=bizagi.localization.getResource("workportal-widget-admincasesearch-to-date"),o=o.replace("{0}",n),bizagi.showMessageBox(o,bizagi.localization.getResource("workportal-general-word-information"),"warning")):(o=bizagi.localization.getResource("workportal-general-invalid-date"),n=bizagi.localization.getResource("workportal-widget-admincasesearch-date-since"),o=o.replace("{0}",n),bizagi.showMessageBox(o,bizagi.localization.getResource("workportal-general-word-information"),"warning"))}),$("#btn-admin-case-back",a).click(function(){"backToMainForm"==e.buttonBackAction?e.backToMainForm():"backToCases"==e.buttonBackAction&&e.backToCases()}),$("#btn-admin-case-finish",a).click(function(){e.setupData()}),$("#resultsNumber",t).bind("keypress",function(e){var t=e.charCode?e.charCode:e.keyCode;if(8!=t&&(t<48||t>57))return!1}),$("#btn-admin-cases-invalidate",t).click(function(){!1===$("#allAppsLinkSelected",t).data("allAppSelected")&&0===e.processTreeDelete.getTreeRouteSelected().length?bizagi.showMessageBox(bizagi.localization.getResource("workportal-widget-processTree-no-selected-process"),bizagi.localization.getResource("workportal-general-word-information"),"warning"):e.showConfirmationMessage(),$(e.loader).remove()})},getDateInvariantByControlIDSelector:function(e){var t="",i=$(e).datepicker("getDate");if(null!==i)try{t=bizagi.util.dateFormatter.formatInvariant(i,!1)}catch(i){t="",$(e).val("")}return t},backToCases:function(){var e=this.getContent();this.buttonBackAction="backToMainForm",$("#dinamicContent",e).show(),$("#dinamicContent2",e).html(""),$("#usersTable").remove(),$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-table-title")),$("#btn-admin-case-search-clear",e).hide(),$("#btn-admin-case-search",e).hide()},backToMainForm:function(){var e=this.getContent();$("#mainForm",e).show(),$("#dinamicContent",e).html(""),$("#generalTitle").html(bizagi.localization.getResource("workportal-widget-admincasesearch-subtitle")),$("#btn-admin-case-search-clear",e).show(),$("#btn-admin-case-search",e).show(),$("#btn-admin-case-back",e).css("display","none")},assignEventReassignLinks:function(e,t){this.selectedUserId=e,this.selectedUserName=t,this.reassignTasks()},setupActionsButton:function(e){var t=this;$("input:checkbox[name=CaseAdmin]",e).click(function(){var e=$(this).val();$(this).is(":checked")?t.selectedCaseAdmin.push(e):t.selectedCaseAdmin.splice($.inArray(e,t.selectedCaseAdmin),1)}),$("input:checkbox[name=workItemAdmin]",e).click(function(){var e=$(this).val();$(this).is(":checked")?t.selectedWorkItemAdmin.push(e):t.selectedWorkItemAdmin.splice($.inArray(e,t.selectedWorkItemAdmin),1)}),$("#btn-admin-case-invalidate",e).click(function(){t.invalidateCases(e)}),$("#btn-admin-case-reassign",e).click(function(){t.showReassignTasksFrame(e)})},setupActivitiesLink:function(e){var t=this;$(".activityClicked",e).click(function(){t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:$(this)[0].getAttribute("data-idCase"),idWorkItem:$(this)[0].getAttribute("data-idworkItem"),idTask:$(this)[0].getAttribute("data-idTask")}),t.publish("closeCurrentDialog")}),$(".caseClicked",e).click(function(){t.publish("executeAction",{action:bizagi.workportal.actions.action.BIZAGI_WORKPORTAL_ACTION_ROUTING,idCase:$(this)[0].getAttribute("data-idCase"),idWorkItem:"",idTask:""}),t.publish("closeCurrentDialog")}),$(".cases-column-header",e).click(function(){var i=$(this)[0].getAttribute("data-columnorder"),a=$(this)[0].getAttribute("data-ordertype"),r=$(this)[0].getAttribute("data-columnOrderName");a="1"==a?0:1,t.searchParams.order=i,t.searchParams.orderType=a,t.searchParams.orderField=r,t.findResults(e,t.searchParams,t.searchParams.Page)})},setupGraphicQueryEvent:function(e){var t=this;$(".biz-wp-diagram-view-icon",e).click(function(){for(var e=$(this).data("idcase"),i=$(this).data("idworkflow"),a=!1,r=null,o=0;o<t.adhocIds.length;o++)parseInt(e)==t.adhocIds[o].caseId&&(a=!0,r=t.adhocIds[o].processId);a?t.showGraphicQuery({idCase:e,idWorkflow:i,isAdhoc:a,idProcess:r}):t.showGraphicQuery({idCase:e,idWorkflow:i})})},paramsToInvalidateSelectedCases:function(){var e=this.processTreeDelete.getTreeRouteSelected(),t="",i="";return e.length>0&&(2==e.length?(t=e[1],i=e[0]):(t=e[e.length-1],i=e[0])),{idProcess:i,idApplication:t}},invalidateSelectedCase:function(e){var t=this;$.when(t.dataService.postAdminInvalidateCase(e)).done(function(){t.last_showSuccessToastInvalidate=!0,t.getProcessRunningInvalidateCases()}).fail(function(e){bizagi.showMessageBox(bizagi.localization.getResource("workportal-widget-admin-transfers-case-security-permissions-assign-fail"),bizagi.localization.getResource("workportal-general-word-information"),"warning"),bizagi.log(e)})},getProcessRunningInvalidateCases:function(){var e=this;return e.resp=!1,$.when(e.dataService.getResponseProcessRunningInvalidateCases()).done(function(t){var i=e.getContent();if("InProgress"===t.status){var a=e;a.isOut?e.resp=!1:($("#btn-admin-cases-invalidate").fadeOut(10),$("#invalidateMessage",i).fadeIn(10),$("#tree",i).fadeOut(10),e.timer=setTimeout(function(){a.getProcessRunningInvalidateCases()},1e4))}else $("#btn-admin-cases-invalidate").fadeIn(10),$("#tree",i).fadeIn(10),$("#invalidateMessage",i).fadeOut(10),e.resp=!1,!0===e.last_showSuccessToastInvalidate&&e.showNotifier();e.isOut?$(e.loader).remove():(e.last_showSuccessToastInvalidate=!1,"InProgress"===t.status&&(e.last_showSuccessToastInvalidate=!0),e.endLoading())}).fail(function(t){var i=e.getContent();bizagi.showMessageBox(bizagi.localization.getResource("workportal-widget-admin-transfers-case-security-permissions-assign-fail"),bizagi.localization.getResource("workportal-general-word-information"),"warning"),$("#btn-admin-cases-invalidate").fadeIn(10),$("#tree",i).fadeIn(10),$("#invalidateMessage",i).fadeOut(10),e.resp=!1,e.endLoading(),bizagi.log(t)}),e.resp},showLoading:function(){var e=this.getContent();$("#deleteCasesWrapper",e).fadeOut(10),$("#case-search-log-data-buttonset",e).fadeOut(10),$("#deleteCases",e).append(this.loader)},endLoading:function(){var e=this.getContent();$("#deleteCasesWrapper",e).fadeIn(10),$("#case-search-log-data-buttonset",e).fadeIn(10),$(this.loader).remove()},dispose:function(){clearTimeout(this.timer)}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.adhoc.create.process",{},{init:function(e,t,i){this.notifier=bizagi.injector.get("notifier"),this.notifier=bizagi.injector.get("notifier"),this._super(e,t,i),this.loadTemplates({"adhoc.create.process":bizagi.getTemplate("bizagi.workportal.desktop.widgets.adhoc.create.process").concat("#adhoc-create-process")})},renderContent:function(){var e=this.getTemplate("adhoc.create.process");return this.content=e.render(),this.content},postRender:function(){this.addEventHandlers()},validateForm:function(){var e=!1,t=$(".js-input-name",this.content);if(t.val()&&""!==t.val())t.next().find("span").html(""),e=!0;else{var i=bizagi.localization.getResource("workportal-general-error-field-required");i=i.replace("{0}",bizagi.localization.getResource("workportal-widget-admin-adhoc-processes-name")),t.next().find("span").html(i),e=!1}return e},onClickCancel:function(){this.publish("closeCurrentDialog")},onSubmitFormCreateProcess:function(e){e.preventDefault();var t=this;if(t.validateForm()){var i={displayName:$("input",t.content).val()};bizagi.showErrorAlertDialog=!1,$.when(t.dataService.createNewAdhocProcess(i)).done(function(e){t.notifier.showSucessMessage(bizagi.localization.getResource("workportal-adhoc-process-created"),bizagi.localization.getResource("workportal-quickprocess-notification-process-title"),""),t.publish("closeCurrentDialog"),bizagi.util.isIE11OrLower()?t.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY}):t.publish("changeWidget",{widgetName:bizagi.workportal.widgets.widget.BIZAGI_WORKPORTAL_WIDGET_PROFLY,data:{route:"process-modeler",params:e}})}).fail(function(e){e=JSON.parse(e.responseText),t.notifier.showErrorMessage(e.message,bizagi.localization.getResource("workportal-quickprocess-notification-generic-error-title"),"")})}},addEventHandlers:function(){var e=this;$(".js-input-name",e.content).on("input",$.proxy(e.validateForm,e)),$("#button-cancel-create-adhoc-process",e.content).on("click",$.proxy(e.onClickCancel,e)),$("form",e.content).on("submit",$.proxy(e.onSubmitFormCreateProcess,e))},dispose:function(){var e=this;$(".js-input-name",e.content).off("input",$.proxy(e.validateForm,e)),$("#button-cancel-create-adhoc-process",e.content).off("click",$.proxy(e.onClickCancel,e)),$("form",e.content).off("submit",$.proxy(e.onSubmitFormCreateProcess,e))}}),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.profly",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({"project-filespreview-wrapper":bizagi.getTemplate("bizagi.workportal.desktop.widget.profly").concat("#project-filespreview-wrapper")})},renderContent:function(){var e=this,t={paramsURL:""};e.params.data&&e.params.data.route&&e.params.data.params.id&&(t.paramsURL=encodeURI("?route="+e.params.data.route+"&id="+e.params.data.params.id+"&displayName="+e.params.data.params.displayName)),e.params.data&&e.params.data.route&&e.params.data.params.module&&(t.paramsURL=encodeURI("?route="+e.params.data.route+"&module="+e.params.data.params.module));var i=e.getTemplate("project-filespreview-wrapper");return e.content=i.render(t),bizagi.util.isIE11OrLower()&&(localStorage.setItem("params_profly",t.paramsURL),$(e.content).css({width:"0px",height:"0px"}),$.when(e.reloadToDashboardWhenLoadIFrame()).done(function(){$(e.content).css("width","100%").css("height","100%")})),bizagi.util.isChrome()&&$(e.content).on("load",function(e){-1===e.currentTarget.contentWindow.location.href.indexOf("quickprocess")&&location.reload()}),e.content},reloadToDashboardWhenLoadIFrame:function(){var e=$.Deferred();return function t(){document.getElementById("iframe-liveprocesses")&&void 0!==document.getElementById("iframe-liveprocesses").contentDocument?(document.getElementById("iframe-liveprocesses").contentDocument.location="./jquery/quickprocess/dist/",setTimeout(function(){e.resolve()},1e3)):setTimeout(t,50)}(),e.promise()},postRender:function(){},clean:function(){var e=this;$("#iframe-liveprocesses",e.content).off(),e.plugins={},e.form={},e.currentFile={},e.filesNumber=0}}),bizagi.injector.register("bizagi.workportal.widgets.profly",["workportalFacade","dataService",bizagi.workportal.widgets.profly]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.sessionTimeout",{},{init:function(e,t,i,a){this._super(e,t,a),this.loadTemplates({"session-timeout":bizagi.getTemplate("bizagi.workportal.desktop.widget.sessionTimeout").concat("#session-timeout")}),this.sessionTimeoutService=bizagi.injector.get("sessionTimeOutService")},renderContent:function(){var e=this.getTemplate("session-timeout");return this.content=e.render({}),this.content},postRender:function(){var e=this;e._onClickMinValue,$("button",e.content).click($.proxy(function(){e.sessionTimeoutService.keepSessionOpen(),$(this.content).closest(".ui-dialog").find(".ui-dialog-titlebar-close").trigger("click")},e)),e.renderingDeferred.then($.proxy(e.removeXClose,e))},removeXClose:function(){var e=this;setTimeout(function(){$(e.content).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide()},0)},clean:function(){}}),bizagi.injector.register("bizagi.workportal.widgets.sessionTimeout",["workportalFacade","dataService","notifier",bizagi.workportal.widgets.sessionTimeout]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.sessionTimeoutExpired",{},{init:function(e,t,i,a){this._super(e,t,a),this.loadTemplates({"session-timeout-expired":bizagi.getTemplate("bizagi.workportal.desktop.widget.sessionTimeoutExpired").concat("#session-timeout-expired")})},renderContent:function(){var e=this.getTemplate("session-timeout-expired");return this.content=e.render({}),this.content},postRender:function(){var e=this;e._onClickMinValue,$("button",e.content).click(function(){bizagi.services.redirectToLogoutPage()}),e.renderingDeferred.then($.proxy(e.removeXClose,e))},removeXClose:function(){var e=this;setTimeout(function(){$(e.content).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide()},0)},clean:function(){}}),bizagi.injector.register("bizagi.workportal.widgets.sessionTimeoutExpired",["workportalFacade","dataService","notifier",bizagi.workportal.widgets.sessionTimeoutExpired]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.user.privacy",{},{init:function(e,t,i,a){this._super(e,t,a),this.notifier=i,this.loadTemplates({"user-privacy":bizagi.getTemplate("bizagi.workportal.desktop.widget.user.privacy").concat("#user-privacy")})},renderContent:function(){var e=this.getTemplate("user-privacy");return this.content=e.render({}),this.content},postRender:function(){$("#js-btn-downloadReport",this.content).on("click",$.proxy(this.onDownloadReport,this))},onDownloadReport:function(){this.dataService.downloadReportUser(bizagi.currentUser.idUser)},clean:function(){$("#js-btn-downloadReport",this.content).off()}}),bizagi.injector.register("bizagi.workportal.widgets.user.privacy",["workportalFacade","dataService","notifier",bizagi.workportal.widgets.user.privacy]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.users.modal",{},{init:function(e,t,i){this.usuarios=i.data,this._super(e,t,i),this.loadTemplates({"users-modal":bizagi.getTemplate("bizagi.workportal.desktop.widgets.users.modal").concat("#users-modal")})},renderContent:function(){var e=this,t=e.getTemplate("users-modal");return e.content=t.render({usuarios:e.usuarios}),e.clickArrow(e.content),e.content},postRender:function(){},clean:function(){},clickArrow:function(e){$(".expand__arrow",e).click(function(e){var t=$(this).parent().parent();"none"==$(".users_collapse",t).css("display")?($(this).addClass("expand__arrow--active"),$(".users_collapse",t).show()):($(this).removeClass("expand__arrow--active"),$(".users_collapse",t).hide())})}}),bizagi.injector.register("bizagi.workportal.widgets.users.modal",["workportalFacade","dataService",bizagi.workportal.widgets.users.modal]),bizagi.workportal.widgets.widget.extend("bizagi.workportal.widgets.accessDenied",{},{init:function(e,t,i){this._super(e,t,i),this.loadTemplates({"access-denied":bizagi.getTemplate("bizagi.workportal.desktop.widget.accessDenied").concat("#access-denied")})},renderContent:function(){var e=this.getTemplate("access-denied");return this.content=e.render({}),this.content}}),bizagi.injector.register("bizagi.workportal.widgets.accessDenied",["workportalFacade","dataService",bizagi.workportal.widgets.accessDenied]),function(e,t,i){var a,r="JSGrid",o="JSGridItem",n="JSGridEditRow",s="asc",d=function(e,i){return t.isFunction(e)?e.apply(i,t.makeArray(arguments).slice(2)):e},c={loadData:t.noop,insertItem:t.noop,updateItem:t.noop,deleteItem:t.noop};function l(e,i){var a=t(e);a.data(r,this),this._container=a,this.data=[],this.fields=[],this._editingRow=null,this._sortField=null,this._sortOrder=s,this._firstDisplayingPage=1,this._init(i),this.render()}l.prototype={width:"auto",height:"auto",updateOnResize:!0,rowClass:t.noop,rowRenderer:null,rowClick:function(e){this.editing&&this.editItem(t(e.event.target).closest("tr"))},rowDoubleClick:t.noop,noDataContent:"Not found",noDataRowClass:"jsgrid-nodata-row",heading:!0,headerRowRenderer:null,headerRowClass:"jsgrid-header-row",headerCellClass:"jsgrid-header-cell",filtering:!1,filterRowRenderer:null,filterRowClass:"jsgrid-filter-row",inserting:!1,insertRowRenderer:null,insertRowClass:"jsgrid-insert-row",editing:!1,editRowRenderer:null,editRowClass:"jsgrid-edit-row",confirmDeleting:!0,deleteConfirm:"Are you sure?",selecting:!0,selectedRowClass:"jsgrid-selected-row",oddRowClass:"jsgrid-row",evenRowClass:"jsgrid-alt-row",cellClass:"jsgrid-cell",sorting:!1,sortableClass:"jsgrid-header-sortable",sortAscClass:"jsgrid-header-sort jsgrid-header-sort-asc",sortDescClass:"jsgrid-header-sort jsgrid-header-sort-desc",paging:!1,pagerContainer:null,pageIndex:1,pageSize:20,pageButtonCount:15,pagerFormat:"Pages: {first} {prev} {pages} {next} {last} &nbsp;&nbsp; {pageIndex} of {pageCount}",pagePrevText:"Prev",pageNextText:"Next",pageFirstText:"First",pageLastText:"Last",pageNavigatorNextText:"...",pageNavigatorPrevText:"...",pagerContainerClass:"jsgrid-pager-container",pagerClass:"jsgrid-pager",pagerNavButtonClass:"jsgrid-pager-nav-button",pagerNavButtonInactiveClass:"jsgrid-pager-nav-inactive-button",pageClass:"jsgrid-pager-page",currentPageClass:"jsgrid-pager-current-page",customLoading:!1,pageLoading:!1,autoload:!1,controller:c,loadIndication:!0,loadIndicationDelay:500,loadMessage:"Please, wait...",loadShading:!0,invalidMessage:"Invalid data entered!",invalidNotify:function(i){var a=t.map(i.errors,function(e){return e.message||null});e.alert([this.invalidMessage].concat(a).join("\n"))},onInit:t.noop,onRefreshing:t.noop,onRefreshed:t.noop,onPageChanged:t.noop,onItemDeleting:t.noop,onItemDeleted:t.noop,onItemInserting:t.noop,onItemInserted:t.noop,onItemEditing:t.noop,onItemUpdating:t.noop,onItemUpdated:t.noop,onItemInvalid:t.noop,onDataLoading:t.noop,onDataLoaded:t.noop,onOptionChanging:t.noop,onOptionChanged:t.noop,onError:t.noop,invalidClass:"jsgrid-invalid",containerClass:"jsgrid",tableClass:"jsgrid-table",gridHeaderClass:"jsgrid-grid-header",gridBodyClass:"jsgrid-grid-body",_init:function(e){t.extend(this,e),this._initLoadStrategy(),this._initController(),this._initFields(),this._attachWindowLoadResize(),this._attachWindowResizeCallback(),this._callEventHandler(this.onInit)},loadStrategy:function(){return this.pageLoading?new jsGrid.loadStrategies.PageLoadingStrategy(this):new jsGrid.loadStrategies.DirectLoadingStrategy(this)},_initLoadStrategy:function(){this._loadStrategy=d(this.loadStrategy,this)},_initController:function(){this._controller=t.extend({},c,d(this.controller,this))},renderTemplate:function(e,t,a){for(var r in args=[],a)args.push(a[r]);return args.unshift(e,t),(e=d.apply(null,args))===i||null===e?"":e},loadIndicator:function(e){return new jsGrid.LoadIndicator(e)},validation:function(e){return jsGrid.Validation&&new jsGrid.Validation(e)},_initFields:function(){var e=this;e.fields=t.map(e.fields,function(i){t.isPlainObject(i)&&(i=new(i.type&&jsGrid.fields[i.type]||jsGrid.Field)(i));return i._grid=e,i})},_attachWindowLoadResize:function(){t(e).on("load",t.proxy(this._refreshSize,this))},_attachWindowResizeCallback:function(){this.updateOnResize&&t(e).on("resize",t.proxy(this._refreshSize,this))},_detachWindowResizeCallback:function(){t(e).off("resize",this._refreshSize)},option:function(e,t){var i,a;if(1===arguments.length)return this[e];i={option:e,oldValue:this[e],newValue:t},this._callEventHandler(this.onOptionChanging,i),this._handleOptionChange(i.option,i.newValue),a={option:i.option,value:i.newValue},this._callEventHandler(this.onOptionChanged,a)},fieldOption:function(e,t,i){if(e=this._normalizeField(e),2===arguments.length)return e[t];e[t]=i,this._renderGrid()},_handleOptionChange:function(e,t){switch(this[e]=t,e){case"width":case"height":this._refreshSize();break;case"rowClass":case"rowRenderer":case"rowClick":case"rowDoubleClick":case"noDataRowClass":case"noDataContent":case"selecting":case"selectedRowClass":case"oddRowClass":case"evenRowClass":this._refreshContent();break;case"pageButtonCount":case"pagerFormat":case"pagePrevText":case"pageNextText":case"pageFirstText":case"pageLastText":case"pageNavigatorNextText":case"pageNavigatorPrevText":case"pagerClass":case"pagerNavButtonClass":case"pageClass":case"currentPageClass":case"pagerRenderer":this._refreshPager();break;case"fields":this._initFields(),this.render();break;case"data":case"editing":case"heading":case"filtering":case"inserting":case"paging":this.refresh();break;case"loadStrategy":case"pageLoading":this._initLoadStrategy(),this.search();break;case"pageIndex":this.openPage(t);break;case"pageSize":this.refresh(),this.search();break;case"editRowRenderer":case"editRowClass":this.cancelEdit();break;case"updateOnResize":this._detachWindowResizeCallback(),this._attachWindowResizeCallback();break;case"invalidNotify":case"invalidMessage":break;default:this.render()}},destroy:function(){this._detachWindowResizeCallback(),this._clear(),this._container.removeData(r)},render:function(){return this._renderGrid(),this.autoload?this.loadData():t.Deferred().resolve().promise()},_renderGrid:function(){this._clear(),this._container.addClass(this.containerClass).css("position","relative").append(this._createHeader()).append(this._createBody()),this._pagerContainer=this._createPagerContainer(),this._loadIndicator=this._createLoadIndicator(),this._validation=this._createValidation(),this.refresh()},_createLoadIndicator:function(){return d(this.loadIndicator,this,{message:this.loadMessage,shading:this.loadShading,container:this._container})},_createValidation:function(){return d(this.validation,this)},_clear:function(){this.cancelEdit(),clearTimeout(this._loadingTimer),this._pagerContainer&&this._pagerContainer.empty(),this._container.empty().css({position:"",width:"",height:""})},_createHeader:function(){var e=this._headerRow=this._createHeaderRow(),i=this._filterRow=this._createFilterRow(),a=this._insertRow=this._createInsertRow(),r=this._headerGrid=t("<table>").addClass(this.tableClass).append(e).append(i).append(a);return this._header=t("<div>").addClass(this.gridHeaderClass).addClass(this._scrollBarWidth()?"jsgrid-header-scrollbar":"").append(r)},_createBody:function(){var e=this._content=t("<tbody>"),i=this._bodyGrid=t("<table>").addClass(this.tableClass).append(e);return this._body=t("<div>").addClass(this.gridBodyClass).append(i).on("scroll",t.proxy(function(e){this._header.scrollLeft(e.target.scrollLeft)},this))},_createPagerContainer:function(){var e=this.pagerContainer||t("<div>").appendTo(this._container);return t(e).addClass(this.pagerContainerClass)},_eachField:function(e){var i=this;t.each(this.fields,function(t,a){a.visible&&e.call(i,a,t)})},_createHeaderRow:function(){if(t.isFunction(this.headerRowRenderer))return t(this.renderTemplate(this.headerRowRenderer,this));var e=t("<tr>").addClass(this.headerRowClass);return this._eachField(function(i,a){var r=this._prepareCell("<th>",i,"headercss",this.headerCellClass).append(this.renderTemplate(i.headerTemplate,i)).appendTo(e);this.sorting&&i.sorting&&r.addClass(this.sortableClass).on("click",t.proxy(function(){this.sort(a)},this))}),e},_prepareCell:function(e,i,a,r){return t(e).css("width",i.width).addClass(r||this.cellClass).addClass(a&&i[a]||i.css).addClass(i.align?"jsgrid-align-"+i.align:"")},_createFilterRow:function(){if(t.isFunction(this.filterRowRenderer))return t(this.renderTemplate(this.filterRowRenderer,this));var e=t("<tr>").addClass(this.filterRowClass);return this._eachField(function(t){this._prepareCell("<td>",t,"filtercss").append(this.renderTemplate(t.filterTemplate,t)).appendTo(e)}),e},_createInsertRow:function(){if(t.isFunction(this.insertRowRenderer))return t(this.renderTemplate(this.insertRowRenderer,this));var e=t("<tr>").addClass(this.insertRowClass);return this._eachField(function(t){this._prepareCell("<td>",t,"insertcss").append(this.renderTemplate(t.insertTemplate,t)).appendTo(e)}),e},_callEventHandler:function(e,i){return e.call(this,t.extend(i,{grid:this})),i},reset:function(){return this._resetSorting(),this._resetPager(),this._loadStrategy.reset()},_resetPager:function(){this._firstDisplayingPage=1,this._setPage(1)},_resetSorting:function(){this._sortField=null,this._sortOrder=s,this._clearSortingCss()},refresh:function(){this._callEventHandler(this.onRefreshing),this.cancelEdit(),this._refreshHeading(),this._refreshFiltering(),this._refreshInserting(),this._refreshContent(),this._refreshPager(),this._refreshSize(),this._callEventHandler(this.onRefreshed)},_refreshHeading:function(){this._headerRow.toggle(this.heading)},_refreshFiltering:function(){this._filterRow.toggle(this.filtering)},_refreshInserting:function(){this._insertRow.toggle(this.inserting)},_refreshContent:function(){var e=this._content;if(e.empty(),!this.data.length)return e.append(this._createNoDataRow()),this;for(var t=this._loadStrategy.firstDisplayIndex(),i=this._loadStrategy.lastDisplayIndex(),a=t;a<i;a++){var r=this.data[a];e.append(this._createRow(r,a))}},_createNoDataRow:function(){var e=0;return this._eachField(function(){e++}),t("<tr>").addClass(this.noDataRowClass).append(t("<td>").attr("colspan",e).append(this.renderTemplate(this.noDataContent,this)))},_createRow:function(e,i){var a;return t.isFunction(this.rowRenderer)?a=this.renderTemplate(this.rowRenderer,this,{item:e,itemIndex:i}):(a=t("<tr>"),this._renderCells(a,e)),a.addClass(this._getRowClasses(e,i)).data(o,e).on("click",t.proxy(function(t){this.rowClick({item:e,itemIndex:i,event:t})},this)).on("dblclick",t.proxy(function(t){this.rowDoubleClick({item:e,itemIndex:i,event:t})},this)),this.selecting&&this._attachRowHover(a),a},_getRowClasses:function(e,t){var i=[];return i.push((t+1)%2?this.oddRowClass:this.evenRowClass),i.push(d(this.rowClass,this,e,t)),i.join(" ")},_attachRowHover:function(e){var i=this.selectedRowClass;e.hover(function(){t(this).addClass(i)},function(){t(this).removeClass(i)})},_renderCells:function(e,t){return this._eachField(function(i){e.append(this._createCell(t,i))}),this},_createCell:function(e,i){var a,r=this._getItemFieldValue(e,i),o={value:r,item:e};return a=t.isFunction(i.cellRenderer)?this.renderTemplate(i.cellRenderer,i,o):t("<td>").append(this.renderTemplate(i.itemTemplate||r,i,o)),this._prepareCell(a,i)},_getItemFieldValue:function(e,t){for(var i=t.name.split("."),a=e[i.shift()];a&&i.length;)a=a[i.shift()];return a},_setItemFieldValue:function(e,t,i){for(var a=t.name.split("."),r=e,o=a[0];r&&a.length;)r=(e=r)[o=a.shift()];if(!r)for(;a.length;)e=e[o]={},o=a.shift();e[o]=i},sort:function(e,i){return t.isPlainObject(e)&&(i=e.order,e=e.field),this._clearSortingCss(),this._setSortingParams(e,i),this._setSortingCss(),this._loadStrategy.sort()},_clearSortingCss:function(){this._headerRow.find("th").removeClass(this.sortAscClass).removeClass(this.sortDescClass)},_setSortingParams:function(e,t){e=this._normalizeField(e),t=t||(this._sortField===e?this._reversedSortOrder(this._sortOrder):s),this._sortField=e,this._sortOrder=t},_normalizeField:function(e){return t.isNumeric(e)?this.fields[e]:"string"==typeof e?t.grep(this.fields,function(t){return t.name===e})[0]:e},_reversedSortOrder:function(e){return e===s?"desc":s},_setSortingCss:function(){var e=this._visibleFieldIndex(this._sortField);this._headerRow.find("th").eq(e).addClass(this._sortOrder===s?this.sortAscClass:this.sortDescClass)},_visibleFieldIndex:function(e){return t.inArray(e,t.grep(this.fields,function(e){return e.visible}))},_sortData:function(){var e=this._sortFactor(),t=this._sortField;t&&this.data.sort(function(i,a){return e*t.sortingFunc(i[t.name],a[t.name])})},_sortFactor:function(){return this._sortOrder===s?1:-1},_itemsCount:function(){return this._loadStrategy.itemsCount()},_pagesCount:function(){var e=this._itemsCount(),t=this.pageSize;return Math.floor(e/t)+(e%t?1:0)},_refreshPager:function(){var e=this._pagerContainer;e.empty(),this.paging&&e.append(this._createPager());var t=this.paging&&this._pagesCount()>1;e.toggle(t)},_createPager:function(){var e;return(e=t.isFunction(this.pagerRenderer)?t(this.pagerRenderer({pageIndex:this.pageIndex,pageCount:this._pagesCount()})):t("<div>").append(this._createPagerByFormat())).addClass(this.pagerClass),e},_createPagerByFormat:function(){var e=this.pageIndex,i=this._pagesCount(),a=this._itemsCount(),r=this.pagerFormat.split(" ");return t.map(r,t.proxy(function(r){var o=r;return"{pages}"===r?o=this._createPages():"{first}"===r?o=this._createPagerNavButton(this.pageFirstText,1,e>1):"{prev}"===r?o=this._createPagerNavButton(this.pagePrevText,e-1,e>1):"{next}"===r?o=this._createPagerNavButton(this.pageNextText,e+1,e<i):"{last}"===r?o=this._createPagerNavButton(this.pageLastText,i,e<i):"{pageIndex}"===r?o=e:"{pageCount}"===r?o=i:"{itemCount}"===r&&(o=a),t.isArray(o)?o.concat([" "]):[o," "]},this))},_createPages:function(){var e=this._pagesCount(),t=this.pageButtonCount,i=this._firstDisplayingPage,a=[];i>1&&a.push(this._createPagerPageNavButton(this.pageNavigatorPrevText,this.showPrevPages));for(var r=0,o=i;r<t&&o<=e;r++,o++)a.push(o===this.pageIndex?this._createPagerCurrentPage():this._createPagerPage(o));return i+t-1<e&&a.push(this._createPagerPageNavButton(this.pageNavigatorNextText,this.showNextPages)),a},_createPagerNavButton:function(e,i,a){return this._createPagerButton(e,this.pagerNavButtonClass+(a?"":" "+this.pagerNavButtonInactiveClass),a?function(){this.openPage(i)}:t.noop)},_createPagerPageNavButton:function(e,t){return this._createPagerButton(e,this.pagerNavButtonClass,t)},_createPagerPage:function(e){return this._createPagerButton(e,this.pageClass,function(){this.openPage(e)})},_createPagerButton:function(e,i,a){var r=t("<a>").attr("href","javascript:void(0);").html(e).on("click",t.proxy(a,this));return t("<span>").addClass(i).append(r)},_createPagerCurrentPage:function(){return t("<span>").addClass(this.pageClass).addClass(this.currentPageClass).text(this.pageIndex)},_refreshSize:function(){this._refreshHeight(),this._refreshWidth()},_refreshWidth:function(){var e=this._headerGrid,t=this._bodyGrid,i=this.width;"auto"===i&&(e.width("auto"),i=e.outerWidth()),e.width(""),t.width(""),this._container.width(i),i=e.outerWidth(),t.width(i)},_scrollBarWidth:function(){if(a===i){var e=t("<div style='width:50px;height:50px;overflow:hidden;position:absolute;top:-10000px;left:-10000px;'></div>"),r=t("<div style='height:100px;'></div>");e.append(r).appendTo("body");var o=r.innerWidth();e.css("overflow-y","auto");var n=r.innerWidth();e.remove(),a=o-n}return a},_refreshHeight:function(){var e,t=this._container,i=this._pagerContainer,a=this.height;t.height(a),"auto"!==a&&(a=t.height(),e=this._header.outerHeight(!0),i.parents(t).length&&(e+=i.outerHeight(!0)),0===e&&(e=41,"none"!==i.style("display")&&(e+=29)),this._body.outerHeight(a-e))},showPrevPages:function(){var e=this._firstDisplayingPage,t=this.pageButtonCount;this._firstDisplayingPage=e>t?e-t:1,this._refreshPager()},showNextPages:function(){var e=this._firstDisplayingPage,t=this.pageButtonCount,i=this._pagesCount();this._firstDisplayingPage=e+2*t>i?i-t+1:e+t,this._refreshPager()},openPage:function(e){e<1||e>this._pagesCount()||(this._setPage(e),this._loadStrategy.openPage(e))},_setPage:function(e){var t=this._firstDisplayingPage,i=this.pageButtonCount;this.pageIndex=e,e<t&&(this._firstDisplayingPage=e),e>t+i-1&&(this._firstDisplayingPage=e-i+1),this._callEventHandler(this.onPageChanged,{pageIndex:e})},_controllerCall:function(e,i,a,r){if(a)return t.Deferred().reject().promise();this._showLoading();var o,n,s=this._controller;if(!s||!s[e])throw Error("controller has no method '"+e+"'");return(o=s[e](i),n=t.Deferred(),o&&o.then?o.then(function(){n.resolve.apply(n,arguments)},function(){n.reject.apply(n,arguments)}):n.resolve(o),n.promise()).done(t.proxy(r,this)).fail(t.proxy(this._errorHandler,this)).always(t.proxy(this._hideLoading,this))},_errorHandler:function(){this._callEventHandler(this.onError,{args:t.makeArray(arguments)})},_showLoading:function(){this.loadIndication&&(clearTimeout(this._loadingTimer),this._loadingTimer=setTimeout(t.proxy(function(){this._loadIndicator.show()},this),this.loadIndicationDelay))},_hideLoading:function(){this.loadIndication&&(clearTimeout(this._loadingTimer),this._loadIndicator.hide())},search:function(e){return this._resetSorting(),this._resetPager(),this.loadData(e)},loadData:function(e){e=e||(this.filtering?this.getFilter():{}),t.extend(e,this._loadStrategy.loadParams(),this._sortingParams());var i=this._callEventHandler(this.onDataLoading,{filter:e});return this._controllerCall("loadData",e,i.cancel,function(e){e&&(this._loadStrategy.finishLoad(e),this._callEventHandler(this.onDataLoaded,{data:e}))})},getFilter:function(){var e={};return this._eachField(function(t){t.filtering&&this._setItemFieldValue(e,t,t.filterValue())}),e},_sortingParams:function(){return this.sorting&&this._sortField?{sortField:this._sortField.name,sortOrder:this._sortOrder}:{}},getSorting:function(){var e=this._sortingParams();return{field:e.sortField,order:e.sortOrder}},clearFilter:function(){var e=this._createFilterRow();return this._filterRow.replaceWith(e),this._filterRow=e,this.search()},insertItem:function(e){var i=e||this._getValidatedInsertItem();if(!i)return t.Deferred().reject().promise();var a=this._callEventHandler(this.onItemInserting,{item:i});return this._controllerCall("insertItem",i,a.cancel,function(e){e=e||i,this._loadStrategy.finishInsert(e),this._callEventHandler(this.onItemInserted,{item:e})})},_getValidatedInsertItem:function(){var e=this._getInsertItem();return this._validateItem(e,this._insertRow)?e:null},_getInsertItem:function(){var e={};return this._eachField(function(t){t.inserting&&this._setItemFieldValue(e,t,t.insertValue())}),e},_validateItem:function(e,a){var r=[],o={item:e,itemIndex:this._rowIndex(a),row:a};if(this._eachField(function(n){if(n.validate){var s=this._getItemFieldValue(e,n);if(s!==i){var d=this._validation.validate(t.extend({value:s,rules:n.validate},o));this._setCellValidity(a.children().eq(this._visibleFieldIndex(n)),d),d.length&&r.push.apply(r,t.map(d,function(e){return{field:n,message:e}}))}}}),!r.length)return!0;var n=t.extend({errors:r},o);return this._callEventHandler(this.onItemInvalid,n),this.invalidNotify(n),!1},_setCellValidity:function(e,t){e.toggleClass(this.invalidClass,!!t.length).attr("title",t.join("\n"))},clearInsert:function(){var e=this._createInsertRow();this._insertRow.replaceWith(e),this._insertRow=e,this.refresh()},editItem:function(e){var t=this.rowByItem(e);t.length&&this._editRow(t)},rowByItem:function(e){return e.jquery||e.nodeType?t(e):this._content.find("tr").filter(function(){return t.data(this,o)===e})},_editRow:function(e){if(this.editing){var t=e.data(o);if(!this._callEventHandler(this.onItemEditing,{row:e,item:t,itemIndex:this._itemIndex(t)}).cancel){this._editingRow&&this.cancelEdit();var i=this._createEditRow(t);this._editingRow=e,e.hide(),i.insertBefore(e),e.data(n,i)}}},_createEditRow:function(e){if(t.isFunction(this.editRowRenderer))return t(this.renderTemplate(field.editRowRenderer,field,{item:e,itemIndex:this._itemIndex(e)}));var i=t("<tr>").addClass(this.editRowClass);return this._eachField(function(t){var a=this._getItemFieldValue(e,t);this._prepareCell("<td>",t,"editcss").append(this.renderTemplate(t.editTemplate||"",t,{value:a,item:e})).appendTo(i)}),i},updateItem:function(e,t){1===arguments.length&&(t=e);var i=e?this.rowByItem(e):this._editingRow;if(t=t||this._getValidatedEditedItem())return this._updateRow(i,t)},_getValidatedEditedItem:function(){var e=this._getEditedItem();return this._validateItem(e,this._getEditRow())?e:null},_updateRow:function(e,i){var a=e.data(o),r=this._itemIndex(a),n=t.extend(!0,{},a);t.extend(!0,a,i);var s=this._callEventHandler(this.onItemUpdating,{row:e,item:a,itemIndex:r,previousItem:n});return this._controllerCall("updateItem",a,s.cancel,function(t){t=t||a;var i=this._finishUpdate(e,t,r);this._callEventHandler(this.onItemUpdated,{row:i,item:t,itemIndex:r,previousItem:n})})},_rowIndex:function(e){return this._content.children().index(t(e))},_itemIndex:function(e){return t.inArray(e,this.data)},_finishUpdate:function(e,t,i){this.cancelEdit(),this.data[i]=t;var a=this._createRow(t,i);return e.replaceWith(a),a},_getEditedItem:function(){var e={};return this._eachField(function(t){t.editing&&this._setItemFieldValue(e,t,t.editValue())}),e},cancelEdit:function(){this._editingRow&&(this._getEditRow().remove(),this._editingRow.show(),this._editingRow=null)},_getEditRow:function(){return this._editingRow.data(n)},deleteItem:function(t){var i=this.rowByItem(t);if(i.length&&(!this.confirmDeleting||e.confirm(d(this.deleteConfirm,this,i.data(o)))))return this._deleteRow(i)},_deleteRow:function(e){var t=e.data(o),i=this._itemIndex(t),a=this._callEventHandler(this.onItemDeleting,{row:e,item:t,itemIndex:i});return this._controllerCall("deleteItem",t,a.cancel,function(){this._loadStrategy.finishDelete(t,i),this._callEventHandler(this.onItemDeleted,{row:e,item:t,itemIndex:i})})}},t.fn.jsGrid=function(e){var a=t.makeArray(arguments).slice(1),o=this;return this.each(function(){var n,s=t(this),d=s.data(r);if(d)if("string"==typeof e){if((n=d[e].apply(d,a))!==i&&n!==d)return o=n,!1}else d._detachWindowResizeCallback(),d._init(e),d.render();else new l(s,e)}),o};var g={},u={},p=function(e,i){t.each(i,function(i,a){t.isPlainObject(a)?p(e[i]||e[i[0].toUpperCase()+i.slice(1)],a):e.hasOwnProperty(i)?e[i]=a:e.prototype[i]=a})};e.jsGrid={Grid:l,fields:g,setDefaults:function(e){var i;t.isPlainObject(e)?i=l.prototype:(i=g[e].prototype,e=arguments[1]||{}),t.extend(i,e)},locales:u,locale:function(e){var i=t.isPlainObject(e)?e:u[e];if(!i)throw Error("unknown locale "+e);p(jsGrid,i)},version:"1.5.1"}}(window,jQuery),function(e,t,i){function a(e){this._init(e)}a.prototype={container:"body",message:"Loading...",shading:!0,zIndex:1e3,shaderClass:"jsgrid-load-shader",loadPanelClass:"jsgrid-load-panel",_init:function(e){t.extend(!0,this,e),this._initContainer(),this._initShader(),this._initLoadPanel()},_initContainer:function(){this._container=t(this.container)},_initShader:function(){this.shading&&(this._shader=t("<div>").addClass(this.shaderClass).hide().css({position:"absolute",top:0,right:0,bottom:0,left:0,zIndex:this.zIndex}).appendTo(this._container))},_initLoadPanel:function(){this._loadPanel=t("<div>").addClass(this.loadPanelClass).text(this.message).hide().css({position:"absolute",top:"50%",left:"50%",zIndex:this.zIndex}).appendTo(this._container)},show:function(){var e=this._loadPanel.show(),t=e.outerWidth(),i=e.outerHeight();e.css({marginTop:-i/2,marginLeft:-t/2}),this._shader.show()},hide:function(){this._loadPanel.hide(),this._shader.hide()}},e.LoadIndicator=a}(jsGrid,jQuery),function(e,t,i){function a(e){this._grid=e}function r(e){this._grid=e,this._itemsCount=0}a.prototype={firstDisplayIndex:function(){var e=this._grid;return e.option("paging")?(e.option("pageIndex")-1)*e.option("pageSize"):0},lastDisplayIndex:function(){var e=this._grid,t=e.option("data").length;return e.option("paging")?Math.min(e.option("pageIndex")*e.option("pageSize"),t):t},itemsCount:function(){return this._grid.option("data").length},openPage:function(e){this._grid.refresh()},loadParams:function(){return{}},sort:function(){return this._grid._sortData(),this._grid.refresh(),t.Deferred().resolve().promise()},reset:function(){return this._grid.refresh(),t.Deferred().resolve().promise()},finishLoad:function(e){this._grid.option("data",e)},finishInsert:function(e){var t=this._grid;t.option("data").push(e),t.refresh()},finishDelete:function(e,t){var i=this._grid;i.option("data").splice(t,1),i.reset()}},r.prototype={firstDisplayIndex:function(){return 0},lastDisplayIndex:function(){return this._grid.option("data").length},itemsCount:function(){return this._itemsCount},openPage:function(e){this._grid.loadData()},loadParams:function(){var e=this._grid;return{pageIndex:e.option("pageIndex"),pageSize:e.option("pageSize")}},reset:function(){return this._grid.loadData()},sort:function(){return this._grid.loadData()},finishLoad:function(e){this._itemsCount=e.itemsCount,this._grid.option("data",e.data)},finishInsert:function(e){this._grid.search()},finishDelete:function(e,t){this._grid.search()}},e.loadStrategies={DirectLoadingStrategy:a,PageLoadingStrategy:r}}(jsGrid,jQuery),function(e,t,i){var a=function(e){return null!=e},r={string:function(e,t){return a(e)||a(t)?a(e)?a(t)?(""+e).localeCompare(""+t):1:-1:0},number:function(e,t){return e-t},date:function(e,t){return e-t},numberAsString:function(e,t){return parseFloat(e)-parseFloat(t)}};e.sortStrategies=r}(jsGrid,jQuery),function(e,t,i){function a(e){this._init(e)}a.prototype={_init:function(e){t.extend(!0,this,e)},validate:function(e){var i=[];return t.each(this._normalizeRules(e.rules),function(a,r){if(!r.validator(e.value,e.item,r.param)){var o=t.isFunction(r.message)?r.message(e.value,e.item):r.message;i.push(o)}}),i},_normalizeRules:function(e){return t.isArray(e)||(e=[e]),t.map(e,t.proxy(function(e){return this._normalizeRule(e)},this))},_normalizeRule:function(e){if("string"==typeof e&&(e={validator:e}),t.isFunction(e)&&(e={validator:e}),!t.isPlainObject(e))throw Error("wrong validation config specified");return e=t.extend({},e),t.isFunction(e.validator)?e:this._applyNamedValidator(e,e.validator)},_applyNamedValidator:function(e,i){delete e.validator;var a=r[i];if(!a)throw Error('unknown validator "'+i+'"');return t.isFunction(a)&&(a={validator:a}),t.extend({},a,e)}},e.Validation=a;var r={required:{message:"Field is required",validator:function(e){return null!=e&&""!==e}},rangeLength:{message:"Field value length is out of the defined range",validator:function(e,t,i){return e.length>=i[0]&&e.length<=i[1]}},minLength:{message:"Field value is too short",validator:function(e,t,i){return e.length>=i}},maxLength:{message:"Field value is too long",validator:function(e,t,i){return e.length<=i}},pattern:{message:"Field value is not matching the defined pattern",validator:function(e,t,i){return"string"==typeof i&&(i=new RegExp("^(?:"+i+")$")),i.test(e)}},range:{message:"Field value is out of the defined range",validator:function(e,t,i){return e>=i[0]&&e<=i[1]}},min:{message:"Field value is too small",validator:function(e,t,i){return e>=i}},max:{message:"Field value is too large",validator:function(e,t,i){return e<=i}}};e.validators=r}(jsGrid,jQuery),function(e,t,i){function a(e){t.extend(!0,this,e),this.sortingFunc=this._getSortingFunc()}a.prototype={name:"",title:null,css:"",align:"",width:100,visible:!0,filtering:!0,inserting:!0,editing:!0,sorting:!0,sorter:"string",headerTemplate:function(){return void 0===this.title||null===this.title?this.name:this.title},itemTemplate:function(e,t){return e},filterTemplate:function(){return""},insertTemplate:function(){return""},editTemplate:function(e,t){return this._value=e,this.itemTemplate(e,t)},filterValue:function(){return""},insertValue:function(){return""},editValue:function(){return this._value},_getSortingFunc:function(){var i=this.sorter;if(t.isFunction(i))return i;if("string"==typeof i)return e.sortStrategies[i];throw Error('wrong sorter for the field "'+this.name+'"!')}},e.Field=a}(jsGrid,jQuery),function(e,t,i){var a=e.Field;function r(e){a.call(this,e)}r.prototype=new a({autosearch:!0,readOnly:!1,filterTemplate:function(){if(!this.filtering)return"";var e=this._grid,t=this.filterControl=this._createTextBox();return this.autosearch&&t.on("keypress",function(t){13===t.which&&(e.search(),t.preventDefault())}),t},insertTemplate:function(){return this.inserting?this.insertControl=this._createTextBox():""},editTemplate:function(e){if(!this.editing)return this.itemTemplate(e);var t=this.editControl=this._createTextBox();return t.val(e),t},filterValue:function(){return this.filterControl.val()},insertValue:function(){return this.insertControl.val()},editValue:function(){return this.editControl.val()},_createTextBox:function(){return t("<input>").attr("type","text").prop("readonly",!!this.readOnly)}}),e.fields.text=e.TextField=r}(jsGrid,jQuery),function(e,t,i){var a=e.TextField;function r(e){a.call(this,e)}r.prototype=new a({sorter:"number",align:"right",readOnly:!1,filterValue:function(){return parseInt(this.filterControl.val()||0,10)},insertValue:function(){return parseInt(this.insertControl.val()||0,10)},editValue:function(){return parseInt(this.editControl.val()||0,10)},_createTextBox:function(){return t("<input>").attr("type","number").prop("readonly",!!this.readOnly)}}),e.fields.number=e.NumberField=r}(jsGrid,jQuery),function(e,t,i){var a=e.TextField;function r(e){a.call(this,e)}r.prototype=new a({insertTemplate:function(){return this.inserting?this.insertControl=this._createTextArea():""},editTemplate:function(e){if(!this.editing)return this.itemTemplate(e);var t=this.editControl=this._createTextArea();return t.val(e),t},_createTextArea:function(){return t("<textarea>").prop("readonly",!!this.readOnly)}}),e.fields.textarea=e.TextAreaField=r}(jsGrid,jQuery),function(e,t,i){var a=e.NumberField,r="number",o="string";function n(e){if(this.items=[],this.selectedIndex=-1,this.valueField="",this.textField="",e.valueField&&e.items.length){var t=e.items[0][e.valueField];this.valueType=typeof t===r?r:o}this.sorter=this.valueType,a.call(this,e)}n.prototype=new a({align:"center",valueType:r,itemTemplate:function(e){var i,a=this.items,r=this.valueField,o=this.textField;i=r?t.grep(a,function(t,i){return t[r]===e})[0]||{}:a[e];var n=o?i[o]:i;return null==n?"":n},filterTemplate:function(){if(!this.filtering)return"";var e=this._grid,t=this.filterControl=this._createSelect();return this.autosearch&&t.on("change",function(t){e.search()}),t},insertTemplate:function(){return this.inserting?this.insertControl=this._createSelect():""},editTemplate:function(e){if(!this.editing)return this.itemTemplate(e);var t=this.editControl=this._createSelect();return void 0!==e&&t.val(e),t},filterValue:function(){var e=this.filterControl.val();return this.valueType===r?parseInt(e||0,10):e},insertValue:function(){var e=this.insertControl.val();return this.valueType===r?parseInt(e||0,10):e},editValue:function(){var e=this.editControl.val();return this.valueType===r?parseInt(e||0,10):e},_createSelect:function(){var e=t("<select>"),i=this.valueField,a=this.textField,r=this.selectedIndex;return t.each(this.items,function(o,n){var s=i?n[i]:o,d=a?n[a]:n;t("<option>").attr("value",s).text(d).appendTo(e).prop("selected",r===o)}),e.prop("disabled",!!this.readOnly),e}}),e.fields.select=e.SelectField=n}(jsGrid,jQuery),function(e,t,i){var a=e.Field;function r(e){a.call(this,e)}r.prototype=new a({sorter:"number",align:"center",autosearch:!0,itemTemplate:function(e){return this._createCheckbox().prop({checked:e,disabled:!0})},filterTemplate:function(){if(!this.filtering)return"";var e=this._grid,i=this.filterControl=this._createCheckbox();return i.prop({readOnly:!0,indeterminate:!0}),i.on("click",function(){var e=t(this);e.prop("readOnly")?e.prop({checked:!1,readOnly:!1}):e.prop("checked")||e.prop({readOnly:!0,indeterminate:!0})}),this.autosearch&&i.on("click",function(){e.search()}),i},insertTemplate:function(){return this.inserting?this.insertControl=this._createCheckbox():""},editTemplate:function(e){if(!this.editing)return this.itemTemplate(e);var t=this.editControl=this._createCheckbox();return t.prop("checked",e),t},filterValue:function(){return this.filterControl.get(0).indeterminate?void 0:this.filterControl.is(":checked")},insertValue:function(){return this.insertControl.is(":checked")},editValue:function(){return this.editControl.is(":checked")},_createCheckbox:function(){return t("<input>").attr("type","checkbox")}}),e.fields.checkbox=e.CheckboxField=r}(jsGrid,jQuery),function(e,t,i){var a=e.Field;function r(e){a.call(this,e),this._configInitialized=!1}r.prototype=new a({css:"jsgrid-control-field",align:"center",width:50,filtering:!1,inserting:!1,editing:!1,sorting:!1,buttonClass:"jsgrid-button",modeButtonClass:"jsgrid-mode-button",modeOnButtonClass:"jsgrid-mode-on-button",searchModeButtonClass:"jsgrid-search-mode-button",insertModeButtonClass:"jsgrid-insert-mode-button",editButtonClass:"jsgrid-edit-button",deleteButtonClass:"jsgrid-delete-button",searchButtonClass:"jsgrid-search-button",clearFilterButtonClass:"jsgrid-clear-filter-button",insertButtonClass:"jsgrid-insert-button",updateButtonClass:"jsgrid-update-button",cancelEditButtonClass:"jsgrid-cancel-edit-button",searchModeButtonTooltip:"Switch to searching",insertModeButtonTooltip:"Switch to inserting",editButtonTooltip:"Edit",deleteButtonTooltip:"Delete",searchButtonTooltip:"Search",clearFilterButtonTooltip:"Clear filter",insertButtonTooltip:"Insert",updateButtonTooltip:"Update",cancelEditButtonTooltip:"Cancel edit",editButton:!0,deleteButton:!0,clearFilterButton:!0,modeSwitchButton:!0,_initConfig:function(){this._hasFiltering=this._grid.filtering,this._hasInserting=this._grid.inserting,this._hasInserting&&this.modeSwitchButton&&(this._grid.inserting=!1),this._configInitialized=!0},headerTemplate:function(){this._configInitialized||this._initConfig();var e=this._hasFiltering,t=this._hasInserting;return this.modeSwitchButton&&(e||t)?e&&!t?this._createFilterSwitchButton():t&&!e?this._createInsertSwitchButton():this._createModeSwitchButton():""},itemTemplate:function(e,i){var a=t([]);return this.editButton&&(a=a.add(this._createEditButton(i))),this.deleteButton&&(a=a.add(this._createDeleteButton(i))),a},filterTemplate:function(){var e=this._createSearchButton();return this.clearFilterButton?e.add(this._createClearFilterButton()):e},insertTemplate:function(){return this._createInsertButton()},editTemplate:function(){return this._createUpdateButton().add(this._createCancelEditButton())},_createFilterSwitchButton:function(){return this._createOnOffSwitchButton("filtering",this.searchModeButtonClass,!0)},_createInsertSwitchButton:function(){return this._createOnOffSwitchButton("inserting",this.insertModeButtonClass,!1)},_createOnOffSwitchButton:function(e,i,a){var r=a,o=t.proxy(function(){n.toggleClass(this.modeOnButtonClass,r)},this),n=this._createGridButton(this.modeButtonClass+" "+i,"",function(t){r=!r,t.option(e,r),o()});return o(),n},_createModeSwitchButton:function(){var e=!1,i=t.proxy(function(){a.attr("title",e?this.searchModeButtonTooltip:this.insertModeButtonTooltip).toggleClass(this.insertModeButtonClass,!e).toggleClass(this.searchModeButtonClass,e)},this),a=this._createGridButton(this.modeButtonClass,"",function(t){e=!e,t.option("inserting",e),t.option("filtering",!e),i()});return i(),a},_createEditButton:function(e){return this._createGridButton(this.editButtonClass,this.editButtonTooltip,function(t,i){t.editItem(e),i.stopPropagation()})},_createDeleteButton:function(e){return this._createGridButton(this.deleteButtonClass,this.deleteButtonTooltip,function(t,i){t.deleteItem(e),i.stopPropagation()})},_createSearchButton:function(){return this._createGridButton(this.searchButtonClass,this.searchButtonTooltip,function(e){e.search()})},_createClearFilterButton:function(){return this._createGridButton(this.clearFilterButtonClass,this.clearFilterButtonTooltip,function(e){e.clearFilter()})},_createInsertButton:function(){return this._createGridButton(this.insertButtonClass,this.insertButtonTooltip,function(e){e.insertItem().done(function(){e.clearInsert()})})},_createUpdateButton:function(){return this._createGridButton(this.updateButtonClass,this.updateButtonTooltip,function(e,t){e.updateItem(),t.stopPropagation()})},_createCancelEditButton:function(){return this._createGridButton(this.cancelEditButtonClass,this.cancelEditButtonTooltip,function(e,t){e.cancelEdit(),t.stopPropagation()})},_createGridButton:function(e,i,a){var r=this._grid;return t("<input>").addClass(this.buttonClass).addClass(e).attr({type:"button",title:i}).on("click",function(e){a(r,e)})},editValue:function(){return""}}),e.fields.control=e.ControlField=r}(jsGrid,jQuery);var usersAdapter=function(){function e(e,t){e.map(function(e){var i=t.find(function(t){return e.idUser==t.idUser});e.extendedInfo=i.extendedInfo})}return{createJsonUserInfo:function(e,t,i,a,r,o,n,s,d,c){return{userAssigned:e,name:t,username:i,picture:a,email:r,initials:o,isAssignee:n,owner:s,activities:d,events:c}},matchUsersForExtendedInfoCase:function(t,i){t.map(function(t){if(t.assignees&&e(t.assignees,i),t.users&&e(t.users,i),t.createdBy){var a=i.find(function(e){return t.createdBy.idUser==e.idUser});t.createdBy.extendedInfo=a.extendedInfo}})}}}();
//# sourceMappingURL=../../../../Maps/desktop/workportal.desktop.production.js.map
