!function(e){"use strict";e.fn.uicombo=function(t,o){var i=this;return i.config={namespace:e.bizagi.ui.controls.uicombo.namespace,cssComponent:e.bizagi.ui.controls.uicombo.css,internalData:{}},i.settings={data:{},ascombo:!0,disabled:!1,isSearchable:!1,isEditable:!1,nameTemplate:e.bizagi.ui.controls.uicombo.tmpl,nameSubTemplate:e.bizagi.ui.controls.uicombo.tmpl2,initValue:null,itemValue:null,itemText:null,css:"",orientation:"biz-o-left",getTemplate:function(e){return bizagi.getTemplate(e)},initializeTemplates:function(){e.Deferred();var t=this.nameTemplate,o=this.nameSubTemplate;return{combo:bizagi.getTemplate(t),list:bizagi.getTemplate(o)}},onComplete:function(){},onChange:function(){},onComboDropDown:function(){}},i.methods={init:function(t){var o,n=e(this);t.getTemplate(t.nameTemplate),t.getTemplate(t.nameSubTemplate);t.IE=navigator.appName.indexOf("Internet Explorer")>0||(!(!navigator.userAgent.match(/Trident\/7.0/)||navigator.userAgent.match(/MSIE/i))||void 0),n.attr("role",t.namespace),n.addClass(t.cssComponent),n.addClass(t.css),n.loader=new bizagi.ui.controls.tmplloader,e.when(n.loader.loadTemplates(t.initializeTemplates())).done(function(){var a=n.loader.getTemplate("combo"),s=n.loader.getTemplate("list");i.config.internalData=o=t.data,o.isEditable=t.isEditable,o.disabled=t.disabled,i.config.subTemplateHTML=s;var l=e.tmpl(a,t.data,{itemValue:t.itemValue?t.itemValue:i.methods.itemValue,itemText:t.itemText?t.itemText:i.methods.itemText});if(n.append(l),i.config.inputCombo=e(".biz-wp-combo-input",n),l.find(".biz-wp-combo-option").each(function(o,i){t.data.combo[o].data&&e.extend(e(i).data(),t.data.combo[o].data)}),i.settings.onComplete.apply(n,[]),n.methods=i.methods,n.config=i.config,n.settings=i.settings,n.methods.configureHandlers.apply(n,[]),e.event.trigger({type:"comboCompleted",message:"combo is Completed",time:new Date,ui:n}),i.settings.initValue){var c="",r="";r=i.settings.itemText?i.settings.itemText(i.settings.initValue):i.settings.initValue.text,c=i.settings.itemValue?i.settings.itemValue(i.settings.initValue):i.settings.initValue.value,""===r?n.config.inputCombo.val(""):n.config.inputCombo.val(r),i.config.inputCombo.data("value",c)}})},getControl:function(){return e(".biz-wp-combo",this)},getData:function(){return i.config.internalData},findDataByValue:function(t){if(null!=t){var o="object"==typeof t?t.join(" - "):"boolean"==typeof t?t.toString():t;e.trim(o).substring(0,o.length).toLowerCase(),this.getData()}return-1},configureHandlers:function(){var t=this,o=t.methods.getControl.apply(t,[]);t.config.inputCombo.focus(function(){}),t.config.inputCombo.blur(function(){t.settings.isSearchable&&t.methods.validateValueInDatasource()}),t.config.inputCombo.click(function(){var i="dd-"+t.config.inputCombo.attr("id");0===e("#"+i,o).length?t.methods.comboDropDown.apply(t,[]):t.methods.dropDownDestroy.apply(t,[e(i)]),t.config.inputCombo.select()}),e(".biz-wp-combo-btn",o).bind("click.combo",function(){t.config.inputCombo.trigger("click").focus()}),t.config.inputCombo.keyup(function(e){t.methods.keyUpFunction.apply(t,[e])}),t.config.inputCombo.keydown(function(e){t.methods.keyDownFunction.apply(t,[e])})},comboDropDown:function(){var t=this;e.when(t.methods.getData()).done(function(e){t.methods.internalComboDropDown.apply(t,[e]),i.settings.onComboDropDown()})},internalComboDropDown:function(t){e(".ui-select-dropdown.open").detach();var o,n=this,a={},s=e("<div class='ui-select-dropdown open'></div>"),l=n.config.inputCombo.closest(".biz-wp-combo-data-container"),c=l.closest(".biz-wp-combo"),r="dd-"+n.config.inputCombo.attr("id"),d=n.methods.findDataByValue(n.config.inputCombo.val()),m=0;t=t||n.properties.data,n.repositionInterval;var u=c.css("height"),p=n.methods.getControl.apply(n,[]);c.addClass("ac-is-visible"),c.css("height",u),l.addClass("ac-is-visible ac-clear-floats"),s.attr("id",r),o=e.tmpl(i.config.subTemplateHTML,t,{itemValue:n.settings.itemValue?n.settings.itemValue:n.methods.itemValue,itemText:n.settings.itemText?n.settings.itemText:n.methods.itemText});var b=s.append(o);l.append(b),b.position({my:"left top",at:"left bottom",of:e(".biz-wp-combo-input",p),collision:"none"}).hide(),b.fadeIn(),b.width(p.width()),n.methods.recalculateComboOffset(b,p),b.data("formWidth",l.width()),b.data("parentCombo",p),b.addClass(n.settings.orientation),-1!==d&&((a=e("li[data-value='"+d.id+"']",b)).addClass("ui-selected"),a.addClass("active"),m=parseInt(a.position().top),b.scrollTop(m)),b.on("mouseup","li",function(t){t.stopPropagation();var o={value:e(this).data("value").toString()?e(this).data("value"):"",text:e(this).text()};n.methods.onComboItemSelected.apply(n,[o]),n.config.inputCombo.focus(),b.fadeOut("slow",function(){n.methods.dropDownDestroy.apply(n,[b])}),e(document).unbind("click.closecombo")}),e.makeArray(b,n.methods.getControl.apply(n,[])).bind("click",function(e){return e.preventDefault(),!1}),b.bind("mousedown.closecombo",function(){b.attr("md",!0)}),e(document).bind("mousedown.resizecombo",function(t){e(t.target).hasClass("ui-resizable-handle")&&(n.repositionInterval&&clearInterval(n.repositionInterval),n.repositionInterval=setInterval(function(){n.methods.dropDownReposition.apply(n,[b,l])},10))}),e(document).bind("mouseup.resizecombo",function(t){clearInterval(n.repositionInterval);var o=e(t.target);b.attr("md")?b.removeAttr("md"):o.hasClass("ui-select-dropdown")||n.methods.dropDownValidClose.apply(n,[o,b])}),e(document).on("mouseup.closecombo",function(t){var o;o=n.settings.IE&&t.currentTarget.activeElement?t.currentTarget.activeElement:t.target;var i=e(o);b.attr("md")?b.removeAttr("md"):i.hasClass("ui-select-dropdown")||n.methods.dropDownValidClose.apply(n,[i,b])}),e(window).bind("resize.resizecombo",function(){n.repositionInterval&&clearInterval(n.repositionInterval),n.methods.dropDownReposition.apply(n,[b,l])}),e(document).one("click.closecombo",function(t){var o=e(t.target);b.attr("md")?b.removeAttr("md"):n.methods.dropDownValidClose.apply(n,[o,b])})},dropDownValidClose:function(t,o){var i=this;o.fadeOut("slow",function(){i.methods.dropDownDestroy.apply(i,[o])}),e(document).unbind("click.closecombo")},dropDownReposition:function(t,o){var i=this.methods.getControl.apply(this,[]);o.width()!=t.data("formWidth")&&(t.width(i.width()<100?100:i.width()),t.position({my:"left top",at:"left bottom",of:e(".biz-wp-combo-input",i),collision:"none"}),t.data("formWidth",o.width()))},dropDownDestroy:function(t){var o=this.config.inputCombo.closest(".ui-bizagi-control"),i=o.closest(".ui-bizagi-render");o.hasClass("ac-is-visible")&&o.removeClass("ac-is-visible"),o.hasClass("ac-clear-floats")&&o.removeClass("ac-clear-floats"),i.css("height","auto"),i.hasClass("ac-is-visible")&&i.removeClass("ac-is-visible"),t.remove(),e(document).unbind("mousedown.closecombo"),e(document).unbind("mouseup.resizecombo"),e(window).unbind("resize.resizecombo"),e(window).unbind("mouseup.closecombo"),this.repositionInterval,clearInterval(this.repositionInterval)},validateValueInDatasource:function(){var e=this,t=i.config.inputCombo.val(),o=e.findDataByValue(t);e.value||(e.value={id:""}),o.id>0?(e.setValue({id:o.id},!1),e.setDisplayValue(o)):""==o.id?(e.value.id!=o.id&&e.setValue(o,!1),e.setDisplayValue(o)):e.setDisplayValue(e.selectedValue)},keyDownFunction:function(t){var o=this,n="dd-"+i.config.inputCombo.attr("id"),a=e("#"+n),s=e("li.active",a);return(t=t||window.event).altKey||t.ctrlKey||t.metaKey?1:(0===a.length&&(o.methods.comboDropDown.apply(o,[]),a=e("#"+n)),t.shiftKey&&t.keyCode?(a.remove(),0):(27==t.keyCode&&(o.methods.setDisplayValue.apply(o,[o.selectedValue]),a.remove()),9==t.keyCode||13==t.keyCode?(s.length>0&&o.config.inputCombo.val(s.text()),o.settings.isSearchable?o.methods.validateValueInDatasource():o.methods.setValue.apply(o,[s.data("value")]),a.remove(),1):"38"==t.keyCode||"37"==t.keyCode?(o.methods.selectPreviousElement.apply(o,[a]),0):"40"==t.keyCode||"39"==t.keyCode?(o.methods.selectNextElement.apply(o,[a]),0):36==t.keyCode?(o.methods.selectFirstElement.apply(o,[a]),0):35==t.keyCode?(o.methods.selectLastElement.apply(o,[a]),0):1))},keyUpFunction:function(t){var o="dd-"+i.config.inputCombo.attr("id"),n=e("#"+o);return(t=t||window.event).altKey||t.ctrlKey||t.metaKey||50==t.keyCode||13==t.keyCode||9==t.keyCode||27==t.keyCode||"38"==t.keyCode||"40"==t.keyCode||t.shiftKey&&t.keyCode||36==t.keyCode||35==t.keyCode||33==t.keyCode||34==t.keyCode?0:(0===n.length&&(this.methods.comboDropDown.apply(this,[]),n=e("#"+o)),this.methods.selectItemByKeyUp.apply(this,[]),1)},selectItemByKeyUp:function(){var t,o=this,n="dd-"+i.config.inputCombo.attr("id"),a=e("#"+n);e(".active",a).removeClass("active");var s=o.settings.isSearchable?o.methods.findDataByValue(i.config.inputCombo.val()):-1;-1!==s?(t=e("li[data-value='"+s.id+"']",a)).addClass("active"):t=e("li.ui-selected",a),a.length>0&&t.length>0?(scrollPosition=parseInt(t.position().top),a.scrollTop(scrollPosition)):o.methods.setValue.apply(o,[o.selectedValue])},selectFirstElement:function(t){var o=e("li:first",t);e("li",t).removeClass("active"),o.addClass("active"),scrollPosition=o.position().top,t.scrollTop(scrollPosition),i.config.inputCombo.val(e(o).text())},selectLastElement:function(t){var o=e("li:last",t);e("li",t).removeClass("active"),o.addClass("active"),scrollPosition=o.position().top,t.scrollTop(scrollPosition),i.config.inputCombo.val(e(o).text())},selectPreviousElement:function(t){var o=0,n=e("li.active",t);0===n.length&&(n=e("li:first",t));var a=n.prev();0!=a.length&&(n.removeClass("active"),e(a).addClass("active"),o=e(a).position().top,t.scrollTop(o),i.config.inputCombo.val(e(a).text()))},selectNextElement:function(t){var o=0,n=e("li.active",t);0===n.length&&(n=e("li:first",t));var a=n.next();0!=a.length&&(n.removeClass("active"),e(a).addClass("active"),o=e(a).position().top,t.scrollTop(o),i.config.inputCombo.val(e(a).text()))},onComboItemSelected:function(e){var t=e.value.toString(),o=e.text||"";this.config.inputCombo.val(o),this.methods.setValue.apply(this,[t])},setValue:function(t){this.config.inputCombo.data("value",t);var o=this.config.inputCombo,n={type:"comboChange",message:"combo change",time:new Date,ui:o};i.settings.onChange(n),e.event.trigger(n)},setDisplayValue:function(e){null!==(e=i.settings.itemValue?i.settings.itemValue:i.methods.itemValue)?i.config.inputCombo.val(""):null===e&&i.config.inputCombo.val("")},clearDisplayValue:function(){i.config.inputCombo.val(""),this.value=this.properties.value=this.selectedValue},getSelectedValue:function(){return this.selectedValue},recalculateComboOffset:function(e,t){if(bizagi.util.isIE()&&9==bizagi.util.getInternetExplorerVersion()&&e.width()!==t.width()){var o=t.width()-e.width();e.width(t.width()+o)}},itemValue:function(e){var t="";return e.itemValue?t=e.itemValue(e):"string"!=typeof e.value&&"number"!=typeof e.value||(t=e.value),t},itemText:function(e){var t="";return e.itemValue?t=e.itemText(e):"string"==typeof e.text&&(t=e.text),t},destroy:function(t){var o=e(this);o.attr("role")===t.namespace?o.empty():e.error("No es posible eliminar un control con un namespace diferente: [role: "+t.namespace+"]")},selectItem:function(t){var o=e(".biz-wp-combo-input",this);o.val(t.text),o.data("value",t.value)}},"object"!=typeof t&&t?(e.extend(i.settings,o,i.config),i.methods[t].apply(this,[i.settings])):"object"!=typeof t&&t&&void 0!==t?void e.error("Method "+t+" does not exist on jQuery.combo"):(e.extend(i.settings,t,i.config),this.each(function(){i.methods.init.apply(this,[i.settings])}))},e.bizagi.ui.controls.uicombo.plugin=e.fn.uicombo}(jQuery);
//# sourceMappingURL=../../../../Maps/desktop/activity-plan-common.desktop.production.js.map
